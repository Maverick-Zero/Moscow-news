/*! For license information please see player-api.modern.js.LICENSE.txt */
(()=>{function e(i){var n=r[i];if(void 0!==n)return n.exports;var s=r[i]={id:i,exports:{}};return t[i].call(s.exports,s,s.exports,e),s.exports}var t={7050:(e,t,r)=>{function i(e){var t=n(e);return r(t)}function n(e){if(!r.o(s,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return s[e]}var s={"./be.ts":5506,"./en.ts":7520,"./id.ts":823,"./kk.ts":2987,"./ru.ts":4072,"./tr.ts":1578,"./tt.ts":4606,"./uk.ts":2468,"./uz.ts":6185};i.keys=function(){return Object.keys(s)},i.resolve=n,e.exports=i,i.id=7050},856:(e,t,r)=>{(t=e.exports=r(870)(!1)).push([e.id,"@keyframes _1f86Je8{0%{transform:rotate(0deg)}to{transform:rotate(360deg)}}._3dwjosp{position:absolute;top:50%;left:50%;pointer-events:none}._2iJDT4A{position:absolute;top:-19px;left:-19px;width:38px;height:38px;animation-name:_1f86Je8;animation-duration:1s;animation-iteration-count:infinite;animation-timing-function:linear}",""]),t.locals={spinner:"_3dwjosp",spinner__svg:"_2iJDT4A",spinner_animation:"_1f86Je8"}},5654:(e,t,r)=>{(e.exports=r(870)(!1)).push([e.id,"yaplayertag,yaplayertag:before,yaplayertag:after,yaplayertag *,yaplayertag :before,yaplayertag :after{hyphens:manual;font-size:inherit;color:inherit;background:0 0;border:0;border-radius:0;border-spacing:0;border-collapse:collapse;box-sizing:content-box;clear:none;float:none;font-variant:normal;font-weight:inherit;letter-spacing:normal;line-height:normal;margin:0;max-height:none;max-width:none;min-height:0;min-width:0;outline:0;padding:0;position:static;text-align:left;text-decoration:none;text-indent:0;text-transform:none;vertical-align:baseline;visibility:inherit;word-spacing:normal}",""])},4661:(e,t,r)=>{(t=e.exports=r(870)(!1)).push([e.id,"._1gZJUfw{user-select:none;-webkit-user-select:none;-webkit-tap-highlight-color:transparent;-webkit-tap-highlight-color:transparent;-webkit-touch-callout:none;position:relative;background:#000;background-position:center;background-size:contain;background-repeat:no-repeat;width:100%;height:100%;font-family:'Helvetica Neue',Helvetica,Arial,sans-serif;overflow:hidden;text-align:left;outline:0}._2jlIyxK{width:100%;height:100%;font-family:'Helvetica Neue',Helvetica,Arial,sans-serif;overflow:hidden;user-select:none;text-align:left;outline:0;position:absolute;top:0;left:0;pointer-events:none;background:0 0}._1gZJUfw ._17DR8Wz{display:none!important}._1gZJUfw>.KNlHF8r{position:absolute;width:100%;height:100%;border:0}._1gZJUfw .xDBHr4L{position:absolute;width:100%;height:100%;pointer-events:none}._1gZJUfw video{width:100%;height:100%}._1gZJUfw video::-webkit-media-controls-start-playback-button{z-index:2147483647!important}._1gZJUfw video._33stY3F::-webkit-media-controls-start-playback-button{display:none!important}._1CaeSWZ{object-fit:cover!important}",""]),t.locals={StreamPlayer:"_1gZJUfw",StreamPlayer_ui:"_2jlIyxK",hidden:"_17DR8Wz",container:"KNlHF8r",adSkin:"xDBHr4L","hide-native-play-button":"_33stY3F",StreamPlayer_iosLandscapeWorkaround:"_1CaeSWZ"}},8024:(e,t,r)=>{var i=r(3379),n=r(866);"string"===typeof(n=n.__esModule?n.default:n)&&(n=[[e.id,n,""]]);var s={injectType:"singletonStyleTag",attributes:{"data-ya-player-style":"data-ya-player-style"},insert:"head",singleton:!0};i(n,s);e.exports=n.locals||{}},3379:(e,t,r)=>{"use strict";function i(e){for(var t=-1,r=0;r<p.length;r++)if(p[r].identifier===e){t=r;break}return t}function n(e,t){for(var r={},n=[],s=0;s<e.length;s++){var a=e[s],o=t.base?a[0]+t.base:a[0],d=r[o]||0,u="".concat(o," ").concat(d);r[o]=d+1;var c=i(u),h={css:a[1],media:a[2],sourceMap:a[3]};-1!==c?(p[c].references++,p[c].updater(h)):p.push({identifier:u,updater:l(h,t),references:1}),n.push(u)}return n}function s(e){var t=document.createElement("style"),i=e.attributes||{};if("undefined"===typeof i.nonce){var n=r.nc;n&&(i.nonce=n)}if(Object.keys(i).forEach((function(e){t.setAttribute(e,i[e])})),"function"===typeof e.insert)e.insert(t);else{var s=h(e.insert||"head");if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(t)}return t}function a(e,t,r,i){var n=r?"":i.media?"@media ".concat(i.media," {").concat(i.css,"}"):i.css;if(e.styleSheet)e.styleSheet.cssText=f(t,n);else{var s=document.createTextNode(n),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(s,a[t]):e.appendChild(s)}}function o(e,t,r){var i=r.css,n=r.media,s=r.sourceMap;if(n?e.setAttribute("media",n):e.removeAttribute("media"),s&&"undefined"!==typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),e.styleSheet)e.styleSheet.cssText=i;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(i))}}function l(e,t){var r,i,n;if(t.singleton){var l=g++;r=m||(m=s(t)),i=a.bind(null,r,l,!1),n=a.bind(null,r,l,!0)}else r=s(t),i=o.bind(null,r,t),n=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(r)};return i(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;i(e=t)}else n()}}var d,u,c=function(){return"undefined"===typeof d&&(d=Boolean(window&&document&&document.all&&!window.atob)),d},h=function(){var e={};return function(t){if("undefined"===typeof e[t]){var r=document.querySelector(t);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(i){r=null}e[t]=r}return e[t]}}(),p=[],f=(u=[],function(e,t){return u[e]=t,u.filter(Boolean).join("\n")}),m=null,g=0;e.exports=function(e,t){(t=t||{}).singleton||"boolean"===typeof t.singleton||(t.singleton=c());var r=n(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var s=0;s<r.length;s++){var a=i(r[s]);p[a].references--}for(var o=n(e,t),l=0;l<r.length;l++){var d=i(r[l]);0===p[d].references&&(p[d].updater(),p.splice(d,1))}r=o}}}},7792:e=>{e.exports='<svg viewBox="0 0 29 29" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.5 1.5a13 13 0 1 0 12.898 14.63" stroke="#fff" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"></path></svg>'},310:e=>{e.exports='<svg viewBox="0 0 18 18"><path d="M14.684 3.292Q17.053 5.661 17.053 9q0 3.34-2.369 5.708Q12.34 17.053 9 17.053V18q3.742 0 6.371-2.629Q18 12.742 18 9q0-3.718-2.629-6.371Q12.742 0 9 0v.947q3.34 0 5.684 2.345z"></path></svg>'},5506:(e,t,r)=>{"use strict";r.r(t),r.d(t,{be:()=>i});const i={TRACK_AUTO:"\u0410\u045e\u0442\u0430"}},7520:(e,t,r)=>{"use strict";r.r(t),r.d(t,{en:()=>i});const i={TRACK_AUTO:"Auto"}},823:(e,t,r)=>{"use strict";r.r(t),r.d(t,{id:()=>i});const i={TRACK_AUTO:"Otomatis"}},2987:(e,t,r)=>{"use strict";r.r(t),r.d(t,{kk:()=>i});const i={TRACK_AUTO:"\u0410\u0432\u0442\u043e"}},4072:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ru:()=>i});const i={TRACK_AUTO:"\u0410\u0432\u0442\u043e"}},1578:(e,t,r)=>{"use strict";r.r(t),r.d(t,{tr:()=>i});const i={TRACK_AUTO:"Oto"}},4606:(e,t,r)=>{"use strict";r.r(t),r.d(t,{tt:()=>i});const i={TRACK_AUTO:"\u0410\u0432\u0442\u043e"}},2468:(e,t,r)=>{"use strict";r.r(t),r.d(t,{uk:()=>i});const i={TRACK_AUTO:"\u0410\u0432\u0442\u043e"}},6185:(e,t,r)=>{"use strict";r.r(t),r.d(t,{uz:()=>i});const i={TRACK_AUTO:"Avto"}},1485:(e,t,r)=>{"use strict";function i(e){return new Promise((t,r)=>{const i=new Image;i.onload=function(){i.width>0&&i.height>0&&t(!0),r("Feature isn't supported")},i.onerror=function(){r("Feature isn't supported")},i.src="data:image/webp;base64,"+b[e]})}async function n(e,t){if(!(0,E.HD)(e))return;const r=e.replace(/https?:\/\//i,"").replace(/\/\//i,"").split("/")[1]||null;if(!r||-1===_.indexOf(r))return e;const n=(t?function(e){if("object"!==typeof e)return T.Horizontal;const{width:t,height:r}=e;return t&&r?t>r?T.Horizontal:T.Vertical:T.Horizontal}(t):T.Horizontal)===T.Horizontal?"1920x1080":"1080x1920",s=await async function(){try{const e=localStorage.getItem("playerapi_webp_support_info");if(null!==e){const{isWebpSupported:t,lastCheckTimestamp:r}=JSON.parse(e);if(t)return!0;if(Date.now()-r<864e5)return!1}return await Promise.all([i("lossy"),i("lossless"),i("alpha"),i("animation")]),localStorage.setItem("playerapi_webp_support_info",JSON.stringify(new A(!0))),!0}catch(e){return localStorage.setItem("playerapi_webp_support_info",JSON.stringify(new A(!1))),!1}}()?"q15":"q30";return e.replace("orig",""+n+s)}function s(e){return new w.A(e).toString("/",!0,P)}function a(e,t){const r={content_id:t.content_id,stream_block:t.stream_block,channel_id:t.channel_id,path:"player-events."+e};return"error"===e&&(r.error_code="{{error-code}}"),"seek"===e&&(r.position_from="{{old-position}}"),function(e){if(C&&e.reqid===I)return C;I=e.reqid;const t={reqid:I,yandexuid:e.yandexuid,select_event:"click",cid:73037,pid:197,dtype:"stred",source:e.from,from_block:e.from_block};return e.licence&&(t.licence=e.licence),e.svod&&(t.svod=e.svod),C=k+"//yandex.ru/clck/jclck/"+s(t)}(t)+s({rnd:"{{random}}",fullscreen:"{{fullscreen}}",mute:"{{muted}}",duration:"{{duration}}",timestamp:"{{timestamp}}",user_ts:"{{vts}}",watchedTime:"{{fts}}",vsid:"{{vsid}}"})+s(r)+"*"}function o(e,t){this[t]=Boolean(e)}function l(e,t){this[t]=void 0!==e?Boolean(e):void 0}function d(e,t){!0===e&&(this[t]=e)}function u(e,t){e&&(this[t]=String(e))}function c(e,t){(0,E.hj)(e)&&(this[t]=e)}function h(e,t){const r=Number(e);this[t]=(0,E.hj)(r)?r:0}function p(e,t){!M&&Array.isArray(e)&&(M=!0,this[t]=e)}function f(){return{from:{value:"other",set:u},slots:null,"test-id":{value:[],set(e,t){const r=(0,E.HD)(e)?w.A.parseJSON(e):e;r&&(Array.isArray(r)?this[t]=r.filter(Boolean).map(String):(0,E.HD)(r)?this[t]=r.split(/[,_]/).filter(Boolean):(0,E.hj)(r)&&(this[t]=[String(r)]))}},distr_id:null,audio_only:!1,tv:{value:!1,set:o},loop:{value:!1,set:o},preload:{value:!1,set:o},report:{value:!0,set:o},preview:{value:!0,set:o},preview_src:{value:"",set:u},poster_object_fit:{set:u},nativeui:{value:!1,set:o},use_friendly_frame:{value:!0,set:o},branding_intro:{value:!1,set:o},restore_playback_progress:{value:!1,set:o},remote_progress_saving:{value:!1,set:o},progress:{value:!0,set:o},start_position_confirmation:{value:!1,set:o},force_unmute:{value:!0,set:o},stream_cms:{value:!0,set:o},beta:{value:!1,set:d},event_prefix:{value:"",set:u},from_block:{value:"other",set:u},hidden:{value:"",set:u},device_id:{value:"",set:u},primary_color:{set:u},secondary_color:{set:u},pip:{value:!0,set(e,t){0===e&&(this[t]=!1)}},autoplay:{value:!0,set(e,t){0===e&&(this[t]=!1)}},lang:{value:"",set(e,t){var r;(r=e,-1!==x.indexOf(r))&&(this[t]=e)}},allow_muted:{set:o},mute:{value:!1,set:l},volume:{set(e,t){(0,E.hj)(e)&&e>=0&&e<=100&&(this[t]=e)}},play_on_visible:{set(e,t){(0,E.hj)(e)?e>0&&e<=1&&(this[t]={threshold:e}):(0,E.o8)(e)||"undefined"===e||(this[t]=Boolean(e))}},adConfig:{set(e,t){(0,E.Kn)(e)&&(this[t]=e)}},streams:{set(e,t){Array.isArray(e)&&(this[t]=e)}},vmap_id:{set:h},vmap_scenario_id:{set:h},meta:{value:void 0,set(e,t){if(!(0,E.HD)(e))return;const r=O[e];(0,E.hj)(r)&&(this[t]=r)}},subscribe_button:{value:void 0,set(e,t){if(!(0,E.HD)(e))return;const r=D[e];(0,E.hj)(r)&&(this[t]=e)}},m_duration:{value:3e3,set(e,t){(0,E.hj)(e)&&e>=0&&(this[t]=1e3*e)}},m_title:{value:null,set:u},m_desc:{value:null,set:u},live_offset:{set(e,t){(0,E.hj)(e)&&e>=0&&(this[t]=e)}},platform:{set(e,t){N.indexOf(e)>-1&&(this[t]=e)}},mod:{value:"",set:u},t:{set:c},skippable_fragments:{value:!0,set:o},preferable_width:{set:c},preferable_height:{set:c},preferable_audio:{value:[],set(e,t){this[t]="string"===typeof e?e.split(",").filter(e=>e.length>0):[]}},preferable_text:{value:[],set(e,t){this[t]="string"===typeof e?e.split(",").filter(e=>e.length>0):[]}},release_timeout:{value:0,set:c},retpath:{set:u},ya_station:{value:!0,set:o},share:{value:!0,set:o},has_preroll:{set:o},disable_update:{value:!1,set:o},velocity_metrics_sampled:{value:!0,set:o},test_mode:{value:!1,set:o},test_data:{value:"default",set(e,t){var r;(r=e,-1!==L.indexOf(r))&&(this[t]=e)}},object_fit:{set:u},background_color:{set:u},zen_preload:{set:o},disable_postmessage_broadcast:{value:!1,set:o},cache_sources_count:{set:h},scriptedEvents:{set:p},version:{set(e,t){/^1\.0-\d+$/.test(e)&&(this[t]=e)}}}}function m(e,t){var r,i,n,s;const a={yandexuid:U,reqid:t.reqid,from:t.from,sandboxVersion:null==(r=e.request_info)?void 0:r.player_version,slots:(0,B.S)((null==(i=e.request_info)?void 0:i.slots)||"",t.slots||""),frontendVhReqid:e["apphost-reqid"]||(null==(n=e.user_data)?void 0:n.req_id),contentId:null!=(o=e.content)&&o.actual_episode?e.content.actual_episode.content_id:null==(l=e.content)?void 0:l.content_id,fromBlock:t.from_block,streamBlock:t.stream_block||(null==(s=e.content)?void 0:s.streamBlock)};var o,l,d;(!a.reqid&&(0,E.Kn)(t.counters)&&(a.reqid=t.counters.reqid),!a.reqid&&e.user_data)&&(a.reqid=null==(d=e.user_data)?void 0:d.req_id);return a.reqid||(a.reqid=""),a}function g(e,t){const r=parseFloat(e);r===r&&(this[t]=r)}function v(e,t){(0,E.o8)(e)||(this[t]=e)}function y(){return(y=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}r.d(t,{y:()=>W});var S=r(8225),E=r(719);const b={lossy:"UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",lossless:"UklGRhoAAABXRUJQVlA4TA0AAAAvAAAAEAcQERGIiP4HAA==",alpha:"UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAwAAAARBxAR/Q9ERP8DAABWUDggGAAAABQBAJ0BKgEAAQAAAP4AAA3AAP7mtQAAAA==",animation:"UklGRlIAAABXRUJQVlA4WAoAAAASAAAAAAAAAAAAQU5JTQYAAAD/////AABBTk1GJgAAAAAAAAAAAAAAAAAAAGQAAABWUDhMDQAAAC8AAAAQBxAREYiI/gcA"};class A{constructor(e){this.isWebpSupported=void 0,this.lastCheckTimestamp=void 0,this.isWebpSupported=e,this.lastCheckTimestamp=Date.now()}}var T;!function(e){e.Horizontal="HORIZONTAL",e.Vertical="VERTICAL"}(T||(T={}));const _=["get-vh"];var w=r(1321);const k="undefined"!==typeof window&&"http:"===location.protocol?"http:":"https:",R=["init","error","adStart","adEnd","start","play","pause","end","seek"],P=["rnd","fullscreen","mute","duration","timestamp","user_ts","watchedTime","vsid","error_code","position_from"];let C="",I="";const O={none:0,always:1,start:2,ui:3,restriction_age:4},D={plain:0,colourful:1,with_subscribe_info:2,with_subscribe_label:3},N=["desktop","touch","pad","app","tv","tvapp"],L=["default","live","paid","avod","alive"],x=["be","en","id","kk","ru","tr","tt","uk","uz"];let M=!1;const F=function(e,t){return function(r,i){if(!(0,E.mf)(i))throw new Error("VHQuery: missing method for handling unsafe params.");const n=new w.A(r,e(),i.bind(this));return t(n)}}((function(){return f()}),(function(e){return e.reqid&&(0,E.Kn)(e.counters)&&!e.counters.reqid&&(e.counters.reqid=e.reqid),(0,E.Kn)(e.counters)&&e.counters.reqid&&!e.reqid&&(e.reqid=e.counters.reqid),(e.tv||e.nativeui||e.test_mode)&&(e.recommendations=""),function(e){const t={};(0,E.HD)(e.slots)&&e.slots.split(";").forEach((function(e){const r=e.split(",",1)[0];r&&(t[r]=e)}));Array.isArray(e["test-id"])&&e["test-id"].forEach((function(e){e&&(t[e]||(t[e]=e+",0,-1"))}));let r="";const i=[];for(const n in t)t.hasOwnProperty(n)&&(r+=r.length>0?";"+t[n]:t[n],i.push(n));r&&(e.slots=r);i.length>0&&(e["test-id"]=i)}(e),e}));class V{static parse(){const e=V.getDefault();for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];const n=r.filter(Boolean).join(";"),s=w.A.parse(n,";",!0);return new w.A(s,e)}static getDefault(){return{"videoplayer-version":void 0,version:void 0,force_unmute:{value:void 0,set:o},restore_playback_progress:{value:void 0,set:o},use_friendly_frame:{value:void 0,set:o},progress:{value:void 0,set:o},start_position_confirmation:{value:void 0,set:o},hide_brand_play_button:{value:void 0,set:o},disable_autoplay_slow_connection:{value:!1,set:o},disable_autoplay_save_data:{value:!1,set:o},max_buffer_length:{value:void 0,set:c},bandwidth_estimate_offset:{value:void 0,set:c},soft_max_res_height:{value:void 0,set:c},poll_id:{value:void 0,set:u},poll_timeout:{value:21600,set:c},poll_show_before_midroll:{value:!1,set:o}}}}var B=r(3563);const U=((e,t)=>{let r=[];try{r=e.cookie?e.cookie.split("; "):[]}catch(s){}const i=/(%[0-9A-Z]{2})+/g;let n;for(let a=0;a<r.length;a++){const e=r[a].split("="),o=e.slice(1).join("=");try{const r=e[0].replace(i,decodeURIComponent);if(o.replace(i,decodeURIComponent),t===r){n=decodeURIComponent(o);break}}catch(s){return}}return n})(document,"yandexuid");var j=r(5859);class H{static create(e){var t,r,i;let{queryParams:n,vhParams:s,playerApi:a}=e;const o=F(n||{},()=>{});null!=(t=s.content)&&t.ottParams&&(0,E.hj)(null==(r=s.content)?void 0:r.restriction_age)&&(o.meta=O.restriction_age,o.m_duration=8,o.m_title=s.content.restriction_age+"+");const l=V.parse(null==(i=s.request_info)?void 0:i.flags,o.mb_flags);return function(e,t){e.version=e["videoplayer-version"]||t.version,e.progress=(0,E.jn)(e.progress)?e.progress:t.progress,e.start_position_confirmation=(0,E.jn)(e.start_position_confirmation)?e.start_position_confirmation:t.start_position_confirmation,e.force_unmute=(0,E.jn)(e.force_unmute)?e.force_unmute:t.force_unmute,e.restore_playback_progress=(0,E.jn)(e.restore_playback_progress)?e.restore_playback_progress:t.restore_playback_progress,e.hide_brand_play_button=(0,E.jn)(e.hide_brand_play_button)?e.hide_brand_play_button:t.hide_brand_play_button}(l,o),new H({query:o,expFlags:l,params:{data:s},player:a,ids:m(s,o)})}constructor(e){this.params=void 0,this.query=void 0,this.ids=void 0,this.expFlags=void 0,this.player=void 0,this.requestInfo=void 0,this.params=e.params,this.query=e.query,this.ids=e.ids,this.expFlags=e.expFlags,this.player=e.player,this.requestInfo=e.params.data.request_info||{}}async prepareVHParams(){const e=this.params.data.content||{},t=Object.create(e),r=e.actual_episode;if(r)for(const n in r)r.hasOwnProperty(n)&&(t[n]=r[n]);t.stream&&(t.withCredentials=Boolean(t.stream.withCredentials)),t.loop=Boolean(t.loop);const i=e.max_video_size;return t.meta&&(t.meta.announce_thumbnail=await n(t.meta.announce_thumbnail,i)),t.thumbnail=await n(t.thumbnail,i),t.onto_poster=await n(t.onto_poster,i),t.cover=await n(t.cover,i),t.first_frame_url=await n(t.first_frame_url,i),t}getHiddenControls(e){if(this.query.tv)return"*";let t=[];return(0,E.Kn)(null==e?void 0:e.auto_fields)&&null!=e&&e.auto_fields.player_controls_hidden&&(t=e.auto_fields.player_controls_hidden),[].concat(t,this.query.hidden.split(",")).join(",")}getLiveOffset(e){return(0,E.hj)(this.query.live_offset)?this.query.live_offset:null!=e&&e.ugc_live?15:void 0}getSkinConfig(e){const t=this.getHiddenControls(e),r=this.getLogoConfig(e),i=this.getTitleSettings(),n=this.getSubscribeButton();return{showReportButton:this.query.report,showUnmuteButtonForAll:this.expFlags.force_unmute,logoConfig:r,hiddenControls:t,showSubscribeButton:n,title:i,primaryColor:this.getColor(this.query.primary_color),secondaryColor:this.getColor(this.query.secondary_color),timelineThumbColor:this.getColor(this.query.timeline_thumb_color)}}async getPlayerConfig(){const e=await this.prepareVHParams(),t=this.getSourceConfig(e),r=this.getAutoplay(),i=this.getLiveOffset(e),n={source:t,skinParams:{skinConfig:this.getSkinConfig(e)},autoplay:r,allowPip:this.query.pip,volume:this.query.volume,muted:this.query.mute,lang:this.query.lang||this.requestInfo.lang,preload:this.getPreload(),platform:this.query.platform,togglePlaybackOnVisibilityChange:this.query.play_on_visible,useAbdBundle:this.requestInfo.use_aab_bundle,useFriendlyFrame:this.query.use_friendly_frame,flags:this.expFlags,usePlayerApiMock:this.query.test_mode,liveOffset:i,slowConnection:this.requestInfo.slow_connection||this.query.slow_connection,maxBufferLength:this.expFlags.max_buffer_length,bandwidthEstimateOffset:this.expFlags.bandwidth_estimate_offset,logUrl:this.requestInfo.use_aab_bundle?this.requestInfo.logging_url:void 0,device:{id:this.query.device_id},objectFit:this.query.object_fit,backgroundColor:this.query.background_color,zenPreload:this.query.zen_preload,cacheSourcesCount:this.query.cache_sources_count,restoreTabSessionPlaybackProgress:this.expFlags.restore_playback_progress,loadSkin:this.query.skin};return this.params.disableOTTPlayerLoader&&(n.disableOTTPlayerLoader=!0),n}getSourceConfig(e){var t;this.preparePlaybackParams(e),this.prepareAdParams(e);const r=String(this.getStreamParams(e)),i=this.getAdConfig(e),n=this.getVideoInfo(e),s=this.getTrackings(e),a=this.getOTTParams(e),o=this.getStartPosition(e),l=this.getAdditionalParams(e),d=this.getPreview(e),u=this.getPosterStyle(),c={adConfig:i,videoInfo:n,trackings:s,preview:d,firstFrameHash:null==e?void 0:e.first_frame_hash,firstFrameUrl:null==e?void 0:e.first_frame_url,startPosition:o,enableRemoteProgressSaving:this.query.remote_progress_saving||this.expFlags.progress,withCredentials:this.query.with_credentials||(null==e?void 0:e.withCredentials),loop:(null==e?void 0:e.loop)||this.query.loop,additionalParams:l,preferredTracks:{preferredAudioLangs:this.query.preferable_audio,preferredTextLangs:this.query.preferable_text},context:a,passportRetpath:this.query.retpath},h=null==(t=this.getStreamsConfig(e))?void 0:t.map((function(e){return r&&(e.url+=e.url.indexOf("?")>-1?"&":"?",e.url+=r),e}));return h&&(c.streams=h),u&&(c.posterStyle=u),this.params.data.scriptedEvents&&(c.scriptedEvents=this.params.data.scriptedEvents),(0,E.HD)(l.slots)&&(0,E.Kn)(c.context)&&(c.context.testIds=l.slots.split(";").map(e=>parseInt(e,10)).join(",")),this.query.scriptedEvents&&(c.scriptedEvents=this.query.scriptedEvents,delete this.query.scriptedEvents),c}preparePlaybackParams(e){e&&(e.start_time=parseInt(e.start_time,10)||void 0,e.finish_time=parseInt(e.finish_time,10),e.finish_time=isNaN(e.finish_time)?void 0:e.finish_time-1,e.dvr=parseInt(e.dvr,10)||void 0)}prepareAdParams(e){e&&(e.imp_id=1,(0,E.Kn)(e.adConfig)&&!e.adConfig.category&&(e.adConfig.category=1017))}getStreamParams(e){const t={audio_only:this.query.audio_only,start:null==e?void 0:e.start_time,end:null==e?void 0:e.finish_time,dvr:null==e?void 0:e.dvr,soft_max_res_height:this.expFlags.soft_max_res_height};return new w.A(t,{audio_only:{set(e,t){e&&(this[t]=1)}},start:{set:v},end:{set:v},dvr:{set:v},soft_max_res_height:{set:g}})}getStreamsConfig(e){const t=Array.isArray(this.query.streams)?this.query.streams:null==e?void 0:e.streams;if(Array.isArray(t))return t.reduce((function(e,t){const r={};for(const n in t)t.hasOwnProperty(n)&&(r[n]=t[n]);if(!r.url)return e;const i=r.id||"default";return e.defId||(e.defId=i),r.drmConfig=r.drmConfig||r.drm_config||void 0,delete r.id,delete r.options,delete r.drm_config,i===e.defId&&e.result.push(r),e}),{result:[],defId:""}).result}getAdConfig(e){if((0,E.Kn)(this.query.adConfig))return this.query.adConfig;const t=(0,E.Kn)(null==e?void 0:e.adConfig)?null==e?void 0:e.adConfig:{},r=t||{};if(t){r.partnerId=t.partner_id||t.partnerId,r.category=t.category,r.videoContentId=t.video_content_id||t.videoContentId,r.videoContentName=t.video_content_name||t.videoContentName,r.videoGenreId=t.video_genre_id,r.videoGenreName=t.video_genre_name,r.hasPreroll=(0,E.jn)(this.query.has_preroll)?this.query.has_preroll:t.hasPreroll,r.distrId=this.query.distr_id||t.distr_id,r.useAdSession=(0,E.jn)(this.query.use_ad_session)?this.query.use_ad_session:t.useAdSession;const e=parseInt(r.partnerId,10);e&&(r.partnerId=e);const i=parseInt(r.category,10);i&&(r.category=i),t.video_publisher_id&&(r.videoPublisherId=t.video_publisher_id),t.video_publisher_name&&(r.videoPublisherName=t.video_publisher_name)}return this.query.vmap_id&&(r.vmapId=this.query.vmap_id),this.query.vmap_scenario_id&&(r.vmapScenarioId=this.query.vmap_scenario_id),(0,E.hj)(this.query.preferable_width)&&(0,E.hj)(this.query.preferable_height)&&(r.preferableAdSize={width:this.query.preferable_width,height:this.query.preferable_height}),r}getVideoInfo(e){const t=(0,E.Kn)(null==e?void 0:e.adConfig)?null==e?void 0:e.adConfig:{},r={videoContentId:null==e?void 0:e.content_id,videoContentName:null==e?void 0:e.title,videoContentDescription:null==e?void 0:e.description,videoPublisherId:(null==t?void 0:t.video_publisher_id)||"",videoPublisherName:(null==t?void 0:t.video_publisher_name)||""};return r.videoGenreId=String((null==t?void 0:t.video_genre_id)||""),r.videoGenreName=String((null==e?void 0:e.genres)||(null==t?void 0:t.video_genre_name)||""),Object.keys(r).reduce((function(e,t){const i=r[t];return i&&(e[t]=i),e}),{})}getTrackings(e){if("zen"===this.ids.from)return{trackingEvents:[]};let t=[];(0,E.Kn)(null==e?void 0:e.trackingEvents)&&(t=t.concat(e.trackingEvents)),(0,E.Kn)(null==e?void 0:e.stream)&&(0,E.Kn)(null==e?void 0:e.stream.trackings)&&(0,E.Kn)(null==e?void 0:e.stream.trackings.trackingEvents)&&(t=t.concat(e.stream.trackings.trackingEvents));const r=this.getYaVideoTrackings(e);return r&&(t=t.concat(r).filter(Boolean)),{trackingEvents:t}}getSubscribeButton(){return{type:this.query.subscribe_button}}getColor(e){return e&&(0,E.HD)(e)&&CSS.supports("color","#"+e)?"#"+e:e}getPreview(e){return this.query.preview_src?this.query.preview_src:this.query.preview&&!this.query.streams?null==e?void 0:e.thumbnail:""}getPosterStyle(){let e;return this.query.poster_object_fit&&(e={objectFit:String(this.query.poster_object_fit)}),e}getLogoConfig(e){return null!=e&&e.logoConfig?e.logoConfig:(0,E.Kn)(null==e?void 0:e.watermark)&&(0,E.HD)(null==e?void 0:e.watermark.src)?null==e?void 0:e.watermark:void 0}getTitleSettings(){if(void 0===this.query.meta)return;if(this.query.meta===O.none)return null;const e={name:this.query.m_title,description:this.query.m_desc};switch(this.query.meta){case O.always:e.isVisible=!0;break;case O.start:e.isVisible=!0,e.duration=this.query.m_duration;break;case O.restriction_age:e.isVisible=!0,e.visibleOnPlay=!0,e.duration=this.query.m_duration;break;case O.ui:e.isVisible=!0,e.visibleWithSkinOnly=!0}return e}getOTTParams(e){const t=null==e?void 0:e.ottParams;return(0,E.Kn)(t)?(t.from=this.query.from,t.contentTypeID&&!t.contentTypeId&&(t.contentTypeId=t.contentTypeID),"cover"in(e||{})&&(t.cover=null==e?void 0:e.cover,t.thumbnailLogos=null==e?void 0:e.thumbnail_logos),t.container={context:this.query.platform||"",init:this.createOttEventTrigger.call(this,"placeholder:init"),mod:this.query.mod,paymentWidget:this.createOttEventTrigger.call(this,"placeholder:pay")},t):null}createOttEventTrigger(e){return t=>{var r;t.event===e&&(null==(r=this.player)||r.publicEmit("OTT/"+e,t))}}getStartPosition(e){return(0,E.hj)(this.query.t)?this.query.t:(0,E.hj)(null==e?void 0:e.progress)&&(0,E.hj)(null==e?void 0:e.duration)&&e.progress/e.duration>.95?0:this.expFlags.progress&&(0,E.hj)(null==e?void 0:e.progress)?null==e?void 0:e.progress:void 0}getYaVideoTrackings(e){if(!(0,E.Kn)(e))return null;const t={from:this.ids.from,from_block:this.ids.fromBlock,reqid:this.ids.reqid,yandexuid:this.ids.yandexuid,content_id:this.ids.contentId,channel_id:e.channel_id,stream_block:this.ids.streamBlock,duration:e.duration};return(0,E.Kn)(e.ottParams)&&(t.licence=e.ottParams.monetizationModel,t.svod=e.ottParams.subscriptionType),function(e){const t={};var r;return t.heartbeat=[[a("heartbeat",e),{delay:3e4}],[a("deep_watch",e),{delay:1e3*(r=e.duration,r<=180?.57*r:r<=1200?72+.17*r:r<=3600?252+.02*r:216+.03*r),callsCount:1}]],R.forEach((function(r){t[r]=[a(r,e)]})),t}(t)}getAdditionalParams(e){const t=(0,E.Kn)(null==e?void 0:e.additionalParams)?e.additionalParams:{};if(this.ids.frontendVhReqid&&(t.frontend_vh_reqid=this.ids.frontendVhReqid),this.ids.reqid&&(t.reqid=this.ids.reqid),(null!=e&&e.puid||this.query.puid)&&(t.puid=(null==e?void 0:e.puid)||this.query.puid),null!=e&&e.content_id&&(t.content_id=e.content_id),null!=e&&e.folder_id&&(t.folder_id=e.folder_id),this.ids.from&&(t.from=this.ids.from),this.ids.fromBlock&&(t.from_block=this.ids.fromBlock),this.ids.slots&&(t.slots=this.ids.slots),this.ids.streamBlock&&(t.stream_block=this.ids.streamBlock),null!=e&&e.channel_id&&(t.channel_id=e.channel_id),!Array.isArray(this.query["brand-safety-categories"])||(0,E.Kn)(null==e?void 0:e.adTags)&&null!=e&&e.adTags["brand-safety-categories"]||(t["brand-safety-categories"]=this.prepareCategory("brand-safety-categories")),(0,E.Kn)(null==e?void 0:e.adTags))for(const r in null==e?void 0:e.adTags)null!=e&&e.adTags.hasOwnProperty(r)&&(t[r]=this.prepareCategory(r,e.adTags[r]));return t.sandboxVersion=this.ids.sandboxVersion,t}prepareCategory(e,t){const r=this.query[e];let i=[];if(Array.isArray(t)&&Array.isArray(r))i=t.concat(r);else if(Array.isArray(t))i=t;else{if(!Array.isArray(r))return null;i=r}return"brand-safety-categories"===e?"["+i.join(",")+"]":i.join("\n")}getAutoplay(){if((0,j.z)())return!1;const e=navigator&&navigator.connection&&navigator.connection.saveData,t=this.requestInfo.slow_connection||this.query.slow_connection;return!(this.expFlags.disable_autoplay_slow_connection&&this.expFlags.disable_autoplay_save_data&&t&&e)&&(!(this.expFlags.disable_autoplay_slow_connection&&!this.expFlags.disable_autoplay_save_data&&t)&&(!(!this.expFlags.disable_autoplay_slow_connection&&this.expFlags.disable_autoplay_save_data&&e)&&((0,E.jn)(this.query.allow_muted)?{allowMuted:this.query.allow_muted}:Boolean(this.query.autoplay))))}getPreload(){return!(0,j.z)()&&this.query.preload}}class W{constructor(e,t){this.params=e,this.playerApi=t}async getSourceConfig(e){const{source:t}=await this.createInternalVhConfig(e).getPlayerConfig();return y({},t,{update:async()=>{var t;const{sourceConfig:r}=await(0,S.s6)(null==(t=e.content)?void 0:t.content_id,this.params);return y({},r,{startPosition:void 0})}})}async getPlayerConfig(e){return y({},await this.createInternalVhConfig(e).getPlayerConfig(),{source:await this.getSourceConfig(e)})}getIframeParams(){var e,t;return{eventPrefix:null!=(e=this.params)&&e.event_prefix?String(null==(t=this.params)?void 0:t.event_prefix):void 0}}createInternalVhConfig(e){return H.create({vhParams:e,queryParams:this.params,playerApi:this.playerApi})}}},8484:(e,t,r)=>{"use strict";function i(e){return e?b.A.parse((0,A.en)(e).search):{}}function n(){return(n=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function s(e,t){if(null==e)return{};var r,i,n={},s=Object.keys(e);for(i=0;i<s.length;i++)r=s[i],t.indexOf(r)>=0||(n[r]=e[r]);return n}function a(e,t,r,a,c){const h=(0,l.K)(),{setReadyInstance:b,setSource:A}=h,k=s(h,T);let R,P,C=!1,I=!1;const O=(()=>{const s=(0,y.K)(r)?r:(0,v.H)(r)?i(r):{};return(0,E.r)(n({},(0,y.K)(t)?i(location.href):{},s),e)})(),D=async()=>{if("1"===String(O.test_mode))return async function(e){const t=["alive","avod","live","paid"].includes(e)?e:"default";return(await(0,m.W)({method:"GET",url:"https://playerweb-stands.s3.yandex.net/mediabox-test-presets/"+t+".json",responseType:"json",withCredentials:!1,retries:2})).response}(String(O.test_data));if((0,v.H)(t)){const e=t;return(await(0,f.s6)(e,O)).vhParams}return t.data};let N,L;const x=async()=>{if(L)return L;N=N||await D();const t=new o.y(O,k),r=await t.getPlayerConfig(N),i=r.source,{trackings:l}=i,u=s(i,_);return L=n({},r,{source:n({},u,{trackings:null!=c&&c.disableVhTrackings?void 0:l,queryParams:O}),element:e,vhParams:N}),a&&(L.envName=a),(0,d.Vc)(L),L};let M=new g.B;const F=async e=>{const{disableOTTPlayerLoader:r}=(0,y.K)(t)?t:{disableOTTPlayerLoader:!1},i=r?{api:window.Ya.playerApi.create(e),withWrapper:!1,withTrackings:!1}:await async function(e){try{const t=await Ya.OTT.PlayerLoader.init(e);return(0,u.m)(t),t}catch(t){}return{api:window.Ya.playerApi.create(e),withWrapper:!1,withTrackings:!1}}(e);if((0,u.m)(i))return P=new p(i),b(P),void M.resolve();C=i.withWrapper,I=i.withTrackings,R=i.api,b(R),M.resolve()};x().then(async e=>{await F(e)}).catch(()=>{M.resolve()});const V=n({},k,{setSource:async(t,r)=>{var a,l;await M.promise;const d=(0,y.K)(r)?r:(0,v.H)(r)?i(r):{},u=(0,E.r)(d,e),h=await(async()=>{if((0,v.H)(t))return{contentId:t,queryParams:u};const e=new o.y(u,k),r=await e.getSourceConfig(t.data),{trackings:i}=r;return n({},s(r,w),{trackings:null!=c&&c.disableVhTrackings?void 0:i,queryParams:u})})();if(R)return A(h);const p=(null==(a=P)?void 0:a.getAllHandlers())||{};await(null==(l=P)?void 0:l.destroy()),P=void 0,M=new g.B,await F(n({},await x(),{source:h}));const f=P||R;void 0!==f&&(0,S.M)(p,(e,t)=>{e&&e.forEach(e=>{let{once:r,fn:i}=e;f[r?"once":"on"](t,i)})})}});return Object.defineProperty(V,"skin",{get:()=>{var e;return null==(e=R)?void 0:e.skin}}),Object.defineProperty(V,"withOttWrapper",{get:()=>C}),Object.defineProperty(V,"withOttTrackings",{get:()=>I}),V}r.r(t),r.d(t,{createVhPlayerApi:()=>a});var o=r(1485),l=r(2516),d=r(2067),u=r(5605),c=r(6094),h=r(9320);class p extends h.h{constructor(e){super(void 0),this.ottPlaceholder=e,this.skin=void 0}publicEmit(e,t){if(e.indexOf("/")>-1)return this.emit(e,t);const r=new Error("Event "+e+" is invalid. Namespace is required: NAMESPACE/"+e);setTimeout(()=>{throw r},0)}getState(){}getReadyState(){return c.k.init}destroy(){return this.ottPlaceholder.innerHTML="",Promise.resolve()}setVideoTrack(){}setAudioTrack(){}setTextTrack(){}changeAdditionalParams(){}sendReportLog(){return Promise.reject()}setSource(){return Promise.reject()}preloadSource(){return Promise.reject()}requestVideoElementFullscreen(){return Promise.reject()}exitVideoElementFullscreen(){}setPlaybackRate(){}setMuted(){}setVolume(){}setPictureInPictureAllowed(){}setVideoStyle(){}setNativeControlsVisibility(){}setNativeTextTrackVisibility(){}setNativeAdControlsVisibility(){}setDebugPanelVisibility(){}requestDebugInfo(){return Promise.reject()}requestExternalPlay(){return Promise.reject()}requestExternalPlayerList(){return Promise.reject()}play(){return Promise.reject()}pause(){}seek(){}openReportWindow(){}playInrollAd(){}skipAdPod(){}logEvent(){}logEventInternal(){}logError(){}insertInto(){return Promise.reject()}playAdViewers(){return Promise.reject()}}var f=r(8225),m=r(7668),g=r(5636),v=r(9209),y=r(6878),S=r(9632),E=r(8875),b=r(1321),A=r(9223);r(5207);const T=["setReadyInstance","setInstance","setSource"],_=["trackings"],w=["trackings"]},8875:(e,t,r)=>{"use strict";function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function n(e,t){if(e&&"adsdk-container-width"in e&&"adsdk-container-height"in e)return e;const r=t.getBoundingClientRect();return i({},e,{"adsdk-container-width":r.width,"adsdk-container-height":r.height})}r.d(t,{r:()=>n})},1321:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var i=r(719);class n{static parse(e,t,r){const s={};if(!e||!(0,i.HD)(e))return s;let a=e;"?"!==a[0]&&"#"!==a[0]||(a=a.slice(1));const o=a.split(t||"&");for(let i=0;i<o.length;i++){const e=o[i].indexOf("=");if(-1===e){r&&(s[decodeURIComponent(o[i])]=!0);continue}s[decodeURIComponent(o[i].slice(0,e))]=n.parseJSON(decodeURIComponent(o[i].slice(e+1)))}return s}static parseJSON(e){try{return JSON.parse(e)}catch(t){return e}}constructor(e,t,r){const s={},a={};if((0,i.Kn)(t))for(const n in t){if(!t.hasOwnProperty(n))continue;const e=t[n];(0,i.Kn)(e)?((0,i.o8)(e.value)||(this[n]=e.value),(0,i.mf)(e.set)&&(s[n]=e.set),e.unsafe&&(a[n]=!0)):(0,i.o8)(e)||(this[n]=e)}let o;if(e){const t=(0,i.Kn)(e)?e:n.parse(e);for(const e in t){if(!t.hasOwnProperty(e))continue;const r=this[e],n=s[e];s.hasOwnProperty(e)&&(0,i.mf)(n)?n.call(this,t[e],e):this[e]=t[e],this[e]!==r&&a[e]&&(o=o||{},o[e]=this[e])}}o&&(0,i.mf)(r)&&r(o,this)}toString(e,t,r){void 0===e&&(e="&"),void 0===t&&(t=!1),void 0===r&&(r=[]);const n=encodeURIComponent,s=this;let a,o=Object.keys(this).filter((function(e){return!(0,i.o8)(s[e])&&!(0,i.mf)(s[e])})).map((function(e){return a=s[e],(0,i.Kn)(a)&&(a=JSON.stringify(a)),r.indexOf(e)>-1?e+"="+a:n(e)+"="+n(a)})).join(e);return t&&(o+=e),o}appendTo(e){const t=this.toString();return t?(e+=e.indexOf("?")>-1?"&":"?",e+=t):e}}},719:(e,t,r)=>{"use strict";function i(e){return"undefined"===typeof e}function n(e){return"boolean"===typeof e}function s(e){return"number"===typeof e&&e===e}function a(e){return"string"===typeof e}function o(e){return"function"===typeof e}function l(e){return Boolean(e)&&"object"===typeof e}r.d(t,{HD:()=>a,Kn:()=>l,hj:()=>s,jn:()=>n,mf:()=>o,o8:()=>i})},7320:(e,t,r)=>{"use strict";r.d(t,{H:()=>d});var i=r(1729),n=r(9840);const s={},a=()=>{};class o extends n.Z{constructor(e){if(super(),this.aborted=void 0,this.reason=void 0,this._onabort=a,e!==s)throw new TypeError("Illegal constructor.");this.aborted=!1}set onabort(e){const t=this._onabort;t&&this.removeEventListener("abort",t),this._onabort=e,this.addEventListener("abort",e)}get onabort(){return this._onabort}throwIfAborted(){throw this.reason}}const l="object"===typeof self?self:window,d=Boolean((0,i.Y)(()=>new l.AbortController))?l.AbortController:class{constructor(){this._signal=void 0,this._signal=new o(s)}get signal(){return this._signal}abort(e){const t=this.signal;t.aborted||(t.aborted=!0,t.reason=e,t.dispatchEvent(new Event("abort")))}}},9002:(e,t,r)=>{"use strict";r.d(t,{M:()=>n});var i=r(7179);class n extends i.v{destroy(){this.emit("Destroy"),this.off("Destroy"),Object.keys(this.handlers).forEach(e=>{this.off(e)}),Object.keys(this.onceHandlers).forEach(e=>{this.off(e)})}}},7179:(e,t,r)=>{"use strict";r.d(t,{v:()=>i});class i{constructor(){this.handlers=Object.create(null),this.onceHandlers=Object.create(null),this.maxEventListeners=10}setMaxListeners(e){!isFinite(e)||e<=0||(this.maxEventListeners=e)}on(e,t){this.getHandlers(e).push(t),this.checkSubscriptions(e)}once(e,t){this.getOnceHandlers(e).push(t),this.checkSubscriptions(e)}off(e,t){const r=this.getHandlers(e),i=this.getOnceHandlers(e);if(void 0===t)return r.length=0,void(i.length=0);this.removeHandler(t,r),this.removeHandler(t,i)}emit(e,t){const r=this.getHandlers(e),i=this.getOnceHandlers(e).slice();this.getOnceHandlers(e).length=0,r.slice().concat(i).forEach(e=>{try{e(t)}catch(r){setTimeout(()=>{throw r},0)}})}getHandlers(e){return void 0===this.handlers[e]&&(this.handlers[e]=[]),this.handlers[e]}getOnceHandlers(e){return void 0===this.onceHandlers[e]&&(this.onceHandlers[e]=[]),this.onceHandlers[e]}checkSubscriptions(e){const t=this.getHandlers(e).length+this.getOnceHandlers(e).length;t>this.maxEventListeners&&console.warn("There are "+t+" subscriptions on event named "+String(e))}removeHandler(e,t){const r=t.indexOf(e);-1!==r&&t.splice(r,1)}}},2067:(e,t,r)=>{"use strict";function i(){return m}function n(e){if(T.flagsInited)return;T.flagsInited=!0,function(){var e;const t=null==(e=S())?void 0:e.vpuid;if(!t)return;const r=(()=>{try{var e;return null==(e=E.localStorage)?void 0:e.getItem(g.v)}catch(t){return null}})();if(!r||r!==t)try{var i;null==(i=E.localStorage)||i.setItem(g.v,String(t))}catch(n){}}();const{flags:t,slots:r,testids:i}=S()||{};(0,A.K)(t)&&(0,y.Y)(()=>{(0,b.M)(t,(e,t)=>{T.flags[t]=String(e)})}),T.slots=void 0!==r?String(r):void 0,T.testids=Array.isArray(i)?i.join(","):void 0!==i?String(i):void 0,(0,A.K)(e)&&(0,A.K)(e.flags)&&(0,y.Y)(()=>{(0,b.M)(e.flags,(e,t)=>{T.flags[t]=String(e)})})}function s(){return c(),w.flags||{}}function a(e){return c(e),w.flags[e]}function o(e){return"true"===e||"1"===e||"false"!==e&&"0"!==e&&void 0}function l(e){const t=o(a(e));if("undefined"===typeof t){return o(_[e])}return t}function d(e){if("undefined"===typeof e)return;const t=parseFloat(e);return(0,h.z)(t)?t:void 0}function u(e){const t=d(a(e));if("undefined"===typeof t){return d(_[e])}return t}function c(e){if(w.flagsInited)return;const t=new Error(e?"Unexpected usage of player's flag "+e+" before any flag configuration":"Unexpected usage of player's getFlagsJson before any flag configuration");setTimeout(()=>{throw t})}r.d(t,{Vc:()=>n,RW:()=>l,rg:()=>i,r0:()=>a,qm:()=>s,jS:()=>u});var h=r(1652),p=r(9525);const f=(0,p.I)();f.Ya||(f.Ya={}),f.Ya.streamPlayer||(f.Ya.streamPlayer={}),f.Ya.streamPlayer.exp||(f.Ya.streamPlayer.exp={});const m=f.Ya.streamPlayer.exp;m.flags||(m.flags={});var g=r(2890),v=r(3697),y=r(1729);const S=(0,v.I)((function(){return(0,y.Y)(()=>{const{flags:e,testids:t,slots:r,vpuid:i}=JSON.parse("__UAAS_CONFIG_INLINE__");return{flags:e,testids:t,slots:r,vpuid:i}})||void 0})),E=(0,p.I)();var b=r(9632),A=r(6878);const T=i(),_="undefined"!==typeof{use_correct_method_in_workershim_revert:"false",web_debug_log_calls:"false",web_debug_log_events:"false",web_debug_log_internals:"false",web_debug_panel:"false",web_destroy_yasp_only_with_no_instances:"true",web_forbid_allow_muted_autoplay:"false",web_ignore_render_stalled:"true",web_mp_ttfb_estimator:"false",web_userquality_ttl:"false",web_yasp_buffer_goal_bytes_size:"0",web_yasp_enable_network_traces:"false",web_yasp_enable_worker:"true",web_yasp_object_fit_in_resolution_rule:"false",web_yasp_screenshot_capturing:"false",web_yasp_static_timeout_for_low_latency:"true",web_yasp_target_latency_debug:"-1",web_yasp_time_to_start:"null",web_yasp_unify_abr_decision_hash_code:"true",yasp_abr_loading_segment:"false",yasp_body_timeout:"1000",yasp_decrease_mse_buffer_on_allocation_error:"false",yasp_decrease_mse_buffer_on_quota_exceeded_error:"false",yasp_enable_new_timeout:"false",yasp_fair_bandwidth:"false",yasp_headers_timeout:"5000",yasp_no_source_abort_on_fake_seek:"false",yasp_npr_by_segment_info:"false",yasp_preload_content_5_sec_before_ad_end:"false",yasp_preload_content_5_sec_before_ad_skip:"false",yasp_videosegment_expected_load_time_multiplier:"1"}?{use_correct_method_in_workershim_revert:"false",web_debug_log_calls:"false",web_debug_log_events:"false",web_debug_log_internals:"false",web_debug_panel:"false",web_destroy_yasp_only_with_no_instances:"true",web_forbid_allow_muted_autoplay:"false",web_ignore_render_stalled:"true",web_mp_ttfb_estimator:"false",web_userquality_ttl:"false",web_yasp_buffer_goal_bytes_size:"0",web_yasp_enable_network_traces:"false",web_yasp_enable_worker:"true",web_yasp_object_fit_in_resolution_rule:"false",web_yasp_screenshot_capturing:"false",web_yasp_static_timeout_for_low_latency:"true",web_yasp_target_latency_debug:"-1",web_yasp_time_to_start:"null",web_yasp_unify_abr_decision_hash_code:"true",yasp_abr_loading_segment:"false",yasp_body_timeout:"1000",yasp_decrease_mse_buffer_on_allocation_error:"false",yasp_decrease_mse_buffer_on_quota_exceeded_error:"false",yasp_enable_new_timeout:"false",yasp_fair_bandwidth:"false",yasp_headers_timeout:"5000",yasp_no_source_abort_on_fake_seek:"false",yasp_npr_by_segment_info:"false",yasp_preload_content_5_sec_before_ad_end:"false",yasp_preload_content_5_sec_before_ad_skip:"false",yasp_videosegment_expected_load_time_multiplier:"1"}:{},w=i()},9525:(e,t,r)=>{"use strict";function i(){return"object"===typeof self?self:window}r.d(t,{I:()=>i})},5176:(e,t,r)=>{"use strict";function i(e){return e&&"function"===typeof e.catch&&e.catch(e=>{}),e}r.d(t,{v:()=>i})},3354:(e,t,r)=>{"use strict";r.d(t,{M:()=>a});const i=!(0,r(2839).t)(Math.random)||Math.random()===Math.random();var n=r(3451);let s=(0,n.m6)()*(0,n.no)()%2147483647;const a=i?function(){return s=16807*s%2147483647,(s-1)/2147483646}:function(){return Math.random()}},9396:(e,t,r)=>{"use strict";r.d(t,{t:()=>n});var i=r(2741);const n={getItem(e){try{return i.ZP.getItem(e)}catch(t){return null}},setItem(e,t){try{i.ZP.setItem(e,t)}catch(r){}},removeItem(e){try{i.ZP.removeItem(e)}catch(t){}},clear(){try{i.ZP.clear()}catch(e){}}}},3451:(e,t,r)=>{"use strict";function i(e){return"function"===typeof e||"Function"===(e=>{const t=n.call(e);if(!t)return null;const r=t.match(s);if(!r)return null;const i=r[1];if(!i)return null;return i})(e)}r.d(t,{m6:()=>a,e0:()=>u,no:()=>h});const n={}.toString,s=/\[object (\w+)\]/,a=Date&&i(Date.now)?()=>Date.now():()=>(new Date).getTime(),o="undefined"===typeof window?void 0:window.performance,l=o&&i(o.now),d=o&&o.timing&&o.timing.navigationStart,u=o&&o.timeOrigin?o.timeOrigin:d?o.timing.navigationStart:a();let c=0;const h=l?()=>o.now():()=>(()=>{const e=a()-u;return c=Math.max(e,c),c})()},1729:(e,t,r)=>{"use strict";function i(e,t){try{return e()}catch(r){"function"===typeof t&&t(r)}}r.d(t,{Y:()=>i})},808:(e,t,r)=>{"use strict";r.d(t,{h:()=>i});const i=(e,t,r)=>{const i=[];for(let n=0;n<e.length;n++){const s=e[n];t.call(r,s,n,e)&&i.push(s)}return i}},3015:(e,t,r)=>{"use strict";r.d(t,{s:()=>s});var i=r(2839);const n=[].find,s=(0,i.t)(n)?(e,t)=>n.call(e,t):(e,t)=>{for(let r=0;r<e.length;r++){const i=e[r];if(t(i,r,e))return i}}},1115:(e,t,r)=>{"use strict";r.d(t,{k:()=>s});var i=r(9521);const n=(0,r(7118).C)(Array,"isArray"),s=n?e=>n.call(Array,e):e=>"Array"===(0,i.M)(e)},7618:(e,t,r)=>{"use strict";function i(e,t){const r=[],i=[];return((e,t,r)=>{for(let i=0;i<e.length;i++)t.call(r,e[i],i,e)})(e,(n,s)=>{t(n,s,e)?r.push(n):i.push(n)}),[r,i]}r.d(t,{x:()=>i})},3697:(e,t,r)=>{"use strict";function i(e){let t=function(){let r;return t=()=>r,r=e.apply(this,arguments),r};return function(){return t.apply(this,arguments)}}r.d(t,{I:()=>i})},7118:(e,t,r)=>{"use strict";function i(e,t){let r=e[t];if(!(0,n.t)(r)){const n=r;try{delete e[t];const i=e[t];"function"===typeof i&&(r=i),e[t]=n}catch(i){}}return r}r.d(t,{C:()=>i});var n=r(2839)},1652:(e,t,r)=>{"use strict";function i(e){return"number"===typeof e&&isFinite(e)}r.d(t,{z:()=>i})},9632:(e,t,r)=>{"use strict";function i(e,t,r){for(const i in e)(0,n.n)(e,i)&&t.call(r,e[i],i,e)}r.d(t,{M:()=>i});var n=r(2480)},3479:(e,t,r)=>{"use strict";function i(e){return"function"===typeof Object.entries?Object.entries(e):(0,n.Z)(e).map(t=>[t,e[t]])}r.d(t,{J:()=>i});var n=r(8337)},8337:(e,t,r)=>{"use strict";function i(e){if("function"===typeof Object.keys)return Object.keys(e);const t=[];for(const r in e)(0,n.n)(e,r)&&t.push(r);return t}r.d(t,{Z:()=>i});var n=r(2480)},106:(e,t,r)=>{"use strict";function i(e){const t=Object.values;if("function"===typeof t)return t(e);const r=[];for(const i in e)(0,n.n)(e,i)&&r.push(e[i]);return r}r.d(t,{z:()=>i});var n=r(2480)},2480:(e,t,r)=>{"use strict";function i(e,t){return Object.prototype.hasOwnProperty.call(e,t)}r.d(t,{n:()=>i})},6878:(e,t,r)=>{"use strict";function i(e){const t=typeof e;return Boolean(e)&&("object"===t||"function"===t)}r.d(t,{K:()=>i})},9209:(e,t,r)=>{"use strict";function i(e){return"string"===typeof e}r.d(t,{H:()=>i})},9521:(e,t,r)=>{"use strict";r.d(t,{M:()=>s});const i={}.toString,n=/\[object (\w+)\]/,s=e=>{const t=i.call(e);if(!t)return null;const r=t.match(n);if(!r)return null;const s=r[1];return s||null}},2839:(e,t,r)=>{"use strict";function i(e,t){if(void 0===t&&(t=!1),!e)return!1;const r=t?Function.prototype.toString.call(e):e.toString?e.toString():"";return/\[native code\]/.test(r)||/\/\* source code not available \*\//.test(r)}r.d(t,{t:()=>i})},2890:(e,t,r)=>{"use strict";r.d(t,{z:()=>l,v:()=>i});const i="vpuid";var n=r(9396),s=r(3354);const a="qwertyuiopasdfghjklzxcvbnm0123456789";var o;const l=-1==="__VPUID_INLINE__".indexOf("__VPUID")?"__VPUID_INLINE__":null!=(o=n.t.getItem(i))?o:function(){const e=[];for(let t=0;t<10;t++)e.push(a[Math.floor((0,s.M)()*a.length)]);return e.join("")}();var d;d=l,n.t.setItem(i,d)},5859:(e,t,r)=>{"use strict";r.d(t,{z:()=>a});const i=(0,r(1247).i)(),n=new RegExp("("+["Googlebot","YandexBot","AhrefsBot","spider","Bot","HeadlessChrome"].join("|")+")","i"),s=new RegExp("("+["Robotics"].join("|")+")","i"),a=function(e){return void 0===e&&(e=i),!s.test(e)&&n.test(e)}},1247:(e,t,r)=>{"use strict";function i(e){void 0===e&&(e=window);try{return(e.navigator||{}).userAgent||""}catch(t){return""}}r.d(t,{i:()=>i})},5776:(e,t,r)=>{"use strict";r.d(t,{y:()=>n});var i=r(1247);const n=function(e){void 0===e&&(e=window);return(0,i.i)(e).includes("Tizen")}},9881:(e,t,r)=>{"use strict";r.d(t,{F:()=>n});var i=r(1247);const n=function(e){void 0===e&&(e=window);const t=(0,i.i)(e);return t.includes("VIDAA")||t.includes("Hisense")}},6223:(e,t,r)=>{"use strict";r.d(t,{V:()=>n});var i=r(1247);const n=function(e){void 0===e&&(e=window);return(0,i.i)(e).includes("Web0S")}},6094:(e,t,r)=>{"use strict";let i;r.d(t,{k:()=>i}),function(e){e.init="init",e.ready="ready",e.broken="broken",e.destroyed="destroyed"}(i||(i={}))},7746:(e,t,r)=>{"use strict";let i;r.d(t,{X:()=>i}),function(e){e.PLAY="play",e.PAUSE="pause",e.BUFFERING="buffering",e.END="end"}(i||(i={}))},4651:(e,t,r)=>{"use strict";let i;r.d(t,{Z:()=>i}),function(e){e.LIVE="LIVE",e.EVENT="EVENT",e.VOD="VOD"}(i||(i={}))},6690:(e,t,r)=>{"use strict";function i(e){return Math.floor(e/30)}function n(e){void 0===e&&(e=window);const{navigator:t}=e,{connection:r={}}=t;return Boolean(r.saveData)}function s(e,t){return e?"fullscreen":t?"pip":"default"}function a(){return(a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function o(e,t){return{reason:e,details:t,getElapsedTime:(0,L.u)()}}function l(){return(l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function d(e,t,r){void 0===r&&(r=" ");const i=t-e.length;if(i>0){let t=r;for(;t.length<i;)t+=t;return(t.length>i?t.substr(0,i):t)+e}return e}function u(e){return d(String(e%Math.pow(10,4)),4,"0")}function c(e,t){if(3!==t.length)throw new Error("playerType should contains exact 3 symbols");return[(0,q.a)(44),t,u(e),d(Date.now().toString().slice(0,10),10,"0")].join("x")}function h(){return(h=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}r.d(t,{M0:()=>K,lY:()=>c});var p=r(6588);r(7881);class f{constructor(e){this.params=e,this.previousWatchedTime=0}onWatchedTimeChange(e){const{previousWatchedTime:t}=this;t!==e&&(!function(e,t){return 0===e&&t>0}(t,e)?!function(e,t){return e<4&&t>=4}(t,e)?!function(e,t){return e<10&&t>=10}(t,e)?!function(e,t){return e<20&&t>=20}(t,e)?function(e,t){return i(e)<i(t)}(t,e)&&this.params.onEvent(p.r.Heartbeat30Sec):this.params.onEvent(p.r.Watched20Sec):this.params.onEvent(p.r.Watched10Sec):this.params.onEvent(p.r.Watched4Sec):this.params.onEvent(p.r.Start),this.previousWatchedTime=e)}onPlayingStateChange(e){e===p.X.END&&this.params.onEvent(p.r.End)}}class m{constructor(){this.lastSourceIndexWithFatal=null}extractSourceIndex(e){const t=e.split("?")[1];if(t){const e=t.split("&");for(const t of e){const[e,r]=t.split("=");if("source_index"===e)return r?Number(r):null}}return null}checkIsFatal(e,t){if(!e||!t)return e;const r=this.extractSourceIndex(t);return null===r?e:(null===this.lastSourceIndexWithFatal||r>this.lastSourceIndexWithFatal)&&(this.lastSourceIndexWithFatal=r,!0)}}var g=r(6048),v=r.n(g);var y=r(3451);class S{constructor(e,t){this.onTick=e,this.onFlush=t,this.wasFirstFlush=!1,this.isDestroyed=!1,this.lastFlushTime=void 0,this.startTime=void 0,this.timer=void 0,this.handleTimeout=()=>{this.onTick(),this.handleFlush(),this.nextTick()},this.startTime=this.lastFlushTime=(0,y.no)(),this.timer=window.setTimeout(()=>{this.onTick(),this.nextTick()},0)}next(){this.isDestroyed||(window.clearTimeout(this.timer),this.handleFlush(),this.nextTick())}destroy(){window.clearTimeout(this.timer),this.isDestroyed=!0}nextTick(){this.isDestroyed||(window.clearTimeout(this.timer),this.timer=window.setTimeout(this.handleTimeout,this.getTimeout()))}handleFlush(){this.needFlush()&&(this.onFlush(),this.lastFlushTime=this.wasFirstFlush?(0,y.no)():this.startTime,this.wasFirstFlush=!0)}needFlush(){const e=(0,y.no)();return this.wasFirstFlush?e-this.lastFlushTime>=3e4:e-this.startTime>=1e4}getTimeout(){return(0,y.no)()-this.startTime<1e4?1e3:5e3}}const E=Math.max(Math.abs(0),0),b={remainingBufferedTime:Math.max(Math.abs(0),0),state:p.X.BUFFERING,currentTime:E,watchedTime:Math.max(Math.abs(0),0),duration:Math.max(0,0)};var A=r(9240);let T,_;!function(e){e[e.PLAYING=1]="PLAYING",e[e.NOT_PLAYING=2]="NOT_PLAYING"}(T||(T={})),function(e){e.preroll="preroll",e.midroll="midroll",e.postPauseroll="postPauseroll",e.postroll="postroll",e.inroll="inroll"}(_||(_={}));var w=r(9178);class k{constructor(e){this.props=e,this.prevState=void 0,this.states=[],this.timer=void 0,this.destroyHandlers=[],this.writeStateManually=(0,w.D)(()=>{this.writeState(),this.timer.next()},0),this.timer=new S(()=>this.writeState(),()=>this.flushStates())}addDestroyHandler(e){this.destroyHandlers.push(e)}destroy(){this.timer.destroy(),this.flushStates(),this.destroyHandlers.forEach(e=>{e()}),this.destroyHandlers=[]}getStates(){return[...this.states]}flushStates(){this.writeStateManually.now();const e=this.getStates();e.length>0&&this.props.onFlushStates(e),this.states.length=0}writeState(){const e=this.getPlayerAliveState();v()(this.prevState,e)||(this.prevState=e,this.states.push(a({},e,{timestamp:this.props.getTimestamp()})))}getPlayerAliveState(){var e,t;const r=a({},b,{saveData:n(),rtt:(0,A.n)()},this.props.stalledController.getStalledHistory()),i=this.props.getState();if(!i)return a({},r);const{currentTime:o,duration:l,muted:d,playingState:u,remainingBufferedTime:c,adState:h,liveLatency:p,videoTracks:f,audioTrack:m,videoSize:g,isVisible:v,capHeight:y,capWidth:S,containerHeight:E,containerWidth:_,bandwidthEstimate:w,bandwidthSource:k,droppedFrames:R,shownFrames:P,isFullscreen:C,isPictureInPicture:I,volume:O,playbackRate:D}=i,N=f.find(e=>e.selected),L=[...f].sort((e,t)=>t.bitrate-e.bitrate),x=(null==h?void 0:h.state)===T.PLAYING,M=!x,F=this.props.getWatchedTime();return a({},r,{watchedTime:Math.max(0,F),currentTime:isNaN(o)?0:Math.max(0,o),duration:isNaN(l)?0:Math.max(0,l),isMuted:d,state:u,remainingBufferedTime:(null==c?void 0:c.total)||0,remainingAudioBufferedTime:void 0===(null==c?void 0:c.audio)?void 0:Math.max(0,c.audio),remainingVideoBufferedTime:void 0===(null==c?void 0:c.video)?void 0:Math.max(0,c.video),ad:x?null==h?void 0:h.type:void 0,liveLatency:void 0===p?void 0:Math.max(0,p),stalledReason:this.props.stalledController.getCurrentStalledReason(),auto:void 0===(null==N?void 0:N.auto)?void 0:N.auto,isVisible:v,bitrate:null!=N&&N.bitrate?Math.max(0,Math.floor(1e3*N.bitrate)):void 0,width:void 0===(null==g?void 0:g.videoWidth)||isNaN(null==g?void 0:g.videoWidth)?void 0:Math.max(0,Math.floor(null==g?void 0:g.videoWidth)),height:void 0===(null==g?void 0:g.videoHeight)||isNaN(null==g?void 0:g.videoHeight)?void 0:Math.max(0,Math.floor(null==g?void 0:g.videoHeight)),maxWidth:M&&null!=(e=L[0])&&e.width?Math.max(0,Math.floor(L[0].width)):void 0,maxHeight:M&&null!=(t=L[0])&&t.height?Math.max(0,Math.floor(L[0].height)):void 0,audioTrack:(null==m?void 0:m.value)||void 0,audioLang:(null==m?void 0:m.lang)||void 0,audioBitrate:null!=m&&m.bitrate?Math.max(0,Math.floor(1e3*m.bitrate)):void 0,capHeight:M&&y?Math.max(0,Math.floor(y)):void 0,capWidth:M&&S?Math.max(0,Math.floor(S)):void 0,containerHeight:void 0!==E?Math.max(0,Math.floor(E)):void 0,containerWidth:void 0!==_?Math.max(0,Math.floor(_)):void 0,bandwidthEstimate:void 0===w||isNaN(w)?void 0:Math.max(0,Math.round(w)),bandwidthSource:k||void 0,droppedFrames:void 0===R?void 0:Math.max(0,Math.floor(R)),shownFrames:void 0===P?void 0:Math.max(0,Math.floor(P)),viewport:s(C,I),volume:O,playbackRate:D})}}var R=r(1662);const P=[0,1,4,5];let C=0;const I=P.map(e=>(C=e+C,C)),O=1e3*I[I.length-1],D=[R.k.Init];var N=r(3807),L=r(371);class x{constructor(e){let{getState:t,logEvent:r}=e;this.isBuffering=!1,this.timer=void 0,this.stalledId=1,this.stalledDurationRemainder=0,this.getState=void 0,this.logEvent=void 0,this.expectedStalled=o(R.k.Init,{}),this.currentStalled=void 0,this.stalledTime=0,this.stalledCount=0,this.getState=t,this.logEvent=r}setBuffering(e,t){var r;if(void 0===t&&(t=0),e!==this.isBuffering)if(this.isBuffering=e,this.isBuffering){const e=[],r=P.filter((r,i)=>{const n=this.currentStalled?this.currentStalled.expectedStalled:this.getExpectedStalled(),s=I[i];if(t/1e3>s){const e=this.currentStalled?this.currentStalled.id:this.stalledId++;return this.currentStalled||this.stalledCount++,this.currentStalled={id:e,expectedStalled:n,duration:s,getElapsedTime:(0,L.u)()},this.send(!1,n,s,e),!1}return e.push(s),!0});this.currentStalled&&(this.stalledDurationRemainder=t/1e3-this.currentStalled.duration),r.length&&(r[0]=r[0]-this.stalledDurationRemainder),this.timer=new N.B7(t=>{let{count:i}=t;const n=this.currentStalled?this.currentStalled.expectedStalled:this.getExpectedStalled();if(i>0){const t=e[i-1],r=this.currentStalled?this.currentStalled.id:this.stalledId++;this.currentStalled||this.stalledCount++,this.currentStalled={id:r,expectedStalled:n,duration:t,getElapsedTime:(0,L.u)()},this.send(!1,n,t,r)}return i>=r.length?(this.destroyTimer(),1/0):1e3*r[i]}),this.timer.start()}else{if(this.currentStalled){var i,n;const{expectedStalled:e,id:t}=this.currentStalled,s=(void 0===(r=this.currentStalled)?0:r.duration+r.getElapsedTime()/1e3)+this.stalledDurationRemainder;this.send(!0,e,s,t),this.currentStalled=void 0,this.stalledDurationRemainder=0,this.stalledTime=s+this.stalledTime;const a=(null==(i=this.getState())||null==(n=i.adState)?void 0:n.state)===T.PLAYING?R.k.AdOther:R.k.Other;this.setExpectedStalled(o(a,void 0))}this.destroyTimer()}}getStalledHistory(){const{stalledCount:e,stalledTime:t}=this;return{stalledCount:Math.max(Math.floor(e)),stalledTime:Math.max(t,0)}}clearStalledHistory(){this.stalledCount=0,this.stalledTime=0}destroy(){this.destroyTimer()}getCurrentStalledReason(){var e;return null==(e=this.currentStalled)?void 0:e.expectedStalled.reason}setExpectedStalled(e){this.expectedStalled=e}isExpiredStalled(e){const{getElapsedTime:t,reason:r}=e;return!(D.indexOf(r)>-1)&&((!this.currentStalled||this.currentStalled.expectedStalled!==e)&&t()>=O)}getExpectedStalled(){const e=this.expectedStalled;return this.isExpiredStalled(e)?o(R.k.Other,void 0):e}destroyTimer(){this.timer&&(this.timer.destroy(),this.timer=void 0)}send(e,t,r,i){const{reason:n,details:s}=t,a={id:i,isStalledEnd:e,reason:n,stalledDuration:r,details:s};let o=l({},a.details,{stalledDuration:a.stalledDuration,stalledId:a.id});const d=this.getState();if(d){const{muted:e,remainingBufferedTime:t,videoTracks:r}=d;o=l({},o,{remainingBufferedTime:t,videoTrack:r.find(e=>e.selected),isMuted:e})}this.logEvent({name:a.isStalledEnd?"StalledEnd":"Stalled",data:o,labels:{reason:a.reason}})}}var M=r(3041),F=r(4364);const V=["Start","4SecWatched","10SecWatched","20SecWatched","30SecHeartbeat","End"];var B=r(5581),U=r(1729),j=(r(7638),r(7154));class H{constructor(e,t){this.getState=e,this.onChange=t,this.intervalId=void 0,this.watchedTimeCounter=new j.p,this.onTick=()=>{var e;const t=this.getState();if(!t)return;const{currentTime:r,playbackRate:i=1,playingState:n,adState:s}=t,a=(null==s?void 0:s.state)===T.PLAYING;this.watchedTimeCounter.calc(r,i,n===p.X.PLAY&&!a),null==(e=this.onChange)||e.call(this,this.watchedTimeCounter.get())},this.intervalId=setInterval(this.onTick,100)}reset(){var e;this.watchedTimeCounter=new j.p,null==(e=this.onChange)||e.call(this,this.watchedTimeCounter.get())}getWatchedTime(){return this.watchedTimeCounter.get()}destroy(){clearInterval(this.intervalId),this.intervalId=void 0}}var W=r(2890),q=r(9761);const Y={enabled:!0,events:[p.r.Watched10Sec,p.r.Watched20Sec,p.r.Heartbeat30Sec]},G={logVersion:"1.2.0"};class K{static getVpuid(){return W.z}constructor(e){let{sendLog:t,playerInfo:r,getState:i}=e;this.watchedTimeTracker=void 0,this.fatalTracker=void 0,this.playbackTracker=void 0,this.playerAliveController=void 0,this.stalledController=void 0,this.remoteProgressSavingInfo=Y,this.staticParams={},this.playerInfo=void 0,this.startTimestamp=y.e0,this.useOfDeprecatedMethodIsLogged=!1,this.sendLog=void 0,this.getState=void 0,this.destroyed=!1,this.wasInitBufferingLogged=!1,this.externalStalledDuration=0,this.initialStalledDuration=0,this.wasInitBufferingHandled=!1,this.initialStalledTimestamp=void 0,this.initialStalledTimestampStop=void 0,this.eventIndex=0,this.reportNumber=0,this.sourceIndexes={current:0,last:0},this.playerInfo=r,this.sendLog=t,this.getState=i,this.playbackTracker=new f({onEvent:e=>this.logEvent({name:e})}),this.stalledController=new x({getState:this.getState,logEvent:e=>this.logEvent(e)}),this.watchedTimeTracker=new H(i,e=>this.playbackTracker.onWatchedTimeChange(e)),this.playerAliveController=new k({getState:i,onFlushStates:e=>this.logEvent({name:"PlayerAlive",data:{states:e}}),getTimestamp:()=>this.getLogTimestamp(),stalledController:this.stalledController,getWatchedTime:()=>this.watchedTimeTracker.getWatchedTime()}),this.fatalTracker=new m,this.initOnVisibilityChangeHandling()}getLogTimestamp(){return Math.round(this.startTimestamp+(0,y.no)())}initOnVisibilityChangeHandling(){const e=(0,B.Y)(document,e=>{e||this.playerAliveController.flushStates()});this.playerAliveController.addDestroyHandler(e)}setStaticParams(e,t){this.staticParams=t?h({},e):h({},this.staticParams,e)}enableRemoteProgressSaving(e){this.remoteProgressSavingInfo.enabled=e}updateWatchedTime(){this.useOfDeprecatedMethodIsLogged||(this.logEvent({name:"DeprecatedTelemetryMethodUsed",data:{method:"updateWatchedTime"}}),this.useOfDeprecatedMethodIsLogged=!0),(0,F.L)(new Error("Deprecated method used. Method is Telemetry#updateWatchedTime(). Just remove. Telemetry calculates watchedTime itself now."))}setPlayingState(e){this.playbackTracker.onPlayingStateChange(e),this.handleInitialBuffering(),e===p.X.BUFFERING?this.setBuffering(!0):this.setBuffering(!1)}logEvent(e,t){if(this.destroyed)return;const r=this.getFullEventLog(e,t),i=this.getUrlParams(r.eventType,r.eventName,e.labels);this.sendData(r,i)}logError(e,t){let{error:r,labels:i,extraRootFields:n}=e;if(this.destroyed)return;r.isFatal=this.fatalTracker.checkIsFatal(r.isFatal,this.staticParams.streamUrl);const s=this.getFullErrorLog({error:r,labels:i,extraRootFields:n,sourceIndex:t}),a=this.getUrlParams(s.eventType,s.eventName,i);this.sendData(s,a)}getUrlParams(e,t,r){return h({},r,{[this.playerInfo.service]:this.playerInfo.version,[e]:String(t)})}getFullEventLog(e,t){const r=this.getState(),i=h({},this.staticParams.labels,e.labels,{videoType:null==r?void 0:r.videoType}),n=V.includes(e.name)?h({},e.data,this.getDataToSend(r)):e.data,s={};return this.remoteProgressSavingInfo.events.includes(e.name)&&r&&(s.playbackProgress={time:r.currentTime}),h({},G,this.staticParams,e.extraRootFields,s,this.playerInfo,{vpuid:W.z,eventType:"event",eventName:e.name,timestamp:this.getLogTimestamp(),documentIsVisible:(0,M.s)(document),eventIndex:this.eventIndex,data:n,labels:i,sourceIndex:null!=t?t:this.sourceIndexes.current})}getFullErrorLog(e){let{error:t,labels:r,extraRootFields:i,sourceIndex:n}=e;const s=h({},this.staticParams.labels,r);return t.details=(0,U.Y)(()=>"string"===typeof t.details?t.details:JSON.stringify(t.details))||t.details,h({},G,this.playerInfo,this.staticParams,i,{vpuid:W.z,eventType:t.isFatal?"fatal":"error",eventName:String(t.code),timestamp:this.getLogTimestamp(),documentIsVisible:(0,M.s)(document),eventIndex:this.eventIndex,data:t,labels:s,sourceIndex:null!=n?n:this.sourceIndexes.current})}getDataToSend(e){if(!e)return{};const{duration:t,currentTime:r,utcStartTime:i,isFullscreen:n,volume:s,muted:a}=e;return{watchedSec:this.watchedTimeTracker.getWatchedTime(),duration:isNaN(t)?void 0:t,time:r,utcTime:void 0===i?void 0:i+r,isFullscreen:n,isMuted:a||0===s}}sendData(e,t){void 0!==e&&((0,U.Y)(()=>this.sendLog(e,t),F.L),this.eventIndex++)}checkStalledReason(e){return this.stalledController.getCurrentStalledReason()===e}setBuffering(e,t){this.stalledController.setBuffering(e,t)}setExpectedBuffering(e){let{reason:t,details:r}=e;switch(this.checkInitBuffering(t),t){case R.k.SetSource:this.setBuffering(!1),this.clearBufferingHistory();break;case R.k.Init:break;default:this.checkStalledReason(t)||this.setBuffering(!1)}return this.stalledController.setExpectedStalled(o(t,r))}checkInitBuffering(e){this.wasInitBufferingLogged||e===R.k.Init||this.onInitBuffering()}setExternalStalledDuration(e){const t=this.getExpectedStalled();t.reason===R.k.Init&&e&&(t.details={externalStalledDuration:e/1e3},this.setExpectedBuffering(t))}startInitBufferingTimer(){this.initialStalledTimestamp=(0,y.no)()}stopInitBufferingTimer(){this.initialStalledTimestampStop=(0,y.no)()}onInitBuffering(e){if(this.wasInitBufferingLogged)return;const t=this.initialStalledTimestamp&&!this.initialStalledTimestampStop,r=this.initialStalledTimestamp&&this.initialStalledTimestampStop;this.initialStalledDuration=t?(0,y.no)()-this.initialStalledTimestamp:r?this.initialStalledTimestampStop-this.initialStalledTimestamp:0,this.externalStalledDuration=null!=e?e:0;const{playingState:i}=this.getState()||{};"pause"!==i&&this.handleInitialBuffering(),this.wasInitBufferingLogged=!0,this.initialStalledTimestamp=void 0,this.initialStalledTimestampStop=void 0}handleInitialBuffering(){this.wasInitBufferingHandled||(this.externalStalledDuration&&this.setExternalStalledDuration(this.externalStalledDuration),this.setBuffering(!0,this.initialStalledDuration),this.wasInitBufferingHandled=!0)}destroy(e){this.stalledController.destroy(),this.playerAliveController.destroy(),this.watchedTimeTracker.destroy(),this.logEvent({name:"DestroyPlayer",data:{reason:null==e?void 0:e.reason}}),this.destroyed=!0}getExpectedStalled(){return this.stalledController.getExpectedStalled()}clearBufferingHistory(){return this.stalledController.clearStalledHistory()}setPreloadDetails(){this.useOfDeprecatedMethodIsLogged||(this.logEvent({name:"DeprecatedTelemetryMethodUsed",data:{method:"setPreloadDetails"}}),this.useOfDeprecatedMethodIsLogged=!0),(0,F.L)(new Error("Deprecated method used. Method is Telemetry#setPreloadDetails(). Just remove it."))}writePlayerAliveStateManually(){return this.playerAliveController.writeStateManually()}flushStates(){return this.playerAliveController.flushStates()}onCreatePlayer(e,t){this.logEvent({name:"CreatePlayer",data:e,extraRootFields:t})}onBeforePreload(){return++this.sourceIndexes.last}getSourceIndex(){return this.sourceIndexes.current}onBeforeSetSource(){return++this.sourceIndexes.last}onSetSource(e,t,r){var i;this.flushStates(),this.sourceIndexes.current=this.sourceIndexes.last>this.sourceIndexes.current?this.sourceIndexes.last:++this.sourceIndexes.last,this.watchedTimeTracker.reset(),r&&this.setStaticParams(r),this.logEvent({name:"SetSource",data:e}),this.setExpectedBuffering({reason:R.k.SetSource,details:t});const n=null==(i=this.getState())?void 0:i.playingState;n!==p.X.PAUSE&&n!==p.X.END&&this.setBuffering(!0)}sendReportLog(e,t,r){void 0===r&&(r=!0);const i=null!=t?t:this.generateReportId();return this.logEvent({name:"ReportLog",data:{reportId:i,reported:r,reportData:e}}),i}generateReportId(){return this.playerInfo.vsid+"x"+this.reportNumber++}onExpectedBuffering(e){let{reason:t,details:r}=e;return this.checkInitBuffering(t),this.stalledController.setExpectedStalled(o(t,r))}onSeek(e){this.setExpectedBuffering({reason:R.k.Seek,details:e})}onVideoTrackChange(e){this.setExpectedBuffering({reason:R.k.VideoTrackChange,details:e})}onAudioTrackChange(e){this.setExpectedBuffering({reason:R.k.AudioTrackChange,details:e})}onRecover(e){this.setExpectedBuffering({reason:R.k.Recover,details:e})}onMediaError(e){this.setExpectedBuffering({reason:R.k.MediaError,details:e})}onNetworkStatusChange(e){this.setExpectedBuffering({reason:R.k.Offline,details:e})}onRepresentationsChange(e){this.setExpectedBuffering({reason:R.k.RepresentationsChange,details:e})}onLiveEdge(e){this.setExpectedBuffering({reason:R.k.LiveEdge,details:e})}onAdStart(e){this.setExpectedBuffering({reason:R.k.AdStart,details:e})}onAdBetween(e){this.setExpectedBuffering({reason:R.k.AdBetween,details:e})}onAdEnd(e){this.setExpectedBuffering({reason:R.k.AdEnd,details:e})}}},1771:(e,t,r)=>{"use strict";r.d(t,{j:()=>i});const i=new RegExp("^https?:\\/\\/([^\\/]+\\.)?("+["(an|strm)\\.yandex\\.(ru|net)","yastatic\\.net","strm-ott\\.akamaized\\.net","cdn\\.ngenix\\.net","strm\\.yandex\\.cdnga\\.net","strm-yandex\\.gcdn\\.co","(widevine|playready|fairplay)-proxy\\.ott\\.yandex\\.ru","drm\\.yandex-team\\.ru"].join("|")+")\\/(?!log|perf|jstracer)")},7638:(e,t,r)=>{"use strict";function i(e,t,r){return e&&"number"===typeof e?e+t-r:e}function n(e){return"function"===typeof e||"Function"===(0,a.M)(e)}function s(e){var t,r,i,n;return null!=(t=null==(r=e.performance)?void 0:r.timeOrigin)?t:null==(i=e.performance)||null==(n=i.timing)?void 0:n.navigationStart}r.d(t,{$:()=>d});r(7881);var a=r(9521),o=r(1771),l=r(3451);class d{constructor(e){this.config=e,this.intervalId=void 0,this.contexts=[]}attach(e){(function(e){return e.performance&&(n(e.performance.getEntriesByType)||n(e.performance.webkitGetEntriesByType))&&(n(e.performance.clearResourceTimings)||n(e.performance.webkitClearResourceTimings))})(e)&&-1===this.contexts.indexOf(e)&&(0===this.contexts.length&&(this.intervalId=setInterval(()=>this.flush(),3e4)),this.contexts.push(e))}detach(e){const t=this.contexts.indexOf(e);-1!==t&&this.contexts.splice(t,1),0===this.contexts.length&&clearInterval(this.intervalId)}destroy(){this.flush(),this.contexts.length=0,clearInterval(this.intervalId)}flush(){const e=[],t=this.contexts.map(s),r=Math.min(...t);this.contexts.forEach((n,s)=>{(function(e){try{var t,r;const i=null!=(t=e.performance.getEntriesByType)?t:e.performance.webkitGetEntriesByType,n=null!=(r=e.performance.clearResourceTimings)?r:e.performance.webkitClearResourceTimings,s=i.call(e.performance,"resource");return n.call(e.performance),s}catch(i){return[]}})(n).forEach(n=>{o.j.test(n.name)&&e.push(function(e,t,r){let{duration:n,entryType:s,name:a,startTime:o,connectEnd:l,connectStart:d,decodedBodySize:u,domainLookupEnd:c,domainLookupStart:h,encodedBodySize:p,fetchStart:f,initiatorType:m,nextHopProtocol:g,redirectEnd:v,redirectStart:y,requestStart:S,responseEnd:E,responseStart:b,secureConnectionStart:A,transferSize:T,workerStart:_,serverTiming:w,responseStatus:k,deliveryType:R,renderBlockingStatus:P,firstInterimResponseStart:C}=e;return{duration:n,entryType:s,name:a,encodedBodySize:p,decodedBodySize:u,initiatorType:m,transferSize:T,nextHopProtocol:g,serverTiming:w,responseStatus:k,deliveryType:R,renderBlockingStatus:P,startTime:i(o,t,r),connectEnd:i(l,t,r),connectStart:i(d,t,r),domainLookupEnd:i(c,t,r),domainLookupStart:i(h,t,r),fetchStart:i(f,t,r),redirectEnd:i(v,t,r),redirectStart:i(y,t,r),requestStart:i(S,t,r),responseEnd:i(E,t,r),responseStart:i(b,t,r),secureConnectionStart:i(A,t,r),workerStart:i(_,t,r),firstInterimResponseStart:i(C,t,r)}}(n,t[s],r))})}),0!==e.length&&this.config.sendLog(e,{perfnow:String((0,l.m6)()),navstart:String(r)})}}},3807:(e,t,r)=>{"use strict";r.d(t,{B7:()=>l,EW:()=>o});var i=r(4364),n=r(1729),s=r(3451);class a{setTimeout(e,t){if(t<=0)return void(0,n.Y)(e,i.L);const r=window.setTimeout(e,t);return()=>window.clearTimeout(r)}now(){return(0,s.m6)()}}class o{constructor(e){void 0===e&&(e=0),this.time=e,this.tasks=void 0,this.tasks=[]}setTimeout(e,t){const r=this.time+t,s={task:e,time:r,isCanceled:!1,isRunned:!1};let a=0;for(;a<this.tasks.length&&!(r<this.tasks[a].time);a+=1);if(this.tasks.splice(a,0,s),!(t<=0))return()=>s.isCanceled=!0;(0,n.Y)(()=>this.runTask(s),i.L)}setTime(e){if(isNaN(e))return;let t=0;for(;t<this.tasks.length&&!(e<this.tasks[t].time);t+=1)this.runTask(this.tasks[t]);this.time=e,this.tasks.splice(0,t)}now(){return this.time}tick(e){this.setTime(this.time+e)}reset(){this.time=0,this.tasks=[]}runTask(e){e.isRunned||e.isCanceled||(e.isRunned=!0,this.time=e.time,e.task())}}class l{constructor(e,t){void 0===t&&(t=new a),this.distributionFunction=e,this.clock=t,this.stopped=!0,this.cancel=void 0,this.lastNow=0,this.lastKnockTime=void 0,this.lastTimeout=0,this.restTime=0,this.destroyed=!1,this.isFirstKnock=!0,this.count=0}setEnabled(e){return e?this.start():this.stop(),this}stop(){return this.stopped||(this.stopped=!0,this.cancelTimeout(),this.restTime=Math.max(this.restTime-(this.clock.now()-this.lastKnockTime),0)),this}start(){return this.stopped&&!this.destroyed&&(this.stopped=!1,this.lastKnockTime=this.clock.now(),this.setTimeout(()=>this.knock(this.lastNow+this.lastTimeout),this.restTime)),this}destroy(){this.cancelTimeout(),this.stopped=!0,this.destroyed=!0}knock(e){this.lastNow=e,this.lastKnockTime=this.clock.now(),this.isFirstKnock?this.isFirstKnock=!1:this.count++;const t=this.restTime=this.lastTimeout=this.distributionFunction({time:e,count:this.count});this.stopped||this.destroyed||this.setTimeout(()=>this.knock(e+t),t)}cancelTimeout(){void 0!==this.cancel&&this.cancel(),this.cancel=void 0}setTimeout(e,t){this.cancelTimeout();const r=this.clock.setTimeout(e,t);void 0!==r&&(this.cancelTimeout(),this.cancel=r)}}},1662:(e,t,r)=>{"use strict";let i;r.d(t,{k:()=>i}),function(e){e.Init="Init",e.SetSource="SetSource",e.Seek="Seek",e.VideoTrackChange="VideoTrackChange",e.AudioTrackChange="AudioTrackChange",e.Recover="Recover",e.MediaError="MediaError",e.Offline="Offline",e.Other="Other",e.Render="Render",e.RepresentationsChange="RepresentationsChange",e.LiveEdge="LiveEdge",e.AdStart="AdStart",e.AdOther="AdOther",e.AdBetween="AdBetween",e.AdEnd="AdEnd"}(i||(i={}))},7154:(e,t,r)=>{"use strict";r.d(t,{p:()=>n});r(7881);var i=r(371);class n{constructor(){this.lastUpdate=void 0,this.watchedTime=0}calc(e,t,r){if(void 0!==this.lastUpdate){const r=function(e,t){const r=e>=0&&e<=t+.5?e:t;return Math.max(0,r)}((e-this.lastUpdate.videoTime)/t,this.lastUpdate.getElapsedTime()/1e3);this.watchedTime=this.watchedTime+r}this.lastUpdate=r?{getElapsedTime:(0,i.u)(),videoTime:e}:void 0}get(){return this.watchedTime}restoreLastUpdate(){this.lastUpdate=void 0}}},6588:(e,t,r)=>{"use strict";let i,n;r.d(t,{X:()=>n,r:()=>i}),function(e){e.Start="Start",e.Watched4Sec="4SecWatched",e.Watched10Sec="10SecWatched",e.Watched20Sec="20SecWatched",e.Heartbeat30Sec="30SecHeartbeat",e.End="End"}(i||(i={})),function(e){e.PLAY="play",e.PAUSE="pause",e.BUFFERING="buffering",e.END="end"}(n||(n={}))},9178:(e,t,r)=>{"use strict";function i(e,t,r,i){function s(){null!==a&&clearTimeout(a),a=null}3===arguments.length&&"boolean"!==typeof r&&(i=r,r=!1);let a=null,o=n.Z;const l=function(){const l=arguments;i=i||this,o=()=>{s(),o=n.Z,e.apply(i,l)},r&&null===a&&e.apply(i,l),s(),a=window.setTimeout((function(){r||e.apply(i,l),a=null}),t)};return l.cancel=s,l.now=()=>{o()},l}r.d(t,{D:()=>i});var n=r(3487)},9761:(e,t,r)=>{"use strict";function i(e){let t="";for(let r=0;r<e;r++)t+=(16*(0,n.M)()|0).toString(16);return t}r.d(t,{a:()=>i});var n=r(3354)},5512:(e,t,r)=>{"use strict";r.d(t,{k:()=>i});const i=e=>"hidden"in e?"hidden":"webkitHidden"in e?"webkitHidden":void 0},3041:(e,t,r)=>{"use strict";function i(e,t){void 0===t&&(t=!0);const r=(0,n.k)(e);if(!r)return t;return!e[r]}r.d(t,{s:()=>i});var n=r(5512)},9240:(e,t,r)=>{"use strict";function i(e){if(void 0===e&&(e=window),!e.navigator)return n;const{connection:t={}}=e.navigator;return"number"===typeof(r=t.rtt)&&isFinite(r)?t.rtt:n;var r}r.d(t,{n:()=>i});const n=NaN},371:(e,t,r)=>{"use strict";function i(e){void 0===e&&(e=n.no);const t=e();return()=>Math.max(0,e()-t)}r.d(t,{u:()=>i});r(7881);var n=r(3451)},3834:(e,t,r)=>{"use strict";function i(e){if(e&&e.location){const{location:t}=e;return"function"===typeof t.toString?t.toString():t.href||""}return""}r.d(t,{b:()=>i})},3487:(e,t,r)=>{"use strict";function i(){}r.d(t,{Z:()=>i})},5581:(e,t,r)=>{"use strict";function i(e,t){const r=function(e){const t=(0,a.k)(e);if(t)return t.replace(/hidden/i,"visibilitychange")}(e);if(!r)return n.Z;const i=()=>{t((0,s.s)(e))};return e.addEventListener(r,i),()=>e.removeEventListener(r,i)}r.d(t,{Y:()=>i});var n=r(3487),s=r(3041),a=r(5512)},4364:(e,t,r)=>{"use strict";function i(e){setTimeout(()=>{throw e},0)}r.d(t,{L:()=>i})},9444:(e,t,r)=>{"use strict";function i(e){return"function"===typeof e||"Function"===(e=>{const t=n.call(e);if(!t)return null;const r=t.match(s);if(!r)return null;const i=r[1];if(!i)return null;return i})(e)}r.d(t,{no:()=>h});const n={}.toString,s=/\[object (\w+)\]/,a=Date&&i(Date.now)?()=>Date.now():()=>(new Date).getTime(),o="undefined"===typeof window?void 0:window.performance,l=o&&i(o.now),d=o&&o.timing&&o.timing.navigationStart,u=o&&o.timeOrigin?o.timeOrigin:d?o.timing.navigationStart:a();let c=0;const h=l?()=>o.now():()=>(()=>{const e=a()-u;return c=Math.max(e,c),c})()},4780:(e,t,r)=>{"use strict";r.d(t,{i:()=>i});const i="playerskin-native-ui-mode"},3942:(e,t,r)=>{"use strict";r.d(t,{R:()=>i});r(7881);const i=e=>null===e?1/0:void 0===e?1280:e},6170:(e,t,r)=>{"use strict";r.d(t,{hV:()=>n,wS:()=>s,V9:()=>a,g2:()=>o,Xy:()=>i});const i="playerapi-version",n="playerapi-debug-logcalls",s="playerapi-debug-logevents",a="playerapi-debug-loginternals",o="playerapi-debug-panel"},2516:(e,t,r)=>{"use strict";function i(e,t,r,i){let{params:n}=e;(0,y.K)(n[0])?((0,v.M)(n[0],(e,i)=>{i===t&&(Array.isArray(e)?e.forEach(e=>e(r)):e(r))}),i&&(n[0][t]=[])):n[0]===t&&(0,g.m)(n[1])&&(n[1](r),i&&(n[1]=c.Z))}function n(e,t,r){for(let n=0;n<e.length;n++){const s=e[n];"on"===s.name?i(s,t,r,!1):"once"===s.name&&i(s,t,r,!0)}}function s(){return(s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function a(e){function t(t){if(e&&console.log("[PLAYER] [CALL]",t.name,t.params),void 0!==i)return i[t.name].apply(i,t.params);if(void 0!==a&&S.indexOf(t.name)>-1)return a[t.name].apply(a,t.params);if(!t.async)return void g.push(t);const r=s({},t,{resolve:c.Z,reject:c.Z});return g.push(r),new Promise((e,t)=>{r.resolve=e,r.reject=t})}function r(e,t){e.forEach(e=>{e.async?t[e.name].apply(t,e.params).then(e.resolve,e.reject):t[e.name].apply(t,e.params)}),e.length=0}let i,a,h=!1,g=[];const v={getReadyState:()=>h?u.k.broken:i?i.getReadyState():u.k.init,getState:()=>{if(i)return i.getState()},setReadyInstance(e){i=e,r(g,i)},handlePlayerDestroy(){i=void 0,a=void 0},setInstance(e){a=e;const[t,i]=(0,o.x)(g,e=>{let{name:t}=e;return f.n.indexOf(t)>-1});g=i,r(t,a)},emitErrorOnStart(e){if(i)throw new Error("Can't emit error on lazyApi after #setInstance()");h=!0,function(e,t){n(e,"ErrorChange",{error:t})}(g,e instanceof Error?e:new Error("NOT_AN_OBJECT_ERROR: "+e))},emitEventOnStart(e,t){a||n(g,e,t)}};return Object.defineProperty(v,"skin",{get:()=>i?i.skin:void 0}),m.t.forEach(e=>{v[e]="pause"===e?function(r){return void 0===r&&(r=d.l.ExternalApi),v.emitEventOnStart("RequestPlayingState",{playingState:l.X.PAUSE,playingStateReason:r}),t({name:e,params:Array.prototype.slice.call(arguments),async:!1})}:function(){return t({name:e,params:Array.prototype.slice.call(arguments),async:!1})}}),p.o.forEach(e=>{v[e]="play"===e?function(r){return void 0===r&&(r=d.l.ExternalApi),v.emitEventOnStart("RequestPlayingState",{playingState:l.X.PLAY,playingStateReason:r}),t({name:e,params:Array.prototype.slice.call(arguments),async:!0})}:function(){return t({name:e,params:Array.prototype.slice.call(arguments),async:!0})}}),v}r.d(t,{K:()=>a});var o=r(7618),l=r(7746),d=r(8172),u=r(9200),c=r(55),h=r(4145),p=r(1792),f=r(1194),m=r(7549),g=r(4754),v=r(9632),y=r(6878);const S=[...f.n,...h.V]},8772:(e,t,r)=>{"use strict";r.r(t),r.d(t,{OTT_DRM_PROXY_HOSTNAMES:()=>i});const i=["playready-proxy.ott.yandex.ru","playready-proxy-preproduction.ott.yandex.ru","widevine-proxy.ott.yandex.ru","widevine-proxy-preproduction.ott.yandex.ru","fairplay-proxy.ott.yandex.ru","fairplay-proxy-preproduction.ott.yandex.ru","drm.yandex-team.ru"]},6336:(e,t,r)=>{"use strict";r.r(t),r.d(t,{OTT_TRACKING_REGEXP:()=>i});const i=new RegExp(/^https:\/\/tracking(-testing){0,1}\.ott\.yandex\.net\/v\d+\/watch-batch/)},123:(e,t,r)=>{"use strict";r.d(t,{g:()=>i});const i="source_index"},8825:(e,t,r)=>{"use strict";function i(e){function t(){if(0===r.length)return;const e=r.slice();r.length=0,e.forEach(e=>{let{task:t,onPromiseReject:r}=e;if(o)r(s);else try{t(i)}catch(n){}}),r.length>0&&t()}const r=[];let i,s,a=!1,o=!1;return e.then(e=>{i=e,a=!0,t()}),e.catch(e=>{s=e,o=!0,t()}),function(e,t){if(void 0===t&&(t=n.Z),o)t(s);else if(!a||r.length>0)r.push({task:e,onPromiseReject:t});else try{e(i)}catch(l){}}}r.d(t,{P:()=>i});var n=r(55)},4723:(e,t,r)=>{"use strict";r.d(t,{s:()=>o});var i=r(9884),n=r(808),s=r(3525);const a=r(8139);class o extends Error{constructor(e,t){void 0===t&&(t={});const r="object"===typeof e?e:{message:String(e||s.J.message)};super(),this.message=void 0,this.code=void 0,this.category=void 0,this.isFatal=void 0,this.details=void 0,this.stack=void 0,this.toString=void 0,this.toJSON=void 0,a(this,o.prototype),this.message=t.message||r.message||s.J.message,this.code=t.code||r.code||r.id||s.J.code,this.category=t.category||r.category||s.J.category,this.isFatal=Boolean(function(e){const[t]=(0,n.h)(e,e=>void 0!==e);return t}([t.isFatal,r.isFatal,s.J.isFatal])),this.details=t.details||r.details||s.J.details,Object.defineProperty(this,"stack",{enumerable:!0});const l=t.stack||r.stack||function(e){const{url:t,line:r,col:i,fileName:n,columnNumber:s,lineNumber:a}=e;return(t||n||"?")+":"+(r||a||"?")+":"+(i||s||"?")}(r);let d=l===s.J.stack?this.stack:l;if(d&&d!==s.J.stack)this.stack=d;else if(!this.stack)try{throw new Error(this.message)}catch(u){this.stack=d=u.stack||s.J.stack}this.toString=()=>(0,i.Y)(this.toJSON())||"{}",this.toJSON=()=>({message:this.message,code:this.code,isFatal:this.isFatal,details:this.details,category:this.category,stack:d})}}},3525:(e,t,r)=>{"use strict";r.d(t,{J:()=>i});const i={message:"DEFAULT_ERROR_MESSAGE",code:0,details:"",stack:"?:?:?",isFatal:!0,category:"DEFAULT"}},520:(e,t,r)=>{"use strict";function i(e){const t=e.map(e=>{let{start:t,end:r}=e;return{start:t,end:r}}).sort((e,t)=>e.start-t.start);if(t.length<=1)return t;const r=[t[0]];return t.slice(1).forEach((e,t)=>{const i=r[r.length-1];i.end<e.start?r.push(e):i.end<e.end&&(i.end=e.end)}),r}r.d(t,{l:()=>i})},3480:(e,t,r)=>{"use strict";function i(e){void 0===e&&(e=window);const t=e.ManagedMediaSource||e.MediaSource||e.WebKitMediaSource;return t&&(0,n.m)(t.isTypeSupported)&&!function(e){void 0===e&&(e=window);const t=e.SourceBuffer||e.WebKitSourceBuffer;return!!t&&!(t.prototype&&(0,n.m)(t.prototype.appendBuffer)&&(0,n.m)(t.prototype.remove))}(e)?t:void 0}r.d(t,{Q:()=>i});var n=r(4754)},8834:(e,t,r)=>{"use strict";r.d(t,{I:()=>i});const i=Number.EPSILON||Math.pow(2,-52)},8243:(e,t,r)=>{"use strict";function i(e,t,r,i){const a=function(e){let t=!1,r=!1,i=!1;return!0===e?t=!0:"object"===typeof e&&(t=Boolean(e.capture),r=Boolean(e.passive),i=Boolean(e.once)),{capture:t,passive:r,once:i}}(i),o=s.FF?a:a.capture,l=a.once&&!s.vE?function(e){d(),r.call(this,e)}:r,d=()=>{(0,n.f)(e,t,l,o)};return(0,n.h)(e,t,l,o),d}r.d(t,{O:()=>i});var n=r(3751),s=r(5531)},7633:(e,t,r)=>{"use strict";r.d(t,{T:()=>n});var i=r(3834);const n=e=>{const t=[],r=[];for(;e;)try{if(r.push((0,i.b)(e)),t.push(e),e.parent===e)break;e=e.parent}catch(n){break}return{windowChain:t,locationChain:r}}},3751:(e,t,r)=>{"use strict";r.d(t,{f:()=>a,h:()=>s});var i=r(7118),n=r(4754);let s=function(e,t,r){(0,n.m)(e.attachEvent)&&e.attachEvent("on"+t,r)},a=function(e,t,r){(0,n.m)(e.detachEvent)&&e.detachEvent("on"+t,r)};(0,i.C)(EventTarget.prototype,"addEventListener")&&(0,i.C)(EventTarget.prototype,"removeEventListener")&&(s=function(e,t,r,n){const s=e&&(0,i.C)(e,"addEventListener");s&&s.call(e,t,r,n)},a=function(e,t,r,n){const s=e&&(0,i.C)(e,"removeEventListener");s&&s.call(e,t,r,n)})},5531:(e,t,r)=>{"use strict";r.d(t,{FF:()=>o,vE:()=>s,wI:()=>a});var i=r(4612),n=r(3751);let s=!1,a=!1,o=!1;try{if(function(e){void 0===e&&(e=window);const t=e.Object;try{const e={};return t.defineProperty(e,"sentinel",{}),"sentinel"in e}catch(r){return!1}}()){const e=document.createElement("div"),t={};Object.defineProperty(t,"once",{get:()=>s=!0}),Object.defineProperty(t,"passive",{get:()=>a=!0}),Object.defineProperty(t,"capture",{get:()=>o=!0}),(0,n.h)(e,"click",i.Z,t)}}catch(l){}},9117:(e,t,r)=>{"use strict";function i(e){return e instanceof Error||"Error"===(0,n.M)(e)}r.d(t,{V:()=>i});var n=r(9521)},4754:(e,t,r)=>{"use strict";function i(e){return"function"===typeof e||"Function"===(0,n.M)(e)}r.d(t,{m:()=>i});var n=r(9521)},5214:(e,t,r)=>{"use strict";function i(e){if(!e)return[];const t=[];for(let r=0;r<e.length;r++)t.push(e[r]);return t}r.d(t,{w:()=>i})},9066:(e,t,r)=>{"use strict";function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function n(e){const{method:t,url:r,async:d=!0,data:u,responseType:c="text",onBeforeSend:h=a.Z,onRetry:p=a.Z,checkStatus:f=(e=>l===e),headers:m={},xhrConstructor:g=XMLHttpRequest,retries:v=0,timeout:y=0,withCredentials:S,onAbort:E,onSetup:b}=e;if(!g)return;const A=e.onSuccess?(0,s.I)(e.onSuccess):a.Z,T=e.onError?(0,s.I)(e.onError):a.Z;let _,w=!1,k=0,R=e=>{w=!0,R=a.Z,_=e,P(new Error("Abort request")),"function"===typeof E&&E(e)};const P=t=>{C.onerror=null,C.onreadystatechange=null,k&&clearTimeout(k);if(k&&4!==C.readyState||w)try{C.abort()}catch(r){}if(!w)if(v>0){const r=p(t,C);if("boolean"!==typeof r||r||R(),w)return;n(i({},e,{onSetup:e=>{let{abort:t}=e;R=e=>t(e),w&&t(_)},retries:v-1}))}else R=a.Z,T(t,C)},C=new g;try{C.open(t,r,d)}catch(I){return void P(I)}if(C.responseType=c,C.withCredentials=Boolean(S),(0,o.M)(m,(e,t)=>{try{C.setRequestHeader(t,e)}catch(I){}}),y>0&&isFinite(y)&&(k=window.setTimeout(()=>{P(new Error("Request timeout, "+r))},y)),C.onerror=P,C.onreadystatechange=()=>{if(4===C.readyState){const{status:e}=C;f(e)?(R=a.Z,clearTimeout(k),A(C)):P(new Error("Invalid request status "+e+", "+r))}},("function"!==typeof b||(b({abort:e=>R(e)}),!w))&&(h(C,e),!w))try{C.send(u)}catch(I){P(I)}}r.d(t,{W:()=>n});var s=r(3697),a=r(4612),o=r(9632);const l=200},7668:(e,t,r)=>{"use strict";function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function n(e){return new Promise((t,r)=>{(0,s.W)(i({},e,{onSuccess:t,onError:r}))})}r.d(t,{W:()=>n});var s=r(9066)},4612:(e,t,r)=>{"use strict";function i(){}r.d(t,{Z:()=>i})},3125:(e,t,r)=>{"use strict";function i(e){void 0===e&&(e=n.no);const t=e();return()=>Math.max(0,e()-t)}r.d(t,{u:()=>i});var n=r(9444)},4204:(e,t,r)=>{"use strict";r.d(t,{_:()=>i});const i=async(e,t)=>{let r;try{await new Promise((i,n)=>{t&&t.then(i,n),r=window.setTimeout(i,e)})}finally{window.clearTimeout(r)}}},6971:(e,t,r)=>{"use strict";let i;r.d(t,{q:()=>i}),function(e){e.DEFAULT="DEFAULT",e.MEDIA="MEDIA",e.NETWORK_MEDIA="NETWORK_MEDIA",e.NETWORK_PLAYER="NETWORK_PLAYER",e.NETWORK_TIMEOUT="NETWORK_TIMEOUT",e.NO_CODECS="NO_CODECS",e.CANNOT_PLAY="CANNOT_PLAY",e.UNSUPPORTED_ENV="UNSUPPORTED_ENV",e.EXCEPTION="EXCEPTION",e.ADS="ADS",e.CONFIG="CONFIG",e.REGIONAL="REGIONAL",e.DRM="DRM",e.ACCESS="ACCESS",e.BANNED="BANNED"}(i||(i={}))},9200:(e,t,r)=>{"use strict";r.d(t,{k:()=>i.k});var i=r(6094)},5636:(e,t,r)=>{"use strict";r.d(t,{B:()=>n});var i=r(55);class n{constructor(){this.resolve=void 0,this.reject=void 0,this.promise=void 0;let e=i.Z,t=i.Z;this.promise=new Promise((r,i)=>{e=r,t=i}),this.resolve=e,this.reject=t}}},45:(e,t,r)=>{"use strict";let i;r.d(t,{v:()=>i}),function(e){e[e.UNKNOWN_ERROR=0]="UNKNOWN_ERROR",e[e.PARSE_ERROR=-32700]="PARSE_ERROR",e[e.INVALID_REQUEST=-32600]="INVALID_REQUEST",e[e.METHOD_NOT_FOUND=-32601]="METHOD_NOT_FOUND",e[e.INVALID_PARAMS=-32602]="INVALID_PARAMS",e[e.INTERNAL_ERROR=-32603]="INTERNAL_ERROR"}(i||(i={}))},3126:(e,t,r)=>{"use strict";function i(e,t,r){void 0===r&&(r=window);const i=(0,n.b)(r),l=t((0,o.ce)(e,i));if(void 0!==l)return console&&(0,a.m)(console.warn)&&console.warn("using "+e+"="+l+" from query"),l;const d=t(function(e,t){try{const r=e.localStorage.getItem(t);if(!r)return;return r}catch(r){return}}(r,e));if(void 0!==d)return console&&(0,a.m)(console.warn)&&console.warn("using "+e+"="+d+" from localStorage"),d;if(e===s.Xy){const i=t(function(e,t){try{const r=e.sessionStorage.getItem(t);if(!r)return;return r}catch(r){return}}(r,e));if(void 0!==i)return i}}r.d(t,{O:()=>i});var n=r(3834),s=r(6170),a=r(4754),o=r(9223)},5605:(e,t,r)=>{"use strict";function i(e){return(0,n.H)(e.tagName)}r.d(t,{m:()=>i});var n=r(9209)},9884:(e,t,r)=>{"use strict";function i(e,t){return e+"/"+t}function n(e){if("string"===typeof e&&(e={message:e}),"object"===typeof e&&null!==e||(e={}),"function"===typeof e.toJSON)try{return{__stringifyError:e.toJSON()}}catch(n){}const{name:t,message:r,stack:i}=e;return{__stringifyError:{name:t,message:r,stack:i}}}function s(e,t,r,n){const s=o(e[t],i(r,t),n);return void 0===s?"null":s}function a(e){return JSON.stringify(e)}function o(e,t,r){switch(typeof e){case"boolean":return e?"true":"false";case"string":return a(e);case"undefined":return;case"bigint":return a(e.toString());case"function":return a("[Function"+("string"===typeof e.name&&e.name.length>0?" "+e.name:"")+"]");case"symbol":return a("[Symbol]");case"number":return isNaN(e)||!isFinite(e)?"null":String(e);case"object":if(null===e)return"null";if(l=e,"[object Window]"===Object.prototype.toString.call(l))return a("[object Window]");if((0,u.m)(e))return a("[DOMNode "+e.tagName+"]");if(function(e){return"undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&ArrayBuffer.isView(e)}(e)){const{name:t}=e.constructor;return a("["+(t||"TypedArray")+"("+(e.byteLength||0)+")]")}const d=r.get(e);if(void 0!==d)return a("[Circular "+d+"]");r.set(e,t);return(0,c.k)(e)?function(e,t,r){if(0===e.length)return"[]";let i="["+s(e,0,t,r);for(let n=1;n<e.length;n++)i+=","+s(e,n,t,r);return i+"]"}(e,t,r):function(e,t,r){if("function"===typeof e.toJSON){let s;try{s=e.toJSON()}catch(d){s=n(d)}return o(s,i(t,"toJSON"),r)}let s="{",l=!0;for(let u in e){if(!Object.prototype.hasOwnProperty.call(e,u))continue;let c;try{c=e[u]}catch(d){c=n(d)}const h=o(c,i(t,u),r);void 0!==h&&(l?l=!1:s+=",",s+=a(u)+":"+h)}return s+"}"}(e,t,r)}var l}function l(e){try{return o(e,"~",function(){const e="undefined"!==typeof WeakMap?new WeakMap:void 0,t=[];return{set:(r,i)=>{if(void 0!==e)try{e.set(r,i)}catch(n){t.push({path:i,value:r})}else t.push({path:i,value:r})},get:r=>{const i=(0,d.s)(t,e=>e.value===r);return void 0!==e&&void 0===i?e.get(r):i?i.path:void 0}}}())}catch(t){return JSON.stringify(n(t))}}r.d(t,{Y:()=>l});var d=r(3015),u=r(5605);var c=r(1115)},3563:(e,t,r)=>{"use strict";function i(){const e={};for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];r.filter(Boolean).join(";").split(";").forEach(t=>{if(!/^\d+,\d+,-?\d+$/.test(t))return;const r=parseInt(t,10);e[r]=e[r]||t});const n=[];for(const s in e)e.hasOwnProperty(s)&&n.push(e[s]);return 0<n.length?n.join(";"):void 0}r.d(t,{S:()=>i})},55:(e,t,r)=>{"use strict";function i(){}r.d(t,{Z:()=>i})},8225:(e,t,r)=>{"use strict";function i(e){return"frontend.vh.yandex."+e}function n(){const e=function(){const e=window.location.hostname.split(".");if(1===e.length)return;const t=e.pop();return isFinite(parseInt(t,10))?void 0:t}();return void 0===e||-1===p.indexOf(e)?i("ru"):i(e)}function s(){return(s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function a(e,t){const r=(()=>{if(function(e){try{return new URL(e),!0}catch(t){return!1}}(e)){const t=(0,d.en)(e);return(0,d.hA)(s({},t,{pathname:t.pathname+".json"}))}const r=function(e,t){if(void 0===t||!t)return e;const r=(0,d.en)(e),i=r.hostname;return r.hostname=i.split(".").slice(0,-1).concat(t).join("."),r.host=r.host.replace(i,r.hostname),(0,d.hA)(r)}("https://frontend.vh.yandex.ru/player",function(e){return(0,u.H)(null==e?void 0:e.tld)?null==e?void 0:e.tld:n().split(".").pop()}(t));return((0,f.I)(window).contentBaseUrl||r)+"/"+e+".json"})();return(0,d.Sr)(r,s({},t||{},{vpuid:c.M0.getVpuid()}))}async function o(e,t){var r;const i=await function(e,t){const r=a(e,t);return(async()=>{const e=new h.H,t=setTimeout(()=>e.abort(),15e3);try{const i={credentials:"include"};return await(await window.fetch(r,s({signal:e.signal},i))).json()}catch(i){if(e.signal.aborted)throw new Error("requestVhParams timeout");throw i}finally{clearTimeout(t)}})()}(e,t),n=new l.y(t,void 0),o=await n.getPlayerConfig(i);return{vhParams:i,playerConfig:o,sourceConfig:o.source,skinConfig:(null==(r=o.skinParams)?void 0:r.skinConfig)||{}}}r.d(t,{s6:()=>o});var l=r(1485),d=r(9223),u=r(9209),c=r(6690),h=(r(7881),r(7320));const p=["ru","by","com","uz","kz"];var f=r(9278)},9223:(e,t,r)=>{"use strict";function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function n(e){let t=new URL(e,location.origin),r=t.pathname||"";"/"!==r.charAt(0)&&(r="/"+r);const i=e.indexOf("?"),n=e.indexOf("#");let s;return s=-1===i&&-1===n?e:-1===i?e.slice(0,n):-1===n?e.slice(0,i):e.slice(0,Math.min(i,n)),{originalPath:s,href:t.href,protocol:t.protocol,host:t.host,hostname:t.hostname,port:t.port,pathname:r,search:t.search,hash:t.hash}}function s(e,t){if(void 0===t&&(t=!1),t){const t=e.originalPath,r="/"===e.pathname&&"/"!==t[t.length-1];return e.originalPath+(r?"/":"")+e.search+e.hash}const r="443"===e.port||"80"===e.port?e.hostname:e.host;return e.protocol+"//"+r+e.pathname+e.search+e.hash}function a(e){try{return decodeURIComponent(e)}catch(t){return e}}function o(e){const t={},r=e.replace(/^[?#]+/,"").replace(/#.*$/,"").split("&");for(let i=0;i<r.length;i++){const e=r[i].indexOf("=");let n,s;if(-1===e?(n=a(r[i]),s=""):(n=a(r[i].slice(0,e)),s=r[i].slice(e+1)),n){const e=Boolean(/(\[\])$/.exec(n));n=n.replace(/\[\]$/,""),e?void 0===t[n]?t[n]=[a(s)]:t[n]=[].concat(t[n],a(s)):t[n]=a(s)}}return t}function l(e,t){return t.map(t=>e+"[]="+encodeURIComponent(t)).join("&")}function d(e){const t=[];for(const r in e)if(e.hasOwnProperty(r)){const i=e[r];(0,S.k)(i)?t.push(l(r,i)):void 0!==i&&t.push(r+"="+encodeURIComponent(i))}return"?"+t.join("&")}function u(e,t,r){if(void 0===r)return e;const a=n(e),l=o(a.search);return l[t]=r,s(i({},a,{search:d(l)}))}function c(e,t,r){let{override:a=!0,saveOriginalPath:l=!1}=void 0===r?{}:r;const u=n(e),c=o(u.search);(0,E.M)(t,(e,t)=>{(void 0===c[t]||a)&&(c[t]=e)});return s(i({},u,{search:d(c)}),l)}function h(e){return n(e).pathname.split("/").pop()||""}function p(e){const t=h(e).split(".");return t.length>1?t.pop():""}function f(e){return new RegExp("^(?:[a-z+]+:)?//","i").test(e.trim())}function m(e,t){const r=new RegExp("[?&]"+e+"=*([^&#]*)","g");let i=null,n=null;for(;n=r.exec(t);)i=n;return i&&"string"===typeof i[1]?decodeURIComponent(i[1]):void 0}function g(e,t){return((n(e).hash||"").slice(1).split("&").map(e=>e.split("=")).map(e=>{let[t,r]=e;return[t,void 0===r?"":r]}).find(e=>{let[r]=e;return r===t})||[])[1]}function v(e,t,r){if(void 0===t)return e;if(void 0===r)return e;const i=encodeURIComponent(t)+"="+encodeURIComponent(r),n=new URL(e,location.origin);return n.hash=n.hash?n.hash+"&"+i:""+i,n.href}function y(e,t,r){return e=function(e,t){if(-1===e.indexOf("#"))return e;const r=new URL(e,location.origin),i=function(e,t){return e.split("&").filter(e=>e!==t&&0!==e.indexOf(t+"=")).join("&")}(r.hash.slice(1),t);return r.hash=i?"#"+i:"",r.href}(e,t),void 0===r?e:v(e,t,r)}r.d(t,{Ou:()=>u,zP:()=>v,Sr:()=>c,lm:()=>p,UO:()=>h,pp:()=>g,ce:()=>m,sD:()=>f,dD:()=>o,en:()=>n,Yc:()=>y,hA:()=>s});var S=r(1115),E=r(9632)},4145:(e,t,r)=>{"use strict";r.d(t,{V:()=>i});const i=["play","setSource","destroy"]},1792:(e,t,r)=>{"use strict";r.d(t,{o:()=>i});const i=["sendReportLog","preloadSource","requestVideoElementFullscreen","requestDebugInfo","requestExternalPlay","requestExternalPlayerList","insertInto","playAdViewers",...r(4145).V]},1194:(e,t,r)=>{"use strict";r.d(t,{n:()=>i});const i=["pause","on","once","off","publicEmit"]},7549:(e,t,r)=>{"use strict";r.d(t,{t:()=>i});const i=["setVideoTrack","setAudioTrack","setTextTrack","changeAdditionalParams","exitVideoElementFullscreen","setPlaybackRate","setMuted","setVolume","setPictureInPictureAllowed","setVideoStyle","setNativeControlsVisibility","setNativeTextTrackVisibility","logEvent","logEventInternal","logError","seek","openReportWindow","playInrollAd","skipAdPod","setNativeAdControlsVisibility","setDebugPanelVisibility",...r(1194).n]},2390:(e,t,r)=>{"use strict";function i(e){function t(){return i.length<e}function r(e){function r(){i.splice(i.indexOf(s),1),function(){if(!t())return;const e=n.shift();e&&e()}()}const s=e.then(r,r);return i.push(s),e}void 0===e&&(e=1);const i=[],n=[];return{waitAndLock:function(e){return t()?r(e()):new Promise(t=>{n.push(()=>{t(r(e()))})})},addLock:r,isFree:t}}r.d(t,{l:()=>i})},9320:(e,t,r)=>{"use strict";function i(e,t,r){(0,a.K)(t)?(0,o.M)(t,(t,r)=>{(Array.isArray(t)?t:[t]).forEach(t=>{e(r,t)})}):(0,n.m)(r)&&e(t,r)}r.d(t,{h:()=>l});var n=r(4754),s=r(8337),a=r(6878),o=r(9632);class l{constructor(e){this.handlers=Object.create(null),this.filters=Object.create(null),this.batchFn=e=>e(),(0,a.K)(e)&&(0,n.m)(e.eventListenersBatch)&&(this.batchFn=e.eventListenersBatch)}on(e,t){i((e,t)=>this.getHandlers(e).push({once:!1,fn:t}),e,t)}once(e,t){i((e,t)=>this.getHandlers(e).push({once:!0,fn:t}),e,t)}off(e,t){const r=this.getHandlers(e),i=r.findIndex(e=>{let{fn:r}=e;return r===t});-1!==i&&r.splice(i,1)}setFilter(e,t){this.filters[e]=t}unsetFilter(e){delete this.filters[e]}getAllHandlers(){return this.handlers}emit(e,t){const r=this.filters[e];r&&!r(t)||this.batchFn(()=>{this.getHandlers(e).slice().forEach(r=>{try{r.once&&this.off(e,r.fn),r.fn(t)}catch(i){setTimeout(()=>{throw i},0)}})})}destroy(){(0,s.Z)(this.handlers).forEach(e=>{this.handlers[e]=void 0})}getHandlers(e){return void 0===this.handlers[e]&&(this.handlers[e]=[]),this.handlers[e]}}},9231:(e,t,r)=>{"use strict";function i(e){if(void 0===e)return Ya.q.DEFAULT;let t=function(e){switch(e){case Ga.DEFAULT_ERROR:return Ya.q.DEFAULT;case Ga.BROADCAST_AD_BLOCK_INIT_ERROR:case Ga.AD_TYPE_IS_NOT_RECOGNIZED:case Ga.AD_IS_ALREADY_PLAYING:case Ga.MULTIROLL_INIT_ERROR:case Ga.PLAY_AD_VIEWERS_ERROR:return Ya.q.ADS;case Ga.INVALID_METADATA:case Ga.NO_STREAMS:case Ga.INVALID_STREAM_URL:case Ga.NO_DRM_CONFIG:return Ya.q.CONFIG;case Ga.ON_TICK_ERROR:case Ga.SAGA_ERROR:case Ga.NO_HLS_JS_INSTANCE:case Ga.REACT_COMPONENT_DID_CATCH_ERROR_INFO:case Ga.RECOVER_TASK_ERROR:case Ga.PRELOAD_SOURCE_FAILED:case Ga.MEDIA_ERR_ABORTED:return Ya.q.EXCEPTION;case Ga.UNSUPPORTED_MEDIA_TYPE:case Ga.NATIVE_HLS_NOT_SUPPORTED_ERROR:case Ga.HLS_JS_NOT_SUPPORTED_ERROR:case Ga.MEDIA_ERR_SRC_NOT_SUPPORTED:case Ga.MEDIA_ERR_CUSTOM:case Ga.MEDIA_ERR_DECODE:case Ga.REPRESENTATION_CHANGE:return Ya.q.MEDIA;case Ga.SCRIPT_INIT_ERROR:case Ga.META_INFO_REQUEST_FAILED:case Ga.STRM_ABD_INVALID_RESPONSE:case Ga.MANIFEST_NOT_FOUND:return Ya.q.NETWORK_PLAYER;case Ga.MEDIA_ERR_NETWORK:return Ya.q.NETWORK_MEDIA;case Ga.MPD_WIDEVINE_CERT_LOAD_ERROR:case Ga.FAIRPLAY_CERT_LOAD_ERROR:case Ga.FAIRPLAY_CREATE_MEDIA_KEYS_ERROR:case Ga.FAIRPLAY_CREATE_KEY_SESSION_ERROR:case Ga.FAIRPLAY_SPC_LOAD_ERROR:case Ga.FAIRPLAY_CREATE_KEY_ERROR:case Ga.FAIRPLAY_INVALID_CONTENT_ID:case Ga.DRM_PROXY_ERROR:case Ga.DRM_PROXY_ERROR_NEED_COOKIE:case Ga.DRM_PROXY_ERROR_NEED_TEAM_LOGIN:case Ga.DRM_PROXY_ERROR_NEED_VIEW_PERMISSION:case Ga.DRM_PROXY_ERROR_SIGNATURE_EXPIRED:case Ga.MEDIA_ERR_ENCRYPTED:case Ga.FAIRPLAY_NOT_SUPPORTED:case Ga.NO_DRM:case Ga.DRM_INIT_ERROR:case Ga.DRM_NO_INIT_DATA:case Ga.DRM_CERT_LOAD_ERROR:case Ga.DRM_NO_SUPPORTED_KEY_SYSTEM:case Ga.DRM_FAILED_TO_CREATE_CDM:case Ga.DRM_FAILED_TO_SET_MEDIA_KEYS:case Ga.DRM_NO_LICENSE_SERVER:case Ga.DRM_FAILED_TO_CREATE_SESSION:case Ga.DRM_SESSION_ERROR:case Ga.DRM_FAILED_TO_GENERATE_REQUEST:case Ga.DRM_UNKNOWN_ERROR:return Ya.q.DRM;case Ga.REGIONAL_LIMITATION_MANIFEST:case Ga.REGIONAL_LIMITATION_LEVEL:case Ga.REGIONAL_LIMITATION_SEGMENT:return Ya.q.REGIONAL;case Ga.SIGNATURE_EXPIRED_MANIFEST:case Ga.SIGNATURE_EXPIRED_LEVEL:case Ga.SIGNATURE_EXPIRED_SEGMENT:return Ya.q.ACCESS;case Ga.BANNED_MANIFEST:case Ga.BANNED_LEVEL:case Ga.BANNED_SEGMENT:return Ya.q.BANNED;case Ga.NO_CODECS:return Ya.q.NO_CODECS;case Ga.NO_PLAYABLE_STREAMS:return Ya.q.CANNOT_PLAY;case Ga.NO_MSE:return Ya.q.UNSUPPORTED_ENV}return}(e);if(void 0!==t)return t;if(t=function(e){switch(e){case"VH_ACCESS_ERROR_OLD_BROWSER":case"VH_ACCESS_ERROR_UNSUPPORTED_BROWSER":return Ya.q.UNSUPPORTED_ENV;case"VH_ACCESS_DENIED":return Ya.q.ACCESS;case"VH_ACCESS_ERROR_INVALID_REGION":return Ya.q.REGIONAL;case"VH_ACCESS_ERROR_NO_LICENSE":return Ya.q.DRM;case"VH_ACCESS_ERROR_FUTURE_VOD_RELEASE":case"VH_ACCESS_ERROR_NOT_FOUND":case"VH_VIDEO_PROCESSING":case"VH_VIDEO_PROCESSING_FAILED":case"VH_ACCESS_ERROR_UNEXPECTED":return Ya.q.DEFAULT}return}(e),void 0!==t)return t;switch(e){case Ba.BUFFER_FULL_ERROR:case Ba.BUFFER_NUDGE_ON_STALL:case Ba.BUFFER_STALLED_ERROR:case Ba.FRAG_PARSING_ERROR:case Ba.BUFFER_SEEK_OVER_HOLE:case Ba.BUFFER_APPENDING_ERROR:case Ba.PIPELINE_ERROR_DECODE:case Ba.DECODER_ERROR_NOT_SUPPORTED:case Ba.BUFFER_APPEND_ERROR:case Ba.MEDIA_ELEMENT_ERROR_FORMAT_ERROR:case Ba.REMUX_ALLOC_ERROR:case Ba.BUFFER_ADD_CODEC_ERROR:case Ba.DEMUXER_ERROR_COULD_NOT_OPEN:case Ba.NS_ERROR_DOM_INVALID_STATE_ERR:case Ba.CHUNK_DEMUXER_ERROR_APPEND_FAILED:case Ba.FAILED_TO_INIT_DECODER:case Ba.PIPELINE_ERROR_INITIALIZATION_FAILED:case Ba.NS_ERROR_FAILURE:case Ba.REQUEST_FAILED:case Ba.PIPELINE_ERROR_EXTERNAL_RENDERER_FAILED:case Ba.PIPELINE_ERROR_COULD_NOT_RENDER:case Ba.NS_ERROR_DOM_MEDIA_METADATA_ERR:case Ba.MEDIA_ELEMENT_ERROR_EMPTY_SRC_ATTRIBUTE:case Ba.NS_ERROR_DOM_MEDIA_FATAL_ERR:case Ba.MANIFEST_PARSING_ERROR:return Ya.q.MEDIA;case Ba.FRAG_LOAD_ERROR:case Ba.MANIFEST_LOAD_ERROR:case Ba.LEVEL_LOAD_ERROR:case Ba.AUDIO_TRACK_LOAD_ERROR:return Ya.q.NETWORK_MEDIA;case Ba.FRAG_LOAD_TIME_OUT:case Ba.MANIFEST_LOAD_TIME_OUT:case Ba.LEVEL_LOAD_TIME_OUT:case Ba.AUDIO_TRACK_LOAD_TIME_OUT:return Ya.q.NETWORK_TIMEOUT;case Ba.INTERNAL_EXCEPTION:case Ba.ON_PLAYER_INIT_ERROR_INTERNAL:case Ba.EXTERNAL_POST_MESSENGER_SEND_MESSAGE_ERROR:case Ba.INTERNAL_POST_MESSENGER_SEND_MESSAGE_ERROR:case Ba.LOAD_SKIN_ERROR:case Ba.INSERT_INTO_WITH_SECURE_FRAME:case Ba.PLAY_AD_VIEWERS_WITH_SECURE_FRAME:case Ba.ERROR_SCREEN_LOAD_ERROR:case Ba.YASP_UNEXPECTED_METHOD_CALL:return Ya.q.EXCEPTION;case Ba.UNABLE_TO_LOAD_PLAYER_IFRAME:case Ba.ON_PLAYER_INIT_ERROR:case Ba.LOADER_INIT_ERROR:case Ba.UNABLE_TO_LOAD_PLAYER_INTERNAL_SCRIPT:case Ba.FAILED_TO_DOWNLOAD_DEBUG_INFO:case Ba.REQUEST_SOURCE_ERROR:return Ya.q.NETWORK_PLAYER;case Ba.PLAYER_CONTAINER_NOT_FOUND:case Ba.KEY_LOAD_ERROR:case Ba.FEATURE_HANDLER_ERROR:case Ba.INVALID_CONFIG_ELEMENT_IN_CREATE_PLAYER:case Ba.INVALID_CONFIG_LANG_IN_CREATE_PLAYER:case Ba.INVALID_CONFIG_IN_CREATE_PLAYER:case Ba.INVALID_CONFIG_IN_SET_SOURCE:case Ba.INVALID_CONFIG_IN_SOURCE_UPDATE:case Ba.IFRAME_DOES_NOT_ALLOW_DRM:case Ba.DRM_IS_NOT_ALLOWED:case Ba.ELEMENT_NOT_IN_DOM:case Ba.INVALID_LOG_URL:case Ba.SCREEN_WAKE_LOCK_ERROR:return Ya.q.CONFIG}return Ya.q.DEFAULT}function n(e,t){function r(){this.constructor=e}if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");$a(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}function s(e,t,r,i){return new(r=r||Promise)((function(n,s){function a(e){try{l(i.next(e))}catch(e){s(e)}}function o(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?n(e.value):((t=e.value)instanceof r?t:new r((function(e){e(t)}))).then(a,o)}l((i=i.apply(e,t||[])).next())}))}function a(e,t){function r(r){return function(o){return function(r){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,n&&(s=2&r[0]?n.return:r[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,r[1])).done)return s;switch(n=0,(r=s?[2&r[0],s.value]:r)[0]){case 0:case 1:s=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,n=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){a.label=r[1];break}if(6===r[0]&&a.label<s[1]){a.label=s[1],s=r;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(r);break}s[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(o){r=[6,o],n=0}finally{i=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,o])}}var i,n,s,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},o={next:r(0),throw:r(1),return:r(2)};return"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o}function o(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&i>=e.length?void 0:e)&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function l(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,n,s=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(i=s.next()).done;)a.push(i.value)}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return a}function d(e,t){for(var r=0,i=t.length,n=e.length;r<i;r++,n++)e[n]=t[r];return e}function u(e){return new $o({values:e,typeName:jo.ZodEnum})}function c(){return(c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function h(e){let t,r=Yl.Z,i=Yl.Z,n=Yl.Z,s=Yl.Z;e.once("Ready",e=>{t=e});const a=()=>{e.off("RequestPlayingState",r),e.off("PlayingStateChange",i),e.off("ContentImpression",n),e.off("AdPodStart",s)};e.on("StreamChange",()=>{let o;a();let l=!1,d=!1,u=Yl.Z,c=Yl.Z;const h=()=>{if(a(),l||!o||!o.engine)return;const{hasPreroll:e=!1,engine:r}=o,i=u(),n=c();(0,Hl.z)(i)&&(0,Wa.Y)(()=>t.logDelta(e?Kl[r]:Gl[r],i)),(0,Hl.z)(n)&&(0,Wa.Y)(()=>t.logDelta(e?Zl[r]:zl[r],n))};r=e=>{let{playingState:t}=e;if(t===Wl.X.PAUSE)return;u=(0,xa.u)(),l=!(0,Vl.s)(document,!0);const r=(0,Bl.Y)(document,e=>{e||(l=!0,r())});void 0!==o?h():d=!0},i=e=>{let{playingState:t}=e;t===Wl.X.BUFFERING?c=(0,xa.u)():t===Wl.X.PAUSE?c=()=>0:t===Wl.X.PLAY&&a()},n=t=>{e.off("AdPodStart",s),t&&t.engine&&(o=t,d&&h())},s=()=>{o={engine:"AD",hasPreroll:!0},e.off("ContentImpression",n),d&&h()},e.once("RequestPlayingState",r),e.on("PlayingStateChange",i),e.once("ContentImpression",n),e.once("AdPodStart",s)})}function p(e){const t=e.document;let r=t.getElementsByTagName("head")[0];return r||(r=t.createElement("head"),t.documentElement.appendChild(r)),r}function f(){return(f=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function m(e){const{dropCacheOnRetry:t=!1,onBeforeLoad:r=td,retries:i=0}=e;if(e.checkLoad&&e.checkLoad())return void(e.onLoad&&e.onLoad());let n=r,s=0;return t&&i>0&&(n=e=>{if(r(e),s>0){const t=-1===e.src.indexOf("?")?"?":"&",r=function(e){const t=1e9;let r=Math.floor(Math.random()*t)%t;return Number.isFinite(r)||(r=0),r+=Date.now()%t,String(e)+r.toString(36)}(s);e.src+=t+r}s++}),function e(t){const{src:r,win:i=window,charset:n="utf-8",async:s=!0,retries:a=0,onRetry:o=td,retryDelay:l=0,checkLoad:d=rd,onBeforeLoad:u=td,onLoad:c=td,onError:h=td}=t,m=i.document.createElement("script"),g=i=>{var n;a>0?(o(i),e(f({},t,{src:r,retries:a-1}))):h(i),null==(n=m.parentNode)||n.removeChild(m)};m.type="text/javascript",m.async=s,m.onload=()=>d(m)?c():g(new Error("checkLoad for "+r+" failed")),m.onerror=e=>{try{i.setTimeout(()=>{g(e)},l)}catch(t){}},m.src=r,m.charset=n,u(m),p(i).appendChild(m)}(f({},e,{onBeforeLoad:n}))}function g(){return(g=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function v(e){return new Promise((t,r)=>{m(g({},e,{onLoad:t,onError:r}))})}function y(){return(y=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function S(){return(S=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function E(e){return new Promise((t,r)=>{!function(e){const{win:t=window,src:r,retries:i=0,onLoad:n=ed.Z,onError:s=ed.Z}=e,a=new $l.s({id:"LOAD_SCRIPT_ERROR",message:"Failed to load script ["+r+"]",details:{src:r,isSelfWindow:t===window,onBeforeLoad:Boolean(e.onBeforeLoad),retries:i}});v(y({},e,{win:t})).then(n).catch(()=>s(a))}(S({},e,{onLoad:t,onError:r}))})}function b(){return(b=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function A(){return od||(!function(){try{ad=encodeURIComponent(JSON.stringify(b({},nd,sd)))}catch(e){}}(),od=!0),ad}function T(){try{return(ed.Z||window.Ya.Rum.setVars)({"-additional":JSON.stringify(nd)})}catch(e){}}function _(){try{return(ed.Z||window.Ya.Rum.updateErrors)({additional:b({},nd)})}catch(e){}}function w(e){return void 0===e||void 0===e.additional?A():encodeURIComponent(JSON.stringify(b({},nd,sd,e.additional)))}function k(e){nd=b({},{},e),T(),_(),od=!1}function R(e,t){nd=b({},{},{[e]:t}),T(),_(),od=!1}function P(){return ld}function C(e){id=(ed.Z||window.Ya.Rum.makeSubPage)(e?"Init":"SetSource"),dd++}function I(){return id}function O(){return dd}function D(){return(D=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function N(e,t){if(null==e)return{};var r,i,n={},s=Object.keys(e);for(i=0;i<s.length;i++)r=s[i],t.indexOf(r)>=0||(n[r]=e[r]);return n}function L(e){(0,Wa.Y)(()=>{(ed.Z||window.Ya.Rum.time)(e)})}function x(e,t){void 0===t&&(t={}),P()&&(0,Wa.Y)(()=>{const r=N(t,ud);(ed.Z||window.Ya.Rum.timeEnd)(e,D({},r,{"-additional":w(t)}))})}function M(e){let{win:t=window,src:r,checkLoad:i,onBeforeLoad:n=Yl.Z,onLoad:s=Yl.Z,withCredentials:a=!1}=e;Na["ll1.0-12103"]=Na["ll1.0-12103"]||{};const o=Na["ll1.0-12103"];return o[r]||(o[r]=E({checkLoad:i,win:t,src:r,retries:3,dropCacheOnRetry:!0,onBeforeLoad:e=>{a||(e.crossOrigin="anonymous"),n()}}).then(s),o[r].catch(()=>delete o[r])),o[r]}function F(){let e=!1;return M({src:Va,checkLoad:()=>"undefined"!==typeof Hls,onBeforeLoad:()=>{e=!0,L("lib.hlsjs")},onLoad:()=>{e&&x("lib.hlsjs")}})}function V(e,t,r){return(r?"https://yastatic.net/yandex-video-player-iframe-api-bundles-stable":"https://yastatic.net/yandex-video-player-iframe-api-bundles")+"/1.0-"+t+"/js/"+e}function B(e){let{modern:t,lang:r}=e;return V(function(e){let{modern:t,lang:r}=e;return"skin_"+r+(t?".modern":"")+".js"}({modern:t,lang:r}),12103,!1)}function U(e){const t=window;let r=!1;return e.player.once(Xl.Destroy,()=>r=!0),M({src:B({modern:e.modern,lang:Jl.f.i18nLang?Jl.f.i18nLang:"ru"}),checkLoad:()=>(0,Za.K)(t.Ya)&&(0,Za.K)(t.Ya.playerSkin)&&(0,Ql.m)(t.Ya.playerSkin.create)}).then(()=>{if(!r)return t.Ya.playerSkin.create(e)})}function j(){return(j=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function H(e,t){Na.timeAPIInit=(0,Fa.no)();const r=t(e),i=(0,jl.K)(r.getDebugConfig().logCalls);!function(e,t){if(void 0===t&&(t=!0),!(0,Vl.s)(document,!0))return;let r=!1;const i=(0,Bl.Y)(document,e=>{e||(r=!0,i())}),n=t?"loader":"create",s=0===Ul++,a=s?n+".player.firstready":n+".player.ready",o=s?n+".player.firststart":n+".player.start",l=(0,xa.u)();let d,u=!0;e.once("Ready",e=>{const t=l();d=e,(0,Wa.Y)(()=>{r||e.logDelta(a,t,{initSubpage:!0})})}),e.once("ResourcesIdle",()=>{u=!1}),e.once("ContentImpression",()=>{const e=l();!r&&u&&void 0!==d&&(0,Wa.Y)(()=>d.logDelta(o,e,{initSubpage:!0}))})}(i,!1),!0!==e.skipPlayRumLogger&&h(i);const{setReadyInstance:n,setInstance:s}=i,a=function(e,t){if(null==e)return{};var r,i,n={},s=Object.keys(e);for(i=0;i<s.length;i++)r=s[i],t.indexOf(r)>=0||(n[r]=e[r]);return n}(i,pd);s(r),r.once(Xl.Ready,n),r.once(Xl.SkinReady,()=>a.skin=r.skin);const{loadSkin:o=U}=e,l=o===U;r.on(Xl.RequestFullscreenStateChange,async e=>{l&&!r.skin&&r.once(Xl.SkinReady,()=>{r.emit(Xl.RequestFullscreenStateChange,e)})});const d=(0,La.I)(async()=>{if(!1===o)return;if(r.getReadyState()===hd.k.destroyed)return;const t=e.skinParams||{};try{if(l){const e=(0,xa.u)();r.once(Xl.SkinReady,t=>{let{error:i}=t;r.logSkinDelta(i?"skin.error":"skin.load",e(),{initSubpage:!0})})}r.skin=await o(j({},t,{container:r.getContainer(),player:a,modern:!0},l?{flags:e.flags}:{})),r.emit(Xl.SkinReady,{})}catch(i){r.logError(new Fl({code:Ba.LOAD_SKIN_ERROR,isFatal:!1,details:i})),r.setNativeControlsVisibility(!0),r.setNativeAdControlsVisibility(!0),r.emit(Xl.SkinReady,{error:i})}}),u=e=>{let{error:t}=e;t&&t.isFatal&&d()};r.once(Xl.ErrorChange,u);return Promise.all([new Promise(e=>r.once(Xl.Ready,e)),Promise.race([new Promise(e=>setTimeout(e,1e4)),new Promise(e=>r.once(Xl.ResourcesIdle,e))])]).then(()=>{r.off(Xl.ErrorChange,u),d()}),a}function W(e,t){const r=e.style;for(const i in t)if(t.hasOwnProperty(i)){r[Sd(i)]=t[i]}}function q(e){const{ownerDocument:t}=e;if(!t)return;const{defaultView:r}=t;return r||void 0}function Y(e,t){void 0===t&&(t=window);return("function"===typeof t.getComputedStyle?t.getComputedStyle(e,null):e.currentStyle)||{}}function G(e){const t=e.getRootNode;if((0,Ql.m)(t))return t.call(e);let r=e;for(;r.parentNode;)r=r.parentNode;return r}function K(e){return Boolean(e)&&"ShadowRoot"===(0,bd.M)(e)}function z(e){const t=e.ownerDocument&&e.ownerDocument.defaultView?e.ownerDocument.defaultView:window;let r=e;for(;r;){if(r&&t.document.body.contains(r))return!0;const e=G(r);if(!K(e)||!_d(e.host))return!1;r=e.host}return!1}function Z(e,t){e.firstChild?e.insertBefore(t,e.firstChild):e.appendChild(t)}function X(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];(0,Ed.k)(e)&&e.forEach(e=>{"function"===typeof e&&e(...r)})}function Q(e){if(!e)return;const{parentElement:t}=e;t&&t.removeChild(e)}function J(e){return function(e){return Boolean(e.PointerEvent)}(e)&&function(e){const t=e.navigator||{},{msMaxTouchPoints:r,maxTouchPoints:i}=t;return r||i||0}(e)>0&&!function(e){void 0===e&&(e=window);return Dd(e)>11}(e)}function $(e,t){if(!(0,Ql.m)(e.matchMedia))return!1;const r=e.matchMedia(t);return(0,Za.K)(r)&&Boolean(r.matches)}function ee(e){return void 0===e&&(e=window),J(e)||function(e){return $(e,Ld)}(e)||function(e){return $(e,xd)}(e)||function(e){const{DocumentTouch:t}=e;return Boolean(t)&&e.document instanceof t}(e)||function(e){return"ontouchstart"in e}(e)}function te(e){void 0===e&&(e=window);const t=e.navigator.userAgent.toLowerCase();return/ipad|iphone|ipod/.test(t)&&!e.MSStream&&!function(e){void 0===e&&(e=window);return e.navigator.userAgent.indexOf("UCBrowser")>-1}(e)}function re(e,t){if(void 0===t&&(t=!0),Vd&&t)return[];const r=[];let i=e;for(;;)try{if(i=i.ownerDocument.defaultView.frameElement,!i)return r;r.push(i)}catch(io){return r}}function ie(e,t){!function(e){return"function"===typeof e.dispatch}(e)?e(t):e.dispatch(t)}function ne(e,t){e.forEach(e=>{ie(e,t)})}function se(e,t){void 0===t&&(t=!1);const r=e.code;if(r===Ga.NO_CODECS&&Kd&&zd>6)return{title:"NO_CODECS_TITLE",message:"NO_CODECS_MESSAGE",helpLink:"https://yandex.ru/support/video-player/player-issues.html#no-codecs",helpLinkButtonText:"NO_CODECS_HELP_LINK_TITLE"};if(r===Ga.DRM_PROXY_ERROR_NEED_COOKIE)return{title:"NEED_COOKIE_TITLE",message:"NEED_COOKIE_MESSAGE",helpLink:e.helpLink||void 0,helpLinkButtonText:"NEED_COOKIE_HELP_LINK_TITLE"};if(r===Ga.DRM_PROXY_ERROR_NEED_TEAM_LOGIN)return{title:"NEED_TEAM_LOGIN_TITLE",message:"NEED_TEAM_LOGIN_MESSAGE",helpLink:e.helpLink||void 0,helpLinkButtonText:"NEED_TEAM_LOGIN_HELP_LINK_TITLE"};if(r===Ga.DRM_PROXY_ERROR_NEED_VIEW_PERMISSION)return{title:"NEED_VIEW_PERMISSION_TITLE",message:"NEED_VIEW_PERMISSION_MESSAGE",helpLink:e.helpLink||void 0,helpLinkButtonText:"NEED_VIEW_PERMISSION_HELP_LINK_TITLE"};const n=i(r);return t&&function(e){return[Ya.q.NETWORK_PLAYER,Ya.q.NETWORK_MEDIA,Ya.q.NETWORK_TIMEOUT,Ya.q.DRM,Ya.q.ADS].indexOf(e)>-1}(n)?{title:"ADBLOCK_DETECTED_TITLE",message:"ADBLOCK_DETECTED_MESSAGE",helpLink:"https://yandex.ru/support/video-player/blocker-settings.html",helpLinkButtonText:"ERROR_SCREEN_DEFAULT_HELP_LINK"}:function(e){return{title:Xd[e],message:Qd[e],helpLink:Zd[e],helpLinkButtonText:Jd[e]||"ERROR_SCREEN_DEFAULT_HELP_LINK"}}(n)}function ae(e){return(t=e.supportInfo).supported&&void 0!==t.engine;var t}function oe(e){return!(t=e.supportInfo).supported&&void 0!==t.noSupportReason;var t}function le(e){return void 0===e?[]:(e.testIds||"").split(",").map(e=>parseInt(e,10)).filter(Hl.z)}function de(e){const t=su(e);return t?()=>{su(e)!==t&&Ha()(e,t)}:Yl.Z}function ue(e){return void 0===e?void 0:Boolean(e)}function ce(e){return"number"===typeof e&&0<=e&&e<=1}function he(e){return function(e){if(0===e.length)return[];e=(()=>{const t=function(e,t){for(let r=e.length-1;r>=0;--r)if(e[r]===t)return r;return-1}(e,Tu.ALL);return-1!==t?[...Fu,...e.splice(t+1)]:e})();const t=new Map;return e.reverse().forEach(e=>{const r="!"===e[0],i=r?e.slice(1):e;t.has(i)||t.set(i,r)}),[...t.entries()].filter(e=>{let[t,r]=e;return!r}).map(e=>{let[t]=e;return t}).reverse()}(function(e){return void 0===e?[]:Array.isArray(e)?e.filter(Bu):String(e).split(",").map(e=>e.trim()).filter(Bu)}(e))}function pe(){return(pe=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function fe(e,t){var i,n;if(!e.servers)return e;const s={},{vsid:a,sourceIndex:o}=t,l=e=>(0,Yu.Sr)(e,{vsid:a,[Ku.g]:String(o)},{override:!0,saveOriginalPath:!0});(0,qu.J)(e.servers).forEach(e=>{let[t,i]=e;!function(e){{const{hostname:t}=(0,Yu.en)(e),{OTT_DRM_PROXY_HOSTNAMES:i}=r(8772);return-1!==i.indexOf(t)}}(i)?s[t]=i:s[t]=l(i)});const d=pe({},e);d.servers=s;const u=d;return null!=(i=u.advanced)&&null!=(n=i[Gu.ly])&&n.serverCertificateUrl&&(u.advanced=pe({},u.advanced,{[Gu.ly]:pe({},u.advanced[Gu.ly],{serverCertificateUrl:l(u.advanced[Gu.ly].serverCertificateUrl)})})),function(e){if(!(0,Za.K)(e))return!1;if(!(0,Za.K)(e.servers)||!("com.apple.fps.1_0"in e.servers))return!1;if(!(0,Za.K)(e.advanced)||!("com.apple.fps.1_0"in e.advanced))return!1;const t=e.advanced["com.apple.fps.1_0"];if(!(0,Za.K)(t))return!1;const{processSPCPath:r}=t;return(0,qa.H)(r)}(d)&&(d.advanced=pe({},d.advanced,{[Gu.h9]:pe({},d.advanced[Gu.h9],{processSPCPath:l(d.advanced[Gu.h9].processSPCPath)})})),d}function me(){return(me=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function ge(e){const t=e.filter(Hl.z).sort().join(",");return t.length>0?t:void 0}function ve(e){return ge(e.map(e=>parseInt(e,10)))}function ye(e){try{return JSON.stringify(e),!0}catch(io){return!1}}function Se(e,t){void 0===e&&(e={});const r={};return function(e,t){for(const r in t)(0,cc.n)(t,r)&&(e[r]=t[r])}(r,e),hc.forEach(e=>{"undefined"===typeof r[e]&&"undefined"!==typeof t[e]&&(r[e]=t[e])}),r}function Ee(e){let t=function(e){let{PI:t,min:r,max:i,cos:n,round:s}=Math,a=e[0]|e[1]<<8|e[2]<<16,o=e[3]|e[4]<<8,l=(63&a)/63,d=(a>>6&63)/31.5-1,u=(a>>12&63)/31.5-1,c=(a>>18&31)/31,h=a>>23,p=(o>>3&63)/63,f=(o>>9&63)/63,m=o>>15,g=i(3,m?h?5:7:7&o),v=i(3,m?7&o:h?5:7),y=h?(15&e[5])/15:1,S=(e[5]>>4)/15,E=h?6:5,b=0,A=(t,r,i)=>{let n=[];for(let s=0;s<r;s++)for(let a=s?0:1;a*r<t*(r-s);a++)n.push(((e[E+(b>>1)]>>((1&b++)<<2)&15)/7.5-1)*i);return n},T=A(g,v,c),_=A(3,3,1.25*p),w=A(3,3,1.25*f),k=h&&A(5,5,S),R=function(e){let t=e[3],r=128&e[2],i=128&e[4];return(i?r?5:7:7&t)/(i?7&t:r?5:7)}(e),P=s(R>1?32:32*R),C=s(R>1?32/R:32),I=new Uint8Array(P*C*4),O=[],D=[];for(let N=0,L=0;N<C;N++)for(let e=0;e<P;e++,L+=4){let s=l,a=d,o=u,c=y;for(let r=0,l=i(g,h?5:3);r<l;r++)O[r]=n(t/P*(e+.5)*r);for(let e=0,r=i(v,h?5:3);e<r;e++)D[e]=n(t/C*(N+.5)*e);for(let e=0,t=0;e<v;e++)for(let r=e?0:1,i=2*D[e];r*v<g*(v-e);r++,t++)s+=T[t]*O[r]*i;for(let e=0,t=0;e<3;e++)for(let r=e?0:1,i=2*D[e];r<3-e;r++,t++){let e=O[r]*i;a+=_[t]*e,o+=w[t]*e}if(h)for(let e=0,t=0;e<5;e++)for(let r=e?0:1,i=2*D[e];r<5-e;r++,t++)c+=k[t]*O[r]*i;let p=s-2/3*a,f=(3*s-p+o)/2,m=f-o;I[L]=i(0,255*r(1,f)),I[L+1]=i(0,255*r(1,m)),I[L+2]=i(0,255*r(1,p)),I[L+3]=i(0,255*r(1,c))}return{w:P,h:C,rgba:I}}(e);return function(e,t,r){let i=4*e+1,n=6+t*(5+i),s=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,0,0,e>>8,255&e,0,0,t>>8,255&t,8,6,0,0,0,0,0,0,0,n>>>24,n>>16&255,n>>8&255,255&n,73,68,65,84,120,1],a=[0,498536548,997073096,651767980,1994146192,1802195444,1303535960,1342533948,-306674912,-267414716,-690576408,-882789492,-1687895376,-2032938284,-1609899400,-1111625188],o=1,l=0;for(let d=0,u=0,c=i-1;d<t;d++,c+=i-1)for(s.push(d+1<t?0:1,255&i,i>>8,255&~i,i>>8^255,0),l=(l+o)%65521;u<c;u++){let e=255&r[u];s.push(e),o=(o+e)%65521,l=(l+o)%65521}s.push(l>>8,255&l,o>>8,255&o,0,0,0,0,0,0,0,0,73,69,78,68,174,66,96,130);for(let[d,u]of[[12,29],[37,41+n]]){let e=-1;for(let t=d;t<u;t++)e^=s[t],e=e>>>4^a[15&e],e=e>>>4^a[15&e];e=~e,s[u++]=e>>>24,s[u++]=e>>16&255,s[u++]=e>>8&255,s[u++]=255&e}return"data:image/png;base64,"+btoa(String.fromCharCode(...s))}(t.w,t.h,t.rgba)}function be(e){const t=atob(e);let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return Ee(r)}function Ae(){return(Ae=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function Te(){return(Te=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function _e(e,t,r){var i,n;const s=Te({},pc.parse(e),{sourceIndex:r}),{vsid:a,vpuid:o}=t;s.params.additionalParams.vsid=a,s.params.additionalParams=Te({},Wu,s.params.additionalParams,{vsid:a});const l=(0,hu.rg)(),{testIds:d,slots:u}=function(e){const{testIds:t,slots:r}=Ju.parse({testIds:null==e?void 0:e.testids,slots:null==e?void 0:e.slots});return{testIds:t,slots:r}}({slots:l.slots,testids:l.testids}),c=(0,fc.S)(s.params.additionalParams.slots,u),h=function(){const e={};for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];r.filter(Boolean).join(",").split(",").forEach(t=>{if(!/^\d+$/.test(t))return;const r=parseInt(t,10);e[r]=null});const n=Object.keys(e);return 0<n.length?n.join(","):void 0}(s.params.additionalParams.testIds,d);s.params.additionalParams=Te({},s.params.additionalParams,c?{slots:c}:{},h?{testIds:h}:{}),s.params.posterStyle=Te({objectFit:t.objectFit},s.params.posterStyle);const{adConfig:p}=s.params;return void 0!==p&&void 0===p.skinType&&(p.skinType=function(e){return void 0===e.loadSkin?"defaultInstream":void 0}(t)),s.params.feed=null==(i=t.streamPlayerParams)?void 0:i.feed,s.params.shouldEmitFrameRendered=null==(n=t.streamPlayerParams)?void 0:n.shouldEmitFrameRendered,s.streams=s.streams.map(e=>Te({},e,{drmConfig:e.drmConfig?fe(e.drmConfig,{vsid:a,sourceIndex:r}):void 0,url:(0,Yu.Sr)(e.url,{vsid:a,vpuid:o,[Ku.g]:String(r)},{override:!0,saveOriginalPath:!0})})),s}function we(e){if(!(0,Za.K)(e))return!1;const{utcStart:t,utcEnd:r}=e;return(void 0===t||(0,Hl.z)(t))&&(void 0===r||(0,Hl.z)(r))}function ke(e){return Array.isArray(e)?e.filter(e=>"string"===typeof e):[]}function Re(e){if(!(0,Za.K)(e))return{init:[],start:[],end:[],setSource:[],adStart:[],adRequest:[],adError:[],adEnd:[],adPodStart:[],adPodClick:[],adPodEnd:[],adPodSkip:[],sourceStart:[],play:[],pause:[],seek:[],firstQuartile:[],midpoint:[],thirdQuartile:[],viewed:[],heartbeat:[],watchedTime:[],error:[]};const{init:t,start:r,end:i,setSource:n,adRequest:s,adError:a,adStart:o,adEnd:l,adPodStart:d,adPodClick:u,adPodEnd:c,adPodSkip:h,sourceStart:p,play:f,pause:m,seek:g,firstQuartile:v,midpoint:y,thirdQuartile:S,viewed:E,heartbeat:b,watchedTime:A,error:T}=e;return{init:ke(t),start:ke(r),end:ke(i),setSource:ke(n),adRequest:ke(s),adError:ke(a),adStart:ke(o),adEnd:ke(l),adPodStart:ke(d),adPodClick:ke(u),adPodEnd:ke(c),adPodSkip:ke(h),sourceStart:ke(p),play:ke(f),pause:ke(m),seek:ke(g),firstQuartile:ke(v),midpoint:ke(y),thirdQuartile:ke(S),heartbeat:(k=b,Array.isArray(k)?k.filter(e=>{if(!Array.isArray(e)||2!==e.length)return!1;const[t,r]=e;if("string"!==typeof t||!we(r))return!1;const{offset:i,delay:n,callsCount:s}=r;return"number"===typeof n&&(void 0===i||(0,Hl.z)(i))&&(void 0===s||"number"===typeof s&&s>0)}):[]),viewed:(w=E,Array.isArray(w)?w.filter(e=>{if(Array.isArray(e)&&2===e.length){const[t,r]=e;if("string"!==typeof t)return!1;if(!(0,Za.K)(r))return!1;{const{percent:e}=r;if("number"!==typeof e)return!1}return!0}return!1}):[]),watchedTime:(_=A,Array.isArray(_)?_.filter(e=>{if(!Array.isArray(e)||2!==e.length)return!1;const[t,r]=e;if("string"!==typeof t||!(0,Za.K)(r))return!1;const{offset:i}=r;return we(r)&&"number"===typeof i}):[]),error:ke(T)};var _,w,k}function Pe(e){if(void 0===e||!(0,Za.K)(e))return mc;const{trackingEvents:t}=e;return{trackingEvents:(Array.isArray(t)?t:[t]).map(Re)}}function Ce(){return(Ce=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function Ie(e,t,r){return Ce({},function(e){return(0,Za.K)(e)?vc.parse(e):vc.parse({})}(e),{source:_e(e,t,r)})}function Oe(e){if(void 0===e)return;const t=e&&e.match&&e.match(Ec);if(t&&t[1])return parseInt(t[1],10);throw new Error("paramsObject.version must be a string like [1.0-0] or undefined")}function De(e,t){return void 0===t&&(t=window),(0,Su.O)(yu.Xy,e=>e&&parseInt(e,10),t)||Oe(e)}function Ne(e,t){return t?yc.PLAYER_API_MOCK:bc&&(e=>{0;try{const t=(0,qa.H)(e)?Oe(e):e;return"number"===typeof t&&t>=1410}catch(t){return!1}})(e||kc)?yc.PLAYER_API_MODERN:yc.PLAYER_API}function Le(e){void 0===e&&(e=window);const{userAgent:t=""}=e.navigator,r=/Android/.test(t),i=Rc(e),n=/com\.yandex\.mobile\.metrica\.ads\.sdk.*?Android/.test(t);return r&&!i||n}function xe(e,t){void 0===t&&(t={});const{silent:r=!0,allowRelative:i=!1}=t;return i||(0,Yu.sD)(e)?new Promise((t,i)=>{const n=document.createElement("img");n.onload=()=>t(e),n.onerror=r?()=>t(null):()=>i(new Error("knockPixel failed to load image ["+e+"]")),n.src=e}):r?Promise.resolve(null):Promise.reject("["+e+"] is not an absolute url, to knock this pixel use { allowRelative: true } option")}function Me(e,t,r){return e.replace(new RegExp("{{"+t+"}}","gm"),encodeURIComponent(r))}async function Fe(e){let{url:t,data:r,contentType:i}=e;if(((e,t)=>{if("function"!==typeof navigator.sendBeacon)return!1;try{return navigator.sendBeacon(e,t)}catch(r){return!1}})(t,i?new Blob([r],{type:i}):r))return;const n=new XMLHttpRequest;n.open("POST",t),n.withCredentials=!0,void 0!==i&&n.setRequestHeader("Content-Type",i),n.send(r)}function Ve(e){let[t,{offset:r,utcStart:i,utcEnd:n}]=e;return[t,{offset:r,utcStart:i,utcEnd:n,delay:1/0,callsCount:1}]}function Be(e,t){return e.map(e=>[e,{percent:t}])}function Ue(e){if("string"===typeof e)return"plain-url="+e;const[t,{utcStart:r="none",offset:i="none",delay:n="none"}]=e;return"url="+t+"|"+r+"/"+i+"/"+n}function je(e){return void 0===e?"":"inroll"===e?"midroll":"postPauseroll"===e?"pauseroll":e}function He(){return(He=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function We(e){const{location:t,referrer:r}=e;return{location:(0,Kc.b)(window),topLocation:t,referrer:window.document.referrer,topReferrer:r}}function qe(e){let t="",r="";if(e){(function(e){const t=re(e.documentElement).map(e=>e.ownerDocument);return t.unshift(e),t.map(e=>({location:(0,Kc.b)(e.defaultView),referrer:e.referrer}))})(e).reverse().forEach(e=>{let{location:i,referrer:n}=e;t=t||i,r=r||n})}return{location:t,referrer:r}}function Ye(e,t){return function(e,t){if(e.status===t.status)return 0;if(e.status===Yd.OFFLINE)return 1;return-1}(e,t)||function(e,t){return String.prototype.localeCompare.call(e.name,t.name)}(e,t)}function Ge(){return(Ge=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function Ke(e){let t=0;var r;return(0,Qc.W)(Ge({},e,{checkStatus:e=>(t=e,304===t||t>=200&&t<300),url:(r=e.url,r.replace(/<tld>/g,Xc))})).then(e=>e.responseText).catch(e=>{throw e.status=t,e})}function ze(e){return{name:e.name,bitrate:e.bitrate,lang:e.lang}}function Ze(e){return"undefined"===typeof e?null:{name:e.name,lang:e.lang}}function Xe(e){return{auto:e.auto,name:e.name,bitrate:e.bitrate,width:e.width,height:e.height}}function Qe(){return(Qe=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function Je(e){void 0===e&&(e={});const t={};for(const r in e){const i=e[r],n=typeof i;"string"!==n&&"number"!==n&&"boolean"!==n||(t[r]=i)}return t}function $e(){const{plugins:e}=window.navigator;return void 0===e||0===e.length?[]:Cd(e,Je)}function et(){const e=window.navigator||{},t=window.performance||{},{location:r,referrer:i}=qe(document);return{navigator:Qe({},Je(e),{connection:Je(e.connection),plugins:$e()}),performance:{memory:Je(t.memory)},playerLocation:location.href,iframeApiLocation:r,iframeApiReferrer:i}}function tt(e){let{videoType:t,currentTime:r,dvrStartTime:i,dvrDuration:n}=e;if(void 0===t||t===jc.Z.VOD)return ou;if(n===1/0||r>i+n-10)return sh;if(t!==jc.Z.LIVE)return ou;return i+(0===r?0:10)>r?nh:ou}function rt(e){return 0===String(e.code).indexOf("VH_")}function it(){return(it=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function nt(e,t){return Sh.some(r=>{if(!e[r.element])return!1;let i=t;for(;i;){if(e[r.element]===i)return!0;i=i.parentElement}return!1})}function st(e){const t=(0,Yu.en)(e).pathname;return 0===t.indexOf("/vod/")||0===t.indexOf("/live/")||0===t.indexOf("/kal/")}function at(e){if(e&&st(e))return(0,Yu.Sr)(e,{json_preview:"1",preview_version:"4"})}function ot(){return(ot=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function lt(){this.returnValue=!1}function dt(){this.cancelBubble=!0}function ut(e){return function(t){const r=function(e){return e.stopPropagation||(e.stopPropagation=dt),e.preventDefault||(e.preventDefault=lt),e.target||(e.target=e.srcElement),e}(t);e.call(this,r)}}function ct(e){e&&e.un()}function ht(e,t,r){return Math.max(Math.min(t,r)-Math.max(e,0),0)}function pt(e){const t=Mh(e),r=t.width,i=t.height;let n=0;if(r>0&&i>0){const e={width:window.innerWidth,height:window.innerHeight};n=ht(t.left,t.right,e.width)*ht(t.top,t.bottom,e.height)/(r*i)}return n}function ft(){return(ft=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function mt(){return(mt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function gt(e){let{playingState:t}=e;return t===Wl.X.BUFFERING||t===Wl.X.PLAY}function vt(e){let{playingState:t}=e;return t===Wl.X.PLAY}function yt(){return(yt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function St(e,t){void 0===t&&(t=window);const r=(0,Md.i)(t),i=new RegExp("\\b"+e+"/((?:\\d+)(?:\\.\\d+)*)\\b","i"),n=r.match(i);if(n)return n[1].split(".").map(e=>parseInt(e,10))}function Et(){const e=Zh<5;return zh(Qh,e=>{let[t,r]=e;const i=St(t);if(void 0===i)return!1;const[n]=i;return n<r})||e}function bt(){return Xh||Pc&&Et()}function At(e){void 0===e&&(e=window);const{document:t={}}=e;return Sh.filter(e=>{let{enabled:r}=e;return r in t})}function Tt(){return bt()||(window,!1)}function _t(){return!Tt()&&((Pc||Cc||Kh)&&!bt())}function wt(){return(wt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function kt(){return(kt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function Rt(e){const t=[...e],r=t.pop();if(!r||0===t.length)throw new Error("memoizeSingle need at least 2 functions as arg");return{preparers:t,resolver:r}}function Pt(e){return(0,qa.H)(e.className)?e.className:e.namespaceURI===pp&&e.getAttribute("class")||""}function Ct(e,t){(0,qa.H)(e.className)?e.className=t:e.namespaceURI===pp&&e.setAttributeNS("","class",t)}function It(e,t){void 0===t&&(t=""),0!==e.className.length?mp(e)?Sp(e,t):function(e,t){let r=Pt(e).split(" ").concat(t.split(" "));r=function(e){const t={};for(let r=0;r<e.length;r++)t[e[r]]=r;return(0,Au.Z)(t)}((0,dp.h)(r,(function(e){return""!==e}))),Ct(e,r.join(" "))}(e,t):e.className=t}function Ot(e,t){const r=document.createElement("style");r.textContent+=e,t?t.appendChild(r):p(window).appendChild(r)}function Dt(e){const t=e.createElement("div");return W(t,Rp),t}function Nt(){const e=document.createElement("div");W(e,{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"});const t=document.createElement("div");return e.appendChild(t),W(t,{color:"#fff",fontFamily:'"Helvetica Neue",Helvetica,Arial,sans-serif',fontSize:"16px",lineHeight:"19px",textShadow:"0 0 3px #000",textAlign:"center",margin:"0 10px 20px 10px"}),{wrapper:e,setText:e=>{t.textContent=e}}}function Lt(e){let{document:t,poster:r,firstFrameHash:i,firstFrameUrl:n,style:s,onReady:a,hiddenControls:o=[],primaryColor:l=Gh,backgroundColor:d}=e;const u=t.createElement("div");W(u,{width:"100%",height:"100%",display:"block",position:"relative",pointerEvents:"none",backgroundColor:d});const c=new lp({container:u,onReady:a,src:r,firstFrameUrl:n,firstFrameHash:i,style:s}),h=Dt(t);let p;-1===o.indexOf(Tu.ALL)&&-1===o.indexOf(Tu.PRELOADER)&&(p=function(e){let{document:t,primaryColor:r,isMobileSkin:i=!1}=e;kp();const n=t.createElement("div");It(n,Tp().locals.spinner),n.innerHTML=i?wp:_p;const s=n.getElementsByTagName("svg")[0];return It(s,Tp().locals.spinner__svg),i||s.setAttributeNS("","fill",r||Gh),n.appendChild(s),n}({document:t,primaryColor:l,isMobileSkin:_t()}),h.appendChild(p)),u.appendChild(h);const f=Nt();return u.appendChild(f.wrapper),{element:u,setPoster:(e,t,r)=>c.setPoster(e,t,r),setStyle:e=>c.setStyle(e),setSpinnerVisibility:e=>{p&&W(p,{display:e?"block":"none"})},setVisibility:e=>{W(u,{display:e?"block":"none"})},setAnnotationText:e=>{f.setText(e)},destroy:()=>{c.destroy(),Q(u)}}}function xt(){return(xt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function Mt(e){const t=()=>Op.forEach(e=>window.removeEventListener(e,r)),r=r=>{"pagehide"===r.type&&r.persisted||(e(r),t())};return Op.forEach(e=>window.addEventListener(e,r)),t}function Ft(e){if(e&&e.location){const{location:t}=e;return"function"===typeof t.toString?t.toString():t.href||""}return""}function Vt(e){return"function"===typeof e}function Bt(e){const t=typeof e;return Boolean(e)&&("object"===t||"function"===t)}function Ut(e){return!!(0,Za.K)(e)&&(!!(0,Za.K)(e.videoInfo)&&Boolean(e.enableRemoteProgressSaving&&e.videoInfo.videoContentId))}function jt(e){return void 0===e&&(e="/log"),"https://log.strm.yandex.ru"+e}function Ht(){return jt("/"+(0,$h.a)((e=jp,t=Hp,Math.floor(Math.floor(Math.random()*(t-e+1))+e))));var e,t}function Wt(e){return{reqid:null==e?void 0:e.reqid,from_block:null==e?void 0:e.from_block,frontend_vh_reqid:null==e?void 0:e.frontend_vh_reqid,recommender_reqid:null==e?void 0:e.recommender_reqid,stream_block:null==e?void 0:e.stream_block}}function qt(e,t){const r=function(e,t,r){return void 0===r&&(r=0),(0,qp.s)(e,e=>{let{start:i,end:n}=e;return i-r<=t&&t<=n+r})}(e,t);return void 0===r?void 0:r.end-t}function Yt(){if(void 0!==document.featurePolicy)try{return document.featurePolicy.allowedFeatures()}catch(e){return}}function Gt(){return(Gt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function Kt(e,t,r,i){void 0===i&&(i={}),(0,Wa.Y)(()=>{const{additional:n={}}=i,s=function(e,t){if(null==e)return{};var r,i,n={},s=Object.keys(e);for(i=0;i<s.length;i++)r=s[i],t.indexOf(r)>=0||(n[r]=e[r]);return n}(i,nf);(ed.Z||window.Ya.Rum.sendTimeMark)(e,t,r,Gt({},s,{"-additional":w(i)}))})}function zt(e,t,r){return e>r?r:e<t?t:e}function Zt(e){return 0===of.length&&(af=window.setInterval(()=>{of.forEach(e=>e())},250)),of.push(e),()=>{const t=of.indexOf(e);t>-1&&of.splice(t,1),0===of.length&&clearInterval(af)}}function Xt(){return(Xt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function Qt(e,t){return void 0===e&&(e=window),void 0===t&&(t=e.HTMLVideoElement&&e.HTMLVideoElement.prototype||{}),Sh.filter(e=>{let{enabled:r}=e;return r in t})}function Jt(e,t){const r=At(e);if(r.length>0)return r[0];const i=Qt(e,t);return i.length>0?i[0]:void 0}function $t(e,t){const r=Jt(e,t);if(!r)return null;let i=e.document[r.element];return t&&t[r.element]&&(i=t),i||null}function er(e){return!!e.includes(Tu.ALL)||_u.every(t=>t===Tu.ALL||e.includes(t))}function tr(e,t){return e.map(e=>({adViewer:e,additionalData:{},adType:t}))}function rr(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const i=t.map(ir),n="YA PLAYER: "+(new Date).toString()+" "+i.join(" ");return n}function ir(e){return e&&"object"===typeof e?JSON.stringify(e,Object.getOwnPropertyNames(e)):e}function nr(e){return e.reduce((e,t)=>e+t.getAdDuration(),0)}function sr(){return(sr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function ar(e){return Boolean(e&&e.adType===hf.inroll)}function or(e,t){const{ad:{originalBroadcastAdCues:r}}=e,i=r[t];if(i){const{start:e}=i;if(void 0===e)return;const{end:t=e+yf}=i;return{start:e,end:t}}}function lr(e){const{ad:{originalBroadcastAdCues:t,adInfo:r}}=e;return ar(r)?r.params.cueId:(0,Au.Z)(t).find(t=>function(e,t){const{controller:{currentTime:r,programDateTime:i}}=e;if(void 0===i)return!1;const n=i/1e3+r,s=or(e,t);if(!s)return!1;const{start:a,end:o}=s;return a<=n&&n<=o}(e,t))}function dr(e){const{controller:{currentTime:t,programDateTime:r}}=e;return void 0===r?r:r+1e3*t}function ur(e,t){return Math.max(e+1e4,t+5e3)}function cr(e){let{cue_id:t,pts:r,offset:i,cutoff:n}=e;const s=r+i;return{start:s,isEndReceived:void 0!==n,cueId:t,end:void 0!==n?r+n:ur(r,s),isValid:!0,invalidateReason:void 0}}function hr(){return(hr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function pr(){return(pr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function fr(e){void 0===e&&(e=window);try{return e.ya.videoAd.getBundleVersion()}catch(t){return"none"}}function mr(e){void 0===e&&(e=window);try{return e.ya.videoAd.getModuleVersion()}catch(t){return"none"}}function gr(e){return"string"===typeof e}function vr(e){return gr(e)&&e.length>0}function yr(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const i=Pf(t,Boolean);if(0!==i.length)return i.join(";")}function Sr(e){if(void 0!==e){if(!gr(e))throw new Error("testIdsString is not a string or undefined ["+e+"]");if(0!==e.length){for(const t of e.split(";")){const r=t.split(",");if(3!==r.length)throw new Error("testIdParts length error ["+e+"]");const[i,,n]=r;if(0===i.trim().length)throw new Error("testId length error ["+e+"]");if(0===n.trim().length)throw new Error("testId bucket length error ["+e+"]")}return e}}}function Er(e){if(!Boolean(null===e||void 0===e?void 0:e.toString))return!1;try{const t=e.toString();return/\[native code\]/.test(t)||/\/\* source code not available \*\//.test(t)}catch(t){return!1}}function br(e){return JSON.stringify(e,function(){const e=[],t=function(){const e="undefined"===typeof WeakMap?void 0:new WeakMap,t=[];return{set:(r,i)=>{if(void 0!==e)try{e.set(r,i)}catch(n){t.push({path:i,value:r})}else t.push({path:i,value:r})},get:r=>{const i=Lf(t,e=>e.value===r);return void 0!==e&&void 0===i?e.get(r):i?i.path:void 0}}}();return(r,i)=>{if(Vt(i))return gr(i.name)?i.name:"[Function]";if(Df(i))return{name:(n=i).name,message:n.message,stack:n.stack};var n;if(!Bt(i))return i;if((e=>{try{return"display"in function(e,t){return void 0===t&&(t=window),("function"===typeof t.getComputedStyle?t.getComputedStyle(e,null):e.currentStyle)||{}}(e)}catch(io){return!1}})(i))return function(e){if(e.id)return e.id;if(e.className)return e.className;return"HTML Element"}(i);const s=t.get(i);if(vr(s))return"[Circular "+s+"]";for(;e.length>0&&e[e.length-1].value[r]!==i;)e.pop();const a=(e.length>0?e[e.length-1].path:"")+(r?"/"+r:"~");return e.push({path:a,value:i}),t.set(i,a),i}}())}function Ar(){}function Tr(e){let t=function(){let r;return t=()=>r,r=e.apply(this,arguments),r};return function(){return t.apply(this,arguments)}}function _r(e,t){try{return e()}catch(io){"function"===typeof t&&t(io)}}function wr(e){const t=function(e,t){if(void 0===t&&(t=!0),Vd&&t)return[];{const t=[];let r=e;for(;;)try{if(r=r.ownerDocument.defaultView.frameElement,!r)return t;t.push(r)}catch(io){return t}}}(e.documentElement).map(e=>e.ownerDocument);return t.unshift(e),t.map(e=>({location:Ft(e.defaultView),referrer:e.referrer}))}function kr(e){let t="",r="";if(e){wr(e).reverse().forEach(e=>{let{location:i,referrer:n}=e;t=t||i,r=r||n})}return{location:t,referrer:r}}function Rr(e){let t=function(){let r;return t=()=>r,r=e.apply(this,arguments),r};return function(){return t.apply(this,arguments)}}function Pr(){}function Cr(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Ir(){return(Ir=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function Or(e){const{method:t,url:r,async:i=!0,data:n,responseType:s="text",onBeforeSend:a=Pr,onRetry:o=Pr,checkStatus:l=(e=>Wf===e),headers:d={},xhrConstructor:u=XMLHttpRequest,retries:c=0,timeout:h=0,withCredentials:p,onAbort:f,onSetup:m}=e;if(!u)return;const g=e.onSuccess?Rr(e.onSuccess):Pr,v=e.onError?Rr(e.onError):Pr;let y,S=!1,E=0,b=e=>{S=!0,b=Pr,y=e,A(new Error("Abort request")),"function"===typeof f&&f(e)};const A=t=>{T.onerror=null,T.onreadystatechange=null,E&&clearTimeout(E);if(E&&4!==T.readyState||S)try{T.abort()}catch(t){}if(!S)if(c>0){const r=o(t,T);if("boolean"!==typeof r||Boolean(r)||b(),S)return;Or(Ir({},e,{onSetup:e=>{let{abort:t}=e;b=e=>t(e),S&&t(y)},retries:c-1}))}else b=Pr,v(t,T)},T=new u;try{T.open(t,r,i)}catch(io){return void A(io)}if(T.responseType=s,T.withCredentials=Boolean(p),function(e,t,r){for(const i in e)Cr(e,i)&&t.call(r,e[i],i,e)}(d,(e,t)=>{try{T.setRequestHeader(t,e)}catch(io){}}),h>0&&isFinite(h)&&(E=window.setTimeout(()=>{A(new Error("Request timeout, "+r))},h)),T.onerror=A,T.onreadystatechange=()=>{if(4===T.readyState){const{status:e}=T;l(e)?(b=Pr,clearTimeout(E),g(T)):A(new Error("Invalid request status "+e+", "+r))}},("function"!==typeof m||(m({abort:e=>b(e)}),!S))&&(a(T,e),!S))try{T.send(n)}catch(io){A(io)}}function Dr(e){if(!e||!e.toString)return!1;const t=e.toString();return/\[native code\]/.test(t)||/\/\* source code not available \*\//.test(t)}function Nr(e,t){var r,i,n;return null!==(n=null!==(i=null!==(r=Kf(e,t))&&void 0!==r?r:function(e,t){const r=function(e){var t,r;const i=[e.document];let n=e.document;for(;n;)n=null===(r=null===(t=n.defaultView)||void 0===t?void 0:t.frameElement)||void 0===r?void 0:r.ownerDocument,n&&i.push(n);return i}(e);for(let i=0;i<r.length;i++){const e=new URLSearchParams(r[i].location.search).get(t);if(null!==e)return e}return}(e,t))&&void 0!==i?i:((e,t)=>{var r,i;for(const n of Dp(e)){const e=null===(i=null===(r=n.Ya)||void 0===r?void 0:r.hardcodedParams)||void 0===i?void 0:i[t];if(e)return String(e)}return})(e,t))&&void 0!==n?n:void 0}function Lr(e){return"function"===typeof e||"Function"===Of(e)}function xr(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Mr(){return(Mr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function Fr(e,t){var r,i,n;return null===(n=null===(i=null===(r=t.ya)||void 0===r?void 0:r.videoAd)||void 0===i?void 0:i.loadedModules)||void 0===n?void 0:n[e]}function Vr(){return(Vr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function Br(e){return mm||function(e){return""+vm+e+"/"}(e)}function Ur(e){return function(e){const{src:t,win:r,onBeforeLoad:i=Ar}=e,n=new Bf(new Error,{});let s=Ar;return{promise:new Promise((e,a)=>{const o=r.document.createElement("script");let l=!1;s=()=>{l=!0,function(e){if(!e)return;const{parentElement:t}=e;t&&t.removeChild(e)}(o)};o.type="text/javascript",o.async=!0,o.onload=()=>{l||e()},o.onerror=e=>{l||(a(new Bf(n,{message:"Failed to load script ["+t+"]",details:{src:t,isSelfWindow:r===window,event:e}})),s())},o.src=t,o.charset="utf-8",i(o),function(e){const t=e.document;let r=t.getElementsByTagName("head")[0];return r||(r=t.createElement("head"),t.documentElement.appendChild(r)),r}(r).appendChild(o)}),teardown:s}}(e)}function jr(e){let t="";for(let r=0;r<e;r++)t+=(16*sm()|0).toString(16);return t}function Hr(e,t,r){void 0===r&&(r=" ");const i=t-e.length;if(i>0){let t=r;for(;t.length<i;)t+=t;return(t.length>i?t.substr(0,i):t)+e}return e}function Wr(){return(Wr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function qr(e){const t=O();return wm.subpageIndex!==t?(wm.subpageIndex=t,wm.deltas={},!1):Boolean(wm.deltas[e])}function Yr(e){qr(e)||L(e)}function Gr(e,t){var r;(void 0===t&&(t={}),qr(e))||(x(e,t),r=e,wm.deltas[r]=!0)}function Kr(){return(Kr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}async function zr(e,t,r,i){var n;void 0===e&&(e=window);const s=e===window;s&&Yr("adsdk.multiroll.full");const a=(e=>{var t;0;const{win:r,config:{vasUaasConfig:i,activeTestIds:n,additionalCustomRootFields:s,vh_sid:a,withCredentials:o},moduleName:l,serviceName:d,serviceVersion:u,productTheme:c,pageId:h,impId:p}=e,f=null!==(t=null===s||void 0===s?void 0:s.vsid)&&void 0!==t?t:Tm,m=(e=>{let{serviceName:t,serviceVersion:r,vsid:i}=e;const n=new Gf({rnd:am,vsid:i,defaultProbability:Xf,serviceName:t,serviceVersion:r});return{event:e=>n.log(e),error:e=>n.error(e)}})({serviceName:d,serviceVersion:u,vsid:f}),g=Wr({},s),v=vr(a)?a:void 0;!vr(g.vh_sid)&&v&&(g.vh_sid=v);const y=_r(()=>Sr(null===g||void 0===g?void 0:g.testIds),e=>{m.error({error:new Bf({code:"LOAD_VAS_MODULE_INVALID_TEST_IDS",details:{message:e.message}})})});return(e=>{const t=new Hf;return{promise:new Promise((r,i)=>{e({resolve:r,reject:i,subscribeForTeardown:e=>{t.subscribe(e)}})}),teardown:()=>t.dispatch(void 0)}})(e=>{let{resolve:t,reject:s,subscribeForTeardown:a}=e,d=!1;a(()=>{d=!0,s(new Error("Teardown called"))}),(e=>{let{externalUaasConfig:t,loaderFunctionsStatsWrapper:r,withCredentials:i}=e;return new Promise((e,n)=>{var s,a;const o=cm(t);t?o.parseUaasConfigError?r.error({error:new Bf({code:"LOAD_VAS_MODULE_PARSE_EXTERNAL_UAAS_CONFIG_ERROR",details:{message:o.parseUaasConfigError.message,vasUaasConfig:t}})}):void 0===(null===(a=null===(s=o.parsedUaasConfig)||void 0===s?void 0:s.flags)||void 0===a?void 0:a.VAS_STABLE_VERSION)&&r.error({error:new Bf({code:"LOAD_VAS_MODULE_NO_VAS_STABLE_VERSION_IN_EXTERNAL_AB_FLAGS",details:{vasUaasConfig:t}})}):r.event({name:"LoadVasModule_NoUAAS",data:{}}),o.version?e({uaasConfig:o.parsedUaasConfig,rawUaasConfig:t,version:o.version}):Sm(i).then(t=>{var i,n,s;const a=cm(t);a.parseUaasConfigError?r.error({error:new Bf({code:"LOAD_VAS_MODULE_PARSE_LOADED_UAAS_CONFIG_ERROR",details:{message:a.parseUaasConfigError.message,vasUaasConfig:t}})}):void 0===(null===(n=null===(i=a.parsedUaasConfig)||void 0===i?void 0:i.flags)||void 0===n?void 0:n.VAS_STABLE_VERSION)&&r.error({error:new Bf({code:"LOAD_VAS_MODULE_NO_VAS_STABLE_VERSION_IN_LOADED_AB_FLAGS",details:{vasUaasConfig:t}})}),e({uaasConfig:a.parsedUaasConfig,rawUaasConfig:t,version:null!==(s=a.version)&&void 0!==s?s:String(t.stableVersion),stableVersion:t.stableVersion})}).catch(n)})})({externalUaasConfig:i,loaderFunctionsStatsWrapper:m,withCredentials:o}).then(e=>{let{uaasConfig:i,rawUaasConfig:o,version:u,stableVersion:v}=e;var S,E;if(d)return;if((e=>{if((e=>{const t=e.document;return"documentMode"in t&&"undefined"!==typeof t.documentMode})(e)||(e=>{const t=e.navigator.userAgent;if(t.indexOf("MSIE ")>0)return!0;if(t.indexOf("Trident/")>0)return!0;if(t.indexOf("Edge/")>0)return!0;return!1})(e))return!0;return!1})(r))return m.event({name:"LoadVasModule_brokeInIE11",probability:Xf,data:{bundleName:l}}),t(void 0);const b={AB_FLAGS_STORE:void 0,AB_FLAGS:null!==(S=null===i||void 0===i?void 0:i.flags)&&void 0!==S?S:{},ICOOKIE:null===i||void 0===i?void 0:i.iCookie,TEST_IDS:yr(y,null===i||void 0===i?void 0:i.testIds),VAS_UAAS_CONFIG:i,ActiveTestIds:n,AdditionalStatsRootFields:g,VSID:f,VAS_USER_SESSION_RANDOM:am,STATS_ROOT_PARAMS:{},loaderLoadedFromAnYandexRu:void 0,loaderLoadedFromYaRu:void 0,grWasSent:void 0,productTheme:c,pageId:h,impId:p},A=e=>{const{promise:t,teardown:i}=(e=>{let{moduleName:t,version:r,win:i,scriptSessionParams:n}=e;var s;const a=Fr(t,i);if(a)return{promise:Promise.resolve(a),teardown:Ar};const o=ym({version:r,bundleName:t,win:i,ecmaVersion:null!==(s=Zf.adsdkecmaver)&&void 0!==s?s:hm}),{promise:l,teardown:d}=Ur({src:o,win:i,onBeforeLoad:e=>{(e=>{e.crossOrigin="anonymous"})(e),((e,t)=>{e.__AD_SDK_SCRIPT_SESSION_PARAMETERS__=t})(e,n)}});return{promise:l.then(()=>Fr(t,i)),teardown:d}})({moduleName:l,scriptSessionParams:b,version:e,win:r});return a(i),t},T=e=>{m.event({name:"LoadVasModule_ModuleLoaded",probability:Xf,data:{bundleName:l}}),t(e)},_=null!==(E=Zf.adsdkver)&&void 0!==E?E:u;A(_).then(T).catch(e=>{if(_===String(v))throw e;return m.error({error:new Bf({code:"LOAD_VAS_MODULE_CANNOT_LOAD_MODULE_WITH_UAAS_VERSION",details:{vasUaasConfig:o}})}),v?A(String(v)).then(T):Sm().then(e=>String(e.stableVersion)).then(A).then(T)}).catch(s)}).catch(s)})})({serviceName:"player",serviceVersion:"1.0-12103",config:Kr({},t,{withCredentials:!i,additionalCustomRootFields:{vsid:r,contentPlayerVersion:"1.0-12103",testIds:null==(n=t.additionalParams)?void 0:n.slots}}),win:e,moduleName:"Multiroll"}).promise;return a.then(()=>{s&&Gr("adsdk.multiroll.full")}).catch(Yl.Z),a}function Zr(e){const{audioTrackValue:t,audioTracks:r}=e.controller;return r.find(e=>{let{value:r}=e;return r===t})}function Xr(e){const{textTrackValue:t,textTracks:r}=e.controller;return r.find(e=>{let{value:r}=e;return r===t})}function Qr(){return(Qr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function Jr(e){const{videoTrackValue:t,videoTracks:r,isAbrEnabled:i}=e.controller,n=r.find(e=>{let{value:r}=e;return r===t});if(n)return Qr({},n,{auto:i})}function $r(e){return void 0!==e.ad.adInfo}function ei(e){const{currentTime:t,bufferingRanges:r}=e.controller;return qt(r,t)}function ti(){return(ti=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function ri(){return(ri=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function ii(e,t){if(!e||!e.height||!e.width||!t)return"unknown";const r=t.getMaxCapAllowedVideoTrack();return r&&r.height&&r.width?r.width===e.width&&r.height===e.height?"same":r.width>e.width||r.height>e.height?"smaller":r.width<e.width||r.height<e.height?"larger":"unknown":"unknown"}function ni(){return(ni=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function si(e){const t=I();return ni({},t,{additional:ni({},(0,Za.K)(t)?t.additional:void 0,e)})}function ai(e){const t=0===tg,r=rg[e];return rg[e]=!0,P()&&t&&!r}function oi(){ai("sourceStart")&&Kt(Ym.autoplayFalse)}function li(e){let{reason:t="unknown"}=e,r=function(e,t){if(null==e)return{};var r,i,n={},s=Object.keys(e);for(i=0;i<s.length;i++)r=s[i],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,Gm);ai("sourceStart")&&Kt(Ym.firstStartAdSDKFailed,void 0,void 0,ni({reason:t},r))}function di(){tg++,rg.sourceStart=!1;const e=0===tg;e?Kt(Ym.firstLoadSource):ld=(0,Vl.s)(document);try{C(e);const r=I();t=(null==r?void 0:r.additional)||{},sd=t,od=!1}catch(io){}var t}function ui(e,t){if(!P()||rg.sourceStart)return;const r=0===tg;L(r&&t?Jm[e]:r?Qm[e]:t?eg[e]:$m[e])}function ci(e,t,r){const i=rg.sourceStart;if(rg.sourceStart=!0,!P()||i)return;if(0===tg){const i=r?Jm[e]:Qm[e];Kt(r?zm[e]:Km[e],void 0,!1,{additional:t}),x(i,{additional:t})}else x(r?eg[e]:$m[e],si(t))}function hi(e,t,r){ai("yaFirstFrameDecoded")&&(r&&"AD"!==e||Kt(Zm[e],void 0,!1,{additional:t}))}function pi(e,t,r){ai("yaFirstFrameShown")&&(r&&"AD"!==e||Kt(Xm[e],void 0,!1,{additional:t}))}function fi(){return(fi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function mi(e){const t=function(e){return e.filter(oe).map(e=>{let{supportInfo:t}=e;return t.noSupportReason})}(e),r={details:{streams:e},isFatal:!0};if(zh(t,e=>e===og.INVALID_STREAM_URL))return new Fl(fi({},r,{code:Ga.INVALID_STREAM_URL}));if(zh(t,e=>e===og.NO_SUPPORTED_DRM))return new Fl(fi({},r,{code:Ga.NO_DRM}));if(zh(t,e=>e===og.NO_CODECS))return new Fl(fi({},r,{code:Ga.NO_CODECS}));const i=zh(t,e=>e===og.NO_MSE);return new Fl(fi({},r,i?ag?{code:Ga.NO_PLAYABLE_STREAMS}:{code:Ga.NO_MSE}:{code:Ga.NO_PLAYABLE_STREAMS}))}function gi(e){if(void 0===e||!(0,Za.K)(e))return!1;const{servers:t,advanced:r}=e;return(0,Za.K)(t)&&(0,qa.H)(t["com.apple.fps.1_0"])&&(0,Za.K)(r)&&(0,Za.K)(r["com.apple.fps.1_0"])&&(0,qa.H)(r["com.apple.fps.1_0"].processSPCPath)}function vi(e){return e.preferNative||gg||Vd||gi(e.stream.drmConfig)?ql.NATIVE:ql.HLS}function yi(){const e={};return vg.forEach(t=>{yg.forEach(r=>{var i;e["video/"+t+"/"+r]=sg("video/"+t+'; codecs="'+r+'"'),e["mse-video/"+t+"/"+r]=null!=(i=null==cg?void 0:cg.isTypeSupported("video/"+t+'; codecs="'+r+'"'))&&i})}),Sg.forEach(t=>{Eg.forEach(r=>{var i;e["audio/"+t+"/"+r]=sg("audio/"+t+'; codecs="'+r+'"'),e["mse-audio/"+t+"/"+r]=null!=(i=null==cg?void 0:cg.isTypeSupported("audio/"+t+'; codecs="'+r+'"'))&&i})}),e["audio/plain/flac"]=sg("audio/flac"),e}function Si(){return(Si=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function Ei(){return(Ei=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function bi(e){if(!hg(e))return!1;const t=te(e);if(t&&qc(e))return!1;const r=function(e){return St("YaBrowser",e)}(e);if(void 0===r)return!1;const[i,n,s,a]=r;if(i<18)return!0;if(18===i){if(n>4)return!1;if(t&&s<3)return!0;if(Le(e)&&(s<1||!a||a<=526))return!0}return!1}async function Ai(){const e=[];return await Promise.all(Pg.map(async t=>{try{await window.navigator.requestMediaKeySystemAccess(t,Ig),e.push(t)}catch(r){}})),e}function Ti(){const e=[];return Pg.forEach(t=>{window.MSMediaKeys.isTypeSupported(t)&&e.push(t)}),e}function _i(e){let{video:t}=e;const r=[];return Pg.forEach(e=>{t.canPlayType("video/mp4",e)&&r.push(e)}),r}function wi(){const e=[];return[Gu.h9,Gu.oo].forEach(t=>{window.WebKitMediaKeys.isTypeSupported(t,"video/mp4")&&e.push(t)}),e}async function ki(e){void 0===Dg&&(Dg=async function(e){return Ic&&!(wg||_g||pg)?{supportedDrmSystems:[],detectionMethod:Og.YandexBrowserLinux}:bi()?{supportedDrmSystems:[],detectionMethod:Og.OldYandexBrowser}:window.WebKitMediaKeys?{supportedDrmSystems:wi(),detectionMethod:Og.WebKitMediaKeys}:"function"===typeof window.navigator.requestMediaKeySystemAccess?{supportedDrmSystems:await Ai(),detectionMethod:Og.requestMediaKeySystemAccess}:"function"===typeof window.MSMediaKeys?{supportedDrmSystems:Ti(),detectionMethod:Og.MSMediaKeys}:e.video.webkitGenerateKeyRequest?{supportedDrmSystems:_i(e),detectionMethod:Og.GenerateKeyRequest}:{supportedDrmSystems:[],detectionMethod:Og.NotAvailable}}(e));const t=await Dg;return Ei({},t,{supportedDrmSystems:[...t.supportedDrmSystems]})}async function Ri(e,t){const{servers:r={}}=e,i=(0,Au.Z)(r);if(0===i.length)return!1;const n=await xg({video:t});return zh(i,e=>-1!==up(n,e))}function Pi(){const e=Mg.canPlayType('video/mp4;codecs="avc1.4D481F"');return e?{supported:!0,engine:ql.MP4}:{supported:!1,debugInfo:{checkedCodec:'video/mp4;codecs="avc1.4D481F"',isCodecSupported:e,codecs:yi()},noSupportReason:og.NO_CODECS}}function Ci(e){var t;const r=void 0!==e.stream.drmConfig,i=(null==(t=e.stream.drmConfig)?void 0:t.servers)||{},n=Vg.some(e=>e in i);return!(r&&!n)&&dg(e.stream.url)}function Ii(){return(Ii=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}async function Oi(e){const{stream:t,video:i,preferNative:n}=e,{drmConfig:s,url:a}=t;if(!(e=>{{const{isStreamValid:t}=r(9034);return(0,Yu.sD)(e)&&t(e)}})(a))return{supported:!1,debugInfo:{cloud:!1},noSupportReason:og.INVALID_STREAM_URL};const o=dg(a),l=lg(a);if((e=>"mp4"===(0,Yu.lm)(e.toLocaleLowerCase()))(a))return Pi();if(!o&&!l)return{supported:!1,debugInfo:{},noSupportReason:og.NO_SUPPORTED_FORMAT};let d;if(d=o?Bg||(Bg=await mg().then(()=>Fg).catch(e=>({supported:!1,debugInfo:(0,Xa.V)(e)?{message:e.message,stack:e.stack}:{message:"Unknown error while get support info",errorString:String(e)},noSupportReason:og.NO_MSE}))):await async function(e){try{0,void 0===Tg&&(Tg=await mg());const t=Tg.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"');return t?ag?{supported:!0,engine:vi(e)}:gi(e.stream.drmConfig)?{supported:!1,debugInfo:{IS_HLS_NATIVE_SUPPORTED:ag},noSupportReason:og.NO_SUPPORTED_DRM}:Ag:ag?bg:{supported:!1,debugInfo:{checkedCodec:'video/mp4; codecs="avc1.42E01E,mp4a.40.2"',isCodecSupported:t,hasMse:!0,codecs:yi(),IS_HLS_NATIVE_SUPPORTED:ag},noSupportReason:og.NO_CODECS}}catch(t){return ag?bg:{supported:!1,debugInfo:Si({},(0,Xa.V)(t)?{message:t.message,stack:t.stack}:{message:"Unknown error while get support info",errorString:String(t)},{codecs:yi()}),noSupportReason:og.NO_MSE}}}({stream:t,preferNative:n}),!d.supported)return d;if(void 0===s||!(0,Za.K)(s))return Ci({stream:t})?Ii({},d,{engine:ql.YASP}):d;const u=await Ri(s,i);return u?Ci({stream:t})?Ii({},d,{engine:ql.YASP}):d:{supported:!1,debugInfo:{isStreamDRMSupported:u,previousSupportInfo:d},noSupportReason:og.NO_SUPPORTED_DRM}}function Di(e){const t=nu(e);if(0===t.length)return;const r=t.find(e=>{let{supportInfo:t}=e;return t.engine===ql.NATIVE}),i=function(e){var t;const r=e.filter(e=>e.supportInfo.engine===ql.YASP);if(0===r.length)return null;const i=r[0],n=null==(t=i.stream.drmConfig)?void 0:t.servers;if(!n||Hg.some(e=>e in n))return i;if(Gu.xE in n){return r.find(e=>Hg.some(t=>{var r,i;return null==(r=e.stream.drmConfig)||null==(i=r.servers)?void 0:i[t]}))||i}return i}(t),n=Ug.major>=15&&!(Kh&&(e=>{let t=!1;e&&(t=zh(jg.T,t=>e.startsWith("https://"+t+"/live/")||e.startsWith("https://"+t+"/kal/")));return t})(null==i?void 0:i.stream.url)),s=Wg.major>17||17===Wg.major&&Wg.minor>=1;if(Vd&&!n&&!s&&r)return r;if(i)return i;const a=t.find(e=>{let{supportInfo:t}=e;return t.engine!==ql.MP4});return a||t[0]}async function Ni(e){if(0===e.streams.length)return{status:"error",error:new Fl({code:Ga.NO_STREAMS,details:{},isFatal:!0}),streamsWithSupportInfo:[]};const t=await function(e){let{streams:t,video:r,preferNative:i}=e;return Promise.all(t.map(async e=>({stream:e,supportInfo:await Oi({stream:e,video:r,preferNative:i})})))}(e),r=Di(t);return r?{status:"success",supportedStream:r,streamsWithSupportInfo:t}:{status:"error",error:mi(t),streamsWithSupportInfo:t}}function Li(e){return jg.T.indexOf((0,Yu.en)(e).hostname)>-1}async function xi(e,t){const r=function(e){if(!Li(e))return;const{protocol:t,host:r}=(0,Yu.en)(e);return t+"//"+r+"/ping"}(e);return async function(e,t){try{return await(0,Qc.W)({url:e,withCredentials:t,method:"GET",checkStatus:e=>0!==e,retries:3}),!1}catch(io){return!0}}(r||(0,Yu.Ou)((0,qg.c)(e),"abd","1"),!(0,qa.H)(r)&&t)}function Mi(){return(Mi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function Fi(e){const{additionalParams:t=Wu}=e;if(!(0,Za.K)(e.adConfig))return;const{partnerId:r,adBreaks:i}=e.adConfig;return r||i?Mi({},e.adConfig,{additionalParams:t}):void 0}function Vi(e){if(void 0===e||isNaN(e))return"unknown";for(let t=0;t<Gg.length;t++)if(e<Gg[t].end)return Gg[t].name;return"unknown"}function Bi(e,t){return t&&"boolean"===typeof t.withCredentials?t.withCredentials:!!Li(e.url)||Fm.withCredentials}function Ui(e){if(void 0===e||isNaN(e))return"unknown";for(let t=0;t<Kg.length;t++)if(e<Kg[t].end)return Kg[t].name;return"unknown"}function ji(e){return e[0]}function Hi(e){return Array.isArray(e)}function Wi(e){const t=Qg.getItem("playerapi-numbers-session-storage-key"),r=(0,Wa.Y)(()=>JSON.parse(t||""));return function(e,t){const r=e.find(e=>!!Hi(e)&&ji(e)===t);return void 0===r?void 0:r[1]}(Array.isArray(r)?r:[],e)}function qi(e,t){const r=Qg.getItem("playerapi-numbers-session-storage-key"),i=(0,Wa.Y)(()=>JSON.parse(r||"")),n=Array.isArray(i)?i:[];Qg.setItem("playerapi-numbers-session-storage-key",JSON.stringify(function(e,t,r){const i=function(e,t){return[e,t]}(t,r),n=e.findIndex(e=>!!Hi(e)&&ji(e)===t);for(0===n?e[0]=i:(n>0&&e.splice(n,1),e.splice(0,0,i));10<e.length;)e.pop();return e}(n,e,t)))}function Yi(e,t){try{e.details||(e.details={}),e.details.stage=t}catch(r){}}function Gi(e,t){return hg(e)?function(e){void 0===e&&(e=window);const t=(0,Md.i)(e).match(/YaBrowser\/([\d.]+)/),r=t&&t[1]||"";return r?parseFloat(r):-1}(e)<18.6?"pip":"x-yandex-pip":"disablePictureInPicture"in t?"disablePictureInPicture":void 0}function Ki(e,t,r){const i=Gi(e,r);i&&(t?r.removeAttribute(i):r.setAttribute(i,"true"))}function zi(e,t){return e.responseStart-t.responseStart}function Zi(e){return e.responseStart-e.requestStart}function Xi(){if("undefined"===typeof window.performance)return NaN;const e=ev.reduce((e,t)=>(0,$g.Z)(e,function(e){try{return e.performance.getEntriesByType("resource").filter(e=>{let{name:t,transferSize:r,responseStart:i,requestStart:n}=e;return"string"===typeof t&&r>0&&i>0&&n>0})}catch(t){return[]}}(t),zi),[]).filter(e=>{let{name:t}=e;return tv.j.test(t)});return 0===e.length?NaN:e.reduce((e,t)=>(1.3*e+.7*Zi(t))/2,Zi(e[0]))}function Qi(){return"media-track-"+hv++}function Ji(e,t){if(void 0===t&&(t={bubbles:!1,cancelable:!1,detail:void 0}),"function"===typeof CustomEvent)return new CustomEvent(e,t);const r=document.createEvent("CustomEvent");return r.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),r}function $i(e,t){for(let r=0;r<e.length;r++)t.id!==e[r].id&&(e[r].enabled=!1)}function en(e){if(void 0!==e)for(;e.length>0;)e.removeTrack(e[0])}function tn(e,t){for(let r=0;r<e.length;r++)Object.keys(e[r]).length&&t.id!==e[r].id&&(e[r].selected=!1)}function rn(e){void 0===e&&(e=Tc.no);const t=e();return()=>Math.max(0,e()-t)}function nn(){return(nn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function sn(e){if("function"===typeof e.getVideoPlaybackQuality){const t=e.getVideoPlaybackQuality();return{droppedVideoFrames:t.droppedVideoFrames,corruptedVideoFrames:t.corruptedVideoFrames,totalVideoFrames:t.totalVideoFrames}}const t=e;return"number"===typeof t.webkitDroppedFrameCount&&"number"===typeof t.webkitDecodedFrameCount?nn({},wv,{droppedVideoFrames:t.webkitDroppedFrameCount,totalVideoFrames:t.webkitDecodedFrameCount}):wv}function an(e){return(e+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function on(e,t,i){var n={};n[i]=[];var s=t.toString(),a=s.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/)||s.match(/^\(\w+,\s*\w+,\s*(\w+)\)\s?\=\s?\>/);if(!a)return n;for(var o,l=a[1],d=new RegExp("(\\\\n|\\W)"+an(l)+"\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)","g");o=d.exec(s);)"dll-reference"!==o[3]&&n[i].push(o[3]);for(d=new RegExp("\\("+an(l)+'\\("(dll-reference\\s([\\.|\\-|\\+|\\w|/|@]+))"\\)\\)\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)',"g");o=d.exec(s);)e[o[2]]||(n[i].push(o[1]),e[o[2]]=r(o[1]).m),n[o[2]]=n[o[2]]||[],n[o[2]].push(o[4]);for(var u,c=Object.keys(n),h=0;h<c.length;h++)for(var p=0;p<n[c[h]].length;p++)u=n[c[h]][p],isNaN(1*u)||(n[c[h]][p]=1*n[c[h]][p]);return n}function ln(e){return Object.keys(e).reduce((t,r)=>t||e[r].length>0,!1)}function dn(e,t,r,i){let n=e[i].map(e=>'"'+e+'": '+t[i][e].toString()).join(","),s=jv.toString().split("ENTRY_MODULE");return s[0]+"{"+n+"}"+s[1]+'"'+r+'"'+s[2]}function un(e,t){t=t||{};var i={main:r.m},n=t.all?{main:Object.keys(i.main)}:function(e,t){for(var r={main:[t]},i={main:[]},n={main:{}};ln(r);)for(var s=Object.keys(r),a=0;a<s.length;a++){var o=s[a],l=r[o].pop();if(n[o]=n[o]||{},!n[o][l]&&e[o][l]){n[o][l]=!0,i[o]=i[o]||[],i[o].push(l);for(var d=on(e,e[o][l],o),u=Object.keys(d),c=0;c<u.length;c++)r[u[c]]=r[u[c]]||[],r[u[c]]=r[u[c]].concat(d[u[c]])}}return i}(i,e),s="";Object.keys(n).filter(e=>"main"!==e).forEach(e=>{for(var t=0;n[e][t];)t++;n[e].push(t),i[e][t]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",s=s+"var "+e+" = ("+dn(n,i,t,modules)+")();\n"}),s=s+"var a = ("+dn(n,i,e,"main")+");\ntry {\n    a();\n} catch(e) { console.warn(e); throw e }";var a=window.Blob;try{a=window.top.Blob}catch(io){}var o=new a([s],{type:"text/javascript"});if(t.bare)return o;var l=void 0;try{l=window.top.URL||window.top.webkitURL||window.top.mozURL||window.top.msURL}catch(io){}l=l||window.URL||window.webkitURL||window.mozURL||window.msURL;var d=window.Worker;try{d=window.top.Worker}catch(io){}var u=l.createObjectURL(o),c=new d(u);return c.objectURL=u,c}function cn(){return(cn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function hn(e){switch(e.source){case"default":case"default-slow":case"cache":case"timing-api":case"network-api":case"ewma":case"hlsjs":case"yabro":case"shaka-default":case"shaka-network-api":case"external-yasp":return e;default:return{value:e.value,source:"external-yasp"}}}function pn(e){if(isNaN(e.value))return;if(!ey.includes(e.source))return;const t={bandwidthEstimate:Math.floor(e.value),time:Jv(),source:e.source};Nu.t.setItem("videoplayer-bandwidth-estimate",JSON.stringify(t))}function fn(){try{const e=Nu.t.getItem("videoplayer-bandwidth-estimate");if(!e)return NaN;const{bandwidthEstimate:t,time:r,source:i}=JSON.parse(e);return ey.includes(i)&&Jv()-r<$v?t:NaN}catch(e){return NaN}}function mn(e,t){return(0,Tv.Hi)(e)===(0,Tv.Hi)(t)}function gn(){return(gn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function vn(e){var t;return(t=class t extends e{constructor(){super(...arguments),this.progressWatcher=void 0,this.gapController=void 0,this.eventsWatcher=void 0,this.playheadMover=void 0,this.srcSetDeferred=void 0,this.detachCallbacks=void 0,this.playCalled=void 0,this.shouldPlay=void 0,this.restorePrototype=void 0,this.yaspSrc=void 0,this.yaspError=null,this.error=null,this.audioTrackList=void 0,this.mediaStateNotifier=void 0,this.stallDetector=null,this.yaspSeekable=void 0,this.startTime=NaN}static isSupported(){var e;return"function"===typeof(null==(e=(0,ug.Q)())?void 0:e.isTypeSupported)}static isCurrentSrc(e,r){return!(null===r||!t.isYaspElement(e))&&mn(e.yaspSrc,r)}static getDefaultBandwidthEstimate(){const e=t.bandwidth;if(e)return hn(e);const r=fn();return r?{value:r,source:"cache"}:{value:Qv.S,source:"default"}}static attachElement(e,r,i){if(!t.isSupported())throw new Error("Unsupported platform");if(t.isYaspElement(r))return(0,Wp.L)(new Error("Unexpected YaspMediaElement.attach(yaspMediaElement) call")),r;t.setWorkerConfig(i);const n=de(r);Ha()(r,e.prototype);const s=r;s.restorePrototype=n,s.detachCallbacks=[],s.registerMediaRpcHandlers(),s.initAudioTrackList(),s.initPlayheadMover(),s.initWatchdog(),s.initEventsWatcher(),s.initNativeErrorHandling();const a=t.overrideYaspGetters(s);return s.detachCallbacks.push(a),t.instances.push(s),s}static warmUp(){(0,Yl.Z)(t.worker)}static async destroy(){var e;await Promise.all(t.instances.map(e=>e.detach())),null==(e=t.workerImpl)||e.destroy()}static hasActiveInstance(){return Boolean(t.instances.length)}checkShouldPlay(){return this.shouldPlay}static overrideYaspGetters(e){const r=t.initYaspSeekable(e),i=t.attachErrorStore(e),n=t.initYaspCurrentSrc(e);return()=>{r(),i(),n()}}static attachErrorStore(e){return Object.defineProperty(e,"error",{get(){const r=this;return void 0!==r.yaspError?r.yaspError:t.getNativeErrorAndAttachErrorStore(e)},configurable:!0}),()=>delete e.error}static getNativeErrorAndAttachErrorStore(e){delete e.error;const{error:r}=e;return t.attachErrorStore(e),r}static getNativeSeekableAndInitYaspSeekable(e){delete e.seekable;const{seekable:r}=e;return t.initYaspSeekable(e),r}static isYaspElement(e){return!0===e.yasp}get audioTracks(){var e;return this.yaspSrc?this.audioTrackList:null!=(e=super.audioTracks)?e:this.audioTrackList}canPlayType(e){return super.canPlayType(e)}rethrowEmptySrc(e){e||(0,Wp.L)(new Error("Setting empty src"))}getAttribute(e){return"src"===e&&void 0!==this.yaspSrc?this.yaspSrc:super.getAttribute(e)}setAttribute(e,t){return"src"===e?(this.rethrowEmptySrc(t),this.setSrc(t)):super.setAttribute(e,t)}removeAttribute(e){"src"===e&&this.setSrc(""),super.removeAttribute(e)}get src(){var e;return void 0===this.yaspSrc?null!=(e=HTMLMediaElement.prototype.getAttribute.call(this,"src"))?e:"":this.yaspSrc}set src(e){this.rethrowEmptySrc(e),this.setSrc(e)}addEventListener(e,t,r){super.addEventListener(e,t,r)}removeEventListener(e,t,r){super.removeEventListener(e,t,r)}get yasp(){return!0}getMediaElementDebugDump(){const{paused:e,seeking:r,yaspError:i,yaspSeekable:n,currentTime:s,yaspSrc:a,readyState:o}=this,l=Zv.getTimeRanges(t.getNativeSeekableAndInitYaspSeekable(this)),d=t.getNativeErrorAndAttachErrorStore(this),u=(0,Nv.w)(this);return{error:d,yaspError:i,paused:e,seeking:r,seekable:l,yaspSeekable:n,buffered:u,bufferedTime:qt(u,this.currentTime),currentTime:s,src:HTMLMediaElement.prototype.getAttribute.call(this,"src"),yaspSrc:a,readyState:o}}async yaspRequestDebugInfo(){var e;const r={mediaElement:gn({},this.getMediaElementDebugDump()),time:(0,Fa.no)()/1e3,mediaEventsHistory:null==(e=this.eventsWatcher)?void 0:e.getEventHistory()};return gn({},r,await t.worker.request({method:"requestDebugInfo",params:{source:this.yaspSrc}}))}async detach(){var e,r,i,n,s,a;void 0!==this.yaspSrc&&await t.worker.request({method:"detach",params:{source:this.yaspSrc}}),this.detachCallbacks&&(this.detachCallbacks.filter(Boolean).forEach(async e=>{try{await e()}catch(t){(0,Wp.L)(t)}}),this.detachCallbacks.length=0,delete this.detachCallbacks),null==(e=this.gapController)||e.release(),this.stallDetector=null,this.gapController=void 0,null==(r=this.progressWatcher)||r.release(),this.progressWatcher=void 0,null==(i=this.eventsWatcher)||i.release(),this.eventsWatcher=void 0,null==(n=this.playheadMover)||n.release(),this.playheadMover=void 0,this.restore(),this.removeEventListener("progress",this.onSegmentAppended),this.removeEventListener("seeking",this.onSeeking),this.removeEventListener("canplay",this.onCanPlay),this.removeEventListener("error",this.onNativeError),this.removeAttribute("src"),t.messenger.emit("yasp-event",{name:"YaspDetached",data:void 0}),null==(s=this.restorePrototype)||s.call(this),this.restorePrototype=void 0,t.instances=t.instances.filter(e=>e!==this),null==(a=this.mediaStateNotifier)||a.disable()}yaspDispatchEvent(e,t,r){const i=new CustomEvent(e,gn({detail:t},r));super.dispatchEvent(i)}static getStats(){return{bandwidth:t.bandwidth}}static configureSource(e,r){const i=r.defaultBandwidthEstimate?hn(r.defaultBandwidthEstimate):void 0;void 0!==i&&(t.shouldSaveBandwidth=!1),t.worker.sendEvent({method:"configureSource",params:{source:e,config:gn({},r,{defaultBandwidthEstimate:i})}})}static setWorkerConfig(e){void 0!==e&&(t.workerConfig.sourceLimit=e.sourceLimit,t.workerConfig.perfLogUrl=e.perfLogUrl)}static get worker(){if(void 0!==t.workerImpl)return t.workerImpl;const e=(0,ug.Q)(),r=!!e&&"canConstructInDedicatedWorker"in e&&Boolean(e.canConstructInDedicatedWorker),i=!(!(0,hu.RW)("web_yasp_enable_worker")||!r)&&Boolean(window.MediaSourceHandle);return t.workerImpl=new qv({useWebWorker:i,workerConfig:gn({},t.workerConfig,{flags:(0,hu.qm)()}),onTerminate:()=>{t.messenger.emit("yasp-event",{name:"YaspWorkerTerminate",data:void 0}),t.workerImpl=void 0}}),t.workerImpl.registerStaticRpcHandler("updateBandwidthEstimate",e=>(t.bandwidth=e.bandwidth,t.shouldSaveBandwidth&&pn(e.bandwidth),{done:!0,value:void 0})),t.workerImpl.registerStaticRpcHandler("updateBufferedInfo",e=>(t.messenger.emit("BufferedInfoChanged",e),{done:!0,value:void 0})),t.workerImpl.registerStaticRpcHandler("error",t.detachedErrorRpcHandler),t.workerImpl.registerStaticRpcHandler("event",t.detachedEventRpcHandler),t.workerImpl}handleError(e){e.isFatal?(this.yaspError=this.createMediaError(MediaError.MEDIA_ERR_NETWORK,e.message,e),this.yaspDispatchEvent("error",void 0)):("YASP_BUFFER_ALLOCATION_ERROR"===e.code&&(e.details.memory=self?Je((self.performance||{}).memory):{}),this.yaspDispatchEvent("yasp-error",e,{cancelable:!0}))}yaspSetAudioTrack(e){e&&t.configureSource(this.src,{tracks:{audioLang:e}})}initAudioTrackList(){if(void 0!==this.audioTrackList)return;const e=new yv;e.addEventListener("change",()=>{(0,Rd.w)(e).find(e=>{e.enabled&&t.configureSource(this.src,{tracks:{audioLang:e.language}})});const r=new Event("change");(0,Wa.Y)(()=>{super.audioTracks.dispatchEvent(r)})}),this.audioTrackList=e}updateObjectUrl(e){this.rethrowEmptySrc(e),"string"===typeof e?HTMLMediaElement.prototype.setAttribute.call(this,"src",e):this.srcObject=e}registerRpcHandlerForInstance(e,r){this.detachCallbacks.push(t.worker.registerRpcHandler(e,e=>t.isCurrentSrc(this,"source"in e?e.source:null)?r(e):{done:!1,value:void 0}))}registerMediaRpcHandlers(){this.registerRpcHandlerForInstance("setStartInfo",e=>{var t,r;return this.updateObjectUrl(e.objectUrl),this.setStartPosition(e.startPosition),this.readyState<HTMLMediaElement.HAVE_METADATA&&this.addEventListener("loadedmetadata",()=>{mn(this.yaspSrc,e.source)&&this.setStartPosition(e.startPosition)},{once:!0}),null==(t=this.mediaStateNotifier)||t.handleTimeupdate(),null==(r=this.srcSetDeferred)||r.resolve(),{done:!0,value:void 0}}),this.registerRpcHandlerForInstance("addAudioTrack",e=>{var t,r,i;return(null==(t=this.audioTrackList)?void 0:t.getTrackById(e.track.id))&&mn(this.yaspSrc,e.source)||null==(r=this.audioTrackList)||r.addTrack(new mv({enabled:e.track.selected,label:e.track.label,language:null!=(i=e.track.language)?i:void 0,id:e.track.id,kind:e.track.kind,bitrate:e.track.bitrate,channels:e.track.channels})),{done:!0,value:void 0}}),this.registerRpcHandlerForInstance("changeSelectedAudioLanguage",e=>{if(!this.audioTrackList)return{done:!0,value:void 0};for(let t=0;t<this.audioTrackList.length;t++)this.audioTrackList[t].enabled=this.audioTrackList[t].language===e.language;return{done:!0,value:void 0}}),this.registerRpcHandlerForInstance("applyDrmInfos",e=>(this.yaspDispatchEvent("yasp-drmInfoReceived",e.drmInfos,{cancelable:!0}),{done:!0,value:void 0})),this.registerRpcHandlerForInstance("emsg",e=>(this.yaspDispatchEvent("yasp-emsg",e.emsg,{cancelable:!0}),{done:!0,value:void 0})),this.registerRpcHandlerForInstance("logSegmentLoaded",e=>{const t="[SegmentLoader] loaded type = "+e.info.type+", number = "+e.info.number+", cmaf = "+e.info.cmaf;return this.yaspDispatchEvent("yasp-debug",t,{cancelable:!0}),{done:!0,value:void 0}}),this.registerRpcHandlerForInstance("updateUtcStartTime",e=>(this.startTime=e.time,{done:!0,value:void 0})),this.registerRpcHandlerForInstance("updateSeekableRange",e=>(this.yaspSeekable={start:e.start,end:e.end},{done:!0,value:void 0})),this.registerRpcHandlerForInstance("urlObjectUpdated",e=>{const t=this.currentTime;return this.updateObjectUrl(e.objectUrl),this.currentTime=t,{done:!0,value:void 0}}),this.registerRpcHandlerForInstance("flushMediaPipeline",e=>(0===this.buffered.length&&(this.currentTime-=.001),{done:!0,value:void 0})),this.registerRpcHandlerForInstance("event",e=>(this.yaspDispatchEvent("yasp-event",e,{cancelable:!0}),{done:!0,value:void 0})),this.registerRpcHandlerForInstance("error",e=>{let{error:r,source:i}=e;const n=t.parseErrorString(r);return this.handleError(n),{done:!0,value:void 0}})}setStartPosition(e){var t;e<=0||null===this.clampPosition(e)&&((0,hu.RW)("yasp_no_source_abort_on_fake_seek")&&this.currentTime===e||null==(t=this.playheadMover)||t.moveTo(e))}forceTimeUpdate(){var e;null==(e=this.mediaStateNotifier)||e.handleTimeupdate()}clearTrackLists(){en(this.audioTrackList)}createMediaError(e,t,r){let i=r;if(this.error)try{const e="string"===typeof(null==r?void 0:r.details)?gn({},JSON.parse(r.details),{mediaTagError:this.error}):gn({},r.details,{mediaTagError:this.error});i=new Xv.w(gn({},r,{details:e}))}catch(n){}return{code:e,message:t,yaspError:i}}static parseErrorString(e){try{return new Xv.w(JSON.parse(e))}catch(t){return new Xv.w({code:"YASP_PARSE_ERROR_EXCEPTION",details:{error:t,errorString:e},message:"Expect error to be serialized error.",isFatal:!0,category:Ya.q.EXCEPTION})}}initNativeErrorHandling(){this.addEventListener("error",this.onNativeError)}onNativeError(){if(!this.yaspSrc)return;t.getNativeErrorAndAttachErrorStore(this)&&t.worker.sendEvent({method:"destroy",params:{source:this.yaspSrc,reason:"Error"}})}initEventsWatcher(){this.eventsWatcher=new cy(this,()=>this.getMediaElementDebugDump())}initPlayheadMover(){this.playheadMover=new ay(this,3)}initWatchdog(){this.initStallDetector(),this.gapController||(this.gapController=new Kv(this,{getSeekRangeEnd:()=>this.seekable.end(0)},{jumpLargeGaps:!0,jumpOnPause:!0,largeGapLimit:Pm},this.stallDetector,e=>{var t;null==(t=this.eventsWatcher)||t.pushCustomEvent({event:"YaspLargeGap",timestamp:Date.now(),dump:e}),this.yaspDispatchEvent("yasp-event",{name:"YaspLargeGap",data:e},{cancelable:!0})}),this.addEventListener("seeking",this.onSeeking),this.addEventListener("canplay",this.onCanPlay),this.addEventListener("progress",this.onSegmentAppended),this.progressWatcher=new sy(this))}onCanPlay(){var e;null==(e=this.gapController)||e.configure({jumpOnPause:!1}),this.shouldPlay&&(0,Pd.v)(this.play())}onSegmentAppended(){var e;null==(e=this.gapController)||e.onSegmentAppended()}clampPosition(e){if(!this.seekable.length)return null;const t=this.seekable.end(this.seekable.length-1),r=this.seekable.start(0);return e<=t||t-r<=ny.C?null:(this.currentTime=t-ny.C,this.currentTime)}onSeeking(){var e;if(null!==this.clampPosition(this.currentTime))return;null==(e=this.gapController)||e.configure({jumpOnPause:!0});if(!Zv.isBuffered(this.buffered,this.currentTime,.5)&&this.yaspSrc){var r,i;if((0,hu.RW)("yasp_no_source_abort_on_fake_seek"))null==(r=this.gapController)||r.lock(),null==(i=this.gapController)||i.onSeeking();t.worker.request({method:"seeking",params:{source:this.yaspSrc,currentTime:this.currentTime}}).then(async()=>{var e,t,r;(0,hu.RW)("yasp_no_source_abort_on_fake_seek")?null==(e=this.gapController)||e.unlock():null==(t=this.gapController)||t.onSeeking();Vd&&Promise.resolve().then(null==(r=this.mediaStateNotifier)?void 0:r.handleTimeupdate)}).catch(()=>{var e;(0,hu.RW)("yasp_no_source_abort_on_fake_seek")&&(null==(e=this.gapController)||e.unlock())})}else{var n;null==(n=this.gapController)||n.onSeeking()}}updateShouldPlayState(e){this.shouldPlay=e}async play(){var e;(this.playCalled=!0,this.updateShouldPlayState(!0),this.yaspSrc&&"none"===this.preload&&t.worker.sendEvent({method:"load",params:{source:this.yaspSrc}}),HTMLMediaElement.prototype.getAttribute.call(this,"src")||this.srcObject)||await(null==(e=this.srcSetDeferred)?void 0:e.promise);if(this.playCalled)return this.playCalled=!1,this.handleLivePresentationWindowDropout(),super.play()}pause(){this.playCalled=!1,this.updateShouldPlayState(!1),super.pause()}isSupportedSrc(e){return dg(e)}setSrc(e){var r,i,n;this.yaspSrc&&(t.worker.sendEvent({method:"detach",params:{source:this.yaspSrc}}),this.yaspSrc=void 0,this.srcObject=null,this.srcSetDeferred=void 0,null==(r=this.mediaStateNotifier)||r.disable(),this.clearTrackLists(),this.restore());if(this.srcSetDeferred=new Zc.B,this.isSupportedSrc(e))return this.yaspSrc=e,t.worker.sendEvent({method:"attach",params:{source:e}}),null==(i=this.mediaStateNotifier)||i.enable(),null==(n=this.gapController)||n.configure({jumpOnPause:!0}),"none"!==this.preload&&t.worker.sendEvent({method:"load",params:{source:e}}),void(t.shouldSaveBandwidth&&t.worker.sendEvent({method:"configureSource",params:{source:e,config:{defaultBandwidthEstimate:t.getDefaultBandwidthEstimate()}}}));e?HTMLMediaElement.prototype.setAttribute.call(this,"src",e):HTMLMediaElement.prototype.removeAttribute.call(this,"src")}initStallDetector(){if(this.stallDetector)return;this.stallDetector=new iy(this,()=>{var e;null==(e=this.eventsWatcher)||e.pushCustomEvent({event:"YaspNudgeStalled",timestamp:Date.now(),dump:this.getMediaElementDebugDump()}),this.yaspDispatchEvent("yasp-event",{name:"YaspNudgeStalled",data:void 0},{cancelable:!0})})}static initYaspCurrentSrc(e){return Object.defineProperty(e,"currentSrc",{get(){return this.src},configurable:!0}),()=>delete e.currentSrc}static initYaspSeekable(e){return Object.defineProperty(e,"seekable",{get(){return this.yaspSeekable?{start:e=>{if(e>this.length-1)throw new Error("Failed to execute 'start' on 'TimeRanges': The index provided ("+e+") is greater than the maximum bound ("+(this.length-1)+")");return this.yaspSeekable.start},end:e=>{if(e>this.length-1)throw new Error("Failed to execute 'end' on 'TimeRanges': The index provided ("+e+") is greater than the maximum bound ("+(this.length-1)+")");return this.yaspSeekable.end},length:1}:t.getNativeSeekableAndInitYaspSeekable(this)},configurable:!0}),()=>delete e.seekable}restore(){this.startTime=NaN,this.yaspSeekable=void 0}handleLivePresentationWindowDropout(){this.duration===1/0&&this.seekable.length&&this.currentTime<this.seekable.start(0)&&(this.currentTime=this.seekable.end(this.seekable.length-1))}getStartDate(){return this.yaspSrc||"function"!==typeof super.getStartDate?new Date(this.startTime):new Date(super.getStartDate())}static getExpConfig(){const{flags:e,testids:t,slots:r}=(0,hu.rg)()||{};return{flags:(0,Za.K)(e)?JSON.parse(JSON.stringify(e)):{},testids:(0,qa.H)(t)?t.split(",").map(Number).filter(Boolean):[],slots:(0,qa.H)(r)?r:""}}}).instances=[],t.shouldSaveBandwidth=!0,t.bandwidth=void 0,t.workerImpl=void 0,t.messenger=new Bc.v,t.workerConfig={},t.detachedErrorRpcHandler=e=>{let{error:r}=e;const i=t.parseErrorString(r),n=new Xv.w(gn({},i,{message:"Detached mediaElement error: "+i.message}));return t.messenger.emit("yasp-error",n),{done:!0,value:void 0}},t.detachedEventRpcHandler=e=>{let{name:r,data:i,shouldLogWhenDetached:n}=e;return n&&t.messenger.emit("yasp-event",{name:r,data:i}),{done:!0,value:void 0}},t}function yn(){return(yn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function Sn(e,t){if(void 0===t)return e;return void 0!==function(e){const t=(0,Yu.pp)(e,"t");return void 0===t?t:Number(t)}(e)?(0,Yu.Yc)(e,"t",t):(0,Yu.zP)(e,"t",String(t))}function En(e,t){const r={audio_mbr:"1",mburl:"1",drm_packager:"1"};return(e.startsWith("https://strm.yandex.ru/live/")||e.startsWith("https://streaming.tst.strm.yandex.net/live/"))&&(r.packager="1",r.lowlatency="1"),(0,Yu.Sr)(Sn(e,t),r,{saveOriginalPath:!0})}function bn(){return(bn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function An(e){let{engine:t,source:r,getState:i,getCapSizes:n,getVideoElementSizes:s,defaultQuality:a}=e;switch(t){case ql.YASP:return new fy({source:r,getState:i,getCapSizes:n,getVideoElementSizes:s,defaultQuality:a});default:return}}function Tn(e){const{error:t}=e;return new gy(t)}function _n(e){if(e.type===Hls.ErrorTypes.NETWORK_ERROR)return e.networkDetails?e.networkDetails.status:void 0}function wn(e){if(e.type===Hls.ErrorTypes.NETWORK_ERROR)return e.networkDetails?e.networkDetails.readyState:void 0}function kn(e){if(void 0===e)return;const{level:t,start:r,duration:i,url:n,relurl:s,sn:a,programDateTime:o,deltaPTS:l,dropped:d,endDTS:u,endPTS:c,startDTS:h,startPTS:p}=e;return{level:t,start:r,duration:i,url:n,relurl:s,sn:a,programDateTime:o,deltaPTS:l,dropped:d,endDTS:u,endPTS:c,startDTS:h,startPTS:p}}function Rn(){return(Rn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function Pn(e){try{return JSON.parse((0,ih.Y)(Rn({},e,{networkDetails:void 0,frag:kn(e.frag)})))}catch(io){return{message:(0,Wa.Y)(()=>io.message)||"Cannot serialize hlsJsError"}}}function Cn(){return(Cn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function In(e){let{details:t,networkDetails:r}=e;const i=r?r.status:NaN,n=t===Hls.ErrorDetails.MANIFEST_LOAD_ERROR,s=t===Hls.ErrorDetails.LEVEL_LOAD_ERROR;return 451===i?n?Ga.REGIONAL_LIMITATION_MANIFEST:s?Ga.REGIONAL_LIMITATION_LEVEL:Ga.REGIONAL_LIMITATION_SEGMENT:_y.includes(i)?n?Ga.SIGNATURE_EXPIRED_MANIFEST:s?Ga.SIGNATURE_EXPIRED_LEVEL:Ga.SIGNATURE_EXPIRED_SEGMENT:454===i?n?Ga.BANNED_MANIFEST:s?Ga.BANNED_LEVEL:Ga.BANNED_SEGMENT:void 0}function On(e){const{details:t,fatal:r}=e;return t?Hls.ErrorDetails.FRAG_DECRYPT_ERROR!==t&&Hls.ErrorDetails.FRAG_PARSING_ERROR!==t&&Hls.ErrorDetails.BUFFER_STALLED_ERROR!==t&&Hls.ErrorDetails.BUFFER_NUDGE_ON_STALL!==t&&(void 0!==In(e)||Boolean(r)):Boolean(r)}function Dn(e,t){return void 0===e.err||void 0===e.err.message?"MISSED_STACK__"+t:e.err.message}function Nn(e){if(void 0===e)return;const{details:t}=e;if(t===Hls.ErrorDetails.BUFFER_STALLED_ERROR)return;const r=On(e)&&!Ln(e),i=In(e)||t||Ga.DEFAULT_ERROR,{err:{stack:n=new Error(Dn(e,i)).stack}={stack:void 0}}=e;return new Fl({code:i,isFatal:r,details:Cn({},Pn(e),{networkErrorStatus:_n(e),xhrReadyState:wn(e)}),stack:n})}function Ln(e){if(void 0!==In(e))return!1;const{details:t}=e;return!!t&&(Hls.ErrorDetails.FRAG_LOAD_ERROR===t||Hls.ErrorDetails.FRAG_LOAD_TIMEOUT===t||Hls.ErrorDetails.FRAG_PARSING_ERROR===t||Hls.ErrorDetails.BUFFER_APPEND_ERROR===t||Hls.ErrorDetails.INTERNAL_EXCEPTION===t||Hls.ErrorDetails.LEVEL_LOAD_TIMEOUT===t||Hls.ErrorDetails.MANIFEST_LOAD_ERROR===t||Hls.ErrorDetails.MANIFEST_LOAD_TIMEOUT===t)}function xn(e){const{details:t}=e;return!!t&&(Hls.ErrorDetails.MANIFEST_LOAD_ERROR===t||Hls.ErrorDetails.MANIFEST_LOAD_TIMEOUT===t)}function Mn(e,t){if(0===Object.keys(e).length)return;const{uri:r,duration:i,resolution:n,tiles:s}=e;if([r,i,n,s].some(e=>!e))return void(t&&t("NonValidHLSThumbnailTileSessionData"));const a=function(e){const t=e.split("x");if(t.length<2)return;const r={rows:parseInt(t[0],10),columns:parseInt(t[1],10)};return isNaN(r.rows)||isNaN(r.columns)?void 0:r}(s),o=function(e){if(""===e)return;const[t,r]=e.split("x"),i={width:parseInt(t,10),height:parseInt(r,10)};return isNaN(i.width)||isNaN(i.height)?void 0:i}(n),l=parseFloat(i);if(void 0===a||void 0===o||isNaN(l))return void(t&&t("MapTileSessionDataParseError"));return{tiles:a,uriTemplate:r,spriteDuration:l,resolution:o,tileSize:function(e,t){const{rows:r,columns:i}=e;if(!r||!i)return null;const{width:n,height:s}=t;return{width:n/i,height:s/r}}(a,o),tileDuration:function(e,t){return 0===e.rows||0===e.columns?0:t/(e.rows*e.columns)}(a,l)}}function Fn(e,t,r){const i=t===wy.LOWRES?ky:Ry,{VALUE:n=""}=e[i.tiles]||{},{VALUE:s=""}=e[i.duration]||{},{VALUE:a=""}=e[i.resolution]||{},{VALUE:o=""}=e[i.uri]||{},l=[n,s,a,o];if(!l.every(e=>""===e)){if(!l.some(e=>""===e))return{tiles:n,duration:s,resolution:a,uri:o};r&&r("NonValidHLSSessionData")}}function Vn(e){if(void 0!==e)return{name:e.name,value:String(e.id),lang:e.lang||""}}function Bn(e){if(void 0!==e)return{name:e.name,value:String(e.id),lang:e.lang||""}}function Un(e){return e+"p"}function jn(e){let{width:t,height:r}=e;const i=!(0,Hl.z)(r)||r<=0;if(!(0,Hl.z)(t)||t<=0||i)return i?"":Un(r);const n=Math.max(t,r),s=Math.min(t,r);let a=Py[0];for(let o=0;o<Py.length;o++){if(Py[o]===s)return Un(Py[o]);if(n>=Cy*Math.floor(16*Py[o]/9)||s>=Cy*Py[o])return Un(a);a=Py[o]}return Un(Py[Py.length-1])}function Hn(e,t){const{attrs:r={},width:i,height:n}=e;if(!(0,Hl.z)(n))return"";const s=jn(e);if(!(0,Hl.z)(i))return s;const a=function(e){let{width:t,height:r,bitrate:i}=e;return t+"x"+r+"@"+i}({width:i,height:n,bitrate:r["AVERAGE-BANDWIDTH"]?parseInt(r["AVERAGE-BANDWIDTH"],10):e.bitrate}),o=t.get(a);return void 0===o?s:o}function Wn(e,t){if(void 0===e)return;const{height:r,width:i,url:n,bitrate:s}=e;return Array.isArray(n)?{name:Hn(e,t),value:n[0],width:i,height:r,bitrate:s?s/1e3:Vm}:void 0}function qn(e,t){const r=function(e,t,r){const i={};return e.filter(e=>Boolean(r(e))).forEach(e=>{const n=t(e);(!i[n]||r(i[n])<r(e))&&(i[n]=e)}),(0,hh.z)(i)}(e,e=>{let{height:t}=e;return t},e=>{let{bitrate:t}=e;return t}),i=[];return r.forEach(e=>{const r=Wn(e,t);r&&i.push(r)}),i}function Yn(e,t){let{name:r,lang:i}=t;const n=r?e.find(e=>e.name===r):void 0;return n||(i?e.find(e=>e.lang===i):void 0)}function Gn(e,t){let{name:r,height:i}=t;const n=r?e.find(e=>e.name===r):void 0;if(n)return n;if(void 0===i)return;const s=e.filter(e=>{let{height:t}=e;return void 0!==t});return(0,Iy.U)(s,e=>{let{height:t}=e;return Math.abs(t-i)})}function Kn(e,t){const{paused:r}=e,i=t();return r||(0,Pd.v)(e.play()),i}function zn(e){if(e&&e.cues)for(;e.cues.length>0;)e.removeCue(e.cues[0])}function Zn(e){return void 0!==e&&(0,Hl.z)(e)&&e>=0}function Xn(e){const{type:t}=e;return t===jc.Z.VOD||!1===e.live?jc.Z.VOD:t===jc.Z.EVENT?jc.Z.EVENT:jc.Z.LIVE}function Qn(e){let t;void 0===e&&(e=window);try{t=e.devicePixelRatio}catch(io){}return t||1}function Jn(e){let{video:t,maxHeightCapping:r,levels:i=[],bandwidth:n}=e;const s=i.slice().filter(Boolean).sort((e,t)=>t.bitrate-e.bitrate);if(0===s.length)return-1;const{width:a,height:o}=function(e){const t=Qn();return{width:(e.width||e.clientWidth||e.offsetWidth)*t,height:(e.height||e.clientHeight||e.offsetHeight)*t}}(t),[l]=s.filter(e=>!(n&&e.bitrate>n)&&(!(r&&e.height>r)&&(e.width<=a||e.height<=o)));return void 0===l?i.indexOf(s.pop()):i.indexOf(l)}function $n(e){const{VALUE:t=""}=e["com.yandex.video.labels.quality"]||{};return t.split(",").filter(Boolean).reduce((e,t)=>{const[r,i]=t.split(":");return void 0!==function(e){const t=e.match(Ny);if(t)return{width:parseInt(t[1],10),height:parseInt(t[2],10),bitrate:parseInt(t[3],10)}}(r)&&i&&e.set(r,i),e},new Map)}function es(e,t,r){void 0===t&&(t=qd());let i=r;return function(r){if(!t(i,r))return i=r,e(r)}}function ts(e){let{skin:{hiddenControls:t}}=e;return!t.includes(Tu.TIMELINE)}function rs(e){const{controller:{videoType:t}}=e;return t!==jc.Z.VOD&&function(e){const{controller:{currentTime:t,bufferingRanges:r},skin:{skinDVRStartTime:i,skinDVRDuration:n}}=e;return 0!==r.length&&(n===1/0||t>i+n-10)}(e)}function is(e,t){let{name:r,lang:i}=t;const n=e.find(e=>e.name===r);return n||(i?e.find(e=>e.lang===i):void 0)}function ns(e,t){void 0===t&&(t={});let r=0;const i=[],n=(t,n)=>{i.push((0,yh.O)(e,t,n,Vy)),clearTimeout(r)},s=()=>X(i),a=new Promise((i,s)=>{const a=t=>{e.paused&&s(t)},o=(0,Pd.v)(e.play());if(a(Fy.VideoTagPaused),n("durationchange",()=>a(Fy.VideoTagPausedAfterDurationChange)),n("error",()=>a(Fy.VideoTagPausedAfterError)),n("pause",()=>s(Fy.PauseEvent)),n("playing",()=>{i(Fy.PlayingEvent)}),o)t.useProgressEvent&&n("progress",()=>{i(Fy.ProgressEvent)}),o.then(()=>i(Fy.PromiseResolve)).catch(e=>s(function(e){return e?Fy.PromiseReject+"["+e.code+"]["+e.name+"]["+e.message+"]":Fy.PromiseReject}(e)));else{const{timeoutForNonPromisePlay:e}=t;"number"===typeof e&&e>0&&(r=window.setTimeout(()=>{s(Fy.Timeout)},t.timeoutForNonPromisePlay))}});return a.then(s,s),a}function ss(e){let{kind:t}=e;return"subtitles"===t}function as(e){const t=[];for(let r=0;r<e.length;r++)ss(e[r])&&t.push(e[r]);return t}function os(e){return e?"showing":"hidden"}function ls(e,t){return e.responseEnd-t.responseEnd}function ds(){if("undefined"===typeof window.performance)return{value:NaN,source:"timing-api"};const e=ev.reduce((e,t)=>(0,$g.Z)(e,function(e){try{return e.performance.getEntriesByType("resource").filter(e=>{let{duration:t,responseEnd:r,transferSize:i}=e;return t>0&&r>0&&i>1024})}catch(t){return[]}}(t),ls),[]).filter(e=>{let{name:t}=e;return tv.j.test(t)});if(0===e.length)return{value:NaN,source:"timing-api"};const t=new qy.I;return e.forEach(e=>{let{transferSize:r,duration:i}=e;return t.sample(i,r)}),t.getBandwidthEstimate({value:NaN,source:"timing-api"})}function us(e){const{controller:{lastKnownBandwidthEstimate:t,playerConfig:r}}=e;if(isFinite(t.value))return t;if(null!=r&&r.slowConnection)return{value:Qv.e,source:"default-slow"};const i=fn();if(!isNaN(i)&&i>0)return{value:i,source:"cache"};const n=ds();if(!isNaN(n.value)&&n.value>0)return n;const s=function(e){void 0===e&&(e=window);const{navigator:t}=e,{connection:r={}}=t;if("number"===typeof r.downlink)return r.downlink;if("number"===typeof r.downlinkMax)return r.downlinkMax;if("string"===typeof r.type||"number"===typeof r.type)switch(r.type){case Wy.BLUETOOTH:return 3;case Hy.CELL_2G:return.384;case Hy.CELL_3G:case Wy.CELLULAR:return 2;case Wy.WIMAX:return 37;case Wy.NONE:return 0;case Hy.ETHERNET:case Wy.ETHERNET:case Hy.WIFI:case Wy.WIFI:case Wy.MIXED:return 10;case Hy.UNKNOWN:case Wy.UNKNOWN:case Wy.OTHER:}return-1}(window);return-1===s?{value:Qv.S,source:"network-api"}:{value:1e3*s*1e3,source:"network-api"}}function cs(e,t){wg&&Gy<81&&Gy>77&&e.duration-t<.5&&(t=e.duration-.5),e.currentTime=t}function hs(e){const{watchedTime:t=0}=e;return t<15?15:30}function ps(e){const{currentTime:t=0,skippableFragments:r}=e;if(!r)return 30;const i=r.find(e=>t>=e.startTime&&t<e.endTime);if(i)return i.startTime,3;const n=r.find(e=>t<e.startTime);return n?n.startTime-t+Pm:30}function fs(){return(fs=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function ms(){return(ms=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function gs(){return(gs=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function vs(e){if(sS(e.message))return Ga[e.message];if(sS(e.code))return Ga[e.code];const t=my[e.code];return sS(t)?Ga[t]:Ga.DEFAULT_ERROR}function ys(e){if(void 0===e)return;const{id:t,label:r,language:i,bitrate:n}=e;return{name:r||i,value:t,lang:i||"",bitrate:n||void 0}}function Ss(e){const t=(0,Rd.w)(e.audioTracks).find(e=>e.enabled);return t?ys(t):void 0}function Es(e){return"subtitles"===e.kind&&"StreamPlayerJs TextTrack"!==e.label}function bs(e,t){if(void 0===e)return;const{id:r,label:i,language:n}=e;return{name:i||n,value:"undefined"!==typeof r&&""!==r?r:"index:"+t,lang:n||""}}function As(e,t){const{textTracks:r=[]}=e;for(let i=0;i<r.length;i++){const e=r[i];if(e&&Es(e)&&e.mode===t)return bs(e,i)}}function Ts(e){const t=[];return(0,Rd.w)(e).forEach(e=>{const r=ys(e);r&&t.push(r)}),t}function _s(e){const t=[];return(0,Rd.w)(e).forEach((e,r)=>{if(!Es(e))return;const i=bs(e,r);i&&t.push(i)}),t}function ws(e){if(void 0===e)return;const{id:t,label:r,language:i,bitrate:n=Vm,height:s=0,width:a=0,frameRate:o}=e;return{name:r||i,value:t,bitrate:n,height:s,width:a,frameRate:o}}function ks(e){const t=[];return(0,Rd.w)(e).forEach(e=>{const r=ws(e);r&&t.push(r)}),t.filter(e=>{let{value:t}=e;return t!==jm.A})}function Rs(e){let{videoTracks:t=[],videoHeight:r,videoWidth:i}=e;const n=(0,Rd.w)(t),s=n.find(e=>{let{selected:t}=e;return t});if(void 0!==s)return s.id===jm.A?(e=>{let{tracks:t,videoHeight:r,videoWidth:i}=e;return t.sort((e,t)=>{const{width:n=0,height:s=0}=e,{width:a=0,height:o=0}=t;return Math.abs(s-r)-Math.abs(o-r)||Math.abs(n-i)-Math.abs(a-i)})[0]})({tracks:n,videoHeight:r,videoWidth:i}):s}function Ps(){return(Ps=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function Cs(e){let t,r=ed.Z,i=0;const n=e=>{i=e.status,t=e.response};return{promise:new Promise((t,i)=>{(0,uS.W)(Ps({},e,{onSuccess:e=>{n(e),t(e)},onError:(e,t)=>{n(t),i(e)},onAbort:i,onSetup:e=>{let{abort:t}=e;return r=t}}))}),abort:e=>r(e),getStatus:()=>i,getResponse:()=>t}}function Is(e){switch(e.error){case cS.EXPIRED_SIGNATURE:return Ga.DRM_PROXY_ERROR_SIGNATURE_EXPIRED;case cS.NEED_COOKIE:return Ga.DRM_PROXY_ERROR_NEED_COOKIE;case cS.NEED_YATEAM_LOGIN:return Ga.DRM_PROXY_ERROR_NEED_TEAM_LOGIN;case cS.NEED_VIEW_PERMISSION:return Ga.DRM_PROXY_ERROR_NEED_VIEW_PERMISSION;default:return Ga.DRM_PROXY_ERROR}}function Os(e){return new Fl({isFatal:e.isFatal,code:Is(e),details:{drmProxyError:e.error},helpLink:e.helpLink})}function Ds(){return(Ds=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function Ns(e,t){const r=(()=>{try{return function(e){return{error:String(e.error)||"",isFatal:Boolean(e.isFatal),helpLink:String(e.helpLink)||""}}(JSON.parse(e))}catch(t){return Ds({},hS,{error:e})}})();return r.isFatal=r.isFatal||!isFinite(t)||t<=0,r}function Ls(e,t){switch(e){case 429:return([500,2500,6500][t]||1e3)+1e3*Math.random();default:return 0}}function xs(){return(xs=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function Ms(e){return String.fromCharCode(...Array.from(e))}function Fs(e){return e.charCodeAt(0)}function Vs(e){return Array.from(e,Fs)}function Bs(){return(Bs=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function Us(e){return e&&q(e)||window}function js(){return(js=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function Hs(){return(Hs=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function Ws(e){if(e in DS)return DS[e];const t=document.createElement("link");return t.rel="preload",t.as="script",DS[e]=new Promise((r,i)=>{t.onload=r,t.onerror=i,t.href=e,t.crossOrigin="anonymous",OS.appendChild(t)}).then(()=>{DS[e]=Promise.resolve()}).catch(()=>{delete DS[e],OS.removeChild(t)}),DS[e]}function qs(){return(qs=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function Ys(e,t){e.supportInfo.engine===ql.HLS?Ws(Va):e.supportInfo.engine===ql.YASP&&(py.setWorkerConfig(qs({},_S,t)),py.warmUp())}function Gs(e){return"ya-video-player-"+e}function Ks(e,t){return function(e,t){if(!e)return;let r=e.parentElement;for(let i=t;i>0;i--)r=r&&r.parentElement;return r||void 0}(t.getElementById(Gs(e)),2)}function zs(e,t){return void 0===e?void 0===t:"auto"in e&&!0===e.auto?t===jm.A:e.value===t}function Zs(e,t,r){void 0===r&&(r=qd());let i=t;return function(){var t;if(0===arguments.length)return;const n=(t=arguments.length-1)<0||arguments.length<=t?void 0:arguments[t],s=r(n,i)||Number.isNaN(n)&&Number.isNaN(i);return s?void 0:(i=n,e(...arguments))}}function Xs(e,t){const{controller:{textTrackValue:r,textTracks:i,userTextTrackName:n,userTextTrackLang:s}}=e.getState();if(r)return void t.setTextTrack(r);const a=is(i,{name:n,lang:s})||function(e){if(0===e.length)return;const t=function(e,t){if("string"!==typeof t)return;const r=t.split("-")[0].toLowerCase();for(let i=0;i<e.length;i++){const t=e[i];if(t.name.toLowerCase()===r)return t}}(e,navigator.language);return void 0!==t?t:e[0]}(i);void 0===a?mf.error("No text tracks to enable"):t.setTextTrack(a.value)}function Qs(e,t){const r=e.getState(),{skin:{nativeControlsVisibility:i},controller:{textTrackEnabled:n,nativeTextTrackVisible:s,isPip:a}}=r,o=void 0===s||s||a||Boolean(i&&n);t.toggleNativeSubtitles(o)}function Js(e,t){const{skin:{hiddenControls:r}}=e.getState();t.setHiddenControls(r)}function $s(e,t){const r=e.getState(),{controller:{videoType:i,playbackRate:n,encoderState:s}}=r;i!==jc.Z.VOD&&s===Cm.Attached&&($r(r)||(n>1.03?function(e){const{controller:{currentTime:t,bufferingRanges:r,engine:i},skin:{skinDVRStartTime:n,skinDVRDuration:s}}=e;if(0===r.length)return!1;const a=i===ql.NATIVE?5:0;return s===1/0||t>n+s-a}(r)&&t.setPlaybackRate(1):!function(e){const{controller:{currentTime:t,dvrStartTime:r,dvrDuration:i}}=e;return t<r||t>r+i}(r)&&function(e){const{controller:{videoType:t}}=e;if(t!==jc.Z.LIVE)return!1;const{controller:{currentTime:r},skin:{skinDVRStartTime:i}}=e;return i+(0===r?0:10)>r}(r)&&t.setPlaybackRate(1)))}function ea(e){return"number"!==typeof(t=Math.floor(2*e)/2)||isNaN(t)||!isFinite(t)?0:t;var t}async function ta(e,t){const{controller:{autoplay:r,encoderState:i}}=e.getState();r&&i===Cm.Attached&&await t.play().catch(VS.Z)}function ra(e){const t=function(e){return Li(e)&&(0,Yu.en)(e).pathname.slice(1).split("/")[1]||""}(e);return{channel:t,metaInfoUrl:"https://strm.yandex.net/kal/"+t+"/break/last?start_ts={{video-timestamp}}"}}function ia(e,t){const r=e.height||0;return(t.height||0)-r}function na(e){if(Vd)return null;try{const{windowChain:t}=(0,Vh.T)(e.ownerDocument.defaultView);if(t.some(e=>{const{hasBeenActive:t}=(0,Wa.Y)(()=>function(e){const t=e.navigator;if(!t)return;const{userActivation:r}=t;if(!(0,Za.K)(r))return;const{isActive:i,hasBeenActive:n}=r;return{isActive:i,hasBeenActive:n}}(e))||{hasBeenActive:!1};return t}))return{muted:!1,allowed:!0,detectionMethod:"NavigationActive"}}catch(t){}return null}async function sa(e,t,r){return r.stopped?null:(Kn(e,()=>{e.load()}),Vd&&(await(0,US._)(0),r.stopped)?null:(e.src=XS,e.muted=t,e.volume=t?0:1,new Promise(i=>{ns(e,{useProgressEvent:!0,timeoutForNonPromisePlay:500}).then(e=>{if(r.stopped)return i(null);i({muted:t,allowed:!0,detectionMethod:"RealPlayPolicy|"+e})}).catch(()=>{if(r.stopped)return i(null);const n=Tn(e);n&&n.code===my.MEDIA_ERR_DECODE?setTimeout(()=>{if(r.stopped)return i(null);i({muted:t,allowed:!0,detectionMethod:"RealPlayPolicy|OldBrowser"})},0):i(null)})})))}function aa(e,t){let{content:r,size:i}=void 0===t?{}:t;const n=e.ownerDocument.createElement("iframe");n.scrolling="no",n.setAttribute("allowfullscreen",""),n.style.display="block",i&&(n.height=i.height,n.width=i.width),e.appendChild(n);const s=n.contentDocument;s.open(),r&&s.write(r),s.close();try{s.body.style.margin="0"}catch(a){}return n.style.borderWidth="0",n}function oa(e,t){if(void 0===t&&(t=window),!t||!t[e]||!t[e].prototype)return;const{play:r}=t[e].prototype;return r&&(0,wd.t)(r)?r:void 0}function la(e,t){var r,i,n,s;let{initialMuted:a,checkMuted:o,checkUnmuted:l,process:d}=t;if(!o&&!l)return{muted:a,allowed:!1,detectionMethod:"NoCheck"};const{muted:u,paused:c,volume:h}=e,p=e.getAttribute("src"),f=()=>{null===p?e.removeAttribute("src"):e.setAttribute("src",p),e.load(),e.muted=u,e.volume=h,c?e.pause():e.paused&&(0,Pd.v)(function(e){if(!Jp)return Promise.reject();const t=(r=e.play).__yaMuffleVideoPlayPromiseOriginalPlay||r;var r;if((0,wd.t)(t))return t.call(e);const i=oa("HTMLVideoElement")||oa("HTMLMediaElement");if(i)return i.call(e);const n=document.createElement("div");n.style.display="none",document.body.appendChild(n);const s=oa("HTMLMediaElement",aa(n).contentWindow);if(s){const t=s.call(e);return Q(n),t}return e.play()}(e))},m=null!=(r=null!=(i=null!=(n=null!=(s=null!=null?null:na(e))?s:function(e,t){let{checkMuted:r,checkUnmuted:i}=t;try{if("boolean"===typeof e.allowedToPlay){const t=e;if(i&&(t.muted=!1,t.volume=1,t.allowedToPlay))return{muted:!1,allowed:!0,detectionMethod:"YandexBrowser"};if(r)return t.muted=!0,t.volume=0,{muted:!0,allowed:t.allowedToPlay,detectionMethod:"YandexBrowser"}}}catch(n){}return null}(e,{checkMuted:o,checkUnmuted:l}))?n:function(e){try{switch(navigator.getAutoplayPolicy(e)){case"allowed":return{muted:!1,allowed:!0,detectionMethod:"NavigatorAutoplayPolicy"};case"allowed-muted":return{muted:!0,allowed:!0,detectionMethod:"NavigatorAutoplayPolicy"};case"disallowed":return{muted:!1,allowed:!1,detectionMethod:"NavigatorAutoplayPolicy"};default:return null}}catch(t){return null}}(e))?i:ZS>-1&&ZS<=16?{muted:!1,allowed:!0,detectionMethod:"IEPolicy"}:null)?r:Cc&&Wg.major<=9?{muted:!1,allowed:!1,detectionMethod:"IosTill9Policy"}:null;if(null===m){if(l)return sa(e,!1,d).then(t=>null!=t?t:o?sa(e,!0,d):null).then(e=>null!=e?e:{muted:a,allowed:!1,detectionMethod:"RestUnmuted"}).then(e=>(f(),e));if(o)return sa(e,!0,d).then(e=>null!=e?e:{muted:a,allowed:!1,detectionMethod:"RestMuted"}).then(e=>(f(),e))}return f(),null!=m?m:{muted:a,allowed:!1,detectionMethod:"Default"}}function da(){return(da=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function ua(e,t){const r="cover"===t.objectFit?{transform:"translate(-1px, -1px)",height:"calc(100% + 2px)",width:"calc(100% + 2px)"}:{transform:"",height:"",width:""};W(e,da({},"objectFit"in t?r:{},t))}function ca(){return(ca=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function ha(e){void 0===e&&(e=window);const t=(0,Md.i)(e).match(/YaBrowser\/([\d]+)\.([\d]+)/);if(!t)return{major:-1,minor:-1};const[,r,i]=t;return{major:parseInt(r,10),minor:parseInt(i,10)}}function pa(){return hg(window)&&!Cc&&!Kh}function fa(e){return(0,Ql.m)(e.toJSON)?e.toJSON():e}function ma(){return(ma=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function ga(e){const t=e.getVideoType(),r=e.getTimelineInfo();if(t!==jc.Z.LIVE)return r;const{currentTime:i,utcStartTime:n,dvrStartTime:s,dvrDuration:a}=r;return{dvrDuration:a,dvrStartTime:(n||0)+s,utcStartTime:0,duration:1/0,currentTime:(n||0)+i}}function va(e,t){if(e.getVideoType()!==jc.Z.LIVE)return t;const{utcStartTime:r=0}=e.getTimelineInfo();return t.map(e=>{let{start:t,end:i}=e;return{start:r+t,end:r+i}})}function ya(e,t){if(e.getVideoType()!==jc.Z.LIVE)return t;const{utcStartTime:r=0}=e.getTimelineInfo();return t-r}function Sa(e){function t(){return r?r.getSourceId():NaN}let r,{container:i,postMessenger:n,streamPlayerParams:s,vsid:a,vpuid:o}=e;const l={onDrmSystemChange:e=>{n.sendEvent("onDrmSystemChange",{sourceId:t(),data:e})},onChangeStream:e=>{n.sendEvent("onChangeStream",{sourceId:t(),data:e})},onError:e=>{const r=fa(e),i=r.isFatal?se(r,lE):void 0,s=fa(new Fl(ma({},r,{messageDetails:i})));n.sendEvent("onError",{sourceId:t(),data:s})},onRecover:e=>{n.sendEvent("onRecover",{sourceId:t(),data:e})},onStateChange:e=>{const r=t();n.sendEvent("onStateChange",{sourceId:r,data:{playingState:e,reason:oE}}),dE!==e&&(dE=e,oE=eu.l.Unknown)},onAdStateChange:e=>{uE.state!==e.state&&(oE=eu.l.Unknown);const r=ma({},uE);uE=e,n.sendEvent("onAdStateChange",{sourceId:t(),data:{nextAdState:e,prevAdState:r}})},onAdLoaded:e=>{n.sendEvent("onAdLoaded",{sourceId:t(),data:e})},onAdError:e=>{n.sendEvent("onAdError",{sourceId:t(),data:e})},onBeforeAdPodStart:e=>{n.sendEvent("onBeforeAdPodStart",{sourceId:t(),data:e})},onAdPodStart:()=>{n.sendEvent("onAdPodStart",{sourceId:t(),data:void 0})},onAdPodClick:()=>{n.sendEvent("onAdPodClick",{sourceId:t(),data:void 0})},onAdPodSkip:()=>{n.sendEvent("onAdPodSkip",{sourceId:t(),data:void 0})},onAdPodEnd:()=>{n.sendEvent("onAdPodEnd",{sourceId:t(),data:void 0})},onAdSkippableStateChange:e=>{n.sendEvent("onAdSkippableStateChange",{sourceId:t(),data:e})},onAdPodCloseStateChange:e=>{n.sendEvent("onAdPodCloseStateChange",{sourceId:t(),data:e})},onAdPodDurationChange:e=>{n.sendEvent("onAdPodDurationChange",{sourceId:t(),data:e})},onAdPodCurrentTimeChange:e=>{n.sendEvent("onAdPodCurrentTimeChange",{sourceId:t(),data:e})},onAdPodTimeToSkipChange:e=>{n.sendEvent("onAdPodTimeToSkipChange",{sourceId:t(),data:e})},onAdVolumeAvailabilityStateChange:e=>{n.sendEvent("onAdVolumeAvailabilityStateChange",{sourceId:t(),data:e})},onAdInteraction:()=>{n.sendEvent("onAdInteraction",{sourceId:t(),data:void 0})},onVideoTypeChange:e=>{n.sendEvent("onVideoTypeChange",{sourceId:t(),data:e})},onDVRStartTimeChange:()=>{void 0!==r&&n.sendEvent("onTimelineInfoChange",{sourceId:t(),data:ga(r)})},onDVRDurationChange:()=>{void 0!==r&&n.sendEvent("onTimelineInfoChange",{sourceId:t(),data:ga(r)})},onCurrentTimeChange:()=>{void 0!==r&&(n.sendEvent("onPositionChange",{sourceId:t(),data:{time:r.getState().controller.currentTime,utcTime:r.getUtcPosition(),watchedTime:r.getState().controller.watchedTime,videoPlaybackQuality:r.getVideoPlaybackQuality(),liveLatency:r.getLiveLatency()}}),n.sendEvent("onTimelineInfoChange",{sourceId:t(),data:ga(r)}))},onFullScreenChange:e=>{n.sendEvent("onFullScreenChange",{sourceId:t(),data:e})},onVolumeChange:e=>{n.sendEvent("onVolumeChange",{sourceId:t(),data:e})},onVideoTrackChange:e=>{var i;n.sendEvent("onVideoTrackChange",{sourceId:t(),data:e}),n.sendEvent("onCapSizeChange",{sourceId:t(),data:null==(i=r)?void 0:i.getMaxCapAllowedVideoTrack()})},onVideoTracksChange:e=>{n.sendEvent("onVideoTracksChange",{sourceId:t(),data:e})},onAudioTrackChange:e=>{n.sendEvent("onAudioTrackChange",{sourceId:t(),data:e})},onAudioTracksChange:e=>{n.sendEvent("onAudioTracksChange",{sourceId:t(),data:e})},onTextTrackChange:e=>{n.sendEvent("onTextTrackChange",{sourceId:t(),data:e})},onTextTracksChange:e=>{n.sendEvent("onTextTracksChange",{sourceId:t(),data:e})},onSubtitlesChange:e=>{n.sendEvent("onSubtitlesChange",{sourceId:t(),data:e})},onPlaybackRateChange:e=>{n.sendEvent("onPlaybackRateChange",{sourceId:t(),data:e})},onThumbnailTileGeneralMetaInfoChange:e=>{n.sendEvent("onThumbnailTileGeneralMetaInfoChange",{sourceId:t(),data:e})},onOriginalBroadcastAdStateChange:e=>{n.sendEvent("onOriginalBroadcastAdStateChange",{sourceId:t(),data:e})},onAdblockDetected:e=>{lE=e,(0,Wa.Y)(()=>{(ed.Z||window.Ya.Rum.updateErrors)({blocker:lE}),(ed.Z||window.Ya.Rum.setVars)({"-blocker":lE}),Kt(rf,0,!1,{[rf]:Number(lE)})})},onContentImpression:e=>{n.sendEvent("onContentImpression",{sourceId:t(),data:e})},onResourcesIdle:()=>{n.sendEvent("onResourcesIdle",{sourceId:t(),data:void 0})},onVisualStateChange:e=>{n.sendEvent("onVisualStateChange",{sourceId:t(),data:e})},onBufferingRangesChange:e=>{void 0!==r&&n.sendEvent("onBufferingRangesChange",{sourceId:t(),data:va(r,e)})},onStartStageChange:e=>{n.sendEvent("onStartStageChange",{sourceId:t(),data:e})},onVideoSizeChange:e=>{n.sendEvent("onVideoSizeChange",{sourceId:t(),data:e})},onNextAdRemainingTimeChange:e=>{n.sendEvent("onNextAdRemainingTimeChange",{sourceId:t(),data:e})},logEvent:e=>{n.sendEvent("onLogEvent",{sourceId:-1,data:e})},onStreamsWithSupportInfoChange:e=>{n.sendEvent("onStreamsWithSupportInfoChange",{sourceId:t(),data:e})},onEngineChange:(e,t)=>{n.sendEvent("onEngineChange",{sourceId:t,data:e})},onBandwidthEstimateChange:e=>{n.sendEvent("onBandwidthEstimateChange",{sourceId:t(),data:e})},onCapSizeChange:e=>{n.sendEvent("onCapSizeChange",{sourceId:t(),data:e})},onPlaybackQualityUpdate:e=>{n.sendEvent("onPlaybackQualityUpdate",{sourceId:t(),data:e})},onExpectedStalledChange:e=>{n.sendEvent("onExpectedStalledChange",{sourceId:t(),data:e})},onRequestFullscreenChange:e=>{n.sendEvent("onRequestFullscreenChange",{sourceId:t(),data:e})},onInrollFrame:e=>{n.sendEvent("onInrollFrame",{sourceId:t(),data:e})},onFrameRendered:e=>{n.sendEvent("onFrameRendered",{sourceId:t(),data:e})},onTargetLatencyChange:e=>{n.sendEvent("onTargetLatencyChange",{sourceId:t(),data:e})}},d=ma({},s,{perfLogUrl:s.perfLogUrl,device:s.device,bandwidthEstimateOffset:s.bandwidthEstimateOffset,maxBufferLength:s.maxBufferLength,skinConfig:s.skinConfig,backgroundColor:s.backgroundColor,togglePlaybackOnVisibilityChange:s.togglePlaybackOnVisibilityChange,isVisibilitySupported:s.isVisibilitySupported,initialVisibility:s.initialVisibility,callbacks:l});n.sendEvent("onInit",aE),function(e){return void 0===e&&(e=window),(0,Rd.w)(e.document.querySelectorAll("style[data-ya-player-style]"))}().forEach(e=>function(e,t){q(e)!==q(t)&&t.appendChild(e)}(e,i));const u=new sE(i,s.isVisibilitySupported||!1);r=new $S(i,d,{visualState:u},()=>n.sendEvent("onReady",aE)),Kt(tf),n.on("Command",e=>{switch(e.commandName){case ah.pause:oE=e.params,void 0!==r&&r.pause(),e.sendAnswer();break;case ah.play:oE=e.params,r?r.play().then(()=>{e.sendAnswer(!0)}).catch(()=>{e.sendAnswer(!1)}):e.sendAnswer(!1);break;case ah.seek:r.seek({videoTime:ya(r,e.params)});break;case ah.setPlaybackRate:r.setPlaybackRate(e.params);break;case ah.setSource:const{sourceConfig:l,shouldSaveProgress:c}=e.params;if(!l)throw new Fl("setSource method receives an object");e.sendAnswer(),r.setSource(l,{shouldSaveProgress:c});break;case ah.preloadSource:const{sourceConfig:h,requestId:p}=e.params,{promise:f,abort:m,end:g}=r.preloadSource(h);cE[p]=m,f.then(()=>{n.sendEvent("onPreloadSourceResolve",{sourceId:-1,data:p})}).catch(()=>{n.sendEvent("onPreloadSourceReject",{sourceId:-1,data:p})}).then(()=>{(0,Wa.Y)(g),delete cE[p]});break;case ah.abortPreloadSource:const v=cE[e.params];(0,Ql.m)(v)&&(v(),delete cE[e.params]);break;case ah.setVolume:e.params>0&&r.setMuted(!1),r.setVolume(e.params);break;case ah.setMuted:r.setMuted(e.params);break;case ah.setVideoTrack:r.setVideoTrack(e.params);break;case ah.setAudioTrack:r.setAudioTrack(e.params);break;case ah.setTextTrack:r.setTextTrack(e.params);break;case ah.setNativeTextTrackVisibility:r.setNativeTextTrackVisibility(e.params);break;case ah.setNativeAdControlsVisibility:r.setNativeAdControlsVisibility(e.params);break;case ah.setFullscreen:r.setFullscreen(e.params);break;case ah.setPictureInPicture:u.changePipState({isPip:e.params});break;case ah.setHiddenControls:r.setHiddenControls(e.params);break;case ah.setVideoStyle:r.setVideoStyle(e.params);break;case ah.setPictureInPictureEnabled:r.setPictureInPictureEnabled(e.params);break;case ah.requestDebugInfo:(async function(){var e;let t={};return void 0!==r&&(t=await r.requestDebugInfo()),ma({},t,{adState:uE,playingState:dE,vsid:a,vpuid:o,version:"1.0-12103",utcPosition:r.getUtcPosition(),currentTime:null==(e=r)?void 0:e.getState().controller.currentTime,system:et(),clientTimestamp:Date.now(),internalInitialConfig:d})})().then(t=>e.sendAnswer(t));break;case ah.stopAd:r.stopAd({stopAdReason:pf.InsertIntoCalled}).then(()=>{e.sendAnswer()});break;case ah.playInrollAd:r.playInrollAd(e.params);break;case ah.skipAdPod:r.skipAdPod();break;case ah.playAdViewers:const{adType:y,adViewers:S}=e.params;r.playAdViewers(y,S,{},!0).then(()=>{e.sendAnswer({success:!0})}).catch(()=>{e.sendAnswer({success:!1})});break;case ah.destroy:u.destroy(),void 0!==r?r.destroy().catch(ed.Z).then(()=>{e.sendAnswer(e.params)}):e.sendAnswer(e.params);break;case ah.setExternalVisualState:"boolean"===typeof e.params.isVisible&&u.setExternalVisibility(e.params.isVisible),"boolean"===typeof e.params.isFullscreen&&u.setExternalFullscreen(e.params.isFullscreen);break;case ah.logDelta:t=e.params.deltaId,i=e.params.value,void 0===(s=e.params.params)&&(s={}),P()&&(0,Wa.Y)(()=>{const{additional:e,initSubpage:r=!1}=s,n=N(s,cd);if(r&&O()>0)return;const a=I(),o=(0,Za.K)(a)?a.additional:void 0;(ed.Z||window.Ya.Rum.sendDelta)(t,i,D({},a,n,{"-additional":(0,Za.K)(e)?w(D({},o,e)):w(o)}))});break;default:throw new Error("IFrameApi Error: unexpected command in MessageEvent: "+e.commandName)}var t,i,s}),L("detect.visibility"),"boolean"===typeof s.initialVisibility?(u.setExternalVisibility(s.initialVisibility),x("detect.visibility")):n.sendRequest(ah.getExternalVisualState,void 0).then(e=>{let{isVisible:t}=e;u.setExternalVisibility(t),x("detect.visibility")})}function Ea(e){let{source:t}=e;return!!t&&(!!t.adConfig&&(!(!t.adConfig.partnerId&&!t.adConfig.adBreaks)&&!1!==t.adConfig.hasPreroll))}function ba(e,t){if(null==e)return{};var r,i,n={},s=Object.keys(e);for(i=0;i<s.length;i++)r=s[i],t.indexOf(r)>=0||(n[r]=e[r]);return n}function Aa(){return(Aa=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function Ta(e){void 0===e&&(e=document);const t=e.getElementById("ya-video-playerapi-mock-frame");if(t)return t;const r=function(e){const t=aa(e);return t.width="0",t.height="0",t.style.position="absolute",t}(e.body);return r.id="ya-video-playerapi-mock-frame",r}function _a(e){void 0===e&&(e={});const t=De(e.version)||kc,r=[V(bc?SE.PLAYER_API_MODERN:SE.PLAYER_API,t,e.useAbdBundle||!1)];if(Ea(e)){var i;const t=(null==(i=e.source)?void 0:i.adConfig)||{};(e=>{var t;const{win:r,config:{vasUaasConfig:i},moduleName:n}=e,{version:s}=cm(i);if(void 0===s)return[];return[{src:ym({version:s,bundleName:n,win:r,ecmaVersion:null!==(t=Zf.adsdkecmaver)&&void 0!==t?t:hm}),type:"script"}]})({win:window,config:t,moduleName:"Multiroll"}).forEach(e=>{let{src:t}=e;r.push(t)})}return Promise.all(r.map(Ws)).then(()=>r)}function wa(e,t){void 0===t&&(t=window),_a(e);try{const r=function(e,t){let{version:r,useAbdBundle:i,usePlayerApiMock:n}=e;const s=De(r,t),a=Ne(s,n);return V(a,s||kc,Boolean(i))}(e,window);return void 0===EE&&(EE=v({win:t,src:r,retries:3,dropCacheOnRetry:!0,onBeforeLoad:e=>{e.crossOrigin="anonymous"},checkLoad:()=>{try{var e,r;return(0,Ql.m)(null==(e=t.Ya)||null==(r=e.playerApi)?void 0:r.create)}catch(i){return!1}}})),{promise:EE,bundleUrl:r}}catch(io){return{promise:Promise.reject(io),bundleUrl:""}}}function ka(){return(ka=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function Ra(e){const t=ka({},e,{element:"string"===typeof e.element?document.getElementById(e.element):e.element}),r=Ta(document).contentWindow,i=(0,jl.K)(),{setReadyInstance:n,setInstance:s}=i,a=function(e,t){if(null==e)return{};var r,i,n={},s=Object.keys(e);for(i=0;i<s.length;i++)r=s[i],t.indexOf(r)>=0||(n[r]=e[r]);return n}(i,bE);return wa(t,r).promise.then(()=>{const e=r.Ya.playerApi.create(t);n(e),s(e)}),a}var Pa=r(1792),Ca=r(7549);const Ia=[...Pa.o,...Ca.t,"getState","getReadyState"],Oa=window;Oa.Ya||(Oa.Ya={}),Oa.Ya.playerApi||(Oa.Ya.playerApi={}),Oa.Ya.playerApi.METHODS||(Oa.Ya.playerApi.METHODS=Ia);const Da=window.Ya.playerApi,Na=window.Ya.playerApi;var La=r(3697),xa=r(3125),Ma=r(7881),Fa=r(9444);const Va="https://yastatic.net/yandex-video-player-iframe-api-bundles/hlsjs/0.12.2-1761-1846-1976_tmp-2080-2095-2146-2171-2-2172-2232_tmp-2427-2498/hls.min.js";let Ba;!function(e){e.BUFFER_FULL_ERROR="bufferFullError",e.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",e.BUFFER_STALLED_ERROR="bufferStalledError",e.FRAG_PARSING_ERROR="fragParsingError",e.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",e.BUFFER_APPENDING_ERROR="bufferAppendingError",e.PIPELINE_ERROR_DECODE="PIPELINE_ERROR_DECODE",e.DECODER_ERROR_NOT_SUPPORTED="DECODER_ERROR_NOT_SUPPORTED",e.BUFFER_APPEND_ERROR="bufferAppendError",e.MEDIA_ELEMENT_ERROR_FORMAT_ERROR="MEDIA_ELEMENT_ERROR: Format error",e.REMUX_ALLOC_ERROR="remuxAllocError",e.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",e.DEMUXER_ERROR_COULD_NOT_OPEN="DEMUXER_ERROR_COULD_NOT_OPEN",e.NS_ERROR_DOM_INVALID_STATE_ERR="NS_ERROR_DOM_INVALID_STATE_ERR",e.CHUNK_DEMUXER_ERROR_APPEND_FAILED="CHUNK_DEMUXER_ERROR_APPEND_FAILED",e.FAILED_TO_INIT_DECODER="Failed to init decoder",e.PIPELINE_ERROR_INITIALIZATION_FAILED="PIPELINE_ERROR_INITIALIZATION_FAILED",e.NS_ERROR_FAILURE="NS_ERROR_FAILURE",e.REQUEST_FAILED="2147500036: Request failed",e.PIPELINE_ERROR_EXTERNAL_RENDERER_FAILED="PIPELINE_ERROR_EXTERNAL_RENDERER_FAILED",e.PIPELINE_ERROR_COULD_NOT_RENDER="PIPELINE_ERROR_COULD_NOT_RENDER",e.MEDIA_ELEMENT_ERROR_EMPTY_SRC_ATTRIBUTE="MEDIA_ELEMENT_ERROR: Empty src attribute",e.NS_ERROR_DOM_MEDIA_METADATA_ERR="NS_ERROR_DOM_MEDIA_METADATA_ERR",e.NS_ERROR_DOM_MEDIA_FATAL_ERR="NS_ERROR_DOM_MEDIA_FATAL_ERR",e.MANIFEST_PARSING_ERROR="manifestParsingError",e.FRAG_LOAD_ERROR="fragLoadError",e.MANIFEST_LOAD_ERROR="manifestLoadError",e.LEVEL_LOAD_ERROR="levelLoadError",e.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",e.FRAG_LOAD_TIME_OUT="fragLoadTimeOut",e.MANIFEST_LOAD_TIME_OUT="manifestLoadTimeOut",e.LEVEL_LOAD_TIME_OUT="levelLoadTimeOut",e.AUDIO_TRACK_LOAD_TIME_OUT="audioTrackLoadTimeOut",e.INTERNAL_EXCEPTION="internalException",e.ON_PLAYER_INIT_ERROR_INTERNAL="ON_PLAYER_INIT_ERROR_INTERNAL",e.UNABLE_TO_LOAD_PLAYER_IFRAME="UNABLE_TO_LOAD_PLAYER_IFRAME",e.ON_PLAYER_INIT_ERROR="ON_PLAYER_INIT_ERROR",e.LOADER_INIT_ERROR="LoaderInitError",e.UNABLE_TO_LOAD_PLAYER_INTERNAL_SCRIPT="UNABLE_TO_LOAD_PLAYER_INTERNAL_SCRIPT",e.FAILED_TO_DOWNLOAD_DEBUG_INFO="FAILED_TO_DOWNLOAD_DEBUG_INFO",e.PLAYER_CONTAINER_NOT_FOUND="PLAYER_CONTAINER_NOT_FOUND",e.KEY_LOAD_ERROR="keyLoadError",e.FEATURE_HANDLER_ERROR="FEATURE_HANDLER_ERROR",e.INVALID_CONFIG_ELEMENT_IN_CREATE_PLAYER="InvalidConfigElementInCreatePlayer",e.INVALID_CONFIG_LANG_IN_CREATE_PLAYER="InvalidConfigLangInCreatePlayer",e.INVALID_CONFIG_IN_CREATE_PLAYER="InvalidConfigInCreatePlayer",e.INVALID_CONFIG_IN_SET_SOURCE="InvalidConfigInSetSource",e.INVALID_CONFIG_IN_SOURCE_UPDATE="InvalidConfigInSourceUpdate",e.INVALID_LOG_URL="InvalidLogUrl",e.IFRAME_DOES_NOT_ALLOW_DRM="IframeDoesNotAllowDrm",e.DRM_IS_NOT_ALLOWED="DrmIsNotAllowed",e.EXTERNAL_POST_MESSENGER_SEND_MESSAGE_ERROR="EXTERNAL_POST_MESSENGER_SEND_MESSAGE_ERROR",e.INTERNAL_POST_MESSENGER_SEND_MESSAGE_ERROR="INTERNAL_POST_MESSENGER_SEND_MESSAGE_ERROR",e.LOAD_SKIN_ERROR="LOAD_SKIN_ERROR",e.INSERT_INTO_WITH_SECURE_FRAME="INSERT_INTO_WITH_SECURE_FRAME",e.PLAY_AD_VIEWERS_WITH_SECURE_FRAME="PLAY_AD_VIEWERS_WITH_SECURE_FRAME",e.ELEMENT_NOT_IN_DOM="ELEMENT_NOT_IN_DOM",e.ERROR_SCREEN_LOAD_ERROR="ERROR_SCREEN_LOAD_ERROR",e.REQUEST_SOURCE_ERROR="REQUEST_SOURCE_ERROR",e.SCREEN_WAKE_LOCK_ERROR="SCREEN_WAKE_LOCK_ERROR",e.YASP_UNEXPECTED_METHOD_CALL="YASP_UNEXPECTED_METHOD_CALL"}(Ba||(Ba={}));var Ua=r(3525),ja=r(8139),Ha=r.n(ja),Wa=r(1729),qa=r(9209),Ya=r(6971);let Ga;!function(e){e.DEFAULT_ERROR="DEFAULT_ERROR",e.BROADCAST_AD_BLOCK_INIT_ERROR="BROADCAST_AD_BLOCK_INIT_ERROR",e.AD_TYPE_IS_NOT_RECOGNIZED="AD_TYPE_IS_NOT_RECOGNIZED",e.INVALID_METADATA="INVALID_METADATA",e.INVALID_STREAM_URL="INVALID_STREAM_URL",e.UNSUPPORTED_MEDIA_TYPE="UNSUPPORTED_MEDIA_TYPE",e.SCRIPT_INIT_ERROR="SCRIPT_INIT_ERROR",e.MPD_WIDEVINE_CERT_LOAD_ERROR="MPD_WIDEVINE_CERT_LOAD_ERROR",e.NATIVE_HLS_NOT_SUPPORTED_ERROR="NATIVE_HLS_NOT_SUPPORTED_ERROR",e.HLS_JS_NOT_SUPPORTED_ERROR="HLS_JS_NOT_SUPPORTED_ERROR",e.ON_TICK_ERROR="ON_TICK_ERROR",e.FAIRPLAY_NOT_SUPPORTED="FAIRPLAY_NOT_SUPPORTED",e.FAIRPLAY_CERT_LOAD_ERROR="FAIRPLAY_CERT_LOAD_ERROR",e.FAIRPLAY_CREATE_MEDIA_KEYS_ERROR="FAIRPLAY_CREATE_MEDIA_KEYS_ERROR",e.FAIRPLAY_CREATE_KEY_SESSION_ERROR="FAIRPLAY_CREATE_KEY_SESSION_ERROR",e.FAIRPLAY_SPC_LOAD_ERROR="FAIRPLAY_SPC_LOAD_ERROR",e.FAIRPLAY_CREATE_KEY_ERROR="FAIRPLAY_CREATE_KEY_ERROR",e.FAIRPLAY_INVALID_CONTENT_ID="FAIRPLAY_INVALID_CONTENT_ID",e.DRM_PROXY_ERROR="DRM_PROXY_ERROR",e.DRM_PROXY_ERROR_SIGNATURE_EXPIRED="DRM_PROXY_ERROR_SIGNATURE_EXPIRED",e.DRM_PROXY_ERROR_NEED_COOKIE="DRM_PROXY_ERROR_NEED_COOKIE",e.DRM_PROXY_ERROR_NEED_TEAM_LOGIN="DRM_PROXY_ERROR_NEED_TEAM_LOGIN",e.DRM_PROXY_ERROR_NEED_VIEW_PERMISSION="DRM_PROXY_ERROR_NEED_VIEW_PERMISSION",e.DRM_INIT_ERROR="DRM_INIT_ERROR",e.DRM_NO_INIT_DATA="DRM_NO_INIT_DATA",e.DRM_CERT_LOAD_ERROR="DRM_CERT_LOAD_ERROR",e.DRM_NO_SUPPORTED_KEY_SYSTEM="DRM_NO_SUPPORTED_KEY_SYSTEM",e.DRM_FAILED_TO_CREATE_CDM="DRM_FAILED_TO_CREATE_CDM",e.DRM_FAILED_TO_SET_MEDIA_KEYS="DRM_FAILED_TO_SET_MEDIA_KEYS",e.DRM_NO_LICENSE_SERVER="DRM_NO_LICENSE_SERVER",e.DRM_FAILED_TO_CREATE_SESSION="DRM_FAILED_TO_CREATE_SESSION",e.DRM_SESSION_ERROR="DRM_SESSION_ERROR",e.DRM_FAILED_TO_GENERATE_REQUEST="DRM_FAILED_TO_GENERATE_REQUEST",e.DRM_UNKNOWN_ERROR="DRM_UNKNOWN_ERROR",e.NO_HLS_JS_INSTANCE="NO_HLS_JS_INSTANCE",e.AD_IS_ALREADY_PLAYING="AD_IS_ALREADY_PLAYING",e.META_INFO_REQUEST_FAILED="META_INFO_REQUEST_FAILED",e.MULTIROLL_INIT_ERROR="MULTIROLL_INIT_ERROR",e.REACT_COMPONENT_DID_CATCH_ERROR_INFO="REACT_COMPONENT_DID_CATCH_ERROR_INFO",e.PLAY_AD_VIEWERS_ERROR="PLAY_AD_VIEWERS_ERROR",e.SAGA_ERROR="SAGA_ERROR",e.STRM_ABD_INVALID_RESPONSE="STRM_ABD_INVALID_RESPONSE",e.REPRESENTATION_CHANGE="REPRESENTATION_CHANGE",e.RECOVER_TASK_ERROR="RECOVER_TASK_ERROR",e.PRELOAD_SOURCE_FAILED="PRELOAD_SOURCE_FAILED",e.REGIONAL_LIMITATION_MANIFEST="REGIONAL_LIMITATION_MANIFEST",e.REGIONAL_LIMITATION_LEVEL="REGIONAL_LIMITATION_LEVEL",e.REGIONAL_LIMITATION_SEGMENT="REGIONAL_LIMITATION_SEGMENT",e.SIGNATURE_EXPIRED_MANIFEST="SIGNATURE_EXPIRED_MANIFEST",e.SIGNATURE_EXPIRED_LEVEL="SIGNATURE_EXPIRED_LEVEL",e.SIGNATURE_EXPIRED_SEGMENT="SIGNATURE_EXPIRED_SEGMENT",e.BANNED_MANIFEST="BANNED_MANIFEST",e.BANNED_LEVEL="BANNED_LEVEL",e.BANNED_SEGMENT="BANNED_SEGMENT",e.MANIFEST_NOT_FOUND="MANIFEST_NOT_FOUND",e.NO_STREAMS="NO_STREAMS",e.NO_CODECS="NO_CODECS",e.NO_MSE="NO_MSE",e.NO_DRM_CONFIG="NO_DRM_CONFIG",e.NO_DRM="NO_DRM",e.NO_PLAYABLE_STREAMS="NO_PLAYABLE_STREAMS",e.MEDIA_ERR_CUSTOM="MEDIA_ERR_CUSTOM",e.MEDIA_ERR_ABORTED="MEDIA_ERR_ABORTED",e.MEDIA_ERR_NETWORK="MEDIA_ERR_NETWORK",e.MEDIA_ERR_DECODE="MEDIA_ERR_DECODE",e.MEDIA_ERR_SRC_NOT_SUPPORTED="MEDIA_ERR_SRC_NOT_SUPPORTED",e.MEDIA_ERR_ENCRYPTED="MEDIA_ERR_ENCRYPTED"}(Ga||(Ga={}));var Ka,za,Za=r(6878),Xa=r(9117),Qa=window.Map||function(){},Ja=window.Set||function(){},$a=function(e,t){return($a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},eo=function(){return(eo=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},to=function(){function e(e){this.promise=e}return e.prototype.then=function(t){return new e(this.promise.then(t))},e.all=function(t){return new e(Promise.all(t.map((function(t){return t instanceof e?t.promise:t}))))},e}();(za=Ka=Ka||{}).assertNever=function(e){throw new Error},za.arrayToEnum=function(e){var t,r,i={};try{for(var n=o(e),s=n.next();!s.done;s=n.next()){var a=s.value;i[a]=a}}catch(e){t={error:e}}finally{try{s&&!s.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}return i},za.getValidEnumValues=function(e){var t,r,i=za.objectKeys(e).filter((function(t){return"number"!=typeof e[e[t]]})),n={};try{for(var s=o(i),a=s.next();!a.done;a=s.next()){var l=a.value;n[l]=e[l]}}catch(r){t={error:r}}finally{try{a&&!a.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}return za.objectValues(n)},za.objectValues=function(e){return za.objectKeys(e).map((function(t){return e[t]}))},za.objectKeys="function"==typeof Object.keys?function(e){return Object.keys(e)}:function(e){var t,r=[];for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&r.push(t);return r},za.find=function(e,t){var r,i;try{for(var n=o(e),s=n.next();!s.done;s=n.next()){var a=s.value;if(t(a))return a}}catch(e){r={error:e}}finally{try{s&&!s.done&&(i=n.return)&&i.call(n)}finally{if(r)throw r.error}}},za.isInteger="function"==typeof Number.isInteger?function(e){return Number.isInteger(e)}:function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e};var ro,io,no=Ka.arrayToEnum(["invalid_type","custom","invalid_union","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types"]),so=function(e){function t(t){var r=this.constructor,i=e.call(this)||this;return i.issues=[],i.format=function(){var e={_errors:[]};return function t(r){var i,n;try{for(var s=o(r.issues),a=s.next();!a.done;a=s.next()){var l=a.value;if("invalid_union"===l.code)l.unionErrors.map(t);else if("invalid_return_type"===l.code)t(l.returnTypeError);else if("invalid_arguments"===l.code)t(l.argumentsError);else if(0===l.path.length)e._errors.push(l.message);else for(var d=e,u=0;u<l.path.length;){var c,h=l.path[u];u===l.path.length-1?(d[h]=d[h]||{_errors:[]},d[h]._errors.push(l.message)):"string"==typeof h?d[h]=d[h]||{_errors:[]}:"number"==typeof h&&((c=[])._errors=[],d[h]=d[h]||c),d=d[h],u++}}}catch(r){i={error:r}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}}(i),e},i.addIssue=function(e){i.issues=d(d([],l(i.issues)),[e])},i.addIssues=function(e){void 0===e&&(e=[]),i.issues=d(d([],l(i.issues)),l(e))},i.flatten=function(e){var t,r;void 0===e&&(e=function(e){return e.message});var n={},s=[];try{for(var a=o(i.issues),l=a.next();!l.done;l=a.next()){var d=l.value;0<d.path.length?(n[d.path[0]]=n[d.path[0]]||[],n[d.path[0]].push(e(d))):s.push(e(d))}}catch(e){t={error:e}}finally{try{l&&!l.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}return{formErrors:s,fieldErrors:n}},r=r.prototype,Object.setPrototypeOf?Object.setPrototypeOf(i,r):i.__proto__=r,i.name="ZodError",i.issues=t,i}return n(t,e),Object.defineProperty(t.prototype,"errors",{get:function(){return this.issues},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return this.message},Object.defineProperty(t.prototype,"message",{get:function(){return JSON.stringify(this.issues,null,2)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isEmpty",{get:function(){return 0===this.issues.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"formErrors",{get:function(){return this.flatten()},enumerable:!1,configurable:!0}),t.create=function(e){return new t(e)},t}(Error),ao=function(e,t){var r;switch(e.code){case no.invalid_type:r="undefined"===e.received?"Required":"Expected "+e.expected+", received "+e.received;break;case no.unrecognized_keys:r="Unrecognized key(s) in object: "+e.keys.map((function(e){return"'"+e+"'"})).join(", ");break;case no.invalid_union:r="Invalid input";break;case no.invalid_enum_value:r="Invalid enum value. Expected "+e.options.map((function(e){return"string"==typeof e?"'"+e+"'":e})).join(" | ")+", received "+("string"==typeof t.data?"'"+t.data+"'":t.data);break;case no.invalid_arguments:r="Invalid function arguments";break;case no.invalid_return_type:r="Invalid function return type";break;case no.invalid_date:r="Invalid date";break;case no.invalid_string:r="regex"!==e.validation?"Invalid "+e.validation:"Invalid";break;case no.too_small:r="array"===e.type?"Should have "+(e.inclusive?"at least":"more than")+" "+e.minimum+" items":"string"===e.type?"Should be "+(e.inclusive?"at least":"over")+" "+e.minimum+" characters":"number"===e.type?"Value should be greater than "+(e.inclusive?"or equal to ":"")+e.minimum:"Invalid input";break;case no.too_big:r="array"===e.type?"Should have "+(e.inclusive?"at most":"less than")+" "+e.maximum+" items":"string"===e.type?"Should be "+(e.inclusive?"at most":"under")+" "+e.maximum+" characters long":"number"===e.type?"Value should be less than "+(e.inclusive?"or equal to ":"")+e.maximum:"Invalid input";break;case no.custom:r="Invalid input";break;case no.invalid_intersection_types:r="Intersections only support objects";break;default:r=t.defaultError,Ka.assertNever(e)}return{message:r}},oo=ao,lo=Ka.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),uo=function(e){switch(typeof e){case"undefined":return lo.undefined;case"string":return lo.string;case"number":return isNaN(e)?lo.nan:lo.number;case"boolean":return lo.boolean;case"function":return lo.function;case"bigint":return lo.bigint;case"object":return Array.isArray(e)?lo.array:null===e?lo.null:e.then&&"function"==typeof e.then&&e.catch&&"function"==typeof e.catch?lo.promise:e instanceof Qa?lo.map:e instanceof Ja?lo.set:e instanceof Date?lo.date:lo.object;default:return lo.unknown}},co=function(e,t,r,i){var n=d(d([],l(t)),l(i.path||[])),s=eo(eo({},i),{path:n});t=ao(s,{data:e,defaultError:"Invalid input"});return eo(eo({},i),{path:n,message:i.message||r(s,{data:e,defaultError:t.message}).message})},ho=function(e){if(null===e)return[];for(var t=new Array(e.count);null!==e;)t[e.count-1]=e.component,e=e.parent;return t},po=function(e){for(var t=null,r=0;r<e.length;r++)t={parent:t,component:e[r],count:r+1};return t},fo=function(){function e(e,t,r){this.path=e,this.issues=t,this.params=r}return e.prototype.stepInto=function(t){return new e(null===this.path?{parent:null,count:1,component:t}:{parent:this.path,count:this.path.count+1,component:t},this.issues,this.params)},e.prototype.addIssue=function(e,t){t=co(e,ho(this.path),this.params.errorMap,t),this.issues.push(t)},e}(),mo=Object.freeze({valid:!1}),go=function(e){return{valid:!0,value:e}},vo=function(e){return new to(e)},yo=function(e){return!1===e.valid},So=function(e){return!0===e.valid},Eo=function(e){return e instanceof to};(io=ro=ro||{}).errToObj=function(e){return"string"==typeof e?{message:e}:e||{}},io.toString=function(e){return"string"==typeof e?e:null==e?void 0:e.message};var bo,Ao=function(e){return e.params.async?[]:null},To=function(e){var t;return new fo(po(e.path||[]),[],{async:null!==(t=e.async)&&void 0!==t&&t,errorMap:e.errorMap||oo})},_o=function(e,t,r){return So(t)?{success:!0,data:t.value}:(null!=r&&r.addIssues(e.issues),{success:!1,error:new so(e.issues)})},wo=function(){function e(e){var t=this;this.parse=function(e,r){if((r=t.safeParse(e,r)).success)return r.data;throw r.error},this.safeParse=function(e,r){var i=To(eo(eo({},r),{async:!1}));e=t._parseSync(i,e,uo(e));return _o(i,e,null==r?void 0:r.parentError)},this.parseAsync=function(e,r){return s(t,void 0,void 0,(function(){var t;return a(this,(function(i){switch(i.label){case 0:return[4,this.safeParseAsync(e,r)];case 1:if((t=i.sent()).success)return[2,t.data];throw t.error}}))}))},this.safeParseAsync=function(e,r){return s(t,void 0,void 0,(function(){var t,i;return a(this,(function(n){switch(n.label){case 0:return t=To(eo(eo({},r),{async:!0})),i=this._parse(t,e,uo(e)),[4,Eo(i)?i.promise:Promise.resolve(i)];case 1:return i=n.sent(),[2,_o(t,i,null==r?void 0:r.parentError)]}}))}))},this.spa=this.safeParseAsync,this.refine=function(e,r){return t._refinement((function(t,i){function n(){return i.addIssue(eo({code:no.custom},"string"==typeof r||void 0===r?{message:r}:"function"==typeof r?r(t):r))}var s=e(t);return s instanceof Promise?s.then((function(e){return!!e||(n(),!1)})):!!s||(n(),!1)}))},this.refinement=function(e,r){return t._refinement((function(t,i){return!!e(t)||(i.addIssue("function"==typeof r?r(t,i):r),!1)}))},this.superRefine=this._refinement,this.optional=function(){return il.create(t)},this.nullable=function(){return nl.create(t)},this.nullish=function(){return t.optional().nullable()},this.array=function(){return Uo.create(t)},this.promise=function(){return tl.create(t)},this.isOptional=function(){return t.safeParse(void 0).success},this.isNullable=function(){return t.safeParse(null).success},this._def=e,this.transform=this.transform.bind(this),this.default=this.default.bind(this)}return e.prototype._parseSync=function(e,t,r){if(r=this._parse(e,t,r),Eo(r))throw new Error("Synchronous parse encountered promise.");return r},e.prototype._refinement=function(e){return e=new rl(this instanceof rl?eo(eo({},this._def),{effects:d(d([],l(this._def.effects||[])),[{type:"refinement",refinement:e}])}):{schema:this,typeName:jo.ZodEffects,effects:[{type:"refinement",refinement:e}]})},e.prototype.or=function(e){return qo.create([this,e])},e.prototype.and=function(e){return Yo.create(this,e)},e.prototype.transform=function(e){return new rl({schema:this,typeName:jo.ZodEffects,effects:[{type:"transform",transform:e}]})},e.prototype.default=function(e){return new sl({innerType:this,defaultValue:"function"==typeof e?e:function(){return e},typeName:jo.ZodDefault})},e}(),ko=/^([a-f0-9]{8}-[a-f0-9]{4}-[1-5][a-f0-9]{3}-[89ab][a-f0-9]{3}-[a-f0-9]{12}|00000000-0000-0000-0000-000000000000)$/i,Ro=/^(([^<>()[\]\.,;:\s@\"]+(\.[^<>()[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i,Po=function(e){function t(){var r=null!==e&&e.apply(this,arguments)||this;return r._regex=function(e,t,i){return r.refinement((function(t){return e.test(t)}),eo({validation:t,code:no.invalid_string},ro.errToObj(i)))},r.email=function(e){return new t(eo(eo({},r._def),{checks:d(d([],l(r._def.checks)),[eo({kind:"email"},ro.errToObj(e))])}))},r.url=function(e){return new t(eo(eo({},r._def),{checks:d(d([],l(r._def.checks)),[eo({kind:"url"},ro.errToObj(e))])}))},r.uuid=function(e){return new t(eo(eo({},r._def),{checks:d(d([],l(r._def.checks)),[eo({kind:"uuid"},ro.errToObj(e))])}))},r.regex=function(e,i){return new t(eo(eo({},r._def),{checks:d(d([],l(r._def.checks)),[eo({kind:"regex",regex:e},ro.errToObj(i))])}))},r.min=function(e,i){return new t(eo(eo({},r._def),{checks:d(d([],l(r._def.checks)),[eo({kind:"min",value:e},ro.errToObj(i))])}))},r.max=function(e,i){return new t(eo(eo({},r._def),{checks:d(d([],l(r._def.checks)),[eo({kind:"max",value:e},ro.errToObj(i))])}))},r.nonempty=function(e){return r.min(1,ro.errToObj(e))},r}return n(t,e),t.prototype._parse=function(e,t,r){var i,n;if(r!==lo.string)return e.addIssue(t,{code:no.invalid_type,expected:lo.string,received:r}),mo;var s=!1;try{for(var a=o(this._def.checks),l=a.next();!l.done;l=a.next()){var d=l.value;if("min"===d.kind)t.length<d.value&&(s=!0,e.addIssue(t,{code:no.too_small,minimum:d.value,type:"string",inclusive:!0,message:d.message}));else if("max"===d.kind)t.length>d.value&&(s=!0,e.addIssue(t,{code:no.too_big,maximum:d.value,type:"string",inclusive:!0,message:d.message}));else if("email"===d.kind)Ro.test(t)||(s=!0,e.addIssue(t,{validation:"email",code:no.invalid_string,message:d.message}));else if("uuid"===d.kind)ko.test(t)||(s=!0,e.addIssue(t,{validation:"uuid",code:no.invalid_string,message:d.message}));else if("url"===d.kind)try{new URL(t)}catch(r){s=!0,e.addIssue(t,{validation:"url",code:no.invalid_string,message:d.message})}else"regex"===d.kind&&(d.regex.test(t)||(s=!0,e.addIssue(t,{validation:"regex",code:no.invalid_string,message:d.message})))}}catch(r){i={error:r}}finally{try{l&&!l.done&&(n=a.return)&&n.call(a)}finally{if(i)throw i.error}}return s?mo:go(t)},t.prototype.length=function(e,t){return this.min(e,t).max(e,t)},Object.defineProperty(t.prototype,"isEmail",{get:function(){return!!this._def.checks.find((function(e){return"email"===e.kind}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isURL",{get:function(){return!!this._def.checks.find((function(e){return"url"===e.kind}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isUUID",{get:function(){return!!this._def.checks.find((function(e){return"uuid"===e.kind}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"minLength",{get:function(){var e=-1/0;return this._def.checks.map((function(t){"min"===t.kind&&(null===e||t.value>e)&&(e=t.value)})),e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxLength",{get:function(){var e=null;return this._def.checks.map((function(t){"max"===t.kind&&(null===e||t.value<e)&&(e=t.value)})),e},enumerable:!1,configurable:!0}),t.create=function(){return new t({checks:[],typeName:jo.ZodString})},t}(wo),Co=function(e){function t(){var r=null!==e&&e.apply(this,arguments)||this;return r.gte=function(e,t){return r.setLimit("min",e,!0,ro.toString(t))},r.min=r.gte,r.gt=function(e,t){return r.setLimit("min",e,!1,ro.toString(t))},r.lte=function(e,t){return r.setLimit("max",e,!0,ro.toString(t))},r.max=r.lte,r.lt=function(e,t){return r.setLimit("max",e,!1,ro.toString(t))},r.setLimit=function(e,i,n,s){return new t(eo(eo({},r._def),{checks:d(d([],l(r._def.checks)),[{kind:e,value:i,inclusive:n,message:ro.toString(s)}])}))},r.int=function(e){return new t(eo(eo({},r._def),{checks:d(d([],l(r._def.checks)),[{kind:"int",message:ro.toString(e)}])}))},r.positive=function(e){return new t(eo(eo({},r._def),{checks:d(d([],l(r._def.checks)),[{kind:"min",value:0,inclusive:!1,message:ro.toString(e)}])}))},r.negative=function(e){return new t(eo(eo({},r._def),{checks:d(d([],l(r._def.checks)),[{kind:"max",value:0,inclusive:!1,message:ro.toString(e)}])}))},r.nonpositive=function(e){return new t(eo(eo({},r._def),{checks:d(d([],l(r._def.checks)),[{kind:"max",value:0,inclusive:!0,message:ro.toString(e)}])}))},r.nonnegative=function(e){return new t(eo(eo({},r._def),{checks:d(d([],l(r._def.checks)),[{kind:"min",value:0,inclusive:!0,message:ro.toString(e)}])}))},r}return n(t,e),t.prototype._parse=function(e,t,r){var i,n;if(r!==lo.number)return e.addIssue(t,{code:no.invalid_type,expected:lo.number,received:r}),mo;var s=!1;try{for(var a=o(this._def.checks),l=a.next();!l.done;l=a.next()){var d=l.value;"int"===d.kind?Ka.isInteger(t)||(s=!0,e.addIssue(t,{code:no.invalid_type,expected:"integer",received:"float",message:d.message})):"min"===d.kind?(d.inclusive?t<d.value:t<=d.value)&&(s=!0,e.addIssue(t,{code:no.too_small,minimum:d.value,type:"number",inclusive:d.inclusive,message:d.message})):"max"===d.kind&&(d.inclusive?t>d.value:t>=d.value)&&(s=!0,e.addIssue(t,{code:no.too_big,maximum:d.value,type:"number",inclusive:d.inclusive,message:d.message}))}}catch(e){i={error:e}}finally{try{l&&!l.done&&(n=a.return)&&n.call(a)}finally{if(i)throw i.error}}return s?mo:go(t)},Object.defineProperty(t.prototype,"minValue",{get:function(){var e,t,r=null;try{for(var i=o(this._def.checks),n=i.next();!n.done;n=i.next()){var s=n.value;"min"===s.kind&&(null===r||s.value>r)&&(r=s.value)}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}return r},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxValue",{get:function(){var e,t,r=null;try{for(var i=o(this._def.checks),n=i.next();!n.done;n=i.next()){var s=n.value;"max"===s.kind&&(null===r||s.value<r)&&(r=s.value)}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}return r},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isInt",{get:function(){return!!this._def.checks.find((function(e){return"int"===e.kind}))},enumerable:!1,configurable:!0}),t.create=function(){return new t({checks:[],typeName:jo.ZodNumber})},t}(wo),Io=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype._parse=function(e,t,r){return r!==lo.bigint?(e.addIssue(t,{code:no.invalid_type,expected:lo.bigint,received:r}),mo):go(t)},t.create=function(){return new t({typeName:jo.ZodBigInt})},t}(wo),Oo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype._parse=function(e,t,r){return r!==lo.boolean?(e.addIssue(t,{code:no.invalid_type,expected:lo.boolean,received:r}),mo):go(t)},t.create=function(){return new t({typeName:jo.ZodBoolean})},t}(wo),Do=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype._parse=function(e,t,r){return r!==lo.date?(e.addIssue(t,{code:no.invalid_type,expected:lo.date,received:r}),mo):isNaN(t.getTime())?(e.addIssue(t,{code:no.invalid_date}),mo):go(new Date(t.getTime()))},t.create=function(){return new t({typeName:jo.ZodDate})},t}(wo),No=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype._parse=function(e,t,r){return r!==lo.undefined?(e.addIssue(t,{code:no.invalid_type,expected:lo.undefined,received:r}),mo):go(t)},t.create=function(){return new t({typeName:jo.ZodUndefined})},t}(wo),Lo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype._parse=function(e,t,r){return r!==lo.null?(e.addIssue(t,{code:no.invalid_type,expected:lo.null,received:r}),mo):go(t)},t.create=function(){return new t({typeName:jo.ZodNull})},t}(wo),xo=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._any=!0,t}return n(t,e),t.prototype._parse=function(e,t,r){return go(t)},t.create=function(){return new t({typeName:jo.ZodAny})},t}(wo),Mo=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._unknown=!0,t}return n(t,e),t.prototype._parse=function(e,t,r){return go(t)},t.create=function(){return new t({typeName:jo.ZodUnknown})},t}(wo),Fo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype._parse=function(e,t,r){return e.addIssue(t,{code:no.invalid_type,expected:lo.never,received:r}),mo},t.create=function(){return new t({typeName:jo.ZodNever})},t}(wo),Vo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype._parse=function(e,t,r){return r!==lo.undefined?(e.addIssue(t,{code:no.invalid_type,expected:lo.void,received:r}),mo):go(t)},t.create=function(){return new t({typeName:jo.ZodVoid})},t}(wo),Bo=function(e,t,r,i){if(r!==lo.array)return e.addIssue(t,{code:no.invalid_type,expected:lo.array,received:r}),mo;var n=!1;null!==i.minLength&&t.length<i.minLength.value&&(n=!0,e.addIssue(t,{code:no.too_small,minimum:i.minLength.value,type:"array",inclusive:!0,message:i.minLength.message})),null!==i.maxLength&&t.length>i.maxLength.value&&(n=!0,e.addIssue(t,{code:no.too_big,maximum:i.maxLength.value,type:"array",inclusive:!0,message:i.maxLength.message}));var s=Ao(e),a=new Array(t.length),o=i.type;return t.forEach((function(t,r){!function e(t,r){So(r)?a[t]=r.value:yo(r)?n=!0:null!=s&&s.push(r.promise.then((function(r){return e(t,r)})))}(r,o._parse(e.stepInto(r),t,uo(t)))})),null!==s&&0<s.length?vo(Promise.all(s).then((function(){return n?mo:go(a)}))):n?mo:go(a)},Uo=function(e){function t(){var r=null!==e&&e.apply(this,arguments)||this;return r.min=function(e,i){return new t(eo(eo({},r._def),{minLength:{value:e,message:ro.toString(i)}}))},r.max=function(e,i){return new t(eo(eo({},r._def),{maxLength:{value:e,message:ro.toString(i)}}))},r.length=function(e,t){return r.min(e,t).max(e,t)},r.nonempty=function(e){return r.min(1,e)},r}return n(t,e),t.prototype._parse=function(e,t,r){return Bo(e,t,r,this._def)},Object.defineProperty(t.prototype,"element",{get:function(){return this._def.type},enumerable:!1,configurable:!0}),t.create=function(e){return new t({type:e,minLength:null,maxLength:null,typeName:jo.ZodArray})},t}(wo);!function(e){e.mergeShapes=function(e,t){return eo(eo({},e),t)},e.intersectShapes=function(e,t){var r,i,n=Ka.objectKeys(e),s=Ka.objectKeys(t),a=(n=n.filter((function(e){return-1!==s.indexOf(e)})),{});try{for(var l=o(n),d=l.next();!d.done;d=l.next()){var u=d.value;a[u]=Yo.create(e[u],t[u])}}catch(e){r={error:e}}finally{try{d&&!d.done&&(i=l.return)&&i.call(l)}finally{if(r)throw r.error}}return eo(eo(eo({},e),t),a)}}(bo=bo||{});var jo,Ho=function(e){return function(t){return new Wo(eo(eo({},e),{shape:function(){return eo(eo({},e.shape()),t)}}))}},Wo=function(e){function t(){var r=null!==e&&e.apply(this,arguments)||this;return r._cached=null,r.strict=function(){return new t(eo(eo({},r._def),{unknownKeys:"strict"}))},r.strip=function(){return new t(eo(eo({},r._def),{unknownKeys:"strip"}))},r.passthrough=function(){return new t(eo(eo({},r._def),{unknownKeys:"passthrough"}))},r.nonstrict=r.passthrough,r.augment=Ho(r._def),r.extend=Ho(r._def),r.setKey=function(e,t){var i;return r.augment(((i={})[e]=t,i))},r.merge=function(e){var i=bo.mergeShapes(r._def.shape(),e._def.shape());return new t({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:function(){return i},typeName:jo.ZodObject})},r.catchall=function(e){return new t(eo(eo({},r._def),{catchall:e}))},r.pick=function(e){var i={};return Ka.objectKeys(e).map((function(e){i[e]=r.shape[e]})),new t(eo(eo({},r._def),{shape:function(){return i}}))},r.omit=function(e){var i={};return Ka.objectKeys(r.shape).map((function(t){-1===Ka.objectKeys(e).indexOf(t)&&(i[t]=r.shape[t])})),new t(eo(eo({},r._def),{shape:function(){return i}}))},r.partial=function(){var e,i={};for(e in r.shape){var n=r.shape[e];i[e]=n.isOptional()?n:n.optional()}return new t(eo(eo({},r._def),{shape:function(){return i}}))},r.deepPartial=function(){var e,i={};for(e in r.shape){var n=r.shape[e];i[e]=n instanceof t?n.isOptional()?n:n.deepPartial().optional():n.isOptional()?n:n.optional()}return new t(eo(eo({},r._def),{shape:function(){return i}}))},r.required=function(){var e,i={};for(e in r.shape){for(var n=r.shape[e];n instanceof il;)n=n._def.innerType;i[e]=n}return new t(eo(eo({},r._def),{shape:function(){return i}}))},r}return n(t,e),t.prototype._getCached=function(){if(null!==this._cached)return this._cached;var e=this._def.shape(),t=Ka.objectKeys(e);return this._cached={shape:e,keys:t}},t.prototype._parse=function(e,t,r){var i,n,s,a,l;if(r!==lo.object)return e.addIssue(t,{code:no.invalid_type,expected:lo.object,received:r}),mo;var d=(r=this._getCached()).shape,u=(r=r.keys,!1),c=Ao(e),h={},p=function e(r,i){var n;So(i)?(void 0!==(n=i.value)||r in t)&&(h[r]=n):yo(i)?u=!0:null!=c&&c.push(i.promise.then((function(t){return e(r,t)})))};try{for(var f=o(r),m=f.next();!m.done;m=f.next()){var g=m.value,v=d[g],y=t[g];p(g,v._parse(e.stepInto(g),y,uo(y)))}}catch(e){S={error:e}}finally{try{m&&!m.done&&(i=f.return)&&i.call(f)}finally{if(S)throw S.error}}if(this._def.catchall instanceof Fo){var S=this._def.unknownKeys;if("passthrough"===S){var E=Ka.objectKeys(t).filter((function(e){return!(e in d)}));try{for(var b=o(E),A=b.next();!A.done;A=b.next())g=A.value,h[g]=t[g]}catch(e){n={error:e}}finally{try{A&&!A.done&&(s=b.return)&&s.call(b)}finally{if(n)throw n.error}}}else if("strict"===S)0<(E=Ka.objectKeys(t).filter((function(e){return!(e in d)}))).length&&(u=!0,e.addIssue(t,{code:no.unrecognized_keys,keys:E}));else if("strip"!==S)throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{var T=this._def.catchall;E=Ka.objectKeys(t).filter((function(e){return!(e in d)}));try{for(var _=o(E),w=_.next();!w.done;w=_.next())g=w.value,y=t[g],p(g,T._parse(e.stepInto(g),y,uo(y)))}catch(e){a={error:e}}finally{try{w&&!w.done&&(l=_.return)&&l.call(_)}finally{if(a)throw a.error}}}return null!==c&&0<c.length?vo(Promise.all(c).then((function(){return u?mo:go(h)}))):u?mo:go(h)},Object.defineProperty(t.prototype,"shape",{get:function(){return this._def.shape()},enumerable:!1,configurable:!0}),t.create=function(e){return new t({shape:function(){return e},unknownKeys:"strip",catchall:Fo.create(),typeName:jo.ZodObject})},t.strictCreate=function(e){return new t({shape:function(){return e},unknownKeys:"strict",catchall:Fo.create(),typeName:jo.ZodObject})},t.lazycreate=function(e){return new t({shape:e,unknownKeys:"strip",catchall:Fo.create(),typeName:jo.ZodObject})},t}(wo),qo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype._parse=function(e,t,r){function i(r){var i=r.map((function(e){return new so(e)}));return 1===(r=i.filter((function(e){return"invalid_type"!==e.issues[0].code}))).length?r[0].issues.forEach((function(t){return e.issues.push(t)})):e.addIssue(t,{code:no.invalid_union,unionErrors:i}),mo}var n,s,a=this._def.options;if(e.params.async){var l=a.map((function(){return new fo(e.path,[],e.params)}));return to.all(a.map((function(e,i){return e._parse(l[i],t,r)}))).then((function(e){var t,r;try{for(var n=o(e),s=n.next();!s.done;s=n.next()){var a=s.value;if(So(a))return a}}catch(e){t={error:e}}finally{try{s&&!s.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}return i(l.map((function(e){return e.issues})))}))}var d=[];try{for(var u=o(a),c=u.next();!c.done;c=u.next()){var h=c.value,p=new fo(e.path,[],e.params),f=h._parseSync(p,t,r);if(!yo(f))return f;d.push(p.issues)}}catch(s){n={error:s}}finally{try{c&&!c.done&&(s=u.return)&&s.call(u)}finally{if(n)throw n.error}}return i(d)},Object.defineProperty(t.prototype,"options",{get:function(){return this._def.options},enumerable:!1,configurable:!0}),t.create=function(e){return new t({options:e,typeName:jo.ZodUnion})},t}(wo),Yo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype._parse=function(e,t,r){function i(r,i){return yo(r)||yo(i)?mo:(i=function e(t,r){var i,n,s=uo(t),a=uo(r);if(t===r)return{valid:!0,data:t};if(s!==lo.object||a!==lo.object)return{valid:!1};var l=Ka.objectKeys(r),d=(a=Ka.objectKeys(t).filter((function(e){return-1!==l.indexOf(e)})),eo(eo({},t),r));try{for(var u=o(a),c=u.next();!c.done;c=u.next()){var h=c.value,p=e(t[h],r[h]);if(!p.valid)return{valid:!1};d[h]=p.data}}catch(t){i={error:t}}finally{try{c&&!c.done&&(n=u.return)&&n.call(u)}finally{if(i)throw i.error}}return{valid:!0,data:d}}(r.value,i.value)).valid?go(i.data):(e.addIssue(t,{code:no.invalid_intersection_types}),mo)}return e.params.async?to.all([this._def.left._parse(e,t,r),this._def.right._parse(e,t,r)]).then((function(e){var t;return i(e=(t=l(e,2))[0],t=t[1])})):i(this._def.left._parseSync(e,t,r),this._def.right._parseSync(e,t,r))},t.create=function(e,r){return new t({left:e,right:r,typeName:jo.ZodIntersection})},t}(wo),Go=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype._parse=function(e,t,r){if(r!==lo.array)return e.addIssue(t,{code:no.invalid_type,expected:lo.array,received:r}),mo;if(t.length>this._def.items.length)return e.addIssue(t,{code:no.too_big,maximum:this._def.items.length,inclusive:!0,type:"array"}),mo;if(t.length<this._def.items.length)return e.addIssue(t,{code:no.too_small,minimum:this._def.items.length,inclusive:!0,type:"array"}),mo;var i=Ao(e),n=(r=this._def.items,new Array(r.length)),s=!1;return r.forEach((function(r,a){!function e(t,r){So(r)?n[t]=r.value:yo(r)?s=!0:null!=i&&i.push(r.promise.then((function(r){return e(t,r)})))}(a,r._parse(e.stepInto(a),t[a],uo(t[a])))})),null!==i&&0<i.length?vo(Promise.all(i).then((function(){return s?mo:go(n)}))):s?mo:go(n)},Object.defineProperty(t.prototype,"items",{get:function(){return this._def.items},enumerable:!1,configurable:!0}),t.create=function(e){return new t({items:e,typeName:jo.ZodTuple})},t}(wo),Ko=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype._parse=function(e,t,r){if(r!==lo.object)return e.addIssue(t,{code:no.invalid_type,expected:lo.object,received:r}),mo;var i,n=Ao(e),s=this._def.valueType,a={},o=!1,l=function e(t,r){So(r)?a[t]=r.value:yo(r)?o=!0:null!=n&&n.push(r.promise.then((function(r){return e(t,r)})))};for(i in t)l(i,s._parse(e.stepInto(i),t[i],uo(t[i])));return null!==n&&0<n.length?vo(Promise.all(n).then((function(){return o?mo:go(a)}))):o?mo:go(a)},t.create=function(e){return new t({valueType:e,typeName:jo.ZodRecord})},t}(wo),zo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype._parse=function(e,t,r){if(r!==lo.map)return e.addIssue(t,{code:no.invalid_type,expected:lo.map,received:r}),mo;var i=this._def.keyType,n=this._def.valueType,s=(t=t,new Qa),a=Ao(e),o=!1,u=function e(t,r){Eo(t)||Eo(r)?null!=a&&a.push(to.all([t,r]).promise.then((function(t){t=(r=l(t,2))[0];var r=r[1];return e(t,r)}))):yo(t)||yo(r)?o=!0:s.set(t.value,r.value)};return d([],l(t.entries())).forEach((function(t,r){t=(s=l(t,2))[0];var s=s[1];r=e.stepInto(r),t=i._parse(r.stepInto("key"),t,uo(t)),s=n._parse(r.stepInto("value"),s,uo(s));u(t,s)})),null!==a&&0<a.length?vo(Promise.all(a).then((function(){return o?mo:go(s)}))):o?mo:go(s)},t.create=function(e,r){return new t({valueType:r,keyType:e,typeName:jo.ZodMap})},t}(wo),Zo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype._parse=function(e,t,r){if(r!==lo.set)return e.addIssue(t,{code:no.invalid_type,expected:lo.set,received:r}),mo;t=t;var i=this._def.valueType,n=new Ja,s=Ao(e),a=!1;return d([],l(t.values())).forEach((function(t,r){return function e(t){So(t)?n.add(t.value):yo(t)?a=!0:null!=s&&s.push(t.promise.then((function(t){return e(t)})))}(i._parse(e.stepInto(r),t,uo(t)))})),null!==s&&0<s.length?vo(Promise.all(s).then((function(){return a?mo:go(n)}))):a?mo:go(n)},t.create=function(e){return new t({valueType:e,typeName:jo.ZodSet})},t}(wo),Xo=function(e){function t(){var r=null!==e&&e.apply(this,arguments)||this;return r.args=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];return new t(eo(eo({},r._def),{args:Go.create(e)}))},r.returns=function(e){return new t(eo(eo({},r._def),{returns:e}))},r.implement=function(e){return r.parse(e)},r.strictImplement=function(e){return r.parse(e)},r.validate=r.implement,r}return n(t,e),t.prototype._parse=function(e,t,r){function i(t,r){if(r.success)return r.data;throw r=co(t,ho(e.path),e.params.errorMap,{code:no.invalid_arguments,argumentsError:r.error}),new so([r])}function n(t,r){if(r.success)return r.data;throw r=co(t,ho(e.path),e.params.errorMap,{code:no.invalid_return_type,returnTypeError:r.error}),new so([r])}var o=this;if(r!==lo.function)return e.addIssue(t,{code:no.invalid_type,expected:lo.function,received:r}),mo;var u={errorMap:e.params.errorMap},c=t;return this._def.returns instanceof tl?go((function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return s(o,void 0,void 0,(function(){var t,r,s,o,h;return a(this,(function(a){switch(a.label){case 0:return t=i,r=[e],[4,this._def.args.spa(e,u)];case 1:return s=t.apply(void 0,r.concat([a.sent()])),[4,c.apply(void 0,d([],l(s)))];case 2:return s=a.sent(),o=n,h=[s],[4,this._def.returns.spa(s,u)];case 3:return[2,o.apply(void 0,h.concat([a.sent()]))]}}))}))})):go((function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=i(e,o._def.args.safeParse(e,u));return n(r=c.apply(void 0,d([],l(r))),o._def.returns.safeParse(r,u))}))},t.prototype.parameters=function(){return this._def.args},t.prototype.returnType=function(){return this._def.returns},t.create=function(e,r){return new t({args:e||Go.create([]),returns:r||Mo.create(),typeName:jo.ZodFunction})},t}(wo),Qo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),Object.defineProperty(t.prototype,"schema",{get:function(){return this._def.getter()},enumerable:!1,configurable:!0}),t.prototype._parse=function(e,t,r){return this._def.getter()._parse(e,t,r)},t.create=function(e){return new t({getter:e,typeName:jo.ZodLazy})},t}(wo),Jo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype._parse=function(e,t,r){return t!==this._def.value?(e.addIssue(t,{code:no.invalid_type,expected:this._def.value,received:t}),mo):go(t)},Object.defineProperty(t.prototype,"value",{get:function(){return this._def.value},enumerable:!1,configurable:!0}),t.create=function(e){return new t({value:e,typeName:jo.ZodLiteral})},t}(wo),$o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype._parse=function(e,t,r){return-1===this._def.values.indexOf(t)?(e.addIssue(t,{code:no.invalid_enum_value,options:this._def.values}),mo):go(t)},Object.defineProperty(t.prototype,"options",{get:function(){return this._def.values},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"enum",{get:function(){var e,t,r={};try{for(var i=o(this._def.values),n=i.next();!n.done;n=i.next()){var s=n.value;r[s]=s}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}return r},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Values",{get:function(){var e,t,r={};try{for(var i=o(this._def.values),n=i.next();!n.done;n=i.next()){var s=n.value;r[s]=s}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}return r},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Enum",{get:function(){var e,t,r={};try{for(var i=o(this._def.values),n=i.next();!n.done;n=i.next()){var s=n.value;r[s]=s}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}return r},enumerable:!1,configurable:!0}),t.create=u,t}(wo),el=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype._parse=function(e,t,r){var i=Ka.getValidEnumValues(this._def.values);return-1===i.indexOf(t)?(e.addIssue(t,{code:no.invalid_enum_value,options:Ka.objectValues(i)}),mo):go(t)},t.create=function(e){return new t({values:e,typeName:jo.ZodNativeEnum})},t}(wo),tl=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype._parse=function(e,t,r){var i=this;return r!==lo.promise&&!1===e.params.async?(e.addIssue(t,{code:no.invalid_type,expected:lo.promise,received:r}),mo):(t=r===lo.promise?t:Promise.resolve(t),go(t.then((function(t){return i._def.type.parseAsync(t,{path:ho(e.path),errorMap:e.params.errorMap})}))))},t.create=function(e){return new t({type:e,typeName:jo.ZodPromise})},t}(wo),rl=function(e){function t(t){return e.call(this,t)||this}return n(t,e),t.prototype.innerType=function(){return this._def.schema},t.prototype._parse=function(e,t,r){function i(e,t){switch(t.type){case"refinement":var r=t.refinement(e,o);if(r instanceof Promise){if(s)throw new Error("You can't use .parse() on a schema containing async refinements. Use .parseAsync instead.");return r.then((function(t){var r=o.issueFound;return l=l||r,e}))}return r=o.issueFound,l=l||r,e;case"transform":if((r=t.transform(e))instanceof Promise&&s)throw new Error("You can't use .parse() on a schema containing async transformations. Use .parseAsync instead.");return r;default:throw new Error("Invalid effect type.")}}function n(e){return(e=a.reduce((function(e,t){return e instanceof Promise?e.then((function(e){return i(e,t)})):i(e,t)}),e))instanceof Promise?vo(e.then((function(e){return l?mo:go(e)}))):l?mo:go(e)}var s=!1===e.params.async,a=this._def.effects||[],o={issueFound:!1,addIssue:function(r){this.issueFound=!0,e.addIssue(t,r)},get path(){return ho(e.path)}},l=!1;if(s){var d=this._def.schema._parseSync(e,t,r);return So(d)?(d=a.reduce(i,d.value),l?mo:go(d)):mo}return r=this._def.schema._parse(e,t,r),So(r)?n(r.value):yo(r)?mo:vo(r.promise.then((function(e){return yo(e)?mo:(e=n(e.value),Eo(e)?e.promise:e)})))},t.create=function(e){return new t({schema:e,typeName:jo.ZodEffects})},t}(wo),il=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype._parse=function(e,t,r){return r===lo.undefined?go(void 0):this._def.innerType._parse(e,t,r)},t.prototype.unwrap=function(){return this._def.innerType},t.create=function(e){return new t({innerType:e,typeName:jo.ZodOptional})},t}(wo),nl=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype._parse=function(e,t,r){return r===lo.null?go(null):this._def.innerType._parse(e,t,r)},t.prototype.unwrap=function(){return this._def.innerType},t.create=function(e){return new t({innerType:e,typeName:jo.ZodNullable})},t}(wo),sl=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype._parse=function(e,t,r){return r===lo.undefined&&(t=this._def.defaultValue()),this._def.innerType._parse(e,t,uo(t))},t.prototype.removeDefault=function(){return this._def.innerType},t.create=function(e){return new il({innerType:e,typeName:jo.ZodOptional})},t}(wo),al=function(e,t){return e?xo.create().refine(e,t):xo.create()},ol={object:Wo.lazycreate};!function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodPromise="ZodPromise"}(jo=jo||{});var ll=Po.create,dl=Co.create,ul=Io.create,cl=Oo.create,hl=Do.create,pl=No.create,fl=Lo.create,ml=xo.create,gl=Mo.create,vl=Fo.create,yl=Vo.create,Sl=Uo.create,El=Wo.create,bl=Wo.strictCreate,Al=qo.create,Tl=Yo.create,_l=Go.create,wl=Ko.create,kl=zo.create,Rl=Zo.create,Pl=Xo.create,Cl=Qo.create,Il=Jo.create,Ol=$o.create,Dl=el.create,Nl=tl.create,Ll=rl.create,xl=il.create,Ml=nl.create;Object.freeze({__proto__:null,ZodParsedType:lo,getParsedType:uo,makeIssue:co,EMPTY_PATH:null,pathToArray:ho,pathFromArray:po,ParseContext:fo,createRootContext:function(e){var t;return new fo(null,[],{async:null!==(t=e.async)&&void 0!==t&&t,errorMap:e.errorMap||oo})},INVALID:mo,OK:go,ASYNC:vo,isInvalid:yo,isOk:So,isAsync:Eo,ZodType:wo,ZodString:Po,ZodNumber:Co,ZodBigInt:Io,ZodBoolean:Oo,ZodDate:Do,ZodUndefined:No,ZodNull:Lo,ZodAny:xo,ZodUnknown:Mo,ZodNever:Fo,ZodVoid:Vo,ZodArray:Uo,get objectUtil(){return bo},mergeObjects:function(e){return function(t){var r=bo.mergeShapes(e._def.shape(),t._def.shape());return new Wo({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:function(){return r},typeName:jo.ZodObject})}},ZodObject:Wo,ZodUnion:qo,ZodIntersection:Yo,ZodTuple:Go,ZodRecord:Ko,ZodMap:zo,ZodSet:Zo,ZodFunction:Xo,ZodLazy:Qo,ZodLiteral:Jo,ZodEnum:$o,ZodNativeEnum:el,ZodPromise:tl,ZodEffects:rl,ZodTransformer:rl,ZodOptional:il,ZodNullable:nl,ZodDefault:sl,custom:al,Schema:wo,ZodSchema:wo,late:ol,get ZodFirstPartyTypeKind(){return jo},any:ml,array:Sl,bigint:ul,boolean:cl,date:hl,effect:Ll,enum:Ol,function:Pl,instanceof:function(e,t){return void 0===t&&(t={message:"Input not instance of "+e.name}),al((function(t){return t instanceof e}),t)},intersection:Tl,lazy:Cl,literal:Il,map:kl,nativeEnum:Dl,never:vl,null:fl,nullable:Ml,number:dl,object:El,oboolean:function(){return cl().optional()},onumber:function(){return dl().optional()},optional:xl,ostring:function(){return ll().optional()},promise:Nl,record:wl,set:Rl,strictObject:bl,string:ll,transformer:Ll,tuple:_l,undefined:pl,union:Al,unknown:gl,void:yl,ZodIssueCode:no,quotelessJson:function(e){return JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:")},ZodError:so,defaultErrorMap:ao,get overrideErrorMap(){return oo},setErrorMap:function(e){oo=e}});class Fl extends Error{constructor(e,t){const r="object"===typeof e?e:{message:String(e),code:0};super(r.message||String(r.code)),this.message=void 0,this.messageDetails=void 0,this.code=void 0,this.category=void 0,this.isFatal=void 0,this.details=void 0,this.stack=void 0,this.vsid=void 0,this.helpLink=void 0,Ha()(this,Fl.prototype),this.message=r.message||String(r.code)||this.message,this.messageDetails=r.messageDetails,this.code=r.code;const n=i(this.code);if(this.category=null!=r&&r.category&&n===Ya.q.DEFAULT?r.category:n,this.details=r.details,this.isFatal=void 0===r.isFatal||r.isFatal,this.stack=r.stack&&"?:?:?"!==r.stack?r.stack:this.details&&this.details.stack||((e,t)=>{const{url:r,line:i,col:n,fileName:s,columnNumber:a,lineNumber:o}=e;return String(t||(r||s||"?")+":"+(i||o||"?")+":"+(n||a||"?"))})(r,this.stack),!this.stack||this.stack===Ua.J.stack)try{throw new Error(this.message)}catch(io){(0,Za.K)(io)&&(this.stack=io.stack||Ua.J.stack)}this.helpLink=r.helpLink||void 0,this.vsid=t||r.vsid}static from(e,t){var r,i;void 0===t&&(t={});const n=null!=(r=null!=(i=t.code)?i:(0,Wa.Y)(()=>e.code))?r:0;return e instanceof Fl?t?new Fl(c({},e,t,{code:n})):e:e instanceof so?new Fl(t?c({},e,t,{code:n}):c({},e,{code:n})):(0,Xa.V)(e)?new Fl(c({},e,t,{code:n})):(0,qa.H)(e)?new Fl(c({message:e},t,{code:n})):new Fl(c({message:"UNEXPECTED_ERROR_TYPE"},t,{code:n}))}toString(){return JSON.stringify(this.toJSON())}toJSON(){const e={message:this.message,messageDetails:this.messageDetails,code:this.code,category:this.category,isFatal:this.isFatal,details:this.details,stack:this.stack,vsid:this.vsid,helpLink:this.helpLink||void 0};return c({},e,{raw:JSON.stringify(e)})}}var Vl=r(3041),Bl=r(5581);let Ul=0;var jl=r(2516),Hl=r(1652),Wl=r(7746);let ql;!function(e){e.NATIVE="native",e.HLS="hls",e.MP4="mp4",e.YASP="yasp"}(ql||(ql={}));var Yl=r(55);const Gl={AD:"play.start.adsdk",[ql.YASP]:"play.start.yasp",[ql.NATIVE]:"play.start.native",[ql.HLS]:"play.start.hls",[ql.MP4]:"play.start.mp4"},Kl={AD:"play.start.adsdk",[ql.YASP]:"play.start.adsdk.yasp",[ql.NATIVE]:"play.start.adsdk.native",[ql.HLS]:"play.start.adsdk.hls",[ql.MP4]:"play.start.adsdk.mp4"},zl={AD:"network.start.adsdk",[ql.YASP]:"network.start.yasp",[ql.NATIVE]:"network.start.native",[ql.HLS]:"network.start.hls",[ql.MP4]:"network.start.mp4"},Zl={AD:"network.start.adsdk",[ql.YASP]:"network.start.adsdk.yasp",[ql.NATIVE]:"network.start.adsdk.native",[ql.HLS]:"network.start.adsdk.hls",[ql.MP4]:"network.start.adsdk.mp4"};let Xl;!function(e){e.Ready="Ready",e.SkinReady="SkinReady",e.PosterReady="PosterReady",e.UserReady="UserReady",e.Destroy="Destroy",e.ContentImpression="ContentImpression",e.ResourcesIdle="ResourcesIdle",e.SourceChange="SourceChange",e.StreamChange="StreamChange",e.StreamsWithSupportInfoChange="StreamsWithSupportInfoChange",e.StartStageChange="StartStageChange",e.PlayingStateChange="PlayingStateChange",e.RequestPlayingState="RequestPlayingState",e.VideoTypeChange="VideoTypeChange",e.UtcStartTimeChange="UtcStartTimeChange",e.DVRStartTimeChange="DVRStartTimeChange",e.DVRDurationChange="DVRDurationChange",e.CurrentTimeChange="CurrentTimeChange",e.WatchedTimeChange="WatchedTimeChange",e.LiveLatencyChange="LiveLatencyChange",e.DurationChange="DurationChange",e.VolumeChange="VolumeChange",e.MutedChange="MutedChange",e.VolumeChangeReasonChange="VolumeChangeReasonChange",e.FullscreenStateChange="FullscreenStateChange",e.RequestFullscreenStateChange="RequestFullscreenStateChange",e.PictureInPictureStateChange="PictureInPictureStateChange",e.VisibleStateChange="VisibleStateChange",e.VideoSizeChange="VideoSizeChange",e.VideoTracksChange="VideoTracksChange",e.VideoTrackChange="VideoTrackChange",e.AudioTracksChange="AudioTracksChange",e.AudioTrackChange="AudioTrackChange",e.TextTracksChange="TextTracksChange",e.TextTrackChange="TextTrackChange",e.SubtitlesChange="SubtitlesChange",e.ErrorChange="ErrorChange",e.PlaybackRateRangeChange="PlaybackRateRangeChange",e.PlaybackRateChange="PlaybackRateChange",e.AdStateChange="AdStateChange",e.NextAdRemainingTimeChange="NextAdRemainingTimeChange",e.BeforeAdPodStart="BeforeAdPodStart",e.AdPodStart="AdPodStart",e.AdPodSkip="AdPodSkip",e.AdPodEnd="AdPodEnd",e.AdSkippableStateChange="AdSkippableStateChange",e.AdVolumeAvailabilityStateChange="AdVolumeAvailabilityStateChange",e.AdPodCloseStateChange="AdPodCloseStateChange",e.AdPodDurationChange="AdPodDurationChange",e.AdPodCurrentTimeChange="AdPodCurrentTimeChange",e.AdPodTimeToSkipChange="AdPodTimeToSkipChange",e.AdInteraction="AdInteraction",e.BufferedRangesChange="BufferedRangesChange",e.TileMetaInfoChange="TileMetaInfoChange",e.TileMetaInfoUrlChange="TileMetaInfoUrlChange",e.RecoverStart="RecoverStart",e.ConnectionQualityChange="ConnectionQualityChange",e.DrmSystemChange="DrmSystemChange",e.AdLoaded="AdLoaded",e.AdError="AdError",e.AdPodClick="AdPodClick",e.InrollFrame="InrollFrame",e.UgcLiveStatusChange="UgcLiveStatusChange",e.FrameRendered="FrameRendered"}(Xl||(Xl={}));var Ql=r(4754),Jl=r(9278),$l=r(4723),ed=r(4612);const td=()=>{},rd=e=>!0;let id,nd={},sd={},ad="",od=!1,ld=(0,Vl.s)(document);(0,Bl.Y)(document,e=>{e||(ld=e)});let dd=-1;const ud=["additional"],cd=["additional","initSubpage"];var hd=r(6094);const pd=["setReadyInstance","setInstance"];let fd;const md=function(e){return void 0===e&&(e=window),fd||(fd=e.document.createElement("div")),fd}(window),gd=(e,t)=>{const r="undefined"!==typeof md.style[e];if(r&&t&&(0,qa.H)(t))try{md.style.cssText=e+": "+t+";";const r=Boolean(md.style.cssText);return md.style.cssText="",r}catch(io){return!1}return r},vd=["","webkit","moz","o","ms"],yd={},Sd=function(e){return void 0===e&&(e=""),yd[e]||function(e){const t=""+e[0].toUpperCase()+e.slice(1);for(let r=0;r<vd.length;r++){const i=vd[r],n=i?""+i+t:e;if(gd(n))return yd[e]=n}return yd[e]=e}(e)};var Ed=r(1115),bd=r(9521),Ad=r(9632);const Td=function e(t,r){void 0===r&&(r={preserveConstructors:!0});let i=t;if((0,Ed.k)(t)){return t.map(t=>e(t,r))}return(n=t)instanceof Date||"Date"===(0,bd.M)(n)?new Date(t.getTime()):(!(0,Ql.m)(t)&&(0,Za.K)(t)&&(i=r.preserveConstructors?Object.create(t):{},(0,Ad.M)(t,(t,n)=>{i[n]=e(t,r)})),i);var n},_d=e=>{try{return"display"in Y(e)}catch(io){return!1}};var wd=r(2839);const kd=e=>function(e){return e instanceof Promise||"Promise"===(0,bd.M)(e)&&Boolean((0,Wa.Y)(()=>(0,wd.t)(e.constructor)))}(e)||(e=>Boolean((0,Wa.Y)(()=>(0,Ql.m)(e.then)&&(0,Ql.m)(e.catch))))(e);var Rd=r(5214),Pd=r(5176);const Cd=(e,t,r)=>{const i=new Array(e.length);for(let n=0;n<e.length;n++)i[n]=t.call(r,e[n],n,e);return i};var Id=r(6386),Od=r.n(Id);const Dd=function(e){void 0===e&&(e=window);const t=Od()(e);return"boolean"===typeof t?-1:t},Nd=["","-webkit-","-ms-","-moz-","-o-"],Ld=Nd.map(e=>"("+e+"any-pointer:coarse)").join(","),xd=Nd.map(e=>"("+e+"touch-enabled)").join(",");var Md=r(1247);const Fd=function(e){void 0===e&&(e=window);const t=(0,Md.i)(e).toLowerCase();if(t.indexOf("android")>-1)return!1;const r=t.replace(/\(.+?\)/gi,"").split(" ").map(e=>e.trim().split("/")[0]).filter(e=>e&&"mobile"!==e);return 4===r.length&&"mozilla"===r[0]&&"applewebkit"===r[1]&&"version"===r[2]&&"safari"===r[3]},Vd=function(e){return void 0===e&&(e=window),Fd(e)||te(e)||function(e){return void 0===e&&(e=window),/Apple/.test(e.navigator.vendor)&&ee(e)}(e)}(),Bd=re(document.documentElement),Ud=function(){const e=Cd(Bd,e=>e.ownerDocument),{length:t}=e,r=(t?e[t-1]:document).defaultView;return!!r&&r.self!==r.parent}();class jd{constructor(){this.on=[],this.once=[]}add(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.on.push(...t),()=>this.remove(...t)}addOne(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.once.push(...t),()=>this.remove(...t)}promise(){return new Promise(e=>this.addOne(e))}dispatch(e){const{once:t}=this;this.once=[],ne(this.on,e),ne(t,e)}removeAll(){this.on.length=0,this.once.length=0}remove(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.on=this.on.filter(e=>t.indexOf(e)<0),this.once=this.once.filter(e=>t.indexOf(e)<0)}}class Hd extends jd{constructor(e,t){void 0===t&&(t=(e,t)=>e===t),super(),this.checkToEqualFunction=t,this.value=void 0,this.value=e}getValue(){return this.value}subscribeValueCondition(e,t){return this.add(r=>{e(r)&&ie(t,r)})}subscribeValueConditionOnce(e,t){const r=this.subscribeValueCondition(e,e=>{r(),ie(t,e)});return r}dispatch(e){this.checkToEqualFunction(this.value,e)||(this.value=e,super.dispatch(e))}}var Wd=r(6048),qd=r.n(Wd);let Yd,Gd;!function(e){e.OFFLINE="offline",e.IDLE="idle",e.ATTEMPT="attempt",e.PLAYING="playing",e.ERROR="error"}(Yd||(Yd={})),function(e){e.init="init",e.waitForUserPlay="waitForUserPlay",e.waitForDocumentVisibility="waitForDocumentVisibility",e.starting="starting",e.started="started",e.broken="broken",e.destroyed="destroyed"}(Gd||(Gd={}));const Kd=function(e){void 0===e&&(e=window);const t=(0,Md.i)(e).toLowerCase();return/windows/.test(t)}(),zd=function(e){void 0===e&&(e=window);const t=(0,Md.i)(e).toLowerCase(),r=/windows nt (\d+\.\d+)/.exec(t);if(r){const e=Number(r[1]);return e>0?e:-1}return-1}(),Zd={[Ya.q.MEDIA]:"https://yandex.ru/support/video-player/loading-issues.html",[Ya.q.NETWORK_MEDIA]:"https://yandex.ru/support/video-player/loading-issues.html",[Ya.q.NETWORK_PLAYER]:"https://yandex.ru/support/video-player/player-issues.html",[Ya.q.NETWORK_TIMEOUT]:"https://yandex.ru/support/video-player/player-issues.html",[Ya.q.NO_CODECS]:"https://yandex.ru/search/?text=\u043a\u043e\u0434\u0435\u043a\u0438",[Ya.q.UNSUPPORTED_ENV]:"https://yandex.ru/soft/browsers/",[Ya.q.EXCEPTION]:"https://yandex.ru/support/video-player/loading-issues.html",[Ya.q.DRM]:"https://yandex.ru/support/video-player/drm.html",[Ya.q.BANNED]:null},Xd={[Ya.q.DEFAULT]:"DEFAULT_ERROR_CATEGORY_TITLE",[Ya.q.MEDIA]:"MEDIA_ERROR_CATEGORY_TITLE",[Ya.q.NETWORK_MEDIA]:"NETWORK_MEDIA_ERROR_CATEGORY_TITLE",[Ya.q.NETWORK_PLAYER]:"NETWORK_PLAYER_ERROR_CATEGORY_TITLE",[Ya.q.NETWORK_TIMEOUT]:"NETWORK_TIMEOUT_ERROR_CATEGORY_TITLE",[Ya.q.NO_CODECS]:"NO_CODECS_ERROR_CATEGORY_TITLE",[Ya.q.UNSUPPORTED_ENV]:"UNSUPPORTED_ENV_ERROR_CATEGORY_TITLE",[Ya.q.CANNOT_PLAY]:"CANNOT_PLAY_ERROR_CATEGORY_TITLE",[Ya.q.EXCEPTION]:"EXCEPTION_ERROR_CATEGORY_TITLE",[Ya.q.CONFIG]:"CONFIG_ERROR_CATEGORY_TITLE",[Ya.q.REGIONAL]:"REGIONAL_ERROR_CATEGORY_TITLE",[Ya.q.DRM]:"DRM_ERROR_CATEGORY_TITLE",[Ya.q.ACCESS]:"ACCESS_ERROR_CATEGORY_TITLE",[Ya.q.BANNED]:"BANNED_ERROR_CATEGORY_TITLE"},Qd={[Ya.q.DEFAULT]:"DEFAULT_ERROR_CATEGORY_MESSAGE",[Ya.q.MEDIA]:"MEDIA_ERROR_CATEGORY_MESSAGE",[Ya.q.NETWORK_MEDIA]:"NETWORK_MEDIA_ERROR_CATEGORY_MESSAGE",[Ya.q.NETWORK_PLAYER]:"NETWORK_PLAYER_ERROR_CATEGORY_MESSAGE",[Ya.q.NETWORK_TIMEOUT]:"NETWORK_TIMEOUT_ERROR_CATEGORY_MESSAGE",[Ya.q.NO_CODECS]:"NO_CODECS_ERROR_CATEGORY_MESSAGE",[Ya.q.UNSUPPORTED_ENV]:"UNSUPPORTED_ENV_ERROR_CATEGORY_MESSAGE",[Ya.q.CANNOT_PLAY]:"CANNOT_PLAY_ERROR_CATEGORY_MESSAGE",[Ya.q.EXCEPTION]:"EXCEPTION_ERROR_CATEGORY_MESSAGE",[Ya.q.CONFIG]:"CONFIG_ERROR_CATEGORY_MESSAGE",[Ya.q.DRM]:"DRM_ERROR_CATEGORY_MESSAGE",[Ya.q.ACCESS]:"ACCESS_ERROR_CATEGORY_MESSAGE",[Ya.q.BANNED]:"BANNED_ERROR_CATEGORY_MESSAGE"},Jd={[Ya.q.NO_CODECS]:"NO_CODECS_ERROR_CATEGORY_HELP_LINK",[Ya.q.UNSUPPORTED_ENV]:"UNSUPPORTED_ENV_ERROR_CATEGORY_HELP_LINK"};let $d;!function(e){e.BroadcastAdReceived="BroadcastAdReceived",e.BroadcastAdInit="BroadcastAdInit",e.StreamPlayerReceivedMetadata="StreamPlayerReceivedMetadata",e.StreamPlayerChooseMetadata="StreamPlayerChooseMetadata",e.PlayWithoutRAAResults="PlayWithoutRAAResults",e.CanPlay="CanPlay",e.ContentImpression="ContentImpression",e.WaitForPlayCompleted="WaitForPlayCompleted",e.DrmSystemsSupportDetected="DrmSystemsSupportDetected",e.InrollAdStart="InrollAdStart",e.InrollAdPodStart="InrollAdPodStart",e.InrollAdPodEnd="InrollAdPodEnd",e.InrollAdEnd="InrollAdEnd",e.PlayAdViewers="PlayAdViewers",e.AdStart="AdStart",e.AdPodImpression="AdPodImpression",e.AdPodLoading="AdPodLoading",e.AdPodError="AdPodError",e.AdPodStart="AdPodStart",e.AdPodEnd="AdPodEnd",e.AdEnd="AdEnd",e.AdClickThru="AdClickThru",e.NoAdPodsToPlayAd="NoAdPodsToPlayAd",e.Stalled="Stalled",e.NudgeStalledFailed="NudgeStalledFailed",e.LoadSource="LoadSource",e.PrerollInit="PrerollInit",e.WaitForUserGesture="WaitForUserGesture",e.WaitForDocumentVisibility="WaitForDocumentVisibility",e.HiddenAutoplayPrevented="HiddenAutoplayPrevented",e.PlayVideoOnVisibilityChange="PlayVideoOnVisibilityChange",e.PauseVideoOnVisibilityChange="PauseVideoOnVisibilityChange",e.StreamStopWhileLoadingMultiroll="StreamStopWhileLoadingMultiroll",e.StreamStopWhileChoosingStream="StreamStopWhileChoosingStream",e.StreamStopWhileDestroyVideoController="StreamStopWhileDestroyVideoController",e.StreamStopDuringDefineAutoplaySettings="StreamStopDuringDefineAutoplaySettings",e.StreamStopWhileWaitingForPlay="StreamStopWhileWaitingForPlay",e.StreamStopWhileWaitingForDocumentVisibility="StreamStopWhileWaitingForDocumentVisibility",e.StreamStopWhileLoadingPreroll="StreamStopWhileLoadingPreroll",e.StreamStopWhilePreloadingPreroll="StreamStopWhilePreloadingPreroll",e.PreloadSource="PreloadSource",e.UsePreloadedHlsJs="UsePreloadedHlsJs",e.PlayAfterWaitingForDocumentVisibility="PlayAfterWaitingForDocumentVisibility",e.ResourcesIdle="ResourcesIdle",e.ClientInfo="ClientInfo",e.HlsJsForceCappingStart="HlsJsForceCappingStart",e.ExternalPlaybackOpenButtonClick="ExternalPlaybackOpenButtonClick",e.ExternalPlaybackCloseButtonClick="ExternalPlaybackCloseButtonClick",e.ExternalPlayerListVisibleStatusChange="ExternalPlayerListVisibleStatusChange",e.ExternalPlaybackPlayerCsrfFetching="ExternalPlaybackPlayerCsrfFetching",e.ExternalPlaybackPlayerCsrfFetchSuccess="ExternalPlaybackPlayerCsrfFetchSuccess",e.ExternalPlaybackPlayerCsrfFetchError="ExternalPlaybackPlayerCsrfFetchError",e.ExternalPlaybackPlayerListHasAnyDevice="ExternalPlaybackPlayerListHasAnyDevice",e.ExternalPlaybackPlayerListFetching="ExternalPlaybackPlayerListFetching",e.ExternalPlaybackPlayerListFetchSuccess="ExternalPlaybackPlayerListFetchSuccess",e.ExternalPlaybackPlayerListFetchError="ExternalPlaybackPlayerListFetchError",e.ExternalPlaybackPlayerActivate="ExternalPlaybackPlayerActivate",e.ExternalPlaybackPlayerActivateSucceed="ExternalPlaybackPlayerActivateSucceed",e.ExternalPlaybackPlayerActivateFailed="ExternalPlaybackPlayerActivateFailed",e.ExternalPlaybackCsrfTokenExpired="ExternalPlaybackCsrfTokenExpired",e.Seek="Seek",e.MediaInternalsHistoryOnFatal="MediaInternalsHistoryOnFatal",e.PlayInrollAd="PlayInrollAd",e.FPSControllerRestrictions="FPSControllerRestrictions",e.NativeVideoTypeChange="NativeVideoTypeChange",e.LowLatencyDetected="LowLatencyDetected"}($d||($d={}));var eu=r(8172);let tu,ru,iu;!function(e){e[e.PLAYING=1]="PLAYING",e[e.NOT_PLAYING=2]="NOT_PLAYING"}(tu||(tu={})),function(e){e.INIT="INIT",e.SET_SOURCE="SET_SOURCE"}(ru||(ru={})),function(e){e.SetMuted="SetMuted",e.SetVolume="SetVolume",e.RequestAutoplaySettings="RequestAutoplaySettings",e.VolumeChangeEvent="VolumeChangeEvent",e.RestoreSavedMuted="RestoreSavedMuted"}(iu||(iu={}));const nu=e=>e.filter(ae),su=(0,wd.t)(Object.getPrototypeOf)?e=>Object.getPrototypeOf(e):e=>e.__proto__||Object.prototype;let au;!function(e){e.PublicApiCall="PublicApiCall",e.Unload="Unload",e.PlayerContainerNotFound="PlayerContainerNotFound"}(au||(au={}));const ou={min:0,max:1/0},lu="0000000000000000000000000000000000000000000000000000000000000000",du={state:tu.NOT_PLAYING,type:void 0,adParams:{}},uu={source:void 0,stream:void 0,drmSystem:void 0,startStage:Gd.init,playingState:Wl.X.PAUSE,playingStateReason:eu.l.Unknown,videoType:void 0,utcStartTime:void 0,currentTime:NaN,watchedTime:0,dvrStartTime:NaN,dvrDuration:NaN,duration:NaN,volume:NaN,muted:!1,volumeChangeReason:void 0,isFullscreen:!1,pictureInPictureAllowed:!1,isPictureInPicture:!1,isVisible:!1,videoSize:void 0,videoTracks:[],videoTrack:void 0,audioTracks:[],audioTrack:void 0,textTracks:[],textTrack:void 0,subtitles:[],vsid:lu,error:void 0,playbackRateRange:ou,playbackRate:1,version:"1.0-12103",adState:du,adSkippableState:!1,adVolumeAvailabilityState:!1,adPodCloseState:void 0,adPodCurrentTime:NaN,adPodTimeToSkip:NaN,adPodDuration:NaN,nextAdRemainingTime:void 0,bufferedRanges:[],tileMetaInfo:void 0,tileMetaInfoUrl:void 0,liveLatency:void 0,connectionQuality:void 0,ugcLiveStatus:void 0};let cu;!function(e){e[e.LOADING=0]="LOADING",e[e.READY=1]="READY",e[e.ERROR=2]="ERROR"}(cu||(cu={}));var hu=r(2067);const pu=["be","en","id","kk","ru","tr","tt","uk","uz"],fu=Ol([pu[0],...pu.slice(1)]).transform(e=>e).default("ru"),mu=Al([fu,ll().transform(()=>"ru")]).transform(e=>e).default("ru"),gu=e=>void 0!==function(e){let t;try{t=JSON.stringify(e)}catch(io){}return t}(e),vu=Al([cl().default(!1).transform(e=>({autoplay:e,allowMuted:!0})),El({allowMuted:cl()}).transform(e=>{let{allowMuted:t}=e;return{autoplay:!0,allowMuted:t}})]);var yu=r(6170),Su=r(3126);const Eu=Al([cl().default(!1).transform(e=>({logCalls:e,logEvents:e,logInternals:e,showDebugPanel:e})),El({logCalls:cl().default(!1),logEvents:cl().default(!1),logInternals:cl().default(!1),showDebugPanel:cl().default(!1)})]).transform(e=>{let{logCalls:t,logEvents:r,logInternals:i,showDebugPanel:n}=e;return{logCalls:(0,hu.RW)("web_debug_log_calls")||(0,Su.O)(yu.hV,ue)||t,logEvents:(0,hu.RW)("web_debug_log_events")||(0,Su.O)(yu.wS,ue)||r,logInternals:(0,hu.RW)("web_debug_log_internals")||(0,Su.O)(yu.V9,ue)||i,showDebugPanel:(0,hu.RW)("web_debug_panel")||(0,Su.O)(yu.g2,ue)||n}}),bu=El({}).passthrough().optional();var Au=r(8337);let Tu;!function(e){e.ALL="*",e.PLAY="play",e.START_SCREEN_PLAY="startScreenPlay",e.VOLUME="sound",e.VOLUME_SLIDER="volumeSlider",e.SETTINGS="settings",e.SETTINGS_ITEM="settingsItem",e.FULLSCREEN="fullscreen",e.TIMELINE="timeline",e.TIMELINE_PREVIEW="timelinePreview",e.LIVE="live",e.POSTER="poster",e.START_POSITION_CONFIRM="startPositionConfirm",e.TIME_DISPLAY="time",e.TITLE_DISPLAY="titleDisplay",e.REPORT="report",e.FORWARD="forward",e.BACKWARD="backward",e.LOGO="logo",e.PRELOADER="preloader",e.CONTEXT_MENU="contextMenu",e.START_SCREEN="startScreen",e.PLAYBACK_RATE="playbackRate",e.EXTERNAL_PLAYBACK="externalPlayback",e.RECOMMENDATIONS="recommendations",e.CLOSE_BUTTON="closeButton",e.NEXT_AD_INFO="nextAdInfo",e.SUBTITLES_TOGGLE="subtitlesToggle",e.LOGO_WIDGET="logoWidget",e.SKIP_AD="skipAd",e.MOBILE_SEEK_BUTTONS="mobileSeekButtons",e.TITLE="title"}(Tu||(Tu={}));const _u=(0,Au.Z)(Tu).map(e=>Tu[e]),wu=ll().transform(e=>{if("!*"===e)throw new Error("!* is forbidden value");for(const t of _u)if(e===t||e==="!"+t)return e;return""}),ku=Sl(wu).transform(e=>e.filter(Boolean)),Ru=Al([Sl(wu),ll().transform(e=>e.split(",").map(e=>e.trim()).filter(e=>""!==e))]).transform(e=>ku.parse(e)).default(""),Pu=dl().optional().transform(e=>Math.max(void 0===e?30:e,5)),Cu=Al([cl().transform(e=>({enabled:e,reportUrl:"https://yandex.ru/support/video-player/feedback.html"})),El({enabled:gl().transform(e=>!0===e),reportUrl:ll().default("https://yandex.ru/support/video-player/feedback.html")})]).default(!1);var Iu=r(8834);const Ou=Al([cl().transform(e=>{if(e)return{onlyMuted:!1,forceAutoplay:!0,threshold:.5}}),pl().transform(()=>({onlyMuted:!0,forceAutoplay:!1,threshold:Iu.I})),El({onlyMuted:cl()}).strict().transform(e=>{let{onlyMuted:t}=e;return{threshold:.5,onlyMuted:t,forceAutoplay:!0}}),El({threshold:dl().nonnegative().max(1),onlyMuted:cl().default(!1)}).transform(e=>{let{threshold:t,onlyMuted:r}=e;return{threshold:t,onlyMuted:r,forceAutoplay:!0}})]);let Du;!function(e){e.VOLUME="JSPlayerApiSavedUserVolume",e.MUTED="JSPlayerApiSavedUserMuted"}(Du||(Du={}));var Nu=r(9396);class Lu{static setSavedVolume(e){Nu.t.setItem(Du.VOLUME,String(e))}static getSavedVolume(){const e=this.parseVolume(Nu.t.getItem(Du.VOLUME));return void 0===e?1:e}static setSavedMuted(e){Nu.t.setItem(Du.MUTED,String(e))}static getSavedMuted(){return"true"===Nu.t.getItem(Du.MUTED)}static parseVolume(e){if(!(0,qa.H)(e))return;const t=parseFloat(e);return isNaN(t)?void 0:t>=0&&t<=1?t:t>=0&&t<=100?t/100:void 0}}const xu=dl().refine(ce,"must be a number 0..1").optional().transform(e=>void 0===e?Lu.getSavedVolume():e).transform(e=>ce(e)?e:1),Mu=El({debug:Eu,autoplay:vu,slowConnection:cl().default(!1),volume:xu,muted:cl().optional(),preload:cl().default(!0),autoQuality:cl().default(!0),defaultQuality:dl().nullable().default(720),feed:cl().default(!1),shouldEmitFrameRendered:cl().default(!1),useAbdBundle:cl().default(!1),lang:mu,env:bu,maxBufferLength:dl().refine(Hl.z).transform(Ma.toSeconds).optional(),enableRemoteProgressSaving:cl().default(!1),liveOffset:Pu,bandwidthEstimateOffset:dl().refine(Hl.z).transform(Ma.toBps).optional(),report:Cu,preferNative:cl().default(!1),togglePlaybackOnVisibilityChange:Ou,restoreTabSessionPlaybackProgress:cl().default(!1),useFallbackStream:cl().default(!1),loadSkin:Al([Pl(),Il(!1)]).optional(),perfLogUrl:ll().optional(),allowPip:cl().default(!0),skinParams:El({skinConfig:El({hiddenControls:Ru,primaryColor:ll().optional().default("#FFCC00"),secondaryColor:ll().optional().default("#EEEEEE"),timelineThumbColor:ll().optional().default("#FFCC00")}).passthrough().optional().default({})}).refine(gu).optional(),useNativeAdControls:cl().default(!0),device:gl().refine(gu).transform(e=>e).default({}),backgroundColor:ll().transform(e=>e||void 0).default("#000"),objectFit:ll().optional().transform(e=>e||void 0),cacheSourcesCount:dl().nonnegative().int().refine(Hl.z).default(0),isVisibilitySupported:cl().optional(),initialVisibility:cl().optional()}),Fu=_u.filter(e=>e!==Tu.ALL),Vu=new Set([Tu.ALL,...Fu,...Fu.map(e=>"!"+e)]),Bu=e=>Vu.has(e);var Uu=r(5859);const ju=Mu.transform(e=>{var t,r,i,n,s,a;const o=he(null==(t=e.skinParams)||null==(r=t.skinConfig)?void 0:r.hiddenControls),l=0===e.volume||(void 0===e.muted?Lu.getSavedMuted():e.muted),d=e.togglePlaybackOnVisibilityChange&&e.togglePlaybackOnVisibilityChange.forceAutoplay||e.autoplay.autoplay,u=null===e.defaultQuality?e.defaultQuality:Math.floor(e.defaultQuality/9*16),c=(0,Uu.z)();return{streamPlayerParams:{debug:e.debug.logInternals,hidden:!1===e.loadSkin?o:_u,allowPip:e.allowPip,autoplay:!c&&d,allowMuted:(0,hu.RW)("web_forbid_allow_muted_autoplay")?l:e.autoplay.allowMuted,lang:e.lang,autoQuality:e.autoQuality,defaultQuality:u,feed:e.feed,shouldEmitFrameRendered:e.shouldEmitFrameRendered,preload:!c&&e.preload,togglePlaybackOnVisibilityChange:e.togglePlaybackOnVisibilityChange,restoreTabSessionPlaybackProgress:e.restoreTabSessionPlaybackProgress,maxBufferLength:e.maxBufferLength,preferNative:e.preferNative,report:e.report.enabled,skinConfig:null==(i=e.skinParams)?void 0:i.skinConfig,backgroundColor:e.backgroundColor,shouldPlayOnFirstClick:void 0===e.loadSkin,bandwidthEstimateOffset:e.bandwidthEstimateOffset,useNativeAdControls:e.useNativeAdControls,device:e.device,volume:e.volume,muted:l,liveOffset:e.liveOffset,slowConnection:e.slowConnection,cacheSourcesCount:e.cacheSourcesCount,showUnmuteButtonForAll:!1,perfLogUrl:null!=(n=e.perfLogUrl)?n:"https://log.strm.yandex.ru/perf",isVisibilitySupported:e.isVisibilitySupported,initialVisibility:e.initialVisibility},useAbdBundle:e.useAbdBundle,useFallbackStream:e.useFallbackStream,debugConfig:e.debug,reportConfig:e.report,loadSkin:e.loadSkin,originalHiddenControls:o,primaryColor:null==(s=e.skinParams)||null==(a=s.skinConfig)?void 0:a.primaryColor,objectFit:e.objectFit,savedMutedRestored:void 0===e.muted&&0!==e.volume}}),Hu="other",Wu={from:Hu,reqid:void 0,hash:void 0,vsid:lu};var qu=r(3479),Yu=r(9223);var Gu=r(7922),Ku=r(123);const zu=0,Zu=["partnerId","partner_id","category","impId","imp_id","hasPreroll","videoContentId","video_content_id","videoContentName","video_content_name","videoPublisherId","video_publisher_id","videoPublisherName","video_publisher_name","videoGenreId","video_genre_id","videoGenreName","video_genre_name","distrId","distr_id","adBreaks"],Xu=El({}).passthrough().default({partnerId:void 0}).transform((function(e){const{partnerId:t,partner_id:r=t,category:i=zu,impId:n,imp_id:s=n,hasPreroll:a,videoContentId:o,video_content_id:l=o,videoContentName:d,video_content_name:u=d,videoPublisherId:c,video_publisher_id:h=c,videoPublisherName:p,video_publisher_name:f=p,videoGenreId:m,video_genre_id:g=m,videoGenreName:v,video_genre_name:y=v,distrId:S,distr_id:E=S,adBreaks:b}=e;return me({},function(e,t){if(null==e)return{};var r,i,n={},s=Object.keys(e);for(i=0;i<s.length;i++)r=s[i],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,Zu),{partnerId:Number(r),category:Number(i),impId:void 0!==s?parseInt(String(s),10)||0:void 0,hasPreroll:"boolean"===typeof a?a:void 0,videoContentId:l,videoContentName:u,videoPublisherId:h,videoPublisherName:f,videoGenreId:g,videoGenreName:y,distrId:E,adBreaks:b})})),Qu=/^\w(\-|_|:|\s|\.|\w){0,70}$/,Ju=El({from:ll().transform((function(e){if(!e)return Wu.from;const t=String(e);return Qu.test(t)?t:"_$invalid_label_value$_"})).optional(),slots:Al([ll().transform((function(e){return"string"===typeof e?e.split(";"):[]})),Sl(ll()),gl().transform(()=>{})]).optional().transform((function(e){if(!Array.isArray(e))return;const t=e.filter(e=>"string"===typeof e&&/^\d+,\d+,-?\d+$/.test(e)).sort().join(";");return t.length>0?t:void 0})),testIds:Al([ll().transform((function(e){return ve(e.split(","))})),Sl(ll()).transform(ve),Sl(dl()).transform(ge),gl().transform(()=>{})]).optional()}).catchall(gl().transform(e=>{if(void 0!==e)return String(e)})).transform((function(e){return void 0!==e.slots&&(e.testIds=ve(e.slots.split(";"))),e})),$u=El({}).passthrough().refine(ye,"must be serializable"),ec=El({preferredAudioLangs:Sl(ll()).max(1),preferredTextLangs:Sl(ll()).max(1)}).transform(e=>e),tc=xl(dl().nonnegative().refine(Hl.z).transform(Ma.toSeconds)).transform(e=>({videoTime:e})),rc=El({url:ll().url(),drmConfig:$u.optional(),metaInfoUrl:ll().optional()}),ic=El({objectFit:ll().optional()}).optional(),nc=El({videoContentId:ll().optional(),videoContentName:ll().optional(),videoContentDescription:ll().optional(),videoPublisherId:ll().optional(),videoPublisherName:ll().optional(),videoGenreId:ll().optional(),videoGenreName:ll().optional()}),sc=El({endTime:dl(),startTime:dl(),type:Ol(["intro","recap","credits"])}),ac=El({loop:cl().default(!1),startPosition:tc,adConfig:Xu.default({}),withCredentials:cl().optional(),passportRetpath:ll().url().optional(),preview:ll().optional(),firstFrameHash:ll().optional(),firstFrameUrl:ll().optional(),posterStyle:ic,additionalParams:Ju.optional().default({}),externalPlayerConfig:El({}).passthrough().optional(),id:ll().default(""),videoInfo:nc.default({}),enableRemoteProgressSaving:cl().optional().default(!1),preferredTracks:ec.default({preferredAudioLangs:[],preferredTextLangs:[]}),skippableFragments:Sl(sc).optional(),initialStalledDuration:dl().default(0),externalStalledDuration:dl().optional()}),oc=El({streamUrl:ll().url(),drmConfig:$u.optional(),contentId:Al([pl(),vl()])}),lc=El({streams:Sl(rc).nonempty(),drmConfig:Al([pl(),vl()]),contentId:Al([pl(),vl()])}),dc=El({contentId:ll(),streamUrl:Al([pl(),vl()]),streams:Al([pl(),vl()])}),uc=Tl(Al([dc,lc,oc]).transform(e=>{if("contentId"in e)return{contentId:e.contentId,streams:[]};if("streams"in e)return{streams:e.streams,contentId:void 0};if("streamUrl"in e)return{streams:[{url:e.streamUrl,drmConfig:e.drmConfig}],contentId:void 0};throw new Error("SourceSchema Exception")}),ac);var cc=r(2480);const hc=["videoContentName","videoContentId","videoPublisherId","videoPublisherName","videoGenreId","videoGenreName"],pc=uc.transform(e=>({contentId:e.contentId,id:e.id,streams:e.streams,params:{startPosition:e.startPosition,adConfig:Ae({},e.adConfig,Se(e.videoInfo,e.adConfig)),withCredentials:e.withCredentials,loop:e.loop,preview:e.preview,firstFrameHash:be(e.firstFrameHash||""),firstFrameUrl:e.firstFrameUrl,posterStyle:e.posterStyle,additionalParams:e.additionalParams,externalPlayerConfig:(0,Za.K)(e.externalPlayerConfig)?Ae({},e.externalPlayerConfig,{passportRetpath:(0,qa.H)(e.passportRetpath)?e.passportRetpath:void 0}):e.externalPlayerConfig,videoInfo:Se(e.videoInfo,e.adConfig),preferredTracks:e.preferredTracks,skippableFragments:e.skippableFragments},initialStalledDuration:e.initialStalledDuration,externalStalledDuration:void 0!==e.externalStalledDuration?e.externalStalledDuration:void 0}));var fc=r(3563);const mc={trackingEvents:[{init:[],start:[],end:[],setSource:[],adStart:[],adRequest:[],adError:[],adEnd:[],adPodStart:[],adPodClick:[],adPodEnd:[],adPodSkip:[],sourceStart:[],play:[],pause:[],seek:[],firstQuartile:[],midpoint:[],thirdQuartile:[],viewed:[],heartbeat:[],watchedTime:[],error:[]}]},gc=Pl().args().returns(ml()),vc=El({trackings:gl().transform(Pe).default(mc),update:gc.default(()=>Yl.Z),enableRemoteProgressSaving:cl().default(!1).or(gl().transform(()=>!1)),videoInfo:nc.default({})});let yc;!function(e){e.PLAYER_API="player-api.js",e.PLAYER_API_MODERN="player-api.modern.js",e.PLAYER_API_MOCK="player-api-mock.js"}(yc||(yc={}));const Sc=e=>(e=>{try{if("noModule"in e.HTMLScriptElement.prototype)return!0}catch(t){}return!1})(e)&&(e=>(0,wd.t)(e.navigator.sendBeacon))(e),Ec=/1\.0-(\d+)/,bc=(e=>Sc(e))(window),Ac=!(0,wd.t)(Math.random)||Math.random()===Math.random();var Tc=r(3451);let _c=(0,Tc.m6)()*(0,Tc.no)()%2147483647;const wc=Ac?function(){return _c=16807*_c%2147483647,(_c-1)/2147483646}:function(){return Math.random()},kc=function(e){const t=100*wc();let r=0;for(let i=0;i<e.length;i++)if(r+=e[i].percent,t<r)return e[i].id;return e[0].id}([{id:12103,percent:100}]),Rc=function(e){return void 0===e&&(e=window),/Windows Phone/i.test(e.navigator.userAgent)},Pc=Le(),Cc=te(),Ic=function(e){void 0===e&&(e=window);const t=(0,Md.i)(e).toLowerCase();return/linux/.test(t)&&!Le(e)}(),Oc=function(e){void 0===e&&(e=window);const t=(0,Md.i)(e).toLowerCase();return/mac/.test(t)&&!te(e)}(),Dc=Rc();let Nc,Lc,xc,Mc;!function(e){e.DESKTOP="d",e.MOBILE="m"}(Nc||(Nc={})),function(e){e.DESKTOP="desktop",e.MOBILE="mobile",e.TABLET="tablet"}(Lc||(Lc={})),function(e){e.UNDEFINED="0",e.DESKTOP="1",e.IOS="2",e.ANDROID="3",e.WINDOWS_MOBILE="4"}(xc||(xc={})),function(e){e.vsid="vsid",e.dl="dl",e.random="random",e.timestamp="timestamp",e.fts="fts",e.vts="vts",e["watched-time"]="watched-time",e["video-time"]="video-time",e["device-type"]="device-type",e["device-type-mediascope"]="device-type-mediascope",e["device-type-tns"]="device-type-tns",e.fullscreen="fullscreen",e.duration="duration",e["old-position"]="old-position",e["error-code"]="error-code",e["audio-track-name"]="audio-track-name",e["audio-track-lang"]="audio-track-lang",e["text-track-name"]="text-track-name",e["text-track-lang"]="text-track-lang",e.muted="muted",e["drm-supported"]="drm-supported",e["drm-type"]="drm-type",e["bitrate-video"]="bitrate-video",e["bitrate-audio"]="bitrate-audio",e["buffering-duration"]="buffering-duration",e["buffering-count"]="buffering-count",e["initial-buffering-time"]="initial-buffering-time",e["ad-position"]="ad-position",e["client-ad-sec"]="client-ad-sec"}(Mc||(Mc={}));const Fc=(0,Au.Z)(Mc);var Vc=r(3807),Bc=r(7179);class Uc{constructor(){this.value=0,this.measureTime=()=>0}start(){this.measureTime=(0,xa.u)()}pause(){this.value=this.value+this.measureTime(),this.measureTime=()=>0}getTime(){return this.value+this.measureTime()}reset(){this.measureTime=(0,xa.u)(),this.value=0}}var jc=r(4651);const Hc=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test((0,Md.i)());class Wc extends Bc.v{constructor(e){super(),this.params=e,this.MACROS={dl:()=>window.document.referrer||window.location&&window.location.href||"",random:()=>Math.floor(Math.random()*10**16),timestamp:()=>String(Date.now()),vts:()=>{return Math.floor((e=Date.now(),Math.round(e/1e3)));var e},fts:()=>{const e=this.params.getVideoType();return Math.floor(e===jc.Z.VOD?this.params.getCurrentTime():this.params.getUtcPosition())},"watched-time":()=>Math.floor(this.params.getWatchedTime()),"video-time":()=>Math.floor(this.params.getCurrentTime()),"device-type":()=>Hc?Nc.MOBILE:Nc.DESKTOP,"device-type-mediascope":()=>Hc?Lc.MOBILE:Lc.DESKTOP,"device-type-tns":()=>{if(Hc){if(Cc)return xc.IOS;if(Pc)return xc.ANDROID;if(Dc)return xc.WINDOWS_MOBILE}else if(Kd||Oc||Ic)return xc.DESKTOP;return xc.UNDEFINED},fullscreen:()=>this.params.getIsFullscreen()?"1":"0",duration:()=>Math.floor(this.params.getDuration()),vsid:()=>this.params.vsid,"audio-track-name":()=>{const e=this.params.getAudioTrack();return e?e.name:""},"audio-track-lang":()=>{const e=this.params.getAudioTrack();return e?e.lang:""},"text-track-name":()=>{const e=this.params.getTextTrack();return e?e.name:""},"text-track-lang":()=>{const e=this.params.getTextTrack();return e?e.lang:""},"drm-supported":()=>{switch(this.params.getIsDrmSupported()){case!0:return"1";case!1:return"0";default:return""}},"drm-type":()=>{var e;return null!=(e=this.params.getDrmSystemName())?e:""},"bitrate-video":()=>{var e;const t=null==(e=this.params.getVideoTrack())?void 0:e.bitrate;return t?Math.floor(1e3*t):""},"bitrate-audio":()=>{var e;const t=null==(e=this.params.getAudioTrack())?void 0:e.bitrate;return t?Math.floor(1e3*t):""},"initial-buffering-time":()=>{var e;return null!=(e=this.initialBufferingTime)?e:""},"ad-position":()=>{const{type:e}=this.params.getAdState();return je(e)},"client-ad-sec":()=>Math.floor(this.clientAdTimeMeasurer.getTime()/1e3),muted:()=>this.params.getMuted()?"1":"0"},this.measureInitialBufferingTime=void 0,this.initialBufferingTime=void 0,this.clientAdTimeMeasurer=new Uc,this.watchedTimeClock=new Vc.EW,this.heartbeatTimers=[],this.bufferedInfoByTrackKey={},this.trackingEvents={init:[],start:[],end:[],setSource:[],adStart:[],adRequest:[],adError:[],adEnd:[],adPodStart:[],adPodClick:[],adPodEnd:[],adPodSkip:[],sourceStart:[],play:[],pause:[],seek:[],firstQuartile:[],midpoint:[],thirdQuartile:[],viewed:[],heartbeat:[],watchedTime:[],error:[]},this.onError=e=>{let{code:t,isFatal:r}=e;r&&this.trackingEvents.error.forEach(e=>{const r=Ue(e);this.parseAndTrackUrls([e],He({"error-code":()=>String(t)},this.getBufferedInfoGetters(r))),this.clearBufferedInfo(r)})},this.onReady=()=>{this.parseAndTrackUrls(this.trackingEvents.init)},this.onSetSourceComplete=()=>{this.parseAndTrackUrls(this.trackingEvents.setSource)},this.onWatchedTimeChange=e=>{isNaN(e)||this.watchedTimeClock.setTime(1e3*e)},this.onCurrentTimeChange=e=>{this.emit("CurrentTimeChange",e)},this.onAdLoaded=e=>{this.emit("AdLoaded",e)},this.onAdError=()=>{this.emit("AdError")},this.onAdStateChange=e=>{this.emit("AdStateChange",e)},this.onAdPodStart=()=>{this.emit("AdPodStart")},this.onAdPodEnd=()=>{this.emit("AdPodEnd")},this.onAdPodClick=()=>{this.emit("AdPodClick")},this.onAdPodSkip=()=>{this.emit("AdPodSkip")},this.onStateChange=e=>{this.emit("StateChange",e)}}setTrackings(e){this.resetTrackings(),this.trackingEvents=function(e){if(!Array.isArray(e))return e;const t={init:[],start:[],end:[],setSource:[],adStart:[],adRequest:[],adError:[],adEnd:[],adPodStart:[],adPodClick:[],adPodEnd:[],adPodSkip:[],sourceStart:[],play:[],pause:[],seek:[],firstQuartile:[],midpoint:[],thirdQuartile:[],viewed:[],heartbeat:[],watchedTime:[],error:[]};return e.forEach(e=>{(0,qu.J)(e).forEach(e=>{let[r,i]=e;Array.isArray(t[r])||(t[r]=[]),t[r].push(...i)})}),t}(e.trackingEvents);const{start:t,end:r,adStart:i,adError:n,adRequest:s,adEnd:a,adPodStart:o,adPodClick:l,adPodEnd:d,adPodSkip:u,sourceStart:c,play:h,pause:p,error:f,firstQuartile:m,midpoint:g,thirdQuartile:v,viewed:y,heartbeat:S,watchedTime:E}=this.trackingEvents,b=(0,La.I)(()=>{this.parseAndTrackUrls(c)});let A=[...y,...Be(m,25),...Be(g,50),...Be(v,75)],T=!1;[...S,...p,...f].forEach(e=>{const t=Ue(e);this.bufferedInfoByTrackKey[t]={count:0,time:0}});const _=()=>{b(),T=!0,this.parseAndTrackUrls(t),this.heartbeatTimers=S.concat(E.map(Ve)).map(e=>{const[t,{delay:r,offset:i=r,callsCount:n=1/0,utcStart:s,utcEnd:a}]=e,o=Ue(e);let l=0;const d=new Vc.B7(()=>{const e=Math.round(this.params.getUtcPosition());return void 0!==s&&e<s||void 0!==a&&e>a?1e3:0===l?(l++,i):(this.parseAndTrackUrls([t],this.getBufferedInfoGetters(o)),this.clearBufferedInfo(o),l++,l>n?(d.destroy(),0):r)},this.watchedTimeClock);return d}),this.heartbeatTimers.forEach(e=>e.start())};let w=!1,k=!1;this.on("CurrentTimeChange",e=>{if(!this.isStreamPlaying())return;!T&&e>0&&_();const t=this.params.getDuration();if(!t)return;if(this.params.getVideoType()!==jc.Z.VOD)return;const r=e/t;A=A.filter(e=>{let[t,{percent:i}]=e;return!(r>i/100)||(this.parseAndTrackUrls([t]),!1)})}),this.on("AdStateChange",e=>{let{state:t,type:r}=e;const n=t===tu.PLAYING;n&&b(),this.parseAndTrackUrls(n?i:a),this.clientAdTimeMeasurer.reset()}),this.on("AdLoaded",e=>{let{adType:t}=e;this.parseAndTrackUrls(s,{"ad-position":()=>je(t)})}),this.on("AdError",()=>{this.parseAndTrackUrls(n)});let R=null;this.on("StateChange",e=>{if(this.isAdPlaying())R=null;else if(e===Wl.X.BUFFERING)R=(0,xa.u)();else if(null!==R){const e=R()/1e3;R=null;for(const t in this.bufferedInfoByTrackKey)Object.prototype.hasOwnProperty.call(this.bufferedInfoByTrackKey,t)&&(this.bufferedInfoByTrackKey[t].count++,this.bufferedInfoByTrackKey[t].time=e+this.bufferedInfoByTrackKey[t].time)}}),this.on("StateChange",e=>{this.isAdPlaying()?e===Wl.X.PLAY?this.clientAdTimeMeasurer.start():this.clientAdTimeMeasurer.pause():this.clientAdTimeMeasurer.reset()}),this.on("StateChange",e=>{if(e===Wl.X.END)return void this.parseAndTrackUrls(r);if(!w){if(e===Wl.X.PLAY)this.initialBufferingTime=this.measureInitialBufferingTime?Math.floor(Math.floor(this.measureInitialBufferingTime())):Math.floor(0),this.parseAndTrackUrls(h),w=!0,k=!0;else if(e===Wl.X.BUFFERING){var t;this.measureInitialBufferingTime=null!=(t=this.measureInitialBufferingTime)?t:(0,xa.u)()}return}if(this.isAdPlaying())return;const i=e===Wl.X.PLAY||e===Wl.X.BUFFERING;i!==k&&(k=i,i?this.parseAndTrackUrls(h):p.forEach(e=>{const t=Ue(e);this.parseAndTrackUrls([e],this.getBufferedInfoGetters(t)),this.clearBufferedInfo(t)}))});let P=!1,C=!1;this.on("AdPodStart",()=>{P=!0,C=!1,this.parseAndTrackUrls(o),this.clientAdTimeMeasurer.reset()}),this.on("AdPodClick",()=>{this.parseAndTrackUrls(l),this.clientAdTimeMeasurer.reset()}),this.on("AdPodSkip",()=>{C=!0,this.parseAndTrackUrls(u),this.clientAdTimeMeasurer.reset()}),this.on("AdPodEnd",()=>{!C&&P?(P=!1,this.parseAndTrackUrls(d),this.clientAdTimeMeasurer.reset()):P=!1})}destroy(){this.resetTrackings(),this.emit("Destroy"),this.off("Destroy")}clearBufferedInfo(e){const t=this.bufferedInfoByTrackKey[e];void 0!==t&&(t.time=0,t.count=0)}getBufferedInfoGetters(e){const t=this.bufferedInfoByTrackKey[e];return{"buffering-duration":()=>void 0===t?"":Math.floor(t.time),"buffering-count":()=>void 0===t?"":t.count}}isStreamPlaying(){return this.params.getPlayingState()===Wl.X.PLAY&&!this.isAdPlaying()}isAdPlaying(){return this.params.getAdState().state===tu.PLAYING}resetTrackings(){this.heartbeatTimers.forEach(e=>e.destroy()),this.clientAdTimeMeasurer.reset(),this.watchedTimeClock.reset(),this.bufferedInfoByTrackKey={},this.measureInitialBufferingTime=void 0,this.initialBufferingTime=void 0,this.off("StateChange"),this.off("AdStateChange"),this.off("AdLoaded"),this.off("AdError"),this.off("AdPodStart"),this.off("AdPodClick"),this.off("AdPodSkip"),this.off("AdPodEnd"),this.off("CurrentTimeChange")}parseAndTrackUrls(e,t){void 0===t&&(t={});const i=He({},this.MACROS,t);e.forEach(e=>{const t=Fc.reduce((e,t)=>{const r=i[t];return void 0===r?e:Me(e,t,String(r()))},e);if(function(e){{const{OTT_TRACKING_REGEXP:t}=r(6336);return t.test(e)}}(e)){const r=(0,Yu.ce)("data",t);Fe({url:e.split("?")[0],data:"["+r+"]",contentType:"application/json"})}else xe(t)})}}const qc=function(e){return void 0===e&&(e=window),/YandexSearch|YaSearchBrowser|YaApp_iOS|YaApp_Android/i.test((0,Md.i)(e))},Yc=qc()?"#feedback__app-problem":"#feedback__browser-problem";var Gc=r(6690),Kc=r(3834),zc=r(9200),Zc=r(5636);const Xc=(0,Yu.en)(window.location.href).hostname.split(".").reverse()[0];var Qc=r(7668);const Jc=()=>Ke({method:"GET",url:"https://frontend.vh.yandex.ru/csrf_token",retries:3,withCredentials:!0}).then(e=>{try{return{token:e}}catch(t){return{token:""}}}),$c=()=>Ke({method:"GET",url:"https://cloud-api.yandex.ru/videoplayer/v1/personality/profile/yandex_io/devices/",retries:3,withCredentials:!0}).then(e=>{try{const{items:t}=JSON.parse(e);return t&&t.length?t:[]}catch(t){return[]}}),eh=()=>Ke({method:"GET",url:"https://quasar.yandex.<tld>/devices_online_stats",retries:3,withCredentials:!0}).then(e=>{try{const{items:t}=JSON.parse(e);return t&&t.length?t:[]}catch(t){return[]}}),th=(e,t)=>{const r={msg:Ge({},e.config,{start_position:e.startPosition}),device:e.externalPlayerId};return Ke({method:"POST",url:"https://yandex.ru/video/station",headers:{"X-CSRF-TOKEN":t},data:JSON.stringify(r),retries:3,withCredentials:!0}).then(e=>{const t=JSON.parse(e);if("play"!==t.status)throw new Error("ExternalPlaybackError: "+t.msg)})};let rh;!function(e){e.OK="OK",e.SLOW="SLOW",e.UNKNOWN="UNKNOWN"}(rh||(rh={}));var ih=r(9884);const nh={min:1,max:1/0},sh={min:0,max:1};let ah;!function(e){e.play="play",e.pause="pause",e.seek="seek",e.setSource="setSource",e.preloadSource="preloadSource",e.abortPreloadSource="abortPreloadSource",e.setVolume="setVolume",e.setMuted="setMuted",e.setFullscreen="setFullscreen",e.setPictureInPicture="setPictureInPicture",e.setPlaybackRate="setPlaybackRate",e.setVideoTrack="setVideoTrack",e.setAudioTrack="setAudioTrack",e.setTextTrack="setTextTrack",e.setNativeTextTrackVisibility="setNativeTextTrackVisibility",e.setNativeAdControlsVisibility="setNativeAdControlsVisibility",e.setHiddenControls="setHiddenControls",e.setVideoStyle="setVideoStyle",e.setPictureInPictureEnabled="setPictureInPictureEnabled",e.setExternalVisualState="setExternalVisualState",e.getExternalVisualState="getExternalVisualState",e.requestDebugInfo="requestDebugInfo",e.xhrRequest="xhrRequest",e.stopAd="stopAd",e.playInrollAd="playInrollAd",e.skipAdPod="skipAdPod",e.playAdViewers="playAdViewers",e.destroy="destroy",e.logDelta="logDelta"}(ah||(ah={}));const oh={},lh={};class dh extends Bc.v{constructor(e){let{id:t,sender:r,receiver:i}=e;super(),this.id=void 0,this.sender=void 0,this.receiver=void 0,this.id=t,this.sender=r,this.receiver=i;i["handle_event_"+t]=e=>this.emit("Event",e);i["handle_command_"+t]=e=>this.emit("Command",e)}sendEvent(e,t){let{sourceId:r=NaN,data:i}=t;try{this.sender["handle_event_"+this.id]({eventName:e,data:i,sourceId:r})}catch(n){}}sendCommand(e,t){try{this.sender["handle_command_"+this.id]({commandName:e,params:t,sendAnswer:ed.Z})}catch(r){}}sendRequest(e,t){return new Promise(r=>{try{this.sender["handle_command_"+this.id]({commandName:e,params:t,sendAnswer:r})}catch(i){}})}destroy(){this.receiver["handle_event_"+this.id]=void 0,this.receiver["handle_command_"+this.id]=void 0,this.off("Command"),this.off("Event")}}var uh=r(9002),ch=r(8225),hh=r(106);const ph={no_licenses:{message:"ACCESS_ERROR_NO_LICENSE",code:151},invalid_region:{message:"ACCESS_ERROR_INVALID_REGION",code:153},old_browser:{message:"ACCESS_ERROR_OLD_BROWSER",code:5},future_vod_release:{message:"ACCESS_ERROR_FUTURE_VOD_RELEASE",code:100},access_denied:{message:"ACCESS_DENIED",code:100},unexpected:{message:"ACCESS_ERROR_UNEXPECTED",code:100},unsupported_browser:{message:"ACCESS_ERROR_UNSUPPORTED_BROWSER",code:412},not_found:{message:"ACCESS_ERROR_NOT_FOUND",code:404},video_processing:{message:"VIDEO_PROCESSING",code:100},video_processing_failed:{message:"VIDEO_PROCESSING_FAILED",code:100}};(0,hh.z)(ph).map(e=>{let{code:t}=e;return String(t)});var fh=r(1485);class mh extends uh.M{constructor(e){super(),this.params=e,this.destroyed=!1,this.requestSourceConfigTimeout=void 0,this.currentPoster=void 0,this.currentUgcLiveStatus=void 0,this.releaseDate=void 0,this.releaseDate=(()=>{var t,r,i;const n=parseInt(String(null==(t=this.params.queryParams)?void 0:t.release_timeout),10);if(n)return Date.now()/1e3+n;const s=parseInt((null==(r=e.vhParams)||null==(i=r.content)?void 0:i.release_date)||"",10)||void 0;return void 0!==s&&Date.now()/1e3<s?s:void 0})(),this.once("Destroy",()=>{this.destroyed=!0,window.clearTimeout(this.requestSourceConfigTimeout),void 0!==this.currentUgcLiveStatus&&(this.currentUgcLiveStatus=void 0,this.emit("UgcLiveStatusChange",void 0))}),Promise.resolve().then(()=>{this.start()})}async start(){if(this.params.vhParams){var e;const t=new fh.y(this.params.queryParams,this.params.playerApi),r=await t.getPlayerConfig(this.params.vhParams);this.handleVhAnswer({vhParams:this.params.vhParams,sourceConfig:r.source,skinConfig:(null==(e=r.skinParams)?void 0:e.skinConfig)||{},autoplay:r.autoplay})}else await this.run()}async run(e){void 0===e&&(e=0);try{await this.requestSourceConfig()}catch(t){return 3<=e?void this.emit("Error",new Fl({code:Ba.REQUEST_SOURCE_ERROR,category:/timeout/i.test(String(t))?Ya.q.NETWORK_TIMEOUT:Ya.q.NETWORK_MEDIA,details:t,isFatal:!0})):(e++,this.run(e))}}async requestSourceConfig(){const e=this.getContentId();if(this.destroyed||!e)return;const{sourceConfig:t,vhParams:r,skinConfig:i,playerConfig:n}=await(0,ch.s6)(e,this.params.queryParams);if(this.destroyed)return;const{autoplay:s}=n;this.handleVhAnswer({vhParams:r,sourceConfig:t,skinConfig:i,autoplay:s})}handleVhAnswer(e){var t,r,i;let{sourceConfig:n,skinConfig:s,vhParams:a,autoplay:o}=e;const l=function(e){if(void 0!==e)return e.error?ph[e.error]||ph.unexpected:void 0===e.content?ph.not_found:void 0}(a);var d;if(l)return this.requestSetPoster(null==n?void 0:n.preview),this.emit("ShowAnnotation",l.message),void this.emit("Error",new Fl({code:"VH_"+String(l.message),isFatal:!0,details:{reqId:null==(d=a.user_data)?void 0:d.req_id}}));this.releaseDate&&Date.now()/1e3<this.releaseDate?this.handleVhAnswerForReleaseDate({sourceConfig:n,releaseDate:this.releaseDate}):null!=(t=a.content)&&t.ugc_live?this.handleVhAnswerForUgc({sourceConfig:n,skinConfig:s,autoplay:o,vhParamsContent:a.content}):this.requestSetSource({sourceConfig:n,skinConfig:s,autoplay:o,externalPlayerConfig:null==(r=a.content)?void 0:r.yastation_cast_cfg,maxVideoSize:null==(i=a.content)?void 0:i.max_video_size})}handleVhAnswerForUgc(e){let{sourceConfig:t,skinConfig:r,vhParamsContent:i,autoplay:n}=e;const{ugc_live_status:s,reload_on_ready:a}=i;if(this.currentUgcLiveStatus!==s&&(this.currentUgcLiveStatus=s,this.emit("UgcLiveStatusChange",this.currentUgcLiveStatus)),"onair"===s||"finished"===s||"ready"===s&&a)return void this.requestSetSource({sourceConfig:t,skinConfig:r,autoplay:n,externalPlayerConfig:i.yastation_cast_cfg,maxVideoSize:i.max_video_size});let o;this.requestSetPoster(t.preview),"cancelled"===s?o="UGC_LIVE_CANCELLED":("offline"===s||"ready"===s&&!a)&&(o="UGC_LIVE_OFFLINE"),void 0!==o&&this.emit("ShowAnnotation",o),window.clearTimeout(this.requestSourceConfigTimeout);const l=Math.max(i.auto_reload_ms||6e4,5e3);this.requestSourceConfigTimeout=window.setTimeout(()=>this.run(),l)}handleVhAnswerForReleaseDate(e){let{releaseDate:t,sourceConfig:r}=e;this.requestSetPoster(r.preview),this.emit("ShowAnnotation","UGC_LIVE_OFFLINE"),window.clearTimeout(this.requestSourceConfigTimeout);const i=1e3*Math.max(t-Date.now()/1e3,0);this.requestSourceConfigTimeout=window.setTimeout(()=>this.run(),i)}requestSetSource(e){this.setupUpdateRetriesCount(e.sourceConfig),this.emit("SetSource",e)}requestSetPoster(e){this.currentPoster!==e&&(this.currentPoster=e,this.emit("SetPoster",e))}getContentId(){var e,t;return this.params.contentId||(null==(e=this.params.vhParams)||null==(t=e.content)?void 0:t.content_id)}setupUpdateRetriesCount(e){const t=e.update,{playerApi:r}=this.params;if(!t||!r)return;let i=0;const n=async()=>{if(1<=i)return;i+=1;const e=await t();return e?(e.update=n,e):void 0};e.update=n;const s=()=>{i=0};r.on(Xl.ContentImpression,s),this.once("Destroy",()=>{r.off(Xl.ContentImpression,s)})}}const gh=[Ya.q.NO_CODECS,Ya.q.UNSUPPORTED_ENV,Ya.q.CONFIG,Ya.q.NETWORK_PLAYER,Ya.q.BANNED,Ya.q.REGIONAL],vh=it({},{onReady:!1,onResourcesIdle:!1,onInit:!1,onInitError:!1,onVolumeChange:!1,onFullScreenChange:!1,onVisualStateChange:!1,onStartStageChange:!1,onNextAdRemainingTimeChange:!1,onStreamsWithSupportInfoChange:!1,onLogEvent:!1,onPreloadSourceResolve:!1,onPreloadSourceReject:!1,onBandwidthEstimateChange:!1,onRequestFullscreenChange:!1,onPlaybackQualityUpdate:!1,onExpectedStalledChange:!1,onCapSizeChange:!1},{onChangeStream:!0,onDrmSystemChange:!0,onStateChange:!0,onAdStateChange:!0,onAdLoaded:!0,onAdError:!0,onBeforeAdPodStart:!0,onAdPodStart:!0,onAdPodClick:!0,onAdPodSkip:!0,onAdPodEnd:!0,onAdSkippableStateChange:!0,onAdVolumeAvailabilityStateChange:!0,onAdPodCloseStateChange:!0,onAdPodDurationChange:!0,onAdPodCurrentTimeChange:!0,onAdPodTimeToSkipChange:!0,onAdInteraction:!0,onPositionChange:!0,onTimelineInfoChange:!0,onError:!0,onRecover:!0,onVideoTrackChange:!0,onVideoTracksChange:!0,onAudioTrackChange:!0,onAudioTracksChange:!0,onTextTrackChange:!0,onTextTracksChange:!0,onSubtitlesChange:!0,onThumbnailTileGeneralMetaInfoChange:!0,onVideoTypeChange:!0,onVideoSizeChange:!0,onOriginalBroadcastAdStateChange:!0,onContentImpression:!0,onBufferingRangesChange:!0,onPlaybackRateChange:!0,onEngineChange:!0,onInrollFrame:!0,onFrameRendered:!0,onTargetLatencyChange:!0});var yh=r(8243);const Sh=[{enabled:"fullscreenEnabled",element:"fullscreenElement",request:"requestFullscreen",exit:"exitFullscreen",events:{change:"fullscreenchange",error:"fullscreenerror"}},{enabled:"webkitFullscreenEnabled",element:"webkitFullscreenElement",request:"webkitRequestFullscreen",exit:"webkitExitFullscreen",events:{change:"webkitfullscreenchange",error:"webkitfullscreenerror"}},{enabled:"mozFullScreenEnabled",element:"mozFullScreenElement",request:"mozRequestFullScreen",exit:"mozCancelFullScreen",events:{change:"mozfullscreenchange",error:"mozfullscreenerror"}},{enabled:"msFullscreenEnabled",element:"msFullscreenElement",request:"msRequestFullscreen",exit:"msExitFullscreen",events:{change:"MSFullscreenChange",error:"MSFullscreenError"}},{enabled:"webkitSupportsFullscreen",element:"webkitDisplayingFullscreen",request:"webkitEnterFullscreen",exit:"webkitExitFullscreen",events:{change:"webkitfullscreenchange",error:"webkitfullscreenerror"}}],Eh=["from_block","stream_block"];let bh;!function(e){e.PLAY="PLAY",e.PAUSE="PAUSE",e.PREVENT_ACTIONS="PREVENT_ACTIONS",e.CALL_NEXT="CALL_NEXT"}(bh||(bh={}));const Ah=()=>e=>{let{next:t}=e;t({actionType:bh.PREVENT_ACTIONS})},Th=e=>{let{settings:t}=e;return void 0===t?Ah():e=>{let{next:t,getState:r}=e;const{visualState:i}=r();return i.isFullScreen?t({actionType:i.isDocumentVisible?bh.PLAY:bh.PAUSE}):t({actionType:bh.CALL_NEXT})}},_h=e=>{let{settings:t}=e;return void 0===t?Ah():e=>{let{next:t,getState:r}=e;const{visualState:i}=r();return t({actionType:(i.isVisibilitySupported?i.isElementVisible:i.isDocumentVisible)?bh.PLAY:bh.PAUSE})}},wh=e=>{let{settings:t}=e;return void 0===t?Ah():e=>{let{next:r,getState:i}=e;return t.onlyMuted&&!i().muted?r({actionType:bh.PREVENT_ACTIONS}):r({actionType:bh.CALL_NEXT})}},kh=e=>{let{settings:t}=e;return void 0===t?Ah():e=>{let{next:t,getState:r}=e;return r().visualState.isPip?t({actionType:bh.PREVENT_ACTIONS}):t({actionType:bh.CALL_NEXT})}},Rh=(e,t,r,i)=>function(){try{return t.apply(r||this,arguments)}catch(io){if((0,Ql.m)(i)&&i(io),!0===io.preventProtect)throw io;Rh.log(io,e)}};Rh.log=function(e,t){console.log("LOG:"+t+":"+e)},Rh.setTimeout=(e,t,r,i)=>window.setTimeout(Rh("timeout",e,r,i),t);const Ph=function(e,t){return void 0===t&&(t={}),(r,i)=>{let n;const s={portion:void 0!==t.portion?t.portion:0,interval:void 0!==t.interval?t.interval:300,overlappedPoints:void 0!==t.overlappedPoints?t.overlappedPoints:[[0,0]]},a=e({portion:Math.max(Number.MIN_VALUE,s.portion),interval:s.interval,overlappedPoints:s.overlappedPoints,element:r,callback:Rh("visibilityObserver",e=>{n!==e&&(n=e,i(e))})});if(!a)throw new Error("visibilityObserver: no strategy");return a.start(),(0,La.I)(()=>a.stop())}};class Ch{static from(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return e=>{const r=[];for(const i of t){let t=()=>null;const n=i(ot({},e,{callback:e=>t(e)}));if(!n)return null;r.push(e=>(t=e,n))}return new Ch({callback:e.callback,strategyFactories:r})}}constructor(e){this.args=e,this.strategies=void 0,this.runningCount=0,this.callback=(e,t)=>{const r=e+1;t?r===this.strategies.length?this.args.callback(t):r===this.runningCount&&this.startNext():(this.stopUntil(r),this.args.callback(t))},this.strategies=Cd(e.strategyFactories,(e,t)=>e(e=>this.callback(t,e)))}start(){!this.runningCount&&this.strategies.length&&this.startNext()}stop(){this.stopUntil(0)}get isDetermined(){for(const e of this.strategies)if(!e.isDetermined)return!1;return!0}getIsVisible(){for(let e=0;e<this.strategies.length;e++)if(!this.strategies[e].getIsVisible())return!1;return!0}startNext(){this.strategies[this.runningCount++].start()}stopUntil(e){for(;this.runningCount>e;)this.strategies[--this.runningCount].stop()}}var Ih=r(3751),Oh=r(5531);let Dh="hidden",Nh="visibilitychange";if(!(Dh in document)){const e=["webkit","moz","ms","o"];for(const t of e){const e=t+"Hidden";if(e in document){Dh=e,Nh=t+"visibilitychange";break}}}const Lh=new class{constructor(e){void 0===e&&(e=window),this.windowObj=e,this.yaBroApiInstance=void 0,this.initYaBrowserApi()}canUseYaBroApi(){return Boolean(this.yaBroApiInstance&&this.yaBroApiInstance.isInCustoPage)}isPageHiddenYaBroApi(){return!(this.yaBroApiInstance&&this.yaBroApiInstance.pageVisible)}initYaBrowserApi(){this.windowObj.browser&&this.windowObj.browser.BrowserEmbeddedApi&&this.windowObj.browser.BrowserEmbeddedApi.getInstance().then(e=>{this.yaBroApiInstance=e})}};class xh{static factory(e){return new xh(e)}constructor(e){this.args=e,this.isDetermined=!0,this.subscription=void 0,this.timer=void 0,this.onVisibilityChangeCallback=()=>{this.args.callback(this.getIsVisible())}}start(){this.timer=window.setTimeout(()=>{this.onVisibilityChangeCallback(),this.subscription=function(e,t,r,i,n){if(!e||!r)return null;let s=ut(Rh("handler:"+t,r,i));const a={un(){(0,Ih.f)(e,t,s)}};var o;return n&&n.once&&!Oh.vE&&(o=s,s=function(e){o.call(this,e),ct(a)}),Oh.wI?(0,Ih.h)(e,t,s,n):(0,Ih.h)(e,t,s,n&&n.capture),a}(document,Nh,this.onVisibilityChangeCallback)})}stop(){window.clearTimeout(this.timer),ct(this.subscription)}getIsVisible(){return!(Lh.canUseYaBroApi()?Lh.isPageHiddenYaBroApi():Boolean(document[Dh]))}}const Mh=e=>{try{const{left:t,right:r,top:i,bottom:n}=e.getBoundingClientRect();return{left:t,right:r,top:i,bottom:n,width:r-t,height:n-i}}catch(io){return{left:0,width:0,top:0,height:0,right:0,bottom:0}}};class Fh{static factory(e){return"undefined"===typeof IntersectionObserver?null:"thresholds"in IntersectionObserver.prototype&&e.element?new Fh(e):null}constructor(e){this.args=e,this.isDetermined=!0,this.observer=void 0,this.threshold=void 0,this.callback=e=>{const t=e[e.length-1].intersectionRatio>=this.observer.thresholds[0];this.args.callback(t)},this.threshold=Math.max(2**-149,this.args.portion),this.observer=new IntersectionObserver(this.callback,{threshold:this.threshold})}start(){this.observer.observe(this.args.element)}stop(){this.observer.disconnect()}getIsVisible(){return e=this.args.element,t=this.threshold,pt(e)>=(t||Number.MIN_VALUE);var e,t}}var Vh=r(7633);class Bh extends class{constructor(e){this.args=e,this.isDetermined=!0,this.timer=void 0}start(){this.timer=window.setInterval(Rh("visibilityObserver",()=>{this.args.callback(this.isVisible())}),this.args.interval)}stop(){window.clearInterval(this.timer)}getIsVisible(){return this.isVisible()}}{static factory(e){return e.element?new Bh(e):null}constructor(e){super(e),this.args=e,this.isDetermined=void 0,this.windowChain=(0,Vh.T)(window).windowChain.reverse();try{this.isDetermined=Boolean((window.top||window).location.hostname)}catch(io){this.isDetermined=!1}}isVisible(){const e=Mh(this.args.element),t=e.width*e.height;if(t<=0)return!1;const r=function(e,t,r){let i=0;for(arguments.length<3&&(i=1,r=e[0]);i<e.length;i++)r=t(r,e[i],i,e);return r}(this.windowChain,(e,t)=>this.getFrameVisiblePart(t,e),void 0),i=Math.max(e.left,r.left),n=Math.max(e.top,r.top);return(Math.min(e.right,r.right)-i)*(Math.min(e.bottom,r.bottom)-n)>=Math.floor(t*this.args.portion)}getFrameVisiblePart(e,t){if(!t||!e.frameElement)return{left:0,right:e.innerWidth,top:0,bottom:e.innerHeight};const r=Mh(e.frameElement);return{left:Math.max(t.left-r.left,0),right:e.innerWidth-Math.max(r.right-t.right,0),top:Math.max(t.top-r.top,0),bottom:e.innerHeight-Math.max(r.bottom-t.bottom,0)}}}let Uh=null;try{"undefined"!==typeof IntersectionObserver&&(Uh=Ch.from(class{static from(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return e=>{for(const r of t){const t=r(e);if(t)return t}return null}}}.from(Fh.factory,Bh.factory),xh.factory))}catch(TE){}class jh extends Bc.v{constructor(e,t){super(),this.visibilityThreshold=-1,this.state={isPip:!1,isFullScreen:!1,isDocumentVisible:(0,Vl.s)(document),isElementVisible:!0,isVisibilitySupported:null!==Uh},this.element=void 0,this.observe=e=>(this.on("Change",e),()=>this.off("Change",e)),this.notifyDocumentVisibility=e=>{this.state.isDocumentVisible!==e&&(this.state=ft({},this.state,{isDocumentVisible:e}),this.handleChange())},this.notifyElementVisibility=e=>{this.state.isElementVisible!==e&&(this.state=ft({},this.state,{isElementVisible:e}),this.handleChange())},this.element=e,this.state.isDocumentVisible=(0,Vl.s)(e.ownerDocument),t&&(this.visibilityThreshold=Math.min(t.threshold,.99)),this.observeVisibility()}notifyFullScreen(e){this.state.isFullScreen!==e&&(this.state=ft({},this.state,{isFullScreen:e}),this.handleChange())}notifyPip(e){this.state.isPip!==e&&(this.state=ft({},this.state,{isPip:e}),this.handleChange())}destroy(){this.emit("Destroy"),this.off("Change")}getState(){return this.state}observeVisibility(){if(this.state.isVisibilitySupported)try{const e=Ph(Uh,{portion:this.visibilityThreshold})(this.element,this.notifyElementVisibility);this.once("Destroy",e),this.once("Restart",e),this.once("Restart",()=>this.off("Destroy",e))}catch(e){this.state.isVisibilitySupported=!1,this.state.isElementVisible=!0}try{const e=Ph(Ch.from(xh.factory))(this.element,this.notifyDocumentVisibility);this.once("Destroy",e),this.once("Restart",e),this.once("Restart",()=>this.off("Destroy",e))}catch(e){}}restart(){this.emit("Restart"),this.observeVisibility()}handleChange(){this.emit("Change",this.state)}}class Hh{constructor(e){let{element:t,togglePlaybackVisibilitySetting:r,playerStateAdaptor:i,playPauseController:n}=e;this.visibilityObserver=void 0,this.playerStateAdaptor=void 0,this.playPauseController=void 0,this.middlewareInitParams=void 0,this.middlewareList=void 0,this.destroyCallbacks=void 0,this.lastChainId=0,this.done=e=>{switch(e.actionType){case bh.PLAY:return this.playPauseController.play();case bh.PAUSE:return this.playPauseController.pause();case bh.PREVENT_ACTIONS:case bh.CALL_NEXT:return}},this.destroyCallbacks=[],this.visibilityObserver=new jh(t,r),this.playPauseController=n;const s=this.visibilityObserver.observe(()=>{this.emitChange()}),a=i.onChange(()=>{this.emitChange()});this.playerStateAdaptor=i,this.destroyCallbacks.push(s,a,()=>this.visibilityObserver.destroy()),this.middlewareInitParams={settings:r},this.middlewareList=r?[_h(this.middlewareInitParams),Th(this.middlewareInitParams),kh(this.middlewareInitParams),wh(this.middlewareInitParams)]:[]}appendMiddleware(e){this.middlewareList.unshift(e(this.middlewareInitParams))}prependMiddleware(e){this.middlewareList.push(e(this.middlewareInitParams))}observeVisualState(e){return this.visibilityObserver.observe(e)}restartVisibilityObserver(){return this.visibilityObserver.restart()}getVisualState(){return this.visibilityObserver.getState()}notifyFullScreen(e){this.visibilityObserver.notifyFullScreen(e)}notifyPip(e){this.visibilityObserver.notifyPip(e)}destroy(){this.destroyCallbacks.forEach(e=>e())}emitChange(){const e=++this.lastChainId,t=mt({},this.playerStateAdaptor.getState(),{visualState:this.visibilityObserver.getState()}),r=()=>t;this.middlewareList.reduce((t,i)=>()=>{i({getState:r,next:(0,La.I)(r=>{if(e===this.lastChainId)return r.actionType===bh.CALL_NEXT?t():this.done(r)})})},Yl.Z)()}}class Wh{actualizeAutoplay(e){this.expectedAutoplay=e}constructor(e){let{play:t,pause:r,togglePlaybackVisibilitySetting:i,autoplay:n,playerStateAdaptor:s,logEvent:a}=e;this.play=void 0,this.pause=void 0,this.destroy=void 0,this.paused=!1,this.wasEverPlaying=!1,this.pausedViaController=!1,this.expectedAutoplay=!1,this.expectedAutoplay=n,this.paused=!gt(s.getState()),this.play=()=>{(function(e){let{playingState:t,togglePlaybackVisibilitySetting:r,autoplay:i,wasEverPlaying:n}=e;return!!r&&(n?!gt({playingState:t}):(r.forceAutoplay||i)&&!vt({playingState:t}))})(yt({},s.getState(),{togglePlaybackVisibilitySetting:i,autoplay:this.expectedAutoplay,wasEverPlaying:this.wasEverPlaying}))&&(!this.pausedViaController&&this.wasEverPlaying||(this.pausedViaController=!1,t(),a("PlayVideoOnVisibilityChange")))},this.pause=()=>{this.paused||(this.pausedViaController=!0,this.paused=!0,r(),a("PauseVideoOnVisibilityChange"))},this.destroy=s.onChange(()=>{const e=s.getState(),t=gt(e);this.wasEverPlaying=vt(e)&&(e.hasWatchedTime||e.adState.state===tu.PLAYING)||this.wasEverPlaying,this.paused=!t,t&&(this.pausedViaController=!1)})}}class qh{constructor(e){this.playerApi=void 0,this.handlers=void 0,this.previousWatchedTime=0,this.emitChange=()=>{this.handlers.forEach(e=>e())},this.emitWatchedTimeChange=e=>{let{watchedTime:t}=e;(this.previousWatchedTime>0&&0===t||0===this.previousWatchedTime&&t>0)&&this.emitChange(),this.previousWatchedTime=t},this.playerApi=e;if(!e.getState())throw new Error("PlayerStateAdaptorV2 should use only inited PlayerApi");this.handlers=[],this.playerApi.on(Xl.WatchedTimeChange,this.emitWatchedTimeChange),this.playerApi.on(Xl.PlayingStateChange,this.emitChange),this.playerApi.on(Xl.MutedChange,this.emitChange),this.playerApi.on(Xl.AdStateChange,this.emitChange)}getState(){const e=this.playerApi.getState();return{hasWatchedTime:e.watchedTime>0,muted:e.muted,playingState:e.playingState,playingStateReason:e.playingStateReason,adState:e.adState}}onChange(e){return this.handlers.push(e),()=>{this.handlers=this.handlers.filter(t=>t!==e)}}destroy(){this.playerApi.off(Xl.WatchedTimeChange,this.emitWatchedTimeChange),this.playerApi.off(Xl.PlayingStateChange,this.emitChange),this.playerApi.off(Xl.MutedChange,this.emitChange),this.playerApi.off(Xl.AdStateChange,this.emitChange),this.handlers=[]}}var Yh=r(9320);const Gh="#FFCC00",Kh=navigator&&"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1,zh=(e,t)=>{for(let r=0;r<e.length;r++)if(t(e[r],r,e))return!0;return!1},Zh=function(e){void 0===e&&(e=window);const t=e.navigator.userAgent,r=t.indexOf("Android");return-1===r?-1:parseFloat(t.slice(r+8))}(),Xh=function(e){void 0===e&&(e=window);const{platform:t=""}=e.navigator||{};return function(e){void 0===e&&(e=window);const{vendor:t=""}=e.navigator||{};return 0===t.indexOf("Google")}(e)&&!Le(e)&&0===t.indexOf("Linux ")&&ee(e)}(),Qh=[["XiaoMi/MiuiBrowser",11],["UCBrowser",12],["HuaweiBrowser",9]],Jh=(function(e){void 0===e&&(e=window);const{major:t,minor:r}=function(e){void 0===e&&(e=window);const t=(0,Md.i)(e).match(/AppleWebKit\/(\d+)\.(\d+)/);if(!t)return{major:-1,minor:-1};const[,r,i]=t;return{major:parseInt(r,10),minor:parseInt(i,10)}}(e),i=function(e){const t=(0,Md.i)(e).match(/Chrom(e|ium)\/([0-9]+)\./);return t?parseInt(t[2],10):-1}(e),n=Le(e)}(window),function(e){return void 0===e&&(e=window),-1!==Dd(e)}());var $h=r(9761);const ep=ed.Z,tp=ed.Z,rp=ed.Z,ip=e=>{let{win:t,propertyName:r}=e;return{call:e=>ep(wt({win:t,propertyName:r},e)),subscribe:e=>rp(wt({win:t,propertyName:r},e)),wait:e=>(e=>{let{propertyName:t,win:r}=e;return new Promise(e=>{rp({callback:function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return e(r)},propertyName:t,win:r})})})(wt({win:t,propertyName:r},e)),waitUntil:e=>(e=>{let{propertyName:t,win:r,comparator:i}=e;return new Promise(e=>{rp({propertyName:t,win:r,callback:function(){i(...arguments)&&e()}})})})(wt({win:t,propertyName:r},e)),clear:e=>tp(wt({win:t,propertyName:r},e))}};ip({propertyName:"YANDEX_DESTROYABLE_GLOBAL_CALLBACK_PROPERTY_NAME",win:window});class np{get destroyReason(){return this._destroyReason}get isDestroyed(){return this._isDestroyed}static addErrorHandler(e){np.errorHandlers.push(e)}constructor(){this._isDestroyed=!1,this.destroyHandlers=[],this._destroyReason=void 0}addDestroyHandler(e){this._isDestroyed?e(this._destroyReason):this.destroyHandlers.push(e)}destroy(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const[i]=t;if(!this._isDestroyed){this._isDestroyed=!0,this._destroyReason=i;try{X(this.destroyHandlers,...t)}catch(n){X(np.errorHandlers,n)}this.destroyHandlers.length=0}}}np.errorHandlers=[];const sp={position:"absolute",width:"100%",height:"100%",top:"0",left:"0"},ap=kt({},sp,{overflow:"hidden",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",pointerEvents:"none"}),op=kt({},sp,{backgroundSize:"cover",backgroundPosition:"center center",backgroundRepeat:"no-repeat"});class lp extends np{constructor(e){let{container:t,onReady:r=Yl.Z,src:i,firstFrameHash:n,firstFrameUrl:s,style:a}=e;super(),this.container=void 0,this.background=void 0,this.src=void 0,this.style=void 0,this.onReady=void 0,this.src=i,this.style=a,this.onReady=(0,La.I)(r),this.container=document.createElement("div"),this.src?this.setPoster(this.src,n,s):W(this.container,{opacity:"0"}),this.addDestroyHandler(()=>{Q(this.container),this.onReady=Yl.Z}),t.appendChild(this.container)}setPoster(e,t,r){if(this.isDestroyed)return;if(!e&&(!t||!r))return void this.onReady();this.src=t&&r?r:e,W(this.container,kt({},ap,{opacity:"1"}));const i={backgroundImage:t?"url("+t+")":"url("+this.src+")",transition:t&&r?"background-image 1s":""};this.initBackground(i,Boolean(t&&r))}setStyle(e){this.isDestroyed||(this.style=e,this.background&&e&&W(this.background,kt({},e.objectFit?{backgroundSize:e.objectFit}:{})))}async initBackground(e,t){var r;null==(r=this.background)||r.remove();const i=this.background=document.createElement("div");W(i,op),this.setStyle(this.style);const n=xe(this.src);Jh&&await n,W(i,e),this.container.appendChild(i),n.then(()=>{t&&W(this.background,{backgroundImage:'url("'+this.src+'")'}),this.onReady()}).catch(Yl.Z)}}var dp=r(808);const up=function(e,t,r,i){void 0===r&&(r=0),void 0===i&&(i=cp);for(let n=r;n<e.length;n++)if(i(e[n],t))return n;return-1},cp=(e,t)=>e===t,hp=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const{resolver:i,preparers:n}=Rt(t);let s,a=null,o=null;return function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];if(a&&a.every((e,r)=>t[r]===e))return s;const l=n.map(e=>e(...t));if(o&&o.every((e,t)=>l[t]===e))return a=t,s;const d=i(...l);return a=t,o=l,s=d,d}},pp="http://www.w3.org/2000/svg",fp="classList"in document.documentElement,mp=hp(e=>e.classList&&e.classList.add,wd.t),gp=hp(e=>e.classList&&e.classList.remove,wd.t),vp=(()=>{const e=document.createElement("p");return!!fp&&(e.classList.add("c1","c2"),!!e.classList.contains("c2")&&(e.classList.toggle("c3",!1),!e.classList.contains("c3")))})(),yp=e=>e.split(" ").filter(e=>Boolean(e)),Sp=vp?(e,t)=>{const r=yp(t);e.classList.add(...r)}:(e,t)=>{const r=yp(t);for(let i=0;i<r.length;i++)e.classList.add(r[i])},Ep=function(e,t){return void 0===t&&(t=""),gp(e)?bp(e,t):function(e,t){const r=Pt(e).split(" "),i=t.split(" "),n=[];for(let s=0;s<r.length;s++)r[s]&&-1===up(i,r[s])&&n.push(r[s]);Ct(e,n.join(" "))}(e,t)},bp=vp?(e,t)=>{const r=yp(t);e.classList.remove(...r)}:(e,t)=>{const r=yp(t);for(let i=0;i<r.length;i++)e.classList.remove(r[i])};var Ap=r(856),Tp=r.n(Ap);const _p=r(310),wp=r(7792),kp=(0,La.I)(()=>Ot(Tp().toString())),Rp={display:"flex",position:"absolute",top:"0",left:"0",bottom:"0",right:"0",padding:"20px",color:"#fff",fontSize:"24px",textAlign:"center",justifyContent:"center",alignItems:"center"};var Pp=r(2390);const Cp=[Xl.SourceChange,Xl.DrmSystemChange,Xl.StreamChange,Xl.StartStageChange,Xl.PlayingStateChange,Xl.VideoTypeChange,Xl.UtcStartTimeChange,Xl.CurrentTimeChange,Xl.WatchedTimeChange,Xl.LiveLatencyChange,Xl.DurationChange,Xl.DVRStartTimeChange,Xl.DVRDurationChange,Xl.VolumeChange,Xl.MutedChange,Xl.VolumeChangeReasonChange,Xl.FullscreenStateChange,Xl.PictureInPictureStateChange,Xl.VisibleStateChange,Xl.VideoSizeChange,Xl.VideoTracksChange,Xl.VideoTrackChange,Xl.AudioTracksChange,Xl.AudioTrackChange,Xl.TextTracksChange,Xl.TextTrackChange,Xl.SubtitlesChange,Xl.ErrorChange,Xl.PlaybackRateRangeChange,Xl.PlaybackRateChange,Xl.AdStateChange,Xl.NextAdRemainingTimeChange,Xl.BufferedRangesChange,Xl.TileMetaInfoChange,Xl.TileMetaInfoUrlChange,Xl.ConnectionQualityChange,Xl.AdPodDurationChange,Xl.AdPodCurrentTimeChange,Xl.AdPodTimeToSkipChange,Xl.AdSkippableStateChange,Xl.AdPodCloseStateChange,Xl.AdVolumeAvailabilityStateChange,Xl.UgcLiveStatusChange];class Ip{constructor(e,t){this.state=void 0,this.state=xt({},e);const r=e=>{xt(this.state,e)};Cp.forEach(e=>{t(e,r)})}getState(){return this.state}}const Op=["object"===typeof document&&document&&"onfreeze"in document?"pagehide":"beforeunload","unload"],Dp=e=>{const t=[];for(;e;)try{if(Ft(e),t.push(e),e.parent===e)break;e=e.parent}catch(io){break}return t},Np=(e,t)=>{for(const r of t.split(".")){if(!Bt(e)){e=void 0;break}e=e[r]}return e},Lp="__ADB_CONFIG__",xp=(e,t,r)=>{for(let i=0;i<e.length;i++)t.call(r,e[i],i,e)},Mp=Bt(Lp)&&Bt(Lp.fn)?Lp.fn:void 0,Fp=["encodeUrl","decodeUrl","encodeCSS","isEncodedUrl"],Vp=e=>(e=>{if(Mp)return Mp;const t={},r=Dp(e);for(;r.length;){const e=r.pop();e&&xp(Fp,r=>{if(Vt(t[r]))return;const i=Np(e,"ya.videoAd."+r);Vt(i)&&(t[r]=i)})}return t})(e).encodeUrl;var Bp=r(1662);ip({propertyName:"YANDEX_STATS_GLOBAL_CALLBACK_PROPERTY_NAME",win:window});const Up=jt(),jp=Math.floor(5),Hp=Math.floor(20);var Wp=r(4364),qp=r(3015);const Yp=(()=>{const e=Yt();return void 0===e||e.includes("encrypted-media")})();var Gp=r(8875),Kp=r(7638);const zp=(0,r(9525).I)(),Zp=()=>zp.navigator.wakeLock;class Xp{constructor(e){if(this.params=e,this.visibilityObserver=void 0,this.lockPromise=void 0,this.lockerObj=void 0,this.destroyed=!1,this.handler=async()=>{if(!this.destroyed)if(this.lockPromise)this.lockPromise=this.lockPromise.then(this.handler);else if(this.shouldLock()){if(this.lockerObj)return;this.lockPromise=Zp().request("screen").then(e=>{this.lockPromise=void 0,this.lockerObj=e}).catch(e=>{this.destroy(),this.params.onError(e)})}else this.lockerObj&&(this.lockPromise=this.lockerObj.release().then(()=>{this.lockPromise=void 0}),this.lockerObj=void 0)},!Zp())return void(this.destroyed=!0);const{playerContainer:t,playerApi:r}=e;r.on(Xl.PlayingStateChange,this.handler),r.on(Xl.MutedChange,this.handler),this.visibilityObserver=new jh(t,{threshold:.75}),this.visibilityObserver.observe(this.handler)}restartVisibilityObserver(){var e;this.destroyed||null==(e=this.visibilityObserver)||e.restart()}destroy(){var e;this.destroyed=!0,this.params.playerApi.off(Xl.PlayingStateChange,this.handler),this.params.playerApi.off(Xl.MutedChange,this.handler),null==(e=this.visibilityObserver)||e.destroy()}shouldLock(){const e=this.params.playerApi.getState();if(!e)return!1;const{playingState:t,muted:r}=e;return t!==Wl.X.PAUSE&&t!==Wl.X.END&&(!!this.visibilityObserver&&(this.visibilityObserver.getState().isElementVisible||!r))}}const Qp=document.createElement("video"),Jp="function"===typeof Qp.load;(function(){function e(){return(0,Pd.v)(t.apply(this))}if(!Jp)return;const t=HTMLMediaElement.prototype.play;e.__yaMuffleVideoPlayPromiseOriginalPlay=t,HTMLMediaElement.prototype.play=e})(),"toJSON"in Error.prototype||Object.defineProperty(Error.prototype,"toJSON",{value(){const e={};return(0,Wa.Y)(()=>{Object.getOwnPropertyNames(this).forEach((function(t){e[t]=this[t]}),this)}),e},configurable:!0,writable:!0});const $p="https://strm.yandex.net/int/enc/srvr.xml",ef=-1===$p.indexOf("int/enc/srvr.xml"),tf="3036",rf="2923",nf=["additional"],sf=function(e){return void 0===e&&(e=window),(0,Md.i)(e).indexOf("SamsungBrowser")>-1}();let af=0;const of=[];class lf extends np{constructor(e){super(),this.onResize=void 0,this.resizeObserverCallback=e=>{let[{contentRect:{width:t,height:r}}]=e;this.onResize.dispatch({width:t,height:r})};const t=Mh(e);if(this.onResize=new Hd({width:t.width,height:t.height},(e,t)=>{let{width:r,height:i}=t;return!!(isNaN(r)||isNaN(i)||r<1||i<1)||e.width===r&&e.height===i}),this.addDestroyHandler(()=>{this.onResize.removeAll()}),"undefined"!==typeof ResizeObserver)try{const t=new ResizeObserver(this.resizeObserverCallback);t.observe(e),this.addDestroyHandler(()=>{t.disconnect()})}catch(r){this.fallbackToCustomDetectionMethods(e)}else this.fallbackToCustomDetectionMethods(e)}getSize(){return Xt({},this.onResize.getValue())}fallbackToCustomDetectionMethods(e){const{ownerDocument:t}=e;if(!t)return;const{defaultView:r}=t;if(!r)return;const i=()=>{const t=Mh(e);this.onResize.dispatch({width:t.width,height:t.height})};this.addDestroyHandler((0,yh.O)(r,"resize",i,{passive:!0})),this.addDestroyHandler(Zt(i))}}const df=e=>{let t=0;return{promise:new Promise(r=>{t=window.setTimeout(r,e)}),clear(){clearTimeout(t)},timeoutId:t}},uf=Vd?"":"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7";var cf=r(9240);let hf,pf;!function(e){e.preroll="preroll",e.midroll="midroll",e.postPauseroll="postPauseroll",e.postroll="postroll",e.inroll="inroll"}(hf||(hf={})),function(e){e.AdCompleted="AdCompleted",e.LoadSource="LoadSource",e.PlayerDestroy="PlayerDestroy",e.CutOff="CutOff",e.PlayerError="PlayerError",e.AdTypeChange="AdTypeChange",e.InsertIntoCalled="InsertIntoCalled",e.AdSkipped="AdSkipped"}(pf||(pf={}));const ff=[];class mf{static enableConsole(){mf.consoleEnabled=!0,mf.log("YA PLAYER VERSION: 1.0-12103")}static log(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];mf.consoleEnabled&&console.log(rr(...t)),mf.addToHistory("log",t)}static warn(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];mf.consoleEnabled&&console.warn(rr(...t)),mf.addToHistory("warn",t)}static error(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];mf.consoleEnabled&&console.error(rr(...t)),mf.addToHistory("error",t)}static getHistory(){return[...ff]}static addToHistory(e,t){ff.length>=150&&ff.shift(),ff.push("["+e+"]["+Date.now()+"] "+t.map(e=>{try{return(0,ih.Y)(e)}catch(t){return(0,Za.K)(t)?JSON.stringify(["stringify_error",t.stack]):JSON.stringify(["stringify_error","not_an_object_error"])}}).join())}}mf.consoleEnabled=void 0;const gf={play:Wl.X.PLAY,pause:Wl.X.PAUSE,end:Wl.X.END,idle:Wl.X.PAUSE};class vf extends np{constructor(e){super(),this.params=e,this.destroyPromise=new Promise(e=>{this.addDestroyHandler(()=>{e()})}),this.currentAdPlaybackController=void 0,this.playbackQueue=[],this.logAdStart=(0,La.I)(()=>{const e=this.getAdTypeForLogs(),t=this.playbackQueue.length,{logEvent:r}=this.params;r({event:$d.AdStart,params:{adPodsCount:t,adType:e}}),e===hf.inroll&&r({event:$d.InrollAdStart,params:{adPodsCount:t}})}),this.logAdEnd=(0,La.I)(()=>{const e=this.getAdTypeForLogs(),t=this.playbackQueue.length,{logEvent:r}=this.params;e===hf.inroll&&r({event:$d.InrollAdEnd,params:{adPodsCount:t}}),r({event:$d.AdEnd,params:{stopAdReason:this.destroyReason||pf.AdCompleted,adPodsCount:t,adType:e}})}),this.adPodIndex=0,this.startPlayingAd=(0,La.I)(async()=>{for(this.logAdStart();this.adPodIndex<this.playbackQueue.length&&!this.isDestroyed;)await this.playAdPod(this.playbackQueue[this.adPodIndex]),this.adPodIndex++;this.logAdEnd();const e=this.playbackQueue[this.playbackQueue.length-1];this.isDestroyed||void 0===e||(0,Wa.Y)(()=>{this.params.onLastAdPodStopped({adType:e.adViewer.getAdBreakType()})}),this.destroy(pf.AdCompleted)}),this.dispatchOnFirstAdPodStarted=(0,La.I)(()=>{this.params.onFirstAdPodStarted()}),this.updateAdPodCloseState=e=>{this.params.onAdPodCloseStateChange(e.getAdPodCloseState())},this.updateAdVolumeAvailabilityStateChange=e=>{this.params.onAdVolumeAvailabilityStateChange(e.getAdVolumeAvailabilityState())},this.updateAdPodTimeToSkip=e=>{const t=e.getAdPodTimeToSkip();this.params.onAdPodTimeToSkipChange((0,Hl.z)(t)?Math.ceil(t):void 0)},this.playAdPod=async e=>{let{adType:t,adViewer:r,additionalData:i,adDisplayConfig:n,posterUrl:s,adElement:a}=e;if(0===r.getAdPodsCount())return void mf.log("AdViewer is empty");const{logEvent:o}=this.params;if(o({event:$d.AdPodLoading,params:{adPodsCount:this.playbackQueue.length,adType:this.playbackQueue[this.adPodIndex].adPodType,additionalData:i}}),t===hf.inroll){const{cueId:e}=i;o({event:$d.InrollAdPodStart,params:{adPodsCount:this.playbackQueue.length,cueId:e}}),r.setStatsRootFields({cueid:e})}const l=sr({videoSlotCanAutoPlay:!0,controlsSettings:this.params.getControlsSettings(),visibilitySlot:this.params.playerContainer,lang:this.params.lang,contentAfterAd:this.getContentAfterAd(t,s),adSequence:{index:this.adPodIndex,count:this.playbackQueue.length},requestFullscreenStateChange:this.params.onRequestFullscreenStateChange},n),d=r.createPlaybackController(this.params.video,a,l);this.currentAdPlaybackController=d,this.updateAdPodDuration(d),this.params.onAdPodCurrentTimeChange(0),this.params.onAdSkippableStateChange(d.getAdSkippableState()),this.updateAdPodCloseState(d),this.updateAdVolumeAvailabilityStateChange(d),d.subscribe("AdPlayingStateChange",()=>{this.updateAdPodPlayingStateChange()}),d.subscribe("AdMediaStateChange",()=>{this.updateAdPodPlayingStateChange()}),d.subscribe("AdRemainingTimeChange",()=>{const e=d.getAdPodRemainingTime(),t=this.updateAdPodDuration(d);this.params.onAdPodCurrentTimeChange(t-e),this.updateAdPodTimeToSkip(d),this.updateAdPodPlayingStateChange()}),d.subscribe("AdPodError",e=>{const t=sr({},e,{adPodsCount:this.playbackQueue.length,adType:this.playbackQueue[this.adPodIndex].adPodType,additionalData:i});o({event:"AdPodError",params:t}),this.params.onAdPodError(t)}),d.subscribe("AdInteraction",()=>{this.params.onAdInteraction()}),d.subscribe("AdSkippableStateChange",e=>{this.updateAdPodTimeToSkip(d),this.params.onAdSkippableStateChange(e.skippableState)}),d.subscribe("AdStartRejected",e=>{this.params.onAdStartRejected(new Error("AdStartRejected"))}),d.subscribe("AdPodDurationChange",()=>{this.updateAdPodDuration(d)}),d.subscribe("AdPodStartRequest",()=>{this.params.onBeforeAdPodStart({adPlaybackController:d})}),d.subscribe("AdPodStarted",()=>{o({event:$d.AdPodStart,params:{adPodsCount:this.playbackQueue.length,adType:this.playbackQueue[this.adPodIndex].adPodType,additionalData:i}}),this.dispatchOnFirstAdPodStarted(),this.params.onAdPodStarted(),this.updateAdPodPlayingStateChange(),this.updateAdPodDuration(d)});const u=()=>{this.params.onAdPodDurationChange(void 0),this.params.onAdPodCurrentTimeChange(void 0),this.params.onAdSkippableStateChange(!1),this.params.onAdPodTimeToSkipChange(void 0),this.params.onAdPodCloseStateChange(void 0)};d.subscribe("AdPodStopped",()=>{u(),this.params.onAdPodStopped()}),d.subscribe("AdPodSkipped",()=>{u(),this.params.onAdPodSkipped()}),d.subscribe("AdContentSizeChange",()=>{const e=d.getAdContentSize();if(void 0===e)return;const{width:t,height:r}=e;this.params.onAdSizeChange({width:(0,Hl.z)(t)?t:NaN,height:(0,Hl.z)(r)?r:NaN})}),d.subscribe("AdPodImpression",()=>{o({event:$d.AdPodImpression,params:{adPodsCount:this.playbackQueue.length,adType:this.playbackQueue[this.adPodIndex].adPodType,additionalData:i}})}),d.subscribe("AdClickThru",()=>{this.params.onAdClickThru(),o({event:"AdClickThru",params:{adPodsCount:this.playbackQueue.length,adType:this.playbackQueue[this.adPodIndex].adPodType,additionalData:i}})}),this.shouldSkipAllAdPods()&&d.subscribe("AdPodSkipped",()=>{this.destroy(pf.AdSkipped)}),d.subscribe("AdPodCloseStateChange",()=>{this.updateAdPodCloseState(d)}),d.subscribe("AdVolumeAvailabilityStateChange",()=>{this.updateAdVolumeAvailabilityStateChange(d)}),await new Promise(e=>{d.subscribe("AdStopped",e),d.playAd(),this.params.onAdPodPlayingStateChange({adType:t,playingState:Wl.X.BUFFERING,expectedStalledReason:0===this.adPodIndex?Bp.k.AdStart:Bp.k.AdBetween})}),this.currentAdPlaybackController=void 0,o({event:$d.AdPodEnd,params:{adPodsCount:this.playbackQueue.length,adType:this.playbackQueue[this.adPodIndex].adPodType,additionalData:i}}),t===hf.inroll&&(o({event:$d.InrollAdPodEnd,params:{adPodsCount:this.playbackQueue.length,cueId:i.cueId}}),r.setStatsRootFields({cueid:void 0}))},this.addDestroyHandler(()=>{this.currentAdPlaybackController&&(this.currentAdPlaybackController.stopAd(),this.currentAdPlaybackController=void 0)})}getUtcPositionBeforeAd(){return this.params.utcPositionBeforeAd}getCurrentAdPodRemainingTime(){var e;return null==(e=this.currentAdPlaybackController)?void 0:e.getAdRemainingTime()}getQueueDuration(){return nr(this.playbackQueue.map(e=>{let{adViewer:t}=e;return t}))}getIsLastAdPod(){return this.adPodIndex===this.playbackQueue.length-1}playAdViewers(e){this.isDestroyed||(this.playbackQueue.push(e),this.addDestroyHandler(()=>{e.adViewer.destroy()}),Promise.resolve().then(()=>this.startPlayingAd()))}resumeAd(){this.currentAdPlaybackController&&(this.currentAdPlaybackController.resumeAd(),this.updateAdPodPlayingStateChange())}pauseAd(){this.currentAdPlaybackController&&(this.currentAdPlaybackController.pauseAd(),this.updateAdPodPlayingStateChange())}skipAdPod(){this.currentAdPlaybackController&&this.currentAdPlaybackController.skipAd()}setVolume(e){this.currentAdPlaybackController&&this.currentAdPlaybackController.setAdVolume(e)}getDestroyPromise(){return this.destroyPromise}getAdTypeForLogs(){const[e]=this.playbackQueue;return e?e.adType:(this.params.onError(new Fl({code:Ga.AD_TYPE_IS_NOT_RECOGNIZED,isFatal:!1})),"unrecognized")}updateAdPodPlayingStateChange(){if(!this.currentAdPlaybackController)return;const e=this.currentAdPlaybackController.getAdMediaState(),t=this.currentAdPlaybackController.getAdPlayingState(),r=this.playbackQueue[this.adPodIndex].adPodType,i=this.params.video.src,n="stalled"===(null==e?void 0:e.name)&&i?{adType:r,playingState:Wl.X.BUFFERING,expectedStalledReason:Bp.k.AdOther}:{adType:r,playingState:gf[t],expectedStalledReason:void 0};this.params.onAdPodPlayingStateChange(n)}updateAdPodDuration(e){const t=e.getAdPodDuration();return this.params.onAdPodDurationChange(t),t}shouldSkipAllAdPods(){var e;return Boolean(null==(e=this.params.adConfig)?void 0:e.skipAllAdPods)||!1}getContentAfterAd(e,t){const r=this.getIsLastAdPod(),i=this.shouldSkipAllAdPods(),n=t?[{url:t}]:[];switch(e){case hf.preroll:return r||i?{type:"startVideo",poster:n}:{type:"nextAd",poster:[]};case hf.postroll:return{poster:[]};case hf.midroll:case hf.postPauseroll:case hf.inroll:return r||i?{type:"continueVideo",poster:n}:{type:"nextAd",poster:[]};default:return{poster:[]}}}}const yf=900;let Sf;!function(e){e.original="original"}(Sf||(Sf={}));class Ef{constructor(e,t){this.parent=e,this.element=document.createElement("div");const{style:r}=this.element;r.backgroundColor=function(e){switch(e){case Sf.original:return"rgba(0, 255, 0, 0.5)";default:throw new Error("Unexpected BroadcastAdType ["+e+"]")}}(t),r.width="10px",r.height="10px",r.cssFloat="left",r.marginRight="1px"}setVisibility(e){e?this.show():this.hide()}show(){this.parent.appendChild(this.element)}hide(){Q(this.element)}}class bf{constructor(e){this.element=document.createElement("div"),e.appendChild(this.element);const{style:t}=this.element;t.position="absolute",t.bottom="1px",t.left="1px"}createIndicator(e){return new Ef(this.element,e)}}let Af;!function(e){e.INVALID_INROLL_FRAME="INVALID_INROLL_FRAME",e.INVALID_START="INVALID_START",e.CROSSED_BY_INVALID="CROSSED_BY_INVALID",e.MAX_DURATION="MAX_DURATION"}(Af||(Af={}));class Tf extends Bc.v{constructor(){super(...arguments),this.adIntervals=[]}handleInrollFrame(e){if(!function(e){if(e.offset<-6e5||e.offset>63e4)return!1;if(void 0===e.cutoff)return!0;if(e.cutoff<-6e5||e.cutoff>63e4)return!1;const t=e.cutoff-e.offset;return t>=5e3&&t<=6e5}(e))return mf.warn("invalid inroll frame:",e),void this.handleInvalidInrollFrame(e,Af.INVALID_INROLL_FRAME);const t=this.adIntervals.find(t=>{let{cueId:r}=t;return r===e.cue_id});if(!t)return this.addAdIntervalByFastFrame(e);this.updateAdIntervalByInrollFrame(t,e)}validateAdIntervalsByTimestamp(e){for(let t=0;t<this.adIntervals.length;t++){const r=this.adIntervals[t];if(r.start>e)return;if(!r.isValid||r.isEndReceived)continue;if(e-r.start>6e5){this.invalidateAdInterval(r,Af.MAX_DURATION);continue}const i=this.adIntervals[t+1];if(!i)return;i.start<=e&&this.invalidateAdInterval(r,Af.CROSSED_BY_INVALID)}}handleInvalidInrollFrame(e,t){const r=this.adIntervals.find(t=>{let{cueId:r}=t;return r===e.cue_id});if(r)return this.invalidateAdInterval(r,t),void this.updateAdIntervalByInrollFrame(r,e);const i=cr(e);this.invalidateAdInterval(i,t),this.pushAdInterval(i)}addAdIntervalByFastFrame(e){const t=cr(e);return this.pushAdInterval(t),t.isValid?t:void 0}updateAdIntervalByInrollFrame(e,t){const r=t.pts+t.offset;if(Math.abs(e.start-r)>1e3)return void this.invalidateAdInterval(e,Af.INVALID_START);if(e.isEndReceived)return;const i=void 0!==t.cutoff,n=i?t.pts+t.cutoff:ur(t.pts,e.start);e.isEndReceived=i,e.end=n,this.handleUpdatedAdInterval(e)}findCrossedAdIntervals(e){return this.adIntervals.filter(t=>e!==t&&(e.start<t.start?e.end>t.start:t.end>e.start))}pushAdInterval(e){const t=this.findCrossedAdIntervals(e);t.length&&this.invalidateAdInterval(e,Af.CROSSED_BY_INVALID),this.adIntervals.push(e),this.adIntervals.sort((e,t)=>{let{start:r}=e,{start:i}=t;return r-i}),this.invalidate(t,Af.CROSSED_BY_INVALID),e.isValid&&this.emit("AdIntervalUpdated",e)}handleUpdatedAdInterval(e){const t=this.findCrossedAdIntervals(e);if(t.length)return t.push(e),void this.invalidate(t,Af.CROSSED_BY_INVALID);e.isValid&&this.emit("AdIntervalUpdated",e)}invalidate(e,t){e.forEach(e=>{this.invalidateAdInterval(e,t)})}invalidateAdInterval(e,t){e.isValid&&(e.isValid=!1,e.invalidateReason=t,this.emit("InvalidAdInterval",{reason:t,cueId:e.cueId}))}}var _f=r(7618);class wf{constructor(){this.ads=[],this.postAdsIds=[]}add(e){if(this.postAdsIds.indexOf(e.cueId)>-1)return;const t=this.findById(e.cueId);t?t.startTime=e.startTime:this.ads.push(hr({},e,{adViewers:e.adViewers.reduce((e,t)=>e.concat(t.separateAdPods()),[])}))}getAdViewers(e,t){const[r,i]=(0,_f.x)(this.ads,r=>{let{startTime:i,endTime:n,cueId:s,adViewers:a}=r;if(s!==t)return!1;if(e<i)return!1;if(n-15e3<e)return!1;for(const t of a){if(e+1e3*t.getAdDuration()<n)return!0}return!1});if(0===r.length)return[];this.postAdsIds.push(...r.map(e=>{let{cueId:t}=e;return t})),this.ads=i,r.sort((e,t)=>e.startTime-t.startTime);let n=0;const s=[];for(const{adViewers:a,endTime:o,cueId:l}of r)for(const t of a){const r=e+1e3*n;if(o-15e3<r)break;o<r+1e3*t.getAdDuration()||(s.push({adViewer:t,additionalData:{cueId:l},adType:hf.inroll}),n+=t.getAdDuration())}return s}findById(e){return this.ads.find(t=>{let{cueId:r}=t;return r===e})}}class kf extends uh.M{constructor(e){let t,{video:r,slot:i,playerApi:n,playerStore:s,stateController:a,onError:o}=e;super(),this.adIntervalStorage=new Tf,this.isEnabled=!0,this.adIndicators=void 0,this.inrolls=new wf,this.playerApi=void 0,this.playerStore=void 0,this.stateController=void 0,this.onError=void 0,this.adIndicators=new bf(i),this.playerApi=n,this.playerStore=s,this.stateController=a,this.onError=o;const l=this.adIndicators.createIndicator(Sf.original);r.addEventListener("timeupdate",()=>{const e=this.playerStore.getState(),i=lr(e);if(t!==i){const e=void 0!==i;l.setVisibility(e),t=i}const n=dr(e);n&&(this.adIntervalStorage.validateAdIntervalsByTimestamp(n),this.isEnabled&&!r.paused&&(this.stateController.updateOriginalAdState(),this.handleInrolls()))}),this.adIntervalStorage.on("AdIntervalUpdated",e=>{this.emit("AdIntervalUpdated",{cueId:e.cueId,start:e.start,end:e.end})}),this.adIntervalStorage.on("InvalidAdInterval",e=>{let{cueId:t,reason:r}=e;mf.warn("invalid ad interval: [cueId="+t+"] [reason="+r+"]"),this.onError(new Fl({code:Ga.INVALID_METADATA,details:{cueId:t,reason:r},isFatal:!1})),this.emit("AdIntervalRemoved",t)})}handleInrollFrame(e){const t=this.adIntervalStorage.handleInrollFrame(e);if(!t)return Promise.resolve();const{cueId:r,start:i,end:n,isEndReceived:s}=t,a=s?n+15e3:i+6e5;return this.addInroll(r,i,a,{inrollFrame:e})}setEnabled(e){this.isEnabled=e}async addInroll(e,t,r,i){let{inrollFrame:n}=i;this.playerApi.callbacks.logEvent({event:$d.BroadcastAdReceived,params:{cueId:e,podStart:t,adType:hf.inroll}});const s=this.playerApi.getMultiroll(),a=await s.inroll.loadViewers(pr({},n));if(0===a.length)return;const o=nr(a);this.playerApi.callbacks.logEvent({event:$d.BroadcastAdInit,params:{cueId:e,podStart:t,duration:o,adPodsCount:a.length,adType:hf.inroll}}),this.inrolls.add({adViewers:a,cueId:e,startTime:t,endTime:r})}handleInrolls(){const e=this.playerStore.getState(),t=dr(e);if(!t)return;const r=lr(e);if(!r)return;const i=this.inrolls.getAdViewers(t,r);i.length&&this.emit("InrollAdPlayRequest",i)}}class Rf{constructor(){this.stopReasonInternal=void 0,this.stopDeferred=new Zc.B}stop(e){this.stopReasonInternal=e,this.stopDeferred.resolve(e)}get stopReason(){return this.stopReasonInternal}get stopPromise(){return this.stopDeferred.promise}}const Pf=(e,t,r)=>{const i=[];for(let n=0;n<e.length;n++){const s=e[n];t.call(r,s,n,e)&&i.push(s)}return i},Cf={}.toString,If=/\[object (\w+)\]/,Of=e=>{const t=Cf.call(e);if(!t)return null;const r=t.match(If);if(!r)return null;const i=r[1];return i||null},Df=e=>e instanceof Error||"Error"===Of(e),Nf=[].find,Lf=Er(Nf)?(e,t)=>Nf.call(e,t):(e,t)=>{for(let r=0;r<e.length;r++){const i=e[r];if(t(i,r,e))return i}},xf="DEFAULT_ERROR_MESSAGE",Mf="0",Ff="",Vf="?:?:?";class Bf extends Error{constructor(){const e=2===arguments.length?arguments.length<=0?void 0:arguments[0]:void 0,t=2===arguments.length?arguments.length<=1?void 0:arguments[1]:arguments.length<=0?void 0:arguments[0],r=Bt(i=e)&&gr(i.name)&&gr(i.message)||"object"===typeof e&&e&&"code"in e&&"details"in e?e:{message:String(e||xf)};var i;super(),Object.defineProperty(this,"originalError",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"message",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stack",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"toString",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"toJSON",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.originalError="object"===typeof e&&e?e:{unknown:e,unknownStr:String(e)},Ha()(this,Bf.prototype);const n=t.code||r.code||r.id||Mf,s=t.message||r.message||xf;this.message="VAS Error ["+n+"]"+(s?"["+s+"]":""),this.code=n,this.details=t.details||r.details||Ff;const a=r.stack||function(e){const{url:t,line:r,col:i,fileName:n,columnNumber:s,lineNumber:a}=e;return(t||n||"?")+":"+(r||a||"?")+":"+(i||s||"?")}(r);let o=a===Vf?this.stack:a;if(o&&o!==Vf)this.stack=o;else if(!this.stack)try{throw new Error(this.message)}catch(io){this.stack=o=io.stack||Vf}this.toString=()=>br(this.toJSON()),this.toJSON=()=>({originalError:this.originalError,message:this.message,code:this.code,details:this.details,stack:o})}}const Uf=function(e,t){let r=e[t];if(!Er(r)){const i=r;try{delete e[t];const n=e[t];"function"===typeof n&&(r=n),e[t]=i}catch(io){}}return r}(Array,"isArray"),jf=Boolean(Uf)?e=>Uf.call(Array,e):e=>"Array"===Of(e);class Hf{constructor(e){Object.defineProperty(this,"dispatch",{enumerable:!0,configurable:!0,writable:!0,value:Tr(e=>{this.value=e,this._isDispatched=!0,function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];jf(e)&&xp(e,e=>{"function"===typeof e&&e(...r)})}(this.callbacks,e),this.callbacks.length=0})}),Object.defineProperty(this,"callbacks",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_isDispatched",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Vt(e)&&this.callbacks.push(e)}subscribe(e){return this._isDispatched?(e(this.value),Ar):(this.callbacks.push(e),()=>{this.callbacks=Pf(this.callbacks,t=>t!==e)})}getDispatched(){return this._isDispatched}getValue(){return this.value}wait(){return new Promise(e=>{this.subscribe(e)})}}const Wf=200,qf=e=>Dr(e.navigator.sendBeacon),Yf=qf(window);class Gf{constructor(e){let{defaultProbability:t,rnd:r,vsid:i,serviceName:n,serviceVersion:s}=e;Object.defineProperty(this,"rnd",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"vsid",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"defaultProbability",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"serviceName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"serviceVersion",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"error",{enumerable:!0,configurable:!0,writable:!0,value:e=>{let{error:t}=e;this.push({eventName:String(t.code),eventType:"error",eventData:t,probability:1})}}),this.rnd=r,this.vsid=i,this.defaultProbability=t,this.serviceName=n,this.serviceVersion=s}log(e){let{name:t,probability:r,data:i}=e;this.push({eventType:"event",eventName:t,probability:r,eventData:i})}push(e){let{eventType:t,eventName:r,probability:i=this.defaultProbability,eventData:n}=e;if(this.rnd<i){const e="https://log.strm.yandex.ru/log?"+t+"="+r,i=JSON.stringify({service:"VAS",eventType:t,eventName:r,rnd:this.rnd,vsid:this.vsid,data:n,topLocation:kr(document).location,version:"loadVasModule_"+(this.serviceName||"unknown")+"_"+(this.serviceVersion||"unknown"),timestamp:Date.now()});0;if(function(e,t){return!!Yf&&window.navigator.sendBeacon(e,t)}(e,i))return;Or({url:e,data:i,method:"POST"})}}}const Kf=(e,t)=>{try{return e.localStorage.getItem(t)}catch(r){return null}},zf=(e,t)=>{const r=Nr(e,t);return"false"!==r&&Boolean(r)},Zf=function(e){let t,r,i=!1,n=!1,s=!1;return _r(()=>{t=function(e){const t=Nr(e,"adsdkecmaver");if("ES2017"===t||"ES5"===t)return t;return}(e)}),_r(()=>{s=Boolean(Nr(e,"adsdkdebug"))}),_r(()=>{r=Nr(e,"adsdkver")}),_r(()=>{i=Boolean(Nr(e,"vasnetworklogs"))}),_r(()=>{n=zf(e,"vasfulldebug")}),s&&(console.warn("adsdkdebug is deprecated, use vasfulldebug instead"),n=!0),n&&(i=!0),{adsdkecmaver:t,vasfulldebug:n,vasnetworklogs:i,adsdkver:r,adsdkdebug:s}}(window),Xf=Zf.vasnetworklogs?1:.05,Qf=!Dr(Math.random)||Math.random()===Math.random(),Jf=Date&&Lr(Date.now)?()=>Date.now():()=>(new Date).getTime(),$f="undefined"===typeof window?void 0:window.performance,em=$f&&Lr($f.now),tm=$f&&$f.timing&&$f.timing.navigationStart?$f.timing.navigationStart:Jf();let rm=0;const im=em?()=>$f.now():()=>(()=>{const e=Jf()-tm;return rm=Math.max(e,rm),rm})();let nm=Date.now()*im()%2147483647;const sm=Qf?function(){return nm=16807*nm%2147483647,(nm-1)/2147483646}:function(){return Math.random()},am=sm();var om=function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]])}return r};const lm=e=>{const{expFlags:t}=e,r=om(e,["expFlags"]),i={},n={};return xp(e.expFlags,e=>{xp(e,e=>{let{CONTEXT:{FLAGS:t},TESTID:r}=e;Bt(t)&&xp(function(e){if("function"===typeof Object.keys)return Object.keys(e);const t=[];for(const r in e)xr(e,r)&&t.push(r);return t}(t),e=>{var s;const a=t[e];i[e]=a,n[e]=null!==(s=n[e])&&void 0!==s?s:[],n[e].push({value:a,testId:r[0]})})})}),Mr({flags:i,flagsMap:n},r)},dm={testIds:"",flags:{}};Tr(()=>{try{return __UAAS_CFG__}catch(e){return e}});const um=e=>{if(Df(e))return{error:e,config:dm};try{const t=Bt(e)?e:JSON.parse(""+(e||"")),r=(e=>!!Bt(e)&&!(!("expFlags"in e)||!jf(e.expFlags)))(t)?lm(t):t;if(!((e,t)=>{if(!Bt(t))throw new Error("Parsed replaced macro is not an object: "+e);if(Sr(t.testIds),!("flags"in t)||!Bt(t.flags))throw new Error("Parsed replaced macro has no flags field: "+e);return!0})(String(e),r))throw new Error("UAAS config is not valid: "+e);return{error:void 0,config:r}}catch(t){return{error:t,config:dm}}},cm=e=>{var t;const{error:r,config:i}=um(e);if(!r){const e=i.flags,r=null!==(t=e.ADSDKVER)&&void 0!==t?t:e.VAS_STABLE_VERSION,n=vr(r)?r:void 0;if(vr(n))return{version:n,parsedUaasConfig:i,parseUaasConfigError:void 0}}return{version:void 0,parsedUaasConfig:void 0,parseUaasConfigError:r}},hm=(e=>(e=>{try{if("noModule"in e.HTMLScriptElement.prototype)return!0}catch(t){}return!1})(e)&&qf(e))(window)?"ES2017":"ES5",pm={ES5:"bundles",ES2017:"bundles-es2017"},fm=Vr(Vr({},{InPage:"inpage",AdLoader:"loader",VideoBannerAd:"videobannerad",Multiroll:"multiroll",YaMusicAPI:"ya-music-api",VpaidPlayer:"vpaid_player",Rum:"rum"}),{MotionTailor:"motion_ad_creative",Survey:"survey"}),mm="undefined"===typeof BUNDLES_PATH?"":BUNDLES_PATH,gm=("undefined"===typeof BUNDLE_NAME||BUNDLE_NAME,"undefined"===typeof BUILD_TIME||BUILD_TIME,["a","n.ya","nd","ex.ru"].join(""),["y","a","nde","x.ru"].join(""),["y","a",".r","u"].join(""),["ya","sta","tic.net"].join("")),vm=(["ver","ify.y","a","nde","x.ru"].join(""),"https://"+gm+"/vas-bundles/"),ym=e=>{let{bundleName:t,win:r,ecmaVersion:i,version:n}=e;const s=pm[i],a=Vp(r),o=fm[t]+".bundle.js";const l=""+Br(n)+s+"/"+o;return Vt(a)?a(l):l},Sm=e=>new Promise((t,r)=>{Or({method:"GET",url:"https://yandex.ru/ads/system/video-ads-sdk/vas_uaas",responseType:"json",retries:2,withCredentials:Boolean(e),onSuccess:e=>{t(e.response)},onError:()=>{r(new Error("Cannot load uaas"))}})});let Em;try{Em=BUILD_VERSION}catch(io){Em="INVALID_BUILD_VERSION"}const bm="VAS",Am=e=>Hr(e.substr(-4),4,"0"),Tm=(void 0===(_m="1")&&(_m=Em),[jr(44),bm,Am(_m),Hr(Date.now().toString().slice(0,10),10,"0")].join("x"));var _m;const wm={subpageIndex:O(),deltas:{}},km={inStreamPlayingState:void 0,adConfig:void 0,adInfo:void 0,originalBroadcastAdCueId:void 0,originalBroadcastAdCues:{},adblockDetected:!1,hasPreroll:!1,adSyncInit:!1,nextAdInfo:void 0,nativeAdControlsVisibility:!0},Rm=Math.max(0,0),Pm=Math.max(5,0);let Cm;!function(e){e.Detached="Detached",e.Attaching="Attaching",e.Attached="Attached"}(Cm||(Cm={}));const Im={autoplay:!1,initialAutoplay:!1,allowMuted:!0,autoplayImpossible:!1,startStage:Gd.init,preload:!0,from:void 0,encoderState:Cm.Detached,vsid:lu,streams:[],stream:void 0,sourceParams:void 0,sourceId:0,volume:1,muted:!1,userVolume:NaN,duration:NaN,currentTime:Rm,currentTimeLowGranularity:Rm,watchedTime:0,startPosition:{},programDateTime:void 0,fragmentDuration:Pm,dvrStartTime:0,dvrDuration:NaN,videoType:void 0,playingState:Wl.X.PAUSE,bufferingRanges:[],preview:void 0,isFullscreen:!1,isPip:!1,isVisible:void 0,togglePlaybackOnVisibilityChangeSetting:void 0,errorInfo:{},lastRecoverPosition:void 0,isDocumentVisible:!0,lastKnownBandwidthEstimate:{value:NaN,source:"default"},isAbrSupported:!1,isAbrEnabled:!1,defaultQuality:720,feed:!1,shouldEmitFrameRendered:!1,videoTrackValue:void 0,videoTracks:[],userVideoTrackName:void 0,userVideoTrackHeight:void 0,audioTrackValue:void 0,audioTracks:[],userAudioTrackName:void 0,userAudioTrackLang:void 0,textTrackEnabled:!1,nativeTextTrackVisible:void 0,textTrackValue:void 0,textTracks:[],userTextTrackEnabled:void 0,userTextTrackLang:void 0,userTextTrackName:void 0,playbackRate:1,expectedStalled:{reason:Bp.k.Init,details:{}},videoWidth:0,videoHeight:0,playerConfig:void 0},Om={hiddenControls:[],useNativeSubtitles:!1,nativeControlsVisibility:!0,skinDVRStartTime:0,skinDVRDuration:0};let Dm,Nm,Lm,xm,Mm;!function(e){e.inStreamPlayingState="inStreamPlayingState",e.adConfig="adConfig",e.adInfo="adInfo",e.originalBroadcastAdCueId="originalBroadcastAdCueId",e.originalBroadcastAdCues="originalBroadcastAdCues",e.adblockDetected="adblockDetected",e.hasPreroll="hasPreroll",e.adSyncInit="adSyncInit",e.nextAdInfo="nextAdInfo",e.nativeAdControlsVisibility="nativeAdControlsVisibility"}(Dm||(Dm={})),function(e){e.hiddenControls="hiddenControls",e.useNativeSubtitles="useNativeSubtitles",e.nativeControlsVisibility="nativeControlsVisibility",e.skinDVRStartTime="skinDVRStartTime",e.skinDVRDuration="skinDVRDuration"}(Nm||(Nm={})),function(e){e.engine="engine",e.autoplay="autoplay",e.allowMuted="allowMuted",e.autoplayImpossible="autoplayImpossible",e.startStage="startStage",e.preload="preload",e.duration="duration",e.encoderState="encoderState",e.from="from",e.vsid="vsid",e.streams="streams",e.stream="stream",e.streamsWithSupportInfo="streamsWithSupportInfo",e.sourceParams="sourceParams",e.sourceId="sourceId",e.bufferingRanges="bufferingRanges",e.userVolume="userVolume",e.currentTime="currentTime",e.currentTimeLowGranularity="currentTimeLowGranularity",e.watchedTime="watchedTime",e.startPosition="startPosition",e.videoType="videoType",e.playingState="playingState",e.errorInfo="errorInfo",e.lastRecoverPosition="lastRecoverPosition",e.preview="preview",e.isFullscreen="isFullscreen",e.isPip="isPip",e.isVisible="isVisible",e.togglePlaybackOnVisibilityChangeSetting="togglePlaybackOnVisibilityChangeSetting",e.isDocumentVisible="isDocumentVisible",e.lastKnownBandwidthEstimate="lastKnownBandwidthEstimate",e.fragmentDuration="fragmentDuration",e.dvrStartTime="dvrStartTime",e.dvrDuration="dvrDuration",e.programDateTime="programDateTime",e.isAbrSupported="isAbrSupported",e.isAbrEnabled="isAbrEnabled",e.defaultQuality="defaultQuality",e.videoTrackValue="videoTrackValue",e.videoTracks="videoTracks",e.userVideoTrackName="userVideoTrackName",e.userVideoTrackHeight="userVideoTrackHeight",e.audioTrackValue="audioTrackValue",e.audioTracks="audioTracks",e.userAudioTrackName="userAudioTrackName",e.userAudioTrackLang="userAudioTrackLang",e.textTrackEnabled="textTrackEnabled",e.nativeTextTrackVisible="nativeTextTrackVisible",e.textTrackValue="textTrackValue",e.textTracks="textTracks",e.userTextTrackEnabled="userTextTrackEnabled",e.userTextTrackName="userTextTrackName",e.userTextTrackLang="userTextTrackLang",e.playbackRate="playbackRate",e.expectedStalled="expectedStalled",e.videoWidth="videoWidth",e.videoHeight="videoHeight",e.volume="volume",e.videoElementStyle="videoElementStyle",e.playerConfig="playerConfig",e.feed="feed",e.shouldEmitFrameRendered="shouldEmitFrameRendered"}(Lm||(Lm={})),function(e){e.PlaybackRateCatchupSelection="PlaybackRateCatchupSelection",e.Recover="Recover",e.Other="Other"}(xm||(xm={})),function(e){e.ApiPlay="ApiPlay",e.VolumeChange="VolumeChange",e.MuteChange="MuteChange"}(Mm||(Mm={}));const Fm={startPosition:{},additionalParams:Wu,adConfig:void 0,withCredentials:!1,loop:!1,preview:"",videoInfo:{}},Vm=-1;var Bm=r(8533),Um=r.n(Bm);var jm=r(8682);const Hm={name:(e=>{Jl.f.i18nLang||(Jl.f.i18nLang="ru");const t=Jl.f.i18nLang;if(!(0,Ql.m)(Jl.f.i18nTranslateEngine)){const e=r(7050)("./"+t+".ts");(0,Bm.setI18nLang)(t),Jl.f.i18nTranslateEngine=Um()(ti({},e))}return Jl.f.i18nTranslateEngine(e)})("TRACK_AUTO"),value:jm.A,bitrate:Vm};let Wm,qm,Ym;!function(e){e.VideoIsNotPausedOnInit="VideoIsNotPausedOnInit",e.DetectByInterval="DetectByInterval",e.VideoPlayEvent="VideoPlayEvent",e.PlayCallback="PlayCallback"}(Wm||(Wm={})),function(e){e.firstNetworkAdSDK="first.network.adsdk",e.firstNetworkHls="first.network.hls",e.firstNetworkMpd="first.network.mpd",e.firstNetworkMp4="first.network.mp4",e.firstNetworkNative="first.network.native",e.firstNetworkYasp="first.network.yasp",e.firstNetworkAdSDKHls="first.network.adsdk.hls",e.firstNetworkAdSDKMpd="first.network.adsdk.mpd",e.firstNetworkAdSDKMp4="first.network.adsdk.mp4",e.firstNetworkAdSDKNative="first.network.adsdk.native",e.firstNetworkAdSDKYasp="first.network.adsdk.yasp",e.setSourceNetworkAdSDK="setsource.network.adsdk",e.setSourceNetworkHls="setsource.network.hls",e.setSourceNetworkMpd="setsource.network.mpd",e.setSourceNetworkMp4="setsource.network.mp4",e.setSourceNetworkNative="setsource.network.native",e.setSourceNetworkYasp="setsource.network.yasp",e.setSourceNetworkAdSDKHls="setsource.network.adsdk.hls",e.setSourceNetworkAdSDKMpd="setsource.network.adsdk.mpd",e.setSourceNetworkAdSDKMp4="setsource.network.adsdk.mp4",e.setSourceNetworkAdSDKNative="setsource.network.adsdk.native",e.setSourceNetworkAdSDKYasp="setsource.network.adsdk.yasp"}(qm||(qm={})),function(e){e.firstLoadSource="firstloadsource",e.yaFirstFrameDecodedMp4="ya.firstframedecoded.mp4",e.yaFirstFrameDecodedMpd="ya.firstframedecoded.mpd",e.yaFirstFrameDecodedHls="ya.firstframedecoded.hls",e.yaFirstFrameDecodedYandex="ya.firstframedecoded.yandex",e.yaFirstFrameDecodedYasp="ya.firstframedecoded.yasp",e.yaFirstFrameDecodedNative="ya.firstframedecoded.native",e.yaFirstFrameDecodedAdSDK="ya.firstframedecoded.adsdk",e.yaFirstFrameShownMp4="ya.firstframeshown.mp4",e.yaFirstFrameShownMPD="ya.firstframeshown.mpd",e.yaFirstFrameShownHls="ya.firstframeshown.hls",e.yaFirstFrameShownYandex="ya.firstframeshown.yandex",e.yaFirstFrameShownYasp="ya.firstframeshown.yasp",e.yaFirstFrameShownNative="ya.firstframeshown.native",e.yaFirstFrameShownAdSDK="ya.firstframeshown.adsdk",e.autoplayFalse="autoplayfalse",e.firstStartAdSDKFailed="firststart.adsdk.failed",e.firstStartAdSDK="firststart.adsdk",e.firstStartYandex="firststart.yandex",e.firstStartYasp="firststart.yasp",e.firstStartHls="firststart.hls",e.firstStartMp4="firststart.mp4",e.firstStartMpd="firststart.mpd",e.firstStartNative="firststart.native",e.firstStartAdSDKYandex="firststart.adsdk.yandex",e.firstStartAdSDKYasp="firststart.adsdk.yasp",e.firstStartAdSDKHls="firststart.adsdk.hls",e.firstStartAdSDKMpd="firststart.adsdk.mpd",e.firstStartAdSDKMp4="firststart.adsdk.mp4",e.firstStartAdSDKNative="firststart.adsdk.native"}(Ym||(Ym={}));const Gm=["reason"],Km={[ql.HLS]:Ym.firstStartHls,[ql.MP4]:Ym.firstStartMp4,[ql.NATIVE]:Ym.firstStartNative,[ql.YASP]:Ym.firstStartYasp,AD:Ym.firstStartAdSDK},zm={[ql.HLS]:Ym.firstStartAdSDKHls,[ql.MP4]:Ym.firstStartAdSDKMp4,[ql.NATIVE]:Ym.firstStartAdSDKNative,[ql.YASP]:Ym.firstStartAdSDKYasp,AD:Ym.firstStartAdSDK},Zm={[ql.HLS]:Ym.yaFirstFrameDecodedHls,[ql.MP4]:Ym.yaFirstFrameDecodedMp4,[ql.NATIVE]:Ym.yaFirstFrameDecodedNative,[ql.YASP]:Ym.yaFirstFrameDecodedYasp,AD:Ym.yaFirstFrameDecodedAdSDK},Xm={[ql.HLS]:Ym.yaFirstFrameShownHls,[ql.MP4]:Ym.yaFirstFrameShownMp4,[ql.NATIVE]:Ym.yaFirstFrameShownNative,[ql.YASP]:Ym.yaFirstFrameShownYasp,AD:Ym.yaFirstFrameShownAdSDK},Qm={[ql.HLS]:qm.firstNetworkHls,[ql.MP4]:qm.firstNetworkMp4,[ql.NATIVE]:qm.firstNetworkNative,[ql.YASP]:qm.firstNetworkYasp,AD:qm.firstNetworkAdSDK},Jm={[ql.HLS]:qm.firstNetworkAdSDKHls,[ql.MP4]:qm.firstNetworkAdSDKMp4,[ql.NATIVE]:qm.firstNetworkAdSDKNative,[ql.YASP]:qm.firstNetworkAdSDKYasp,AD:qm.firstNetworkAdSDK},$m={[ql.HLS]:qm.setSourceNetworkHls,[ql.MP4]:qm.setSourceNetworkMp4,[ql.NATIVE]:qm.setSourceNetworkNative,[ql.YASP]:qm.setSourceNetworkYasp,AD:qm.setSourceNetworkAdSDK},eg={[ql.HLS]:qm.setSourceNetworkAdSDKHls,[ql.MP4]:qm.setSourceNetworkAdSDKMp4,[ql.NATIVE]:qm.setSourceNetworkAdSDKNative,[ql.YASP]:qm.setSourceNetworkAdSDKYasp,AD:qm.setSourceNetworkAdSDK};let tg=-1;const rg={sourceStart:!1,yaFirstFrameDecoded:!1,yaFirstFrameShown:!1};let ig,ng;!function(e){e.ON="ON",e.OFF="OFF"}(ig||(ig={})),function(e){e.setSource="setSource",e.destroy="destroy",e.end="end"}(ng||(ng={}));const sg=Jp?function(e,t){return void 0===t&&(t=Qp),Boolean(t.canPlayType(e).replace(/no/,""))}:()=>!1,ag=sg("application/vnd.apple.mpegurl")||Zh>=4.4;let og;!function(e){e.NO_MSE="NO_MSE",e.NO_CODECS="NO_CODECS",e.NO_SUPPORTED_DRM="NO_SUPPORTED_DRM",e.NO_SUPPORTED_FORMAT="NO_SUPPORTED_FORMAT",e.INVALID_STREAM_URL="INVALID_STREAM_URL"}(og||(og={}));const lg=e=>"m3u8"===(0,Yu.lm)(e.toLocaleLowerCase()),dg=e=>"mpd"===(0,Yu.lm)(e.toLocaleLowerCase());var ug=r(3480);const cg=(0,ug.Q)(),hg=function(e){return void 0===e&&(e=window),/YaBrowser/.test((0,Md.i)(e))},pg=hg(),fg="detect.probe_mse_support.success",mg=(0,La.I)(()=>{if(void 0===cg)return Promise.reject(new Error("MSE is not supported"));if(function(){if(!pg)return!1;try{return void 0!==window.top.WEB_NTP_VERSION}catch(TE){return!1}}())return Promise.resolve(cg);L(fg),L("detect.probe_mse_support.fail");if(function(){try{const e=Nu.t.getItem("videoplayer-supported-mse");if(null===e)return;const{value:t,time:r,version:i}=JSON.parse(e);if(Date.now()-r>2592e5)return void Nu.t.removeItem("videoplayer-supported-mse");if("1"!==i)return;return t||void 0}catch(e){return}}())return x(fg),Promise.resolve(cg);const e=document.createElement("video"),t=new cg,r=URL.createObjectURL(t);let i,n;const s=new Promise((s,a)=>{i=()=>{s(cg);try{Nu.t.setItem("videoplayer-supported-mse",JSON.stringify({value:!0,time:Date.now(),version:"1"}))}catch(TE){}},n=()=>a(new Error("MSE is not supported")),t.addEventListener("sourceopen",i),e.addEventListener("error",n),e.addEventListener("durationchange",n),e.setAttribute("x-webkit-airplay","deny"),e.src=r});return s.then(()=>x(fg)).catch(()=>x("detect.probe_mse_support.fail")).then(()=>{URL.revokeObjectURL(r),t.removeEventListener("sourceopen",i),e.removeEventListener("error",n),e.removeEventListener("durationchange",n)}),s});(0,Pd.v)(mg());const gg=function(e){void 0===e&&(e=window);const t=(0,Md.i)(e).toLowerCase();return/yandexstation.*yandexio/.test(t)||/station.*crosswalk/.test(t)}(),vg=["mp4","webm"],yg=["vp09.00.50.08.00.02.02.02.00","vp09.00.31.08.00.02.02.02.00","hev1.1.6.L150.90","hev1.1.6.L93.90","avc1.640028","avc1.64001F"],Sg=["mp4","ogg","webm"],Eg=["mp4a.40.2","vorbis","opus","flac"],bg={supported:!0,engine:ql.NATIVE},Ag={supported:!0,engine:ql.HLS};let Tg;const _g=function(e){return void 0===e&&(e=window),/Chrome/.test(e.navigator.userAgent)&&/Google Inc/.test(e.navigator.vendor)&&!hg(e)}(),wg=function(e){return void 0===e&&(e=window),/firefox/.test(e.navigator.userAgent.toLowerCase())}();let kg;!function(e){e.fairplay="fairplay",e.playready="playready",e.widevine="widevine",e.clearkey="clearkey",e.none="none"}(kg||(kg={}));const Rg={[kg.fairplay]:[Gu.D,Gu.h9,Gu.oo],[kg.widevine]:[Gu.ly],[kg.playready]:[Gu.xE],[kg.clearkey]:[Gu.dn],[kg.none]:[]},Pg=(Cg=(0,hh.z)(Rg),[].concat.apply([],Cg));var Cg;const Ig=[{initDataTypes:["cenc"],audioCapabilities:[{contentType:'audio/mp4;codecs="mp4a.40.2"'}],videoCapabilities:[{contentType:'video/mp4; codecs="avc1.42E01E"'}]}];let Og,Dg;!function(e){e.YandexBrowserLinux="YandexBrowserLinux",e.OldYandexBrowser="OldYandexBrowser",e.WebKitMediaKeys="WebKitMediaKeys",e.requestMediaKeySystemAccess="requestMediaKeySystemAccess",e.MSMediaKeys="MSMediaKeys",e.GenerateKeyRequest="GenerateKeyRequest",e.Constant="Constant",e.NotAvailable="NotAvailable",e.LiteMode="LiteMode"}(Og||(Og={}));const Ng=[];let Lg;const xg=(0,La.I)(async e=>{let{video:t}=e;const r=function(){try{const e=Nu.t.getItem("videoplayer-supported-drm-systems");if(null===e)return;const{value:t,time:r,version:i}=JSON.parse(e);if(Date.now()-r>2592e5)return void Nu.t.removeItem("videoplayer-supported-drm-systems");if("90715754cebf2b4ad57b241c7fa0e9b9"!==i)return void Nu.t.removeItem("videoplayer-supported-drm-systems");if(0===t.supportedDrmSystems.length)return;return t}catch(e){return}}();L("detect.drm");const i=r||await ki({video:t});return Ng.forEach(e=>e(i)),Ng.length=0,Lg=i,void 0===r&&function(e){if(0!==e.supportedDrmSystems.length)try{Nu.t.setItem("videoplayer-supported-drm-systems",JSON.stringify({value:e,time:Date.now(),version:"90715754cebf2b4ad57b241c7fa0e9b9"}))}catch(TE){}}(i),x("detect.drm"),i.supportedDrmSystems}),Mg=document.createElement("video"),Fg={supported:!0,engine:ql.YASP},Vg=[Gu.ly,Gu.xE,Gu.dn];let Bg;const Ug=function(e){if(void 0===e&&(e=window),Fd(e)){const t=(0,Md.i)(e).match(/version\/([\d]+)\.([\d]+)/i);if(!t)return{major:-1,minor:-1};const[,r,i]=t;return{major:parseInt(r,10),minor:parseInt(i,10)}}return{major:-1,minor:-1}}();var jg=r(2248);const Hg=[Gu.ly],Wg=function(e){if(void 0===e&&(e=window),te(e)&&e.navigator){const t=(0,Md.i)(e).match(/OS ([\d]+)_([\d]+)_?(\d+)?/i);if(!t)return{major:-1,minor:-1};const[,r,i]=t;return{major:parseInt(r,10),minor:parseInt(i,10)}}return{major:-1,minor:-1}}();var qg=r(3564);const Yg={destroy:Yl.Z,setStatsRootFields:Yl.Z,dispatchEvent:Yl.Z,getNextAdInfo:()=>{},preroll:{loadViewers:()=>Promise.resolve([])},midroll:{loadViewers:()=>Promise.resolve([])},inroll:{loadViewers:()=>Promise.resolve([]),schedule:Yl.Z},postroll:{loadViewers:()=>Promise.resolve([])},postPauseroll:{loadViewers:()=>Promise.resolve([])}},Gg=[{end:0,name:"invalid"},{end:750,name:"750)"},{end:1250,name:"[750-1250)"},{end:2e3,name:"[1250-2000)"},{end:3500,name:"[2000-3500)"},{end:5500,name:"[3500-5500)"},{end:9e3,name:"[5500-9000)"},{end:1e6,name:"[9000"},{end:1/0,name:"infinity"}],Kg=[{end:0,name:"invalid"},{end:100,name:"100"},{end:250,name:"250"},{end:500,name:"500"},{end:750,name:"750"},{end:1e3,name:"1000"},{end:1500,name:"1500"},{end:2500,name:"2500"},{end:5e3,name:"5000"},{end:1/0,name:"infinity"}];var zg=r(2786);class Zg{constructor(e){this.length=e,this.list=[]}push(e){this.list.length>=this.length&&this.list.shift(),this.list.push(e)}getAll(){return this.list}clear(){this.list.length=0}copy(){const e=new Zg(this.length);return e.list=this.list.slice(),e}has(e){return-1!==this.list.indexOf(e)}size(){return this.list.length}}class Xg extends np{constructor(e){super(),this.history=new Zg(100),this.addDestroyHandler((0,yh.O)(e,"logposted",e=>{mf.log("chrome://media-internals event",e.data),this.history.push(e.data)})),this.addDestroyHandler(()=>{this.history=null})}getHistory(){return this.history?[...this.history.getAll()]:["MediaInternalsHistory is destroyed"]}}const Qg={setItem(e,t){try{sessionStorage.setItem(e,t)}catch(io){}},getItem(e){try{return sessionStorage.getItem(e)}catch(io){return null}},removeItem(e){try{sessionStorage.removeItem(e)}catch(io){}}};class Jg{constructor(){this.videoContentId=void 0,this.lastProgress=void 0}setVideoContentId(e){this.lastProgress=void 0,this.videoContentId=e}clearVideoContentId(){this.lastProgress=void 0,this.videoContentId=void 0}getProgress(){if(!this.videoContentId)return;const e=Wi(this.videoContentId);return(0,Hl.z)(e)?e:void 0}saveProgress(e){this.videoContentId&&("number"===typeof this.lastProgress&&Math.abs(this.lastProgress-e)<1||(this.lastProgress=e,qi(this.videoContentId,e)))}}var $g=r(6197);const{windowChain:ev}=(0,Vh.T)(window);var tv=r(1771);class rv{constructor(e,t){this.yaspVideo=void 0,this.detachedSrcInternal=void 0,this.airplaySrcInternal=void 0,this.airplayEnabled=void 0,this.lastSetSrcTime=void 0,this.onAirplayStateChange=void 0,this.airplayEnabled=e.webkitCurrentPlaybackTargetIsWireless,this.onAirplayStateChange=t,this.yaspVideo=e,this.setUpAirplay()}set airplaySrc(e){this.airplaySrcInternal=e,this.airplayEnabled&&e&&(this.lastSetSrcTime=(0,Fa.no)(),this.yaspVideo.src=e,this.yaspVideo.play())}get airplaySrc(){return this.airplaySrcInternal}set detachedSrc(e){this.detachedSrcInternal=e}get detachedSrc(){return this.detachedSrcInternal}setUpAirplay(){let e;this.yaspVideo.setAttribute("x-webkit-airplay","allow"),this.yaspVideo.disableRemotePlayback=!0,this.yaspVideo.addEventListener("webkitcurrentplaybacktargetiswirelesschanged",t=>{const r=(0,Fa.no)();if(this.lastSetSrcTime&&r-this.lastSetSrcTime<3e3)return;if(e&&r-e<2e3)return;e=(0,Fa.no)();const{currentTime:i}=this.yaspVideo;this.yaspVideo.disableRemotePlayback?(this.yaspVideo.disableRemotePlayback=!1,this.onAirplayStateChange(!0),this.airplayEnabled=!0,this.detachedSrc=this.yaspVideo.src,this.yaspVideo.src=this.airplaySrcInternal,this.yaspVideo.addEventListener("loadedmetadata",()=>{this.yaspVideo.currentTime=i,this.yaspVideo.play()})):(this.airplayEnabled=!1,this.onAirplayStateChange(!1),this.yaspVideo.disableRemotePlayback=!0,this.yaspVideo.src=this.detachedSrc,this.yaspVideo.addEventListener("loadedmetadata",()=>{this.yaspVideo.currentTime=i,this.yaspVideo.play()}))})}}const iv=e=>e.devicePixelRatio||e.screen.deviceXDPI&&e.screen.deviceXDPI/e.screen.logicalXDPI||1;const nv=(0,r(5776).y)();const sv=(0,r(9881).F)();const av=(0,r(6223).V)(),ov=(0,La.I)(async e=>{const t=iv(e);if(!nv)return t;const r=e.tizen;if(!r)return t;const i=e.screen.height;try{const e=await new Promise(e=>{r.systeminfo.getPropertyValue("PANEL",t=>e(t.panelHeight))});return e?e/i:t}catch(TE){return t}}),lv=(0,La.I)(e=>{let t=iv(e);if(!sv)return t;const r=e.Hisense_GetPanelResolution,i=e.Hisense_Get4KSupportState;if(i&&i()&&(t=2),!r)return t;const n=e.screen.height;try{const e=r(),{height:i}=dv(e);return i?i/n:t}catch(TE){return t}}),dv=e=>{const t=e.split("*");return{height:parseInt(t[1],10),width:parseInt(t[0],10)}},uv=(0,La.I)(async e=>{const t=iv(e);if(!av)return t;const r=e.webOS;if(!r)return t;const i=e.screen.height;try{const e=await new Promise(e=>{r.deviceInfo(t=>e(t.screenHeight))});return e?e/i:t}catch(TE){return t}}),cv=e=>nv?ov(e):av?uv(e):sv?Promise.resolve(lv(e)):Promise.resolve(iv(e));let hv=0;class pv{constructor(e){let{label:t="",language:r="",id:i=Qi(),sourceBuffer:n=null,props:s}=e;this.label=void 0,this.id=void 0,this.language=void 0,this.kind="",this.props=void 0,this.sourceBuffer=null,this.label=t,this.language=r,this.id=i,this.sourceBuffer=n,this.props=s}}const fv=["enabled","bitrate","channels"];class mv extends pv{constructor(e){let t=void 0===e?{}:e,{enabled:r=!1,bitrate:i,channels:n}=t;super(function(e,t){if(null==e)return{};var r,i,n={},s=Object.keys(e);for(i=0;i<s.length;i++)r=s[i],t.indexOf(r)>=0||(n[r]=e[r]);return n}(t,fv)),this._enabled=!1,this.bitrate=void 0,this.channels=void 0,this.onenabledchange=void 0,this._enabled=r,this.bitrate=i,this.channels=n}_destroy(){delete this.onenabledchange}get enabled(){return this._enabled}set enabled(e){var t;"boolean"===typeof e&&e!==this._enabled&&(this._enabled=e,null==(t=this.onenabledchange)||t.call(this))}}var gv=r(9840);class vv extends gv.Z{constructor(e){void 0===e&&(e=[]),super(),this.tracks=[],this._changing=!1;for(let t=0;t<e.length;t++)this.addTrack(e[t])}get length(){return this.tracks.length}addTrack(e){if(-1!==this.tracks.indexOf(e))return;const t=this.tracks.length;Object.defineProperty(this,t,{get:()=>this.tracks[t],enumerable:!1,configurable:!0}),this.tracks.push(e),this.dispatchTrackEvent("addtrack",e)}removeTrack(e){const t=this.tracks.indexOf(e);if(-1===t)return;null==e._destroy||e._destroy();const r=this.tracks.length-1;String(r)in this&&Object.defineProperty(this,r,{get:void 0,enumerable:!1,configurable:!0}),this.tracks.splice(t,1),this.dispatchTrackEvent("removetrack",e)}getTrackById(e){return this.tracks.find(t=>t.id===e)||null}item(e){return this.tracks[e]}dispatchTrackEvent(e,t){const r=Ji(e);r.track=t,this.dispatchEvent(r)}}class yv extends vv{constructor(e){void 0===e&&(e=[]);for(let t=e.length-1;t>=0;t--)if(e[t].enabled){$i(e,e[t]);break}super(e),this.onaddtrack=void 0,this.onchange=void 0,this.onremovetrack=void 0,this.onaddtrack=null,this.onchange=null,this.onremovetrack=null,this.addEventListener("change",e=>{var t;return null==(t=this.onchange)?void 0:t.call(this,e)}),this.addEventListener("addtrack",e=>{var t;return null==(t=this.onaddtrack)?void 0:t.call(this,e)}),this.addEventListener("removetrack",e=>{var t;return null==(t=this.onremovetrack)?void 0:t.call(this,e)})}addTrack(e){e.enabled&&$i(this,e),super.addTrack(e),e.onenabledchange=()=>{this._changing||(this._changing=!0,$i(this,e),this._changing=!1,this.dispatchEvent(Ji("change")))}}addEventListener(e,t,r){super.addEventListener(e,t,r)}removeEventListener(e,t,r){super.removeEventListener(e,t,r)}}const Sv=["selected","width","height","bitrate","frameRate"];class Ev extends pv{constructor(e){let t=void 0===e?{}:e,{selected:r=!1,width:i,height:n,bitrate:s,frameRate:a}=t;super(function(e,t){if(null==e)return{};var r,i,n={},s=Object.keys(e);for(i=0;i<s.length;i++)r=s[i],t.indexOf(r)>=0||(n[r]=e[r]);return n}(t,Sv)),this._selected=!1,this.width=void 0,this.height=void 0,this.bitrate=void 0,this.frameRate=void 0,this.onselectedchange=void 0,this.selected=r,this.bitrate=s,this.frameRate=a,this.width=i,this.height=n}_destroy(){delete this.onselectedchange}get selected(){return this._selected}set selected(e){var t;"boolean"===typeof e&&e!==this._selected&&(this._selected=e,null==(t=this.onselectedchange)||t.call(this))}}class bv extends vv{constructor(e){void 0===e&&(e=[]);for(let t=e.length-1;t>=0;t--)if(e[t].selected){tn(e,e[t]);break}super(e),this.onaddtrack=void 0,this.onchange=void 0,this.onremovetrack=void 0,this.onaddtrack=null,this.onchange=null,this.onremovetrack=null,this.addEventListener("change",e=>{var t;return null==(t=this.onchange)?void 0:t.call(this,e)}),this.addEventListener("addtrack",e=>{var t;return null==(t=this.onaddtrack)?void 0:t.call(this,e)}),this.addEventListener("removetrack",e=>{var t;return null==(t=this.onremovetrack)?void 0:t.call(this,e)})}addEventListener(e,t,r){super.addEventListener(e,t,r)}removeEventListener(e,t,r){super.removeEventListener(e,t,r)}get selectedIndex(){for(let e=0;e<this.length;e++)if(this[e].selected)return e;return-1}addTrack(e){e.selected&&tn(this,e),super.addTrack(e),e.onselectedchange=()=>{this._changing||(this._changing=!0,tn(this,e),this._changing=!1,this.dispatchEvent(Ji("change")))}}}const Av=URL.createObjectURL(new Blob(["WEBVTT"],{type:"text/vtt"}));var Tv=r(4910);class _v extends uh.M{constructor(e,t){super();let r={videoWidth:e.videoWidth,videoHeight:e.videoHeight};const i=()=>{const{videoWidth:i,videoHeight:n}=e;isNaN(i)||isNaN(n)||i<1||n<1||r.videoWidth===i&&r.videoHeight===n||(r={videoWidth:i,videoHeight:n},t({videoWidth:i,videoHeight:n}))};if("onresize"in e)e.addEventListener("resize",i),this.once("Destroy",()=>e.removeEventListener("resize",i));else{e.addEventListener("timeupdate",i),this.once("Destroy",()=>e.removeEventListener("timeupdate",i));const t=setInterval(i,1e3);this.once("Destroy",()=>clearInterval(t))}}}const wv={droppedVideoFrames:0,corruptedVideoFrames:0,totalVideoFrames:0};class kv extends np{constructor(e){super(),this.video=void 0,this.playbackQuality=wv,this.persistedPlaybackQuality=wv,this.accumulatedPlaybackQuality=wv,this.video=e,this.addDestroyHandler(()=>{this.reset(),this.video=void 0})}update(){if(!this.video)return;const e=sn(this.video);this.playbackQuality=e,0!==this.persistedPlaybackQuality.totalVideoFrames&&(this.persistedPlaybackQuality.totalVideoFrames>e.totalVideoFrames&&(this.accumulatedPlaybackQuality={droppedVideoFrames:this.accumulatedPlaybackQuality.droppedVideoFrames+this.persistedPlaybackQuality.droppedVideoFrames,corruptedVideoFrames:this.accumulatedPlaybackQuality.corruptedVideoFrames+this.persistedPlaybackQuality.corruptedVideoFrames,totalVideoFrames:this.accumulatedPlaybackQuality.totalVideoFrames+this.persistedPlaybackQuality.totalVideoFrames}),this.persistedPlaybackQuality=wv)}persist(){0!==this.playbackQuality.totalVideoFrames&&(this.persistedPlaybackQuality=this.playbackQuality,this.playbackQuality=wv)}reset(){this.playbackQuality=wv,this.persistedPlaybackQuality=wv,this.accumulatedPlaybackQuality=wv}getPlaybackQuality(){return this.persistedPlaybackQuality.totalVideoFrames>0?wv:{droppedVideoFrames:this.playbackQuality.droppedVideoFrames+this.accumulatedPlaybackQuality.droppedVideoFrames,corruptedVideoFrames:this.playbackQuality.corruptedVideoFrames+this.accumulatedPlaybackQuality.corruptedVideoFrames,totalVideoFrames:this.playbackQuality.totalVideoFrames+this.accumulatedPlaybackQuality.totalVideoFrames}}}class Rv{constructor(e,t){this.callback=void 0,this.intervalId=void 0,this.playbackQualityController=void 0,this.oldValues={},this.dprCheckingInProgress=!1,this.tick=()=>{var e;null==(e=this.playbackQualityController)||e.update();const t=this.getFramesValue();void 0!==t&&this.callback("frames",t),this.checkDevicePixelRatio()},this.callback=t,this.playbackQualityController=new kv(e),this.intervalId=null}getFramesValue(){var e,t;if(null===this.playbackQualityController||null===this.oldValues)return;const{droppedVideoFrames:r,totalVideoFrames:i}=this.playbackQualityController.getPlaybackQuality();return(null==(e=this.oldValues.frames)?void 0:e.dropped)!==r||(null==(t=this.oldValues.frames)?void 0:t.total)!==i?(this.oldValues.frames={dropped:Math.max(Math.floor(r)),total:Math.max(Math.floor(i))},this.oldValues.frames):void 0}checkDevicePixelRatio(){if(null===this.oldValues)return;if(this.dprCheckingInProgress)return;const e="undefined"!==typeof globalThis?globalThis:window;this.oldValues.devicePixelRatio||this.handleDpr(iv(e)),this.dprCheckingInProgress=!0,cv(e).then(e=>{this.handleDpr(e)}).catch(()=>{this.handleDpr(iv(e))})}handleDpr(e){this.dprCheckingInProgress=!1,null!==this.oldValues&&this.oldValues.devicePixelRatio!==e&&(this.oldValues.devicePixelRatio=e,void 0!==e&&this.callback("devicePixelRatio",e))}enable(){this.tick(),this.intervalId=setInterval(this.tick,250)}disable(){var e;this.oldValues={},null==(e=this.playbackQualityController)||e.persist(),clearInterval(this.intervalId)}destroy(){var e;this.disable(),null==(e=this.playbackQualityController)||e.destroy(),this.callback=Yl.Z,this.oldValues=null}}class Pv{constructor(e){this.observer=void 0,this.lastValue=void 0,this.video=void 0,this.onChangeCallbacks=[],this.video=e,this.lastValue=this.computeObjectFit(),this.observer=new MutationObserver(e=>{for(let t of e)if("attributes"===t.type&&("class"===t.attributeName||"style"===t.attributeName)){const e=this.computeObjectFit();this.lastValue!==e&&(this.lastValue=e,this.onChangeCallbacks.forEach(t=>t(e)))}}),this.observer.observe(e,{attributes:!0,attributeFilter:["class","style"]})}computeObjectFit(){if(!this.video)throw new Error("No video-element to compute object-fit");return self.getComputedStyle(this.video).getPropertyValue("object-fit")}getObjectFit(){return this.lastValue}onChange(e){this.onChangeCallbacks.push(e)}destroy(){var e;null==(e=this.observer)||e.disconnect(),this.observer=null,this.video=null,this.onChangeCallbacks=[]}}const Cv={attributes:!0,childList:!1,subtree:!1,attributeFilter:["loop"]};class Iv{constructor(e,t){this.observer=void 0,this.observer=new MutationObserver((function(r){for(const i of r){if("attributes"!==i.type)return;const r=i.attributeName;t(r,e[r])}})),this.observer.observe(e,Cv)}destroy(){var e;null==(e=this.observer)||e.disconnect(),this.observer=null}}const Ov=Jh||Vd?(e,t)=>{let r=e.paused;return Zt(()=>{e.paused!==r&&(r=e.paused,t(r))})}:(e,t)=>{let r=e.paused;const i=e=>{const i="pause"===e.type;i!==r&&(r=i,t(r))},n=(0,yh.O)(e,"pause",i,{passive:!0}),s=(0,yh.O)(e,"playing",i,{passive:!0}),a=(0,yh.O)(e,"play",i,{passive:!0});return()=>{n(),s(),a()}};class Dv{constructor(e){this.unsubscribers=[],this.media=void 0,this.destroy=()=>{X(this.unsubscribers)},this.unsubscribers=[],this.media=e}observe(e){const t=Ov(this.media,e),r=()=>{t(),this.unsubscribers=this.unsubscribers.filter(e=>e!==r)};return this.unsubscribers.push(r),r}}var Nv=r(9150);const Lv=function(e,t){if(!e||!e.length)return null;if(1===e.length&&e.end(0)-e.start(0)<1e-6)return null;for(let r=0;r<e.length;r++)if(e.start(r)>t&&(0===r||e.end(r-1)-t<=.5))return r;return null},xv=(e,t,r)=>{let i=!1;const n=()=>{const n=Mv(e,i?.3:.15,r);n!==i&&(i=n,t(i))},s=Zt(n),a=setTimeout(n,0);return()=>{s(),clearTimeout(a)}},Mv=function(e,t,r){void 0===t&&(t=.15);const{currentTime:i,duration:n}=e;if(e.readyState<e.HAVE_FUTURE_DATA)return!0;return(!(null!==Lv(e.buffered,e.currentTime))||!r)&&!(0,Nv.w)(e).some(e=>{let{start:r,end:s}=e;return!(i<r||i>s)&&(n<=s||i+t<s)})};class Fv{constructor(e){this.unsubscribers=[],this.media=void 0,this.destroy=()=>{X(this.unsubscribers)},this.unsubscribers=[],this.media=e}observe(e){const t=xv(this.media,e),r=()=>{t(),this.unsubscribers=this.unsubscribers.filter(e=>e!==r)};return this.unsubscribers.push(r),r}}class Vv extends class{constructor(e,t){this.yaspMediaElement=void 0,this.notifyCallback=void 0,this.notify=void 0,this.attributeObserver=null,this.pausedObserver=null,this.bufferingObserver=null,this.handlePaused=e=>{this.notify("updatePaused",e)},this.handleBuffering=e=>{this.notify("updateBuffering",e)},this.handleBuffered=()=>{if(null===this.yaspMediaElement)throw new Error("Unexpected subscription call after destroy");const e=[],t=this.yaspMediaElement.buffered;for(let r=0;r<t.length;r++)e.push([t.start(r),t.end(r)]);this.notify("updateBuffered",e)},this.handleRatechange=()=>{if(null===this.yaspMediaElement)throw new Error("Unexpected subscription call after destroy");this.notify("updatePlaybackRate",this.yaspMediaElement.playbackRate)},this.handleTimeupdate=()=>{if(null===this.yaspMediaElement)throw new Error("Unexpected subscription call after destroy");this.notify("updateCurrentTime",Math.max(this.yaspMediaElement.currentTime,0))},this.handleDurationchange=()=>{if(null===this.yaspMediaElement)throw new Error("Unexpected subscription call after destroy");this.notify("updateDuration",Math.max(this.yaspMediaElement.duration,0))},this.yaspMediaElement=e,this.notifyCallback=t,this.notify=(e,t)=>{this.notifyCallback&&this.notifyCallback(e,t)}}enable(){var e;null!==this.yaspMediaElement&&(this.disable(),this.yaspMediaElement.addEventListener("ratechange",this.handleRatechange,{passive:!0}),this.yaspMediaElement.addEventListener("timeupdate",this.handleTimeupdate,{passive:!0}),this.yaspMediaElement.addEventListener("seeking",this.handleTimeupdate,{passive:!0}),this.yaspMediaElement.addEventListener("durationchange",this.handleDurationchange,{passive:!0}),this.yaspMediaElement.addEventListener("progress",this.handleBuffered,{passive:!0}),this.attributeObserver=new Iv(this.yaspMediaElement,(e,t)=>{"loop"===e&&this.handleLoop(null!=t&&t)}),this.pausedObserver=new Dv(this.yaspMediaElement),this.bufferingObserver=new Fv(this.yaspMediaElement),this.pausedObserver.observe(this.handlePaused),this.bufferingObserver.observe(this.handleBuffering),this.handleLoop(null!=(e=this.yaspMediaElement.loop)&&e))}disable(){var e,t,r;null!==this.yaspMediaElement&&(this.yaspMediaElement.removeEventListener("ratechange",this.handleRatechange),this.yaspMediaElement.removeEventListener("timeupdate",this.handleTimeupdate),this.yaspMediaElement.removeEventListener("seeking",this.handleTimeupdate),this.yaspMediaElement.removeEventListener("durationchange",this.handleDurationchange),this.yaspMediaElement.removeEventListener("progress",this.handleBuffered),null==(e=this.attributeObserver)||e.destroy(),this.attributeObserver=null,null==(t=this.pausedObserver)||t.destroy(),this.pausedObserver=null,null==(r=this.bufferingObserver)||r.destroy(),this.bufferingObserver=null)}destroy(){this.disable(),this.yaspMediaElement=null,this.notifyCallback=null}handleLoop(e){this.notify("updateLoop",e)}}{constructor(e,t){super(e,t),this.intervalWatcher=null,this.videoSizeObserver=null,this.videoSizeSensor=null,this.objectFitObserver=null,this.handleIntervalUpdate=(e,t)=>{switch(e){case"frames":return void this.handleFrames(t);case"devicePixelRatio":return void this.handleDevicePixelRatio(t)}},this.handleVideoResize=()=>{if(null===this.yaspMediaElement)throw new Error("Unexpected subscription call after destroy");this.notify("updateVideoSize",{height:Math.max(Math.floor(this.yaspMediaElement.videoHeight)),width:Math.max(Math.floor(this.yaspMediaElement.videoWidth))})},this.handleResize=(e,t)=>{if(null===this.yaspMediaElement)throw new Error("Unexpected subscription call after destroy");this.notify("updateContainerSize",{height:Math.max(Math.floor(t),0),width:Math.max(Math.floor(e),0)})},this.handleObjectFit=e=>{this.notify("updateObjectFit",e)},this.yaspMediaElement=e,this.intervalWatcher=new Rv(this.yaspMediaElement,this.handleIntervalUpdate)}enable(){if(null===this.intervalWatcher)return;super.enable(),this.intervalWatcher.enable(),this.videoSizeObserver=new _v(this.yaspMediaElement,this.handleVideoResize),this.videoSizeSensor=new lf(this.yaspMediaElement),this.videoSizeSensor.onResize.add(e=>{let{width:t,height:r}=e;return this.handleResize(t,r)}),this.objectFitObserver=new Pv(this.yaspMediaElement),this.objectFitObserver.onChange(this.handleObjectFit);const e=this.videoSizeSensor.getSize();this.handleResize(e.width,e.height)}disable(){var e,t,r;null!==this.intervalWatcher&&(super.disable(),this.intervalWatcher.disable(),null==(e=this.videoSizeSensor)||e.destroy(),null==(t=this.videoSizeObserver)||t.destroy(),this.videoSizeObserver=null,null==(r=this.objectFitObserver)||r.destroy(),this.objectFitObserver=null)}destroy(){var e;super.destroy(),null==(e=this.intervalWatcher)||e.destroy(),this.intervalWatcher=null}handleFrames(e){if(null===this.yaspMediaElement)throw new Error("Unexpected notification call after destroy");this.notify("updateFrames",e)}handleDevicePixelRatio(e){if(null===this.yaspMediaElement)throw new Error("Unexpected notification call after destroy");this.notify("updateDevicePixelRatio",e)}}var Bv=r(6305);class Uv{constructor(e){this.externalEventTarget=new gv.Z,this.internalEventTarget=new gv.Z,e({addEventListener:this.internalEventTarget.addEventListener.bind(this.internalEventTarget),removeEventListener:(0,hu.RW)("use_correct_method_in_workershim_revert")?this.internalEventTarget.removeEventListener.bind(this.internalEventTarget):this.internalEventTarget.addEventListener.bind(this.internalEventTarget),postMessage:e=>{const t=new MessageEvent("message",{data:e});Promise.resolve().then(()=>this.externalEventTarget.dispatchEvent(t))}})}addEventListener(e,t,r){this.externalEventTarget.addEventListener(e,t,r)}removeEventListener(e,t,r){this.externalEventTarget.removeEventListener(e,t,r)}terminate(){}postMessage(e){this.internalEventTarget.dispatchEvent(new MessageEvent("message",{data:e}))}}const jv=function(){function e(i){if(r[i])return r[i].exports;var n=r[i]={exports:{}};return t[i](n,n.exports,e),n.exports}var t=ENTRY_MODULE,r={};e.m=t,e.n=t=>{var r=t&&t.__esModule?()=>t.default:()=>t;return e.d(r,{a:r}),r},e.d=(t,r)=>{for(var i in r)e.o(r,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:r[i]})},e.g=function(){if("[object Object]"===Object.prototype.toString.call(globalThis))return globalThis;try{return this||new Function("return this")()}catch(io){if("[object Object]"===Object.prototype.toString.call(window))return window}}(),e.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i=e(ENTRY_MODULE);return i.default||i};jv.toString();var Hv=r(7926),Wv=r(1647);class qv{constructor(e){this.workerPromise=void 0,this.handleTerminate=void 0,this.workerPromise=function e(t){let r,{inline:i,path:n,workerInternal:s,workerConfig:a}=t;if(!i)try{r=un(n),(0,wd.t)(r.constructor)||(i=!0,r.terminate())}catch(u){i=!0}i&&(r=new Uv(s));const o=new Hv.A(e=>{r.postMessage(e,(0,Wv._)(e))});let l=!1;const d=new Promise((t,d)=>{const u=o.request({method:"initWorker",params:a}),c=o=>{l||i?console.error(o):(h(),r.terminate(),t(e({inline:!0,workerInternal:s,path:n,workerConfig:a})))},h=()=>{r.removeEventListener("error",c)};u.then(()=>{l=!0,h(),t({worker:r,rpc:o})}).catch(c),r.addEventListener("error",c),r.addEventListener("message",e=>{o.handleMessage(e)})});return(0,Pd.v)(d),d}({inline:!e.useWebWorker,path:6305,workerInternal:Bv.Z,workerConfig:e.workerConfig}),this.handleTerminate=e.onTerminate}async postMessage(){const{worker:e}=await this.workerPromise;e.postMessage(...arguments)}sendEvent(e){let{method:t,params:r}=e;return this.workerPromise.then(e=>{let{rpc:i}=e;return i.sendEvent({method:t,params:r})})}request(e){let{method:t,params:r}=e;return this.workerPromise.then(e=>{let{rpc:i}=e;return i.request({method:t,params:r})})}registerRpcHandler(e,t){return this.workerPromise.then(r=>{let{rpc:i}=r;return i.registerHandler(e,t)}),()=>this.removeRpcHandler(e,t)}registerStaticRpcHandler(e,t){return this.workerPromise.then(r=>{let{rpc:i}=r;return i.registerStaticHandler(e,t)}),()=>this.removeRpcHandler(e,t)}removeRpcHandler(e,t){this.workerPromise.then(r=>{let{rpc:i}=r;return i.removeHandler(e,t)})}destroy(){this.workerPromise.then(e=>{let{worker:t,rpc:r}=e;t.terminate(),r.destroy(),this.handleTerminate()})}}class Yv{constructor(e){this.onTick=void 0,this.cancelPending=void 0,this.onTick=e,this.cancelPending=null}tickAfter(e){this.stop();let t=!0,r=null;this.cancelPending=()=>{self.clearTimeout(r),t=!1};return r=self.setTimeout(()=>{t&&this.onTick()},1e3*e),this}stop(){this.cancelPending&&(this.cancelPending(),this.cancelPending=null)}}class Gv{constructor(e){this.onTick=void 0,this.ticker=void 0,this.onTick=e,this.ticker=null}tickNow(){return this.stop(),this.onTick(),this}tickAfter(e){return this.stop(),this.ticker=new Yv(()=>{this.onTick()}).tickAfter(e),this}tickEvery(e){return this.stop(),this.ticker=new Yv(()=>{var t;null==(t=this.ticker)||t.tickAfter(e),this.onTick()}).tickAfter(e),this}stop(){this.ticker&&(this.ticker.stop(),this.ticker=null)}}class Kv{constructor(e,t,r,i,n){this.media=void 0,this.timeline=void 0,this.config=void 0,this.stallDetector=void 0,this.onEvent=void 0,this.unsubscribe=void 0,this.seekingEventReceived=void 0,this.prevReadyState=void 0,this.didFireLargeGap=void 0,this.hadSegmentAppended=void 0,this.locked=void 0,this.gapJumpTimer=void 0,this.media=e,this.timeline=t,this.config=r,this.stallDetector=i,this.onEvent=n,this.seekingEventReceived=!1,this.prevReadyState=e.readyState,this.didFireLargeGap=!1,this.hadSegmentAppended=!1,this.locked=!1,this.unsubscribe=(0,yh.O)(e,"waiting",()=>this.onPollGapJump(),!1),this.gapJumpTimer=new Gv(()=>{this.onPollGapJump()}).tickEvery(.25)}release(){this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null),null!==this.gapJumpTimer&&(this.gapJumpTimer.stop(),this.gapJumpTimer=null),this.stallDetector&&(this.stallDetector.release(),this.stallDetector=null),this.onEvent=null,this.timeline=null,this.media=null}configure(e){this.config=cn({},this.config,e)}onSegmentAppended(){this.hadSegmentAppended=!0,this.onPollGapJump()}onSeeking(){this.seekingEventReceived=!0,this.hadSegmentAppended=!1,this.didFireLargeGap=!1}lock(){this.locked=!0}unlock(){this.locked=!1}onPollGapJump(){var e,t,r,i,n;if(!this.media)return;if(this.locked&&(0,hu.RW)("yasp_no_source_abort_on_fake_seek"))return;if(0===this.media.readyState)return;if(this.media.seeking){if(!this.seekingEventReceived)return}else this.seekingEventReceived=!1;if(this.media.paused&&(null==(e=this.config)||!e.jumpOnPause))return;if(this.media.readyState!==this.prevReadyState&&(this.didFireLargeGap=!1,this.prevReadyState=this.media.readyState),null!=(t=this.stallDetector)&&t.poll())return;const s=(null==(r=this.config)?void 0:r.smallGapLimit)||.5,a=(null==(i=this.config)?void 0:i.largeGapLimit)||1/0;let o=this.media.currentTime,l=this.media.buffered,d=Lv(l,o);if(null===d)return;if(0===d&&!this.hadSegmentAppended)return;let u=l.start(d);if(u>=((null==(n=this.timeline)?void 0:n.getSeekRangeEnd())||0))return;let c=u-o,h=c<=s,p=!1;if(!(c<Kv.BROWSER_GAP_TOLERANCE)){if(!h&&!this.didFireLargeGap){var f,m;this.didFireLargeGap=!0;const e=[];for(let t=0;t<this.media.buffered.length;t++)e.push([this.media.buffered.start(t),this.media.buffered.end(t)]);null==(f=this.onEvent)||f.call(this,{currentTime:o,gapSize:c,bufferedRanges:e}),null!=(m=this.config)&&m.jumpLargeGaps&&c<a&&(p=!0)}(h||p)&&(this.media.currentTime=u)}}}Kv.BROWSER_GAP_TOLERANCE=.001;var zv=r(520);class Zv{static isBuffered(e,t,r){if(void 0===r&&(r=0),!e||!e.length)return!1;if(1===e.length&&e.end(0)-e.start(0)<1e-6)return!1;if(t>e.end(e.length-1))return!1;for(let i=0;i<e.length;i++)if(t+r>=e.start(i)&&t-r<=e.end(i))return!0;return!1}static getTimeRanges(e){const t=[];for(let r=0;r<e.length;r++)try{t.push({start:e.start(r),end:e.end(r)})}catch(io){}return(0,zv.l)(t)}}var Xv=r(1106),Qv=r(8493);const Jv=Date&&(0,Ql.m)(Date.now)?()=>Date.now():()=>(new Date).getTime(),$v=ee()?9e5:864e5,ey=["ewma","hlsjs"],ty=function(e){void 0===e&&(e=window);return(0,Md.i)(e).includes("CrKey")}(),ry=sv||av||nv;class iy{constructor(e,t,r,i){void 0===t&&(t=Yl.Z),void 0===r&&(r=.1),void 0===i&&(i=1),this.video=void 0,this.wasMakingProgress=void 0,this.value=void 0,this.lastUpdateSeconds=void 0,this.didJump=void 0,this.didTryToEscape=void 0,this.didTryToEscapeSeekingStucking=void 0,this.skipOffset=void 0,this.stallThresholdSeconds=void 0,this.extraThresholdSeconds=void 0,this.onEvent=void 0,this.makePP=()=>{this.video&&(this.video.pause(),(0,Pd.v)(this.video.play()))},this.handleTVPoll=(e,t)=>{if(!this.video)return!1;if(this.video.seeking)return this.tryToEscapeSeekingStucking(e);if(e>=this.stallThresholdSeconds&&t&&!this.didJump)return this.onStall(),this.didJump=!0,this.value=this.video.currentTime,this.onEvent(),!0;return!(!(e>=this.extraThresholdSeconds&&t)||this.didTryToEscape)&&this.tryToEscapeTVStucking()},this.handlePoll=(e,t)=>{if(!this.video)return!1;const r=e>=this.stallThresholdSeconds&&t&&!this.didJump;return r&&(this.onStall(),this.didJump=!0,this.value=this.video.currentTime,this.onEvent()),r},this.video=e,this.wasMakingProgress=this.shouldBeMakingProgress(),this.value=null==e?void 0:e.currentTime,this.lastUpdateSeconds=Date.now()/1e3,this.didJump=!1,this.didTryToEscape=!1,this.didTryToEscapeSeekingStucking=!1,this.skipOffset=r,this.stallThresholdSeconds=i,this.extraThresholdSeconds=2*i,this.onEvent=t}release(){this.video=null,this.onEvent=Yl.Z}onStall(){if(!this.video)return;av||nv||ty||!this.skipOffset?this.makePP():this.video.currentTime+=this.skipOffset}poll(){if(!this.video)return;const e=this.shouldBeMakingProgress(),t=this.video.currentTime,r=Date.now()/1e3;(this.value!==t||this.wasMakingProgress!==e)&&(this.lastUpdateSeconds=r,this.value=t,this.wasMakingProgress=e,this.didJump=!1,this.didTryToEscape=!1,this.didTryToEscapeSeekingStucking=!1);const i=r-this.lastUpdateSeconds;return(ry?this.handleTVPoll:this.handlePoll)(i,e)}shouldBeMakingProgress(){return!!this.video&&(!this.video.paused&&(0!==this.video.playbackRate&&(0!==this.video.buffered.length&&this.hasContentFor(this.video.currentTime))))}tryToEscapeTVStucking(){if(!this.video)return!1;if(sv)return!(this.video.readyState<this.video.HAVE_ENOUGH_DATA)&&(this.didTryToEscape=!0,setTimeout(()=>{var e;null!=(e=this.video)&&e.paused||this.makePP()},2e3),!0);if(nv){const e=qt((0,Nv.w)(this.video),this.video.currentTime);if(!e||e<7.5)return!1;if(this.video.readyState===this.video.HAVE_METADATA)return this.video.currentTime+=this.skipOffset,this.value=this.video.currentTime,this.didTryToEscape=!0,!0}return!1}tryToEscapeSeekingStucking(e){return!(!this.video||this.didTryToEscapeSeekingStucking||!this.video.paused||e<this.extraThresholdSeconds)&&(this.video.readyState===this.video.HAVE_METADATA&&(this.video.currentTime+=this.skipOffset,this.value=this.video.currentTime,this.didTryToEscapeSeekingStucking=!0,!0))}hasContentFor(e){if(!this.video)return!1;for(const{start:t,end:r}of(0,Nv.w)(this.video))if(!(e<t-.1)&&!(e>r-.5))return!0;return!1}}var ny=r(413);class sy{constructor(e){this.media=null,this.wasNativeProgressEmited={default:!1,onPause:!1},this.interval=null,this.lastBufferedEnd=0,this.onPoll=()=>{if(!this.media)return;const{length:e}=this.media.buffered;if(!e)return void(this.lastBufferedEnd=0);const t=this.media.buffered.end(e-1);this.lastBufferedEnd<t&&this.emitProgress(),this.lastBufferedEnd=t},this.onProgress=e=>{this.media&&("detail"in e&&e.detail.synthetic||(this.media.paused?this.wasNativeProgressEmited.onPause=!0:this.wasNativeProgressEmited.default=!0,this.shouldStopPolling()&&this.release()))},this.media=e,e.addEventListener("progress",this.onProgress),this.interval=setInterval(this.onPoll,250)}shouldStopPolling(){return(0,hh.z)(this.wasNativeProgressEmited).every(Boolean)}release(){var e;null==(e=this.media)||e.removeEventListener("progress",this.onProgress),this.interval&&(clearInterval(this.interval),this.interval=null),this.media=null}emitProgress(){var e,t;this.shouldStopPolling()||(this.wasNativeProgressEmited.default||null!=(e=this.media)&&e.paused)&&(this.wasNativeProgressEmited.onPause||null==(t=this.media)||!t.paused)||this.dispatchSyntheticProgress()}dispatchSyntheticProgress(){var e;null==(e=this.media)||e.dispatchEvent(new CustomEvent("progress",{detail:{synthetic:!0}}))}}class ay{constructor(e,t){this.maxAttempts=t,this.remainingAttempts=0,this.originTime=0,this.targetTime=0,this.timer=new Gv(()=>{this.onTick()}),this.media=void 0,this.media=e}release(){this.timer&&(this.timer.stop(),this.timer=null),this.media=null}moveTo(e){this.media&&this.timer&&(this.originTime=this.media.currentTime,this.targetTime=e,this.remainingAttempts=this.maxAttempts,this.media.currentTime=e,this.timer.tickEvery(.1))}onTick(){this.media&&this.timer&&(this.remainingAttempts<=0?this.timer.stop():this.media.currentTime===this.originTime?(this.media.currentTime=this.targetTime,this.remainingAttempts--):this.timer.stop())}}var oy=r(153),ly=r(1911);const dy=["play","playing","pause","error","waiting","stalled","suspend","ended","loadstart","abort","loadedmetadata","loadeddata","canplay","canplaythrough","durationchange","seeking","seeked","encrypted","ratechange"],uy=["error","waiting","seeking","seeked","canplay","encrypted"];class cy{constructor(e,t){this.media=e,this.getDump=t,this.history=new ly.d(oy.K),this.handleEvent=e=>{const t=e.type,r={event:t,timestamp:Date.now()};uy.includes(t)&&(r.dump=this.getDump()),this.history.push(r)},this.subscribeToEvents()}subscribeToEvents(){dy.forEach(e=>{this.media.addEventListener(e,this.handleEvent)})}release(){dy.forEach(e=>{this.media.removeEventListener(e,this.handleEvent)})}getEventHistory(){return this.history.toArray()}pushCustomEvent(e){this.history.push(e)}}const hy=vn(HTMLVideoElement);class py extends hy{constructor(){super(...arguments),this.airplayController=void 0,this.videoTrackList=void 0,this.unsubscribeTextTracksChange=void 0,this.unsubscribeTextTracksAdd=void 0,this.isLowLatency=!1,this.serverTimeInfo=void 0,this.streamEndTime=void 0}static setDevicePixelRatioForSource(e){py.worker.request({method:"setDevicePixelRatio",params:{source:e,devicePixelRatio:iv(window)}}).catch(Yl.Z),cv(window).then(t=>py.worker.request({method:"setDevicePixelRatio",params:{source:e,devicePixelRatio:t}})).catch(Yl.Z)}logAirplayStateChange(e){this.yaspDispatchEvent("yasp-event",{name:"AirplayStateChange",data:{enabled:e}})}static attach(e,t){if(py.isYaspVideoElement(e))return e;const r=hy.attachElement(py,e,t);return r.registerVideoRpcHandlers(),r.initVideoStateNotifier(),r.initVideoTrackList(),r.initTextTrackList(),r.initAirplayController(),hy.messenger.emit("yasp-event",{name:"YaspAttached",data:void 0}),r}get videoTracks(){var e;return this.yaspSrc?this.videoTrackList:null!=(e=super.videoTracks)?e:this.videoTrackList}canPlayType(e){return py.isSupported()&&"application/dash+xml"===e?super.canPlayType('video/mp4; codecs="avc1.42E01E"'):super.canPlayType(e)}set airplaySrc(e){this.airplayController&&(this.airplayController.airplaySrc=e)}get airplaySrc(){var e;return null==(e=this.airplayController)?void 0:e.airplaySrc}static isYaspVideoElement(e){return!0===e.yasp}addEventListener(e,t,r){super.addEventListener(e,t,r)}removeEventListener(e,t,r){super.removeEventListener(e,t,r)}async yaspRequestDebugInfo(){const{videoTracks:e,audioTracks:t,textTracks:r}=this;return yn({},{videoElement:{audioTracks:(0,Rd.w)(t),videoTracks:(0,Rd.w)(e),textTracks:(0,Rd.w)(r)}},await super.yaspRequestDebugInfo())}async detach(){var e,t;await super.detach(),null==(e=this.unsubscribeTextTracksChange)||e.call(this),this.unsubscribeTextTracksChange=void 0,null==(t=this.unsubscribeTextTracksAdd)||t.call(this),this.unsubscribeTextTracksAdd=void 0}static async preloadSrc(e,t){var r;const i=t.yaspSourceConfig;i?py.configureSource(e,i):py.shouldSaveBandwidth&&py.worker.sendEvent({method:"configureSource",params:{source:e,config:{defaultBandwidthEstimate:py.getDefaultBandwidthEstimate()}}}),py.setDevicePixelRatioForSource(e);return await py.worker.request({method:"load",params:{source:e,storePath:null==i||null==(r=i.offlineParams)?void 0:r.storePath}})}async yaspPreloadSrc(e,t){return py.preloadSrc(e,t)}static async releaseSrc(e){return py.worker.request({method:"destroy",params:{source:e,reason:"ExternalApi"}}).catch(mf.warn)}async yaspReleaseSrc(e){return py.releaseSrc(e)}yaspSetVideoElementSizes(e){py.setVideoElementSizes(this.src,e)}static setVideoElementSizes(e,t){dg(e)&&py.configureSource(e,{videoSizes:t})}yaspDispatchEvent(e,t,r){const i=new CustomEvent(e,yn({detail:t},r));super.dispatchEvent(i)}static getStats(){return yn({},hy.getStats(),{maxCapAllowedVideoTrack:py.maxCapAllowedVideoTrack})}static get worker(){const e=hy.worker;return e.registerStaticRpcHandler("updateMaxCapAllowedVideoTrack",e=>(py.maxCapAllowedVideoTrack=e.maxCapAllowedVideoTrack,{done:!0,value:void 0})),e}initVideoTrackList(){if(void 0!==this.videoTrackList)return;const e=new bv;e.addEventListener("change",()=>{const{id:t}=e[e.selectedIndex];py.configureSource(this.src,{tracks:{videoTrackId:t}});const r=new Event("change");(0,Wa.Y)(()=>{super.videoTracks.dispatchEvent(r)})}),this.videoTrackList=e}static removeCues(e){if(!e.cues)return;let t=e.cues;for(let r=t.length-1;r>=0;r--){let i=t[r];i&&e.removeCue(i)}}initTextTrackList(){sv&&(this.unsubscribeTextTracksAdd=(0,yh.O)(this.textTracks,"addtrack",e=>{let{track:t}=e;const r=t;var i;"empty-yasp-text-track"===r.id&&"showing"===r.mode&&(r.mode="disabled",null==(i=this.findEmptyTextTrack())||i.remove())})),this.unsubscribeTextTracksChange=(0,yh.O)(this.textTracks,"change",e=>{let{target:t}=e;const r={source:this.yaspSrc,track:null},i=t;for(let s=0;s<i.length;s++){const e=i[s];var n;if("empty-yasp-text-track"!==e.id)"disabled"!==e.mode&&(py.removeCues(e),r.track={id:e.id,label:e.label,language:e.language,kind:e.kind});else null==(n=this.findEmptyTextTrack())||n.remove()}py.configureSource(this.src,{tracks:{textTrack:r.track}})})}findEmptyTextTrack(){return this.querySelector('track[id="empty-yasp-text-track"]')}registerVideoRpcHandlers(){this.registerRpcHandlerForInstance("changeVideoTracks",e=>{const{added:t,removed:r}=e;return r.forEach(e=>{var t;const r=null==(t=this.videoTrackList)?void 0:t.getTrackById(e);var i;r&&(null==(i=this.videoTrackList)||i.removeTrack(r))}),t.forEach(e=>{var t,r,i;let{source:n,track:s}=e;const a=null==(t=this.videoTrackList)?void 0:t.getTrackById(s.id);mn(this.yaspSrc,n)&&a||null==(r=this.videoTrackList)||r.addTrack(new Ev({selected:s.selected,width:s.width,height:s.height,bitrate:s.bitrate,label:s.label,language:null!=(i=s.language)?i:void 0,frameRate:s.frameRate,id:s.id,kind:s.kind}))}),{done:!0,value:void 0}}),this.registerRpcHandlerForInstance("addTextTrack",e=>{const t=this.getElementsByTagName("track"),r=(0,Rd.w)(t).some(t=>t.id===e.track.id);if(mn(this.yaspSrc,e.source)&&r)return{done:!0,value:void 0};if(sv&&!this.findEmptyTextTrack()){const t=document.createElement("track");t.setAttribute("kind",e.track.kind),t.setAttribute("default","true"),t.setAttribute("id","empty-yasp-text-track"),t.src=Av,this.appendChild(t)}const i=document.createElement("track");return i.setAttribute("kind",e.track.kind),i.setAttribute("label",e.track.label),i.setAttribute("srclang",e.track.language),i.setAttribute("id",e.track.id),i.src=Av,this.appendChild(i),{done:!0,value:void 0}}),this.registerRpcHandlerForInstance("cuesAdded",e=>{let t,{source:r,cues:i,label:n}=e;for(let a=0;a<this.textTracks.length;a++)this.textTracks[a].label===n&&(t=this.textTracks[a]);if(!t)return{done:!0,value:void 0};const s=e=>{const r=new VTTCue(e.startTime,e.endTime,e.payload);t.addCue(r),(e.nestedCues||[]).forEach(s)};return i.forEach(s),{done:!0,value:void 0}}),this.registerRpcHandlerForInstance("changeSelectedVideoTrack",e=>{if(!this.videoTrackList)return{done:!0,value:void 0};const t=this.videoTrackList.getTrackById(e.trackId);return t?(t.selected=!0,{done:!0,value:void 0}):{done:!0,value:void 0}}),this.registerRpcHandlerForInstance("changeVideoType",e=>(this.yaspDispatchEvent("yasp-videoTypeChange",e.videoType,{cancelable:!0}),{done:!0,value:void 0})),this.registerRpcHandlerForInstance("changeIsLowLatency",e=>(this.isLowLatency=e.isLowLatency,{done:!0,value:void 0})),this.registerRpcHandlerForInstance("updateTargetLatency",e=>(this.yaspDispatchEvent("yasp-updateTargetLatency",e.latency,{cancelable:!0}),{done:!0,value:void 0})),this.registerRpcHandlerForInstance("updateServerTime",e=>(this.serverTimeInfo?(this.serverTimeInfo.time=e.time,this.serverTimeInfo.getTime=rn()):this.serverTimeInfo={time:e.time,getTime:rn()},{done:!0,value:void 0})),this.registerRpcHandlerForInstance("updateStreamEndTime",e=>(this.streamEndTime=e.time,{done:!0,value:void 0}))}initVideoStateNotifier(){this.mediaStateNotifier=new Vv(this,(e,t)=>{null!==this.yasp&&py.worker.postMessage({jsonrpc:"2.0",method:e,sourceKey:(0,Tv.Hi)(this.yaspSrc),params:t})}),this.mediaStateNotifier.enable()}getServerTime(){if(this.serverTimeInfo&&this.serverTimeInfo.time)return(this.serverTimeInfo.time+this.serverTimeInfo.getTime())/1e3}getStreamEndTime(){return this.streamEndTime?this.streamEndTime/1e3:null}isLowLatencyLive(){return this.isLowLatency}clearTextTrackList(){for(let t=0;t<this.textTracks.length;t++)this.textTracks[t].mode="disabled";const e=this.getElementsByTagName("track");for(;e.length;)e[0].remove()}clearTrackLists(){super.clearTrackLists(),en(this.videoTrackList),this.clearTextTrackList()}initAirplayController(){this.airplayController||(this.airplayController=new rv(this,e=>this.logAirplayStateChange(e)))}setSrc(e){if(super.setSrc(e),dg(e)){if(this.airplayController&&this.airplayController.airplayEnabled)return void(this.airplayController.detachedSrc=e);py.setDevicePixelRatioForSource(e)}}restore(){super.restore(),this.streamEndTime=void 0,this.serverTimeInfo=void 0,this.isLowLatency=!1}}py.maxCapAllowedVideoTrack=void 0;vn(HTMLAudioElement);class fy extends uh.M{constructor(e){super(),this.props=e,this.isDestroyed=!1,this.preloaded=!1,this.url="",this.preload=(0,La.I)(async e=>{var t,r,i;if(this.isDestroyed)throw new Error("YaspPreloader was destroyed");this.url=En(this.props.source.stream.url,this.props.source.sourceParams.startPosition.videoTime);const n=this.props.getVideoElementSizes(),s=bn({},e,{maxAutoQuality:null!=(t=null==e?void 0:e.maxAutoQuality)?t:this.props.defaultQuality,videoSizes:n});await py.preloadSrc(this.url,{videoContentId:null!=(r=null==(i=this.props.source.sourceParams.videoInfo)?void 0:i.videoContentId)?r:"missed",yaspSourceConfig:s}),this.preloaded=!0}),this.once("Destroy",()=>{this.isDestroyed=!0})}getSource(){return this.props.source}destroy(){this.preloaded||py.releaseSrc(this.url),super.destroy()}}let my;!function(e){e[e.MEDIA_ERR_CUSTOM=0]="MEDIA_ERR_CUSTOM",e[e.MEDIA_ERR_ABORTED=1]="MEDIA_ERR_ABORTED",e[e.MEDIA_ERR_NETWORK=2]="MEDIA_ERR_NETWORK",e[e.MEDIA_ERR_DECODE=3]="MEDIA_ERR_DECODE",e[e.MEDIA_ERR_SRC_NOT_SUPPORTED=4]="MEDIA_ERR_SRC_NOT_SUPPORTED",e[e.MEDIA_ERR_ENCRYPTED=5]="MEDIA_ERR_ENCRYPTED"}(my||(my={}));class gy{constructor(e){this.code=0,this.message="",this.details=void 0,"number"===typeof e?this.code=e:"string"===typeof e?this.message=e:(0,Za.K)(e)&&("number"===typeof e.code&&(this.code=e.code),"string"===typeof e.message&&(this.message=e.message),this.details=e.details),this.message||(this.message=my[this.code]||"")}}var vy=r(6636);const yy=(0,ug.Q)(),Sy=window.SourceBuffer||window.WebKitSourceBuffer,Ey=yy&&"function"===typeof yy.isTypeSupported&&yy.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),by=!Sy||Sy.prototype&&"function"===typeof Sy.prototype.appendBuffer&&"function"===typeof Sy.prototype.remove,Ay=Boolean(Ey)&&Boolean(by);var Ty=r(442);const _y=[401,403];let wy;!function(e){e.LOWRES="lowres",e.HIGHRES="highres"}(wy||(wy={}));const ky={tiles:"com.yandex.video.thumbnail.lowres.tiles",duration:"com.yandex.video.thumbnail.lowres.duration",resolution:"com.yandex.video.thumbnail.lowres.resolution",uri:"com.yandex.video.thumbnail.lowres.uri"},Ry={tiles:"com.yandex.video.thumbnail.tiles",duration:"com.yandex.video.thumbnail.duration",resolution:"com.yandex.video.thumbnail.resolution",uri:"com.yandex.video.thumbnail.uri"},Py=[4320,2880,2160,1440,1080,720,576,480,360,240,144],Cy=Math.min(...Py.slice(1).map((e,t)=>Py[t]/e));var Iy=r(9473);let Oy;!function(e){e.WAS_WORKER_INTERNAL_ERROR="YANDEX_PLAYER_HLS_WAS_WORKER_INTERNAL_ERROR"}(Oy||(Oy={}));let Dy;!function(e){e.HasAd="HasAd",e.NoAd="NoAd",e.NoData="NoData"}(Dy||(Dy={}));const Ny=/^(\d+)x(\d+)@(\d+)$/,Ly=function(){try{const{volume:e}=Qp;Qp.volume=0===e?1:0;const t=Qp.volume!==e;return Qp.volume=e,t}catch(TE){return!1}}(),xy=Fd(),My=xy?.25:.02;let Fy;!function(e){e.VideoTagPaused="VideoTagPaused",e.VideoTagPausedAfterDurationChange="VideoTagPausedAfterDurationChange",e.VideoTagPausedAfterError="VideoTagPausedAfterError",e.PauseEvent="PauseEvent",e.ProgressEvent="ProgressEvent",e.PromiseResolve="PromiseResolve",e.PromiseReject="PromiseReject",e.PlayingEvent="PlayingEvent",e.Timeout="Timeout"}(Fy||(Fy={}));const Vy={once:!0,passive:!0};class By{constructor(e){this.props=e,this.currentAttempt=0,this.recovering=!1,this.plannedTaskPromise=void 0,this.resetTimeoutId=0}get allowed(){return this.currentAttempt<10}get started(){return this.currentAttempt>0}get attempt(){return this.currentAttempt}getState(){return this.started?ig.ON:ig.OFF}planTask(e,t){let r,{reason:i,delay:n,force:s,rawData:a}=t;if(this.recovering&&!s)return this.log("Can't plan task cause is in process of recover"),void this.props.onConcurrentRecover({reason:i,rawData:a});this.clearPlannedTask("new task planned"),this.clearResetTimeout("new task planned"),"number"===typeof n?(r=df(n).promise.then(Yl.Z),this.log("#"+this.currentAttempt+", PLAN task, "+n+"ms, ["+i+"]",a)):(r=n,this.log("#"+this.currentAttempt+", PLAN async task, ["+i+"]",a)),(0,Pd.v)(r),r.then(()=>{if(r===this.plannedTaskPromise)return this.recovering=!0,this.currentAttempt++,this.props.onRunTask({reason:i,delay:n,rawData:a,attempt:this.currentAttempt}),this.log("#"+this.currentAttempt+", RUN task, ["+i+"]",a),this.clearPlannedTask(),e()}).catch(e=>{this.log("Error while recover",e),this.props.onRecoverError({reason:i,rawData:a},e)}).then(()=>{this.recovering=!1}),this.plannedTaskPromise=r}isRecovering(){return this.recovering}planReset(e){let{reason:t,delay:r}=e;this.log("plan RESET, "+r+"ms, if ["+t+"]"),this.clearResetTimeout("new reset planned"),this.resetTimeoutId=window.setTimeout(()=>{this.reset(t)},r)}destroy(){this.reset("destroy")}reset(e){this.props.onReset(),this.log("RESET because of ["+e+"]"),this.clearPlannedTask(),this.clearResetTimeout(),this.currentAttempt=0}log(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];mf.log("RecoverHelper:",...t)}clearPlannedTask(e){e&&this.log("CLEAR planned TASKS because of ["+e+"]"),this.plannedTaskPromise=void 0}clearResetTimeout(e){e&&this.log("CLEAR planned RESET because of ["+e+"]"),0!==this.resetTimeoutId&&(clearTimeout(this.resetTimeoutId),this.resetTimeoutId=0)}}var Uy=r(8024),jy=r.n(Uy);var Hy,Wy;!function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.ETHERNET=1]="ETHERNET",e[e.WIFI=2]="WIFI",e[e.CELL_2G=3]="CELL_2G",e[e.CELL_3G=4]="CELL_3G"}(Hy||(Hy={})),function(e){e.BLUETOOTH="bluetooth",e.CELLULAR="cellular",e.ETHERNET="ethernet",e.MIXED="mixed",e.NONE="none",e.OTHER="other",e.UNKNOWN="unknown",e.WIFI="wifi",e.WIMAX="wimax"}(Wy||(Wy={}));var qy=r(3539);class Yy{constructor(e){void 0===e&&(e={}),this.timeMeasurer=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.totalDecodedFrames=0,this.totalDroppedFrames=0,this.lastVideoWidth=void 0,this.lastVideoHeight=void 0,this.maxWidth=1/0,this.maxHeight=1/0,this.props=void 0,this.frameHistoryDuration=1e3,this.frameHistory=[{time:0,shownFrames:0,droppedFrames:0}],this.props=e}setRestrictions(e,t){var r,i;e>=this.maxWidth&&t>=this.maxHeight||t<360||(this.maxWidth=e,this.maxHeight=t,mf.warn("FPSController changed restrictions: "+e+"\xd7"+t+"."),null==(r=(i=this.props).onRestrictionsChange)||r.call(i,{decodedFrames:this.totalDecodedFrames,droppedFrames:this.totalDroppedFrames,maxWidth:e,maxHeight:t}))}getRestrictions(){return{maxWidth:this.maxWidth,maxHeight:this.maxHeight}}update(e){if(!e.videoWidth||!e.videoHeight)return;const t=sn(e);this.checkFPS(e.videoWidth,e.videoHeight,t.totalVideoFrames,t.droppedVideoFrames)}checkFPS(e,t,r,i){if(!this.timeMeasurer||!r||this.lastVideoWidth!==e||this.lastVideoHeight!==t||r<this.lastDecodedFrames)this.timeMeasurer=(0,xa.u)(),this.totalDecodedFrames=0,this.totalDroppedFrames=0;else{const n=r-this.lastDecodedFrames,s=i-this.lastDroppedFrames;this.totalDecodedFrames+=n,this.totalDroppedFrames+=s,this.timeMeasurer()>5e3&&this.totalDroppedFrames>.25*this.totalDecodedFrames&&this.setRestrictions(e,t),this.updateFrameHistory(n,s)}this.lastDecodedFrames=r,this.lastDroppedFrames=i,this.lastVideoWidth=e,this.lastVideoHeight=t}updateFrameHistory(e,t){if(!this.timeMeasurer)return;const r=this.timeMeasurer();this.frameHistory.push({time:r,shownFrames:e-t,droppedFrames:t}),this.cleanFilterFrameHistory(r)}cleanFilterFrameHistory(e){this.timeMeasurer&&(this.frameHistory=this.frameHistory.filter(t=>e-t.time<=this.frameHistoryDuration))}getApproximateFPS(){if(!this.timeMeasurer)return{approximateShownFPS:0,approximateDroppedFPS:0};const e=this.timeMeasurer();if(this.cleanFilterFrameHistory(e),!this.frameHistory.length)return{approximateShownFPS:0,approximateDroppedFPS:0};const t=this.frameHistory[0].time,r=(this.frameHistory[this.frameHistory.length-1].time-t)/1e3,i=r>0?1/r:1,n=this.frameHistory.slice(1).reduce((e,t)=>e+t.shownFrames,0)*i,s=this.frameHistory.slice(1).reduce((e,t)=>e+t.droppedFrames,0)*i;return{approximateShownFPS:n<0?0:n,approximateDroppedFPS:s<0?0:s}}}const Gy=function(e){const t=(0,Md.i)(e).match(/Firefox\/([0-9]+)\./);return t&&parseInt(t[1],10)||-1}(window);class Ky{constructor(e,t,r){void 0===r&&(r=100),this.win=e,this.callback=t,this.interval=r,this.started=!1,this.intervalId=0,this.getDiff=(0,xa.u)()}start(){this.started||(this.started=!0,this.getDiff=(0,xa.u)(),this.intervalId=this.win.setInterval(()=>{const e=this.getDiff();this.getDiff=(0,xa.u)(),this.callback(e)},this.interval))}stop(){this.started&&(this.started=!1,this.win.clearInterval(this.intervalId))}}class zy{constructor(e){this.props=void 0,this.bufferGoalFilters=[hs,ps],this.props=e}getBufferGoal(e){const{watchedTime:t=0,currentTime:r=0}=e,i=fs({},this.props,{watchedTime:t,currentTime:r});return this.bufferGoalFilters.reduce((e,t)=>Math.min(t(i),e),30)}}var Zy=r(9591),Xy=r(6513),Qy=r(3942);class Jy{constructor(e){this.props=e,this.video=void 0,this.videoSizeSensor=void 0,this.defaultQuality=void 0,this.getPipWindowSize=void 0;const{video:t,videoSizeSensor:r,defaultQuality:i,getPipWindowSize:n}=this.props;this.video=t,this.videoSizeSensor=r,this.defaultQuality=i,this.getPipWindowSize=n}getCapSizes(){var e;const t=null!=(e=this.getPipWindowSize())?e:(0,Xy.k)(this.video,this.props.objectFit||"contain",this.videoSizeSensor.getSize()),r=t.height>t.width,i=(0,zg.R)(),n=null!==this.defaultQuality,s=(0,Qy.R)(this.defaultQuality),a=(n?Math.max(screen.height,t.height):t.height)*devicePixelRatio,o=(n?Math.max(screen.width,t.width):t.width)*devicePixelRatio,l=r?Math.min(a,s):a,d=r?o:Math.min(o,s),u=r&&i?Zy.T/9*16:1/0;return{width:d,height:l,maxWidth:!r&&i?Zy.T/9*16:1/0,maxHeight:u}}}const $y=function(){const e=document.createElement("video");if(!("playbackRate"in e))return!1;try{return e.playbackRate-=.05,!0}catch(TE){return!1}}();class eS{constructor(e,t,r){void 0===r&&(r=window),this.video=e,this.onFrameTickCallback=t,this.win=r,this.intervalController=null,this.lastHandle=0,this.lastCurrentTime=-1,this.stopped=!1,this.onTick=()=>{if(this.stopped)return;const e=this.video.currentTime;e!==this.lastCurrentTime&&(this.onFrameTick(),this.lastCurrentTime=e)};"function"===typeof this.video.requestVideoFrameCallback?this.startNative():this.startIntervals()}onFrameTick(){try{this.onFrameTickCallback()}catch(io){(0,Wp.L)(io)}}startNative(){const e=()=>{this.stopped||(this.onFrameTick(),this.lastHandle=this.video.requestVideoFrameCallback(e))};this.lastHandle=this.video.requestVideoFrameCallback(e)}startIntervals(e){var t;void 0===e&&(e=25),null==(t=this.intervalController)||t.stop(),this.intervalController=new Ky(this.win,()=>{try{this.onTick()}catch(io){}},1e3/e),this.stopped||this.intervalController.start()}stop(){this.stopped=!0,this.intervalController?this.intervalController.stop():this.video.cancelVideoFrameCallback(this.lastHandle)}start(){this.stopped=!1,this.intervalController?this.intervalController.start():this.startNative()}setFps(e){this.intervalController&&this.startIntervals(e)}}class tS extends uh.M{get state(){return this.playerStore.getState()}get fragDuration(){return this.getFragmentsData().fragmentDuration}get isDestroyed(){return this.destroyed}async requestDebugInfo(){return{notImplemented:!0}}constructor(e){var t;super(),this.props=e,this.engine=void 0,this.recoverHelper=void 0,this.video=void 0,this.wasPausedAfterQualityChanged=!1,this.currentTextTrack=void 0,this.withCredentials=!1,this.targetLatency=7,this.playerStore=void 0,this.stateController=void 0,this.currentState=void 0,this.videoTrackLabels=new Map,this.previousScreenshotBlobUrl=void 0,this.destroy=(0,La.I)(()=>(this.destroyed=!0,this.destroyUnsafe())),this.destroyed=!1,this.tickController=void 0,this.fpsController=new Yy({onRestrictionsChange:e=>{this.props.logEvent({event:"FPSControllerRestrictions",params:e})}}),this.frameTickController=null,this.currentSubtitles=[],this.bandwidthEstimateUpdateInterval=null,this.bufferGoalManager=void 0,this.preventPauseState=void 0,this.playDeferred=void 0,this.sizeCapper=void 0,this.isPauseHandlerCalled=void 0,this.longStalledRecoverInfo=null,this.handleConcurrentRecover=e=>{this.props.logEvent({event:"ConcurrentRecoverCalled",params:e})},this.handleRecoverError=(e,t)=>{this.props.onError(new Fl({code:Ga.RECOVER_TASK_ERROR,isFatal:!1,details:e,stack:null==t?void 0:t.stack}))},this.setMaxListeners(100),this.isPauseHandlerCalled=this.props.video.paused,this.recoverHelper=new By({onRunTask:this.props.onRecover,onReset:()=>this.playerStore.setControllerStateField(Lm.lastRecoverPosition,void 0),onConcurrentRecover:this.handleConcurrentRecover,onRecoverError:this.handleRecoverError}),this.on("Destroy",()=>this.recoverHelper.destroy());const{video:r,playerStore:i,sourceParams:n,stateController:s}=this.props;this.video=r,this.playerStore=i,this.stateController=s,this.setLoop(Boolean(e.sourceParams.loop)),this.withCredentials=Boolean(e.sourceParams.withCredentials);const a=!n.startPosition.videoTime&&(!n.adConfig||!1===n.adConfig.hasPreroll)&&n.firstFrameHash&&n.firstFrameUrl;this.setPoster(a?n.firstFrameUrl:n.preview,a?n.firstFrameHash:""),this.updateNativeControlsVisibility();const o=this.playerStore.getState().controller.preload||Cc;r.setAttribute("preload",o?"auto":"none");const l=this.playerStore.getState().controller.vsid,d=(0,yh.O)(r,"loadstart",()=>{this.video.style.opacity="1",(0,Wa.Y)(()=>this.video.setVideoSessionId(l))});this.on("Destroy",d),this.tickController=new Ky(window,e=>{try{this.onTick(e)}catch(io){this.props.onError(Fl.from(io,{code:Ga.ON_TICK_ERROR,isFatal:!1}))}}),this.on("Destroy",()=>this.tickController.stop()),this.on("InternalPlayingStateChange",this.updateBufferGoal),Promise.resolve().then(()=>{this.initInternalSubscribe()}),this.bufferGoalManager=new zy({skippableFragments:e.sourceParams.skippableFragments}),this.sizeCapper=new Jy({video:this.video,fpsController:this.fpsController,videoSizeSensor:this.props.videoSizeSensor,getPipWindowSize:this.props.getPipWindowSize,from:this.state.controller.from,defaultQuality:this.props.defaultQuality,objectFit:null==(t=this.state.controller.videoElementStyle)?void 0:t.objectFit}),this.initFrameTickController()}emitTargetLatencyChanged(){this.emit("TargetLatencyChanged",this.targetLatency)}initInternalSubscribe(){this.on("VideoPlayingStateChange",e=>{if(e!==Wl.X.END||$r(this.state)){if(e===Wl.X.PLAY&&!$r(this.state)){const e=this.fragDuration<=2*Pm?1e3*this.fragDuration:1e3*Pm;this.recoverHelper.planReset({delay:e,reason:"no new errors for "+e+"ms"})}}else this.recoverHelper.reset("onPlayingStateChange ["+Wl.X.END+"]")}),this.on("InternalPlayingStateChange",e=>{const{encoderState:t}=this.state.controller;(t===Cm.Attaching||t===Cm.Attached)&&this.currentState!==e&&(this.isBufferingOnPreload(e)||this.currentState===Wl.X.END&&this.video.paused||(this.currentState=e,this.emit("VideoPlayingStateChange",e)))}),this.on("CurrentTimeChange",e=>{const t=this.getDuration(),{videoType:r}=this.state.controller;e>=t&&t>0&&r===jc.Z.VOD&&!this.props.sourceParams.loop&&this.emit("InternalPlayingStateChange",Wl.X.END)}),this.on("InternalVideoTrackValueChange",es(e=>{this.emit("VideoTrackValueChange",e)})),this.on("InternalAudioTrackValueChange",es(e=>{this.emit("AudioTrackValueChange",e)})),this.on("InternalTextTrackValueChange",es(e=>{this.emit("TextTrackValueChange",e)})),this.subscribeYabroRum(),this.addVideoEventListener("playing",()=>this.handleVideoElementPlayEvent()),this.addVideoEventListener("loadedmetadata",()=>{this.dispatchOnDurationChange()}),this.addVideoEventListener("play",()=>{this.isPauseHandlerCalled=!1}),this.addVideoEventListener("seeking",()=>{this.props.logEvent({event:"Seeking",params:{time:this.video.currentTime}})}),this.addVideoEventListener("seeked",()=>{this.props.logEvent({event:"Seeked",params:{time:this.video.currentTime}}),this.emit("Seeked")});let e=this.video.playbackRate;this.addVideoEventListener("ratechange",()=>{const t=this.video.playbackRate,r=this.state.controller.playbackRate;if(e===t)return;const i=e;e=t,$r(this.state)||this.recoverHelper.isRecovering()||0===t||t===r||(0===i&&t!==r?this.setPlaybackRate(r,xm.Recover):t!==this.state.controller.playbackRate&&this.stateController.putPlaybackRate(t,xm.Other))}),this.addVideoEventListener("pause",()=>this.onPause()),this.addVideoEventListener("progress",()=>{$r(this.state)||this.emit("BufferingRangesChange",(0,Nv.w)(this.props.video))}),this.addVideoEventListener("canplay",()=>{this.emit("CanPlay",void 0)}),this.addVideoEventListener("ended",()=>{const{videoType:e}=this.playerStore.getState().controller;e===jc.Z.VOD||void 0===e?this.emit("InternalPlayingStateChange",Wl.X.END):this.video.paused&&mf.warn('Pause stream after "ended" event on LIVE stream')}),this.addVideoEventListener("loadeddata",()=>{this.emit("LoadedData",void 0)}),this.addVideoEventListener("error",e=>this.onVideoTagError(e)),this.handleSubtitles(),this.addVideoEventListener("timeupdate",()=>{$r(this.state)||this.state.controller.playingState===Wl.X.PAUSE||this.fpsController.update(this.video)}),this.addVideoEventListener("durationchange",()=>{this.dispatchOnDurationChange()}),this.on("DvrChange",()=>this.updateDVRParams())}async play(){if(this.preventPauseState)return this.preventPauseState=ms({},this.preventPauseState,{shouldPlayAfterEnd:!0}),mf.log("play method call during preventPauseAsync operation"),this.playDeferred||(this.playDeferred=new Zc.B,this.playDeferred.promise.catch(Yl.Z).then(()=>this.playDeferred=void 0)),this.playDeferred.promise;await this.playInternal()}getVideoElementSizes(){var e,t;return ms({},null!=(e=this.props.getPipWindowSize())?e:(0,Xy.k)(this.video,(null==(t=this.state.controller.videoElementStyle)?void 0:t.objectFit)||"contain",this.props.videoSizeSensor.getSize()),{dpi:"undefined"!==typeof devicePixelRatio?devicePixelRatio:1})}getFragmentsData(){return{totalDuration:this.getDuration(),fragmentDuration:Pm,startTime:0}}getUtcStartTime(){return 0}getUtcPosition(){return 0}async attachEncoder(){var e;this.tickController.start(),null==(e=this.frameTickController)||e.start(),this.bandwidthEstimateUpdateInterval=window.setInterval(()=>{this.stateController.putLastKnownBandwidthEstimate(this.getBandwidthEstimate()),pn(this.getBandwidthEstimate())},5e3),"defaultPlaybackRate"in this.video&&(this.video.defaultPlaybackRate=this.state.controller.playbackRate);const t=new _v(this.video,()=>{this.onVideoResize()});this.once("Detach",()=>t.destroy()),this.isLowLatencyLive()&&this.emitTargetLatencyChanged()}onVideoTagError(e){!this.video.src&&!$r(this.state)&&(this.video.style.opacity="0")}captureScreenshot(){return Promise.resolve(void 0)}clearScreenshot(){this.previousScreenshotBlobUrl&&(URL.revokeObjectURL(this.previousScreenshotBlobUrl),this.previousScreenshotBlobUrl=void 0)}seek(e){if(!this.canSeek())return void this.playerStore.setControllerStateField(Lm.startPosition,{videoTime:e});this.playerStore.setControllerStateField(Lm.lastRecoverPosition,void 0);const{start:t,end:r}=this.getSeekableRange(),{currentTime:i}=this.state.controller,n=zt(e,t,r);this.props.onExpectedStalledChange({reason:Bp.k.Seek,details:{oldPosition:i,newPosition:n}}),cs(this.video,n),this.emit("CurrentTimeChange",this.getCurrentTime())}setPlaybackRate(e,t){if(!$y)return;const r=this.video.playbackRate;if(r===e)return;this.video.playbackRate=e;const i=this.video.playbackRate;i!==r&&this.stateController.putPlaybackRate(i,t)}getUtcEndTime(){return 0}static isLiveStreamUrl(e){return e.startsWith("https://strm.yandex.ru/live/")||e.startsWith("https://streaming.tst.strm.yandex.net/live/")||e.startsWith("https://edge.video.cloud.yandex.net/live/")}updateNativeControlsVisibility(){const e=!er(this.state.skin.hiddenControls)&&(this.state,!0);var t,r;this.playerStore.setSkinStateField(Nm.nativeControlsVisibility,e),t=this.video,r={controls:e?"controls":null},(0,Au.Z)(r).forEach(e=>{const i=r[e];null===i?t.removeAttribute(e):t.setAttribute(e,i)}),this.video.classList.toggle(jy().video_hiddenControls,!e),this.setNativeTimeControlVisibility(ts(this.state)),this.setNativeTimelineControlVisibility(ts(this.state))}detachEncoder(){var e;if(this.tickController.stop(),null==(e=this.frameTickController)||e.stop(),this.state.controller.encoderState===Cm.Attached){const e=this.getBandwidthEstimate();this.stateController.putLastKnownBandwidthEstimate(e),pn(e)}return null!==this.bandwidthEstimateUpdateInterval&&clearInterval(this.bandwidthEstimateUpdateInterval),this.emit("BufferingRangesChange",[]),this.emit("InternalVideoTrackValueChange",void 0),this.emit("InternalAudioTrackValueChange",void 0),this.emit("InternalTextTrackValueChange",void 0),this.emit("Detach",void 0),"defaultPlaybackRate"in this.video&&(this.video.defaultPlaybackRate=1),Promise.resolve()}async preloadSource(){mf.log("preloadSource() is not implemented for "+this.engine)}createCachePreloader(){}setLoop(e){const{video:t}=this.props,{loop:r}=this.video;e!==r&&(t.loop=e)}isPaused(){return this.props.video.paused}pause(){var e;this.recoverHelper.reset("pause"),this.props.video.pause(),this.onPause(),null==(e=this.playDeferred)||e.reject(new Error("playing rejected cause of #pause()"))}getDuration(){return this.video.duration}getCurrentTime(){return Math.floor(1e3*this.props.video.currentTime)/1e3}getVideoWidth(){return this.video.videoWidth}getVideoHeight(){return this.video.videoHeight}setVolume(e){ce(e)?Ly?this.video.volume=e:mf.warn("cannot change video volume"):mf.warn("setVolume wrong value")}getVolume(){return this.video.volume}setMuted(e){this.video.muted=e}getMuted(){return this.video.muted}setPoster(e,t){if(this.state.skin.nativeControlsVisibility||t)if(this.removePoster(),t){if(this.props.video.setAttribute("poster",t),e){xe(e).then(()=>{this.isDestroyed||this.props.video.setAttribute("poster",e)}).catch(Yl.Z)}}else this.props.video.setAttribute("poster",e||uf)}removePoster(){this.props.video.removeAttribute("poster")}isDvrEnabled(){return!0}toggleNativeSubtitles(e){const t=this.state.skin.useNativeSubtitles;if(t===e)return;const r=os(t),i=os(e);this.playerStore.setSkinStateField(Nm.useNativeSubtitles,e),as(this.video.textTracks).forEach((e,t)=>{e&&(e.mode=r===e.mode?i:"disabled")})}canSeek(){const{video:e}=this.props;return e.readyState>0&&e.duration>0}getRecoverHelperState(){return this.recoverHelper.getState()}getCapSizes(){return this.sizeCapper.getCapSizes()}getMaxCapAllowedVideoTrack(){}getRemainingBufferedTime(){return{total:ei(this.state)||0}}getBandwidthEstimate(){return us(this.playerStore.getState())}async recoverStream(e){void 0===e&&(e=!1);const t=this.getPositionToRecover();this.playerStore.setControllerStateField(Lm.startPosition,e?{}:t),await this.detachEncoder(),await this.attachEncoder()}getLiveLatency(){if(!this.isLiveStreaming())return;const e=this.getUtcPosition(),t=this.getServerTime();return e>0&&void 0!==t?Math.max(t-e,0):void 0}getServerTime(){}getPlayingState(){return this.currentState}isLiveStreaming(){const{state:e}=this;if(!rs(e)||$r(e))return!1;const{controller:{playingState:t,currentTime:r,duration:i}}=e;return!(t!==Wl.X.PLAY&&t!==Wl.X.BUFFERING)&&!(0===r||!i)}subscribeVideoBuffering(e){const{video:t}=this;let r=Mv(t);const i=()=>{const e=function(e,t){let{paused:r}=e;return r?Wl.X.PAUSE:t?Wl.X.BUFFERING:Wl.X.PLAY}(t,r);if(this.isStalledLiveEdge(e))this.props.onExpectedStalledChange({reason:Bp.k.LiveEdge,details:void 0});else if(this.isRender(e)){if((0,hu.RW)("web_ignore_render_stalled"))return;this.props.onExpectedStalledChange({reason:Bp.k.Render,details:{}})}this.emit("InternalPlayingStateChange",e)},n=xv(t,e=>{r=e,i()},e);this.addEventListener(t,"play",i),this.once("Destroy",n)}updateVideoSize(){const{videoWidth:e,videoHeight:t}=this.video;this.state.controller.videoWidth===e&&this.state.controller.videoHeight===t||this.stateController.putVideoSize({videoWidth:e,videoHeight:t})}isRender(e){if(e!==Wl.X.BUFFERING||this.video.seeking)return!1;const{approximateShownFPS:t,approximateDroppedFPS:r}=this.fpsController.getApproximateFPS();return!!r&&(t+r>300&&r>t)}isStalledLiveEdge(e){const{video:t}=this,{controller:{videoType:r}}=this.state,i=e===Wl.X.BUFFERING,n=r===jc.Z.EVENT||r===jc.Z.LIVE,s=t.seekable.length>0&&t.seekable.end(0)-t.currentTime<2.5;return i&&n&&s}initFrameTickController(){this.state.controller.shouldEmitFrameRendered&&!this.frameTickController&&(this.frameTickController=new eS(this.video,()=>{this.emit("FrameRendered",this.getCurrentTime())}),this.on("Destroy",()=>{var e;null==(e=this.frameTickController)||e.stop(),this.frameTickController=null}))}getPositionToRecover(){const{programDateTime:e,currentTime:t,startPosition:r}=this.state.controller;return t?{utc:void 0===e?void 0:e/1e3+t,videoTime:t}:r}subscribeContentImpression(){this.once("Detach",function(e,t){const r=(0,yh.O)(e,"timeupdate",()=>{e.currentTime>0&&!e.paused&&(n(),t())}),i=(0,yh.O)(e,"playing",()=>{e.duration>0&&(n(),t())}),n=()=>{r(),i()};return n}(this.video,()=>{this.emit("ContentImpression",void 0)}))}onTick(e){const t=this.getCurrentTime();t===this.state.controller.currentTime&&0!==t||this.emit("CurrentTimeChange",t),this.video.paused&&this.currentState===Wl.X.PLAY&&!this.wasPausedAfterQualityChanged&&this.state.controller.encoderState!==Cm.Attaching&&this.state.controller.playingState!==Wl.X.PAUSE&&this.emit("InternalPlayingStateChange",Wl.X.PAUSE),this.setPlaybackRateCatchup(),this.planRecoverCauseLongStalled()}planRecoverCauseLongStalled(){if(this.state.controller.playingState!==Wl.X.BUFFERING||this.state.controller.encoderState!==Cm.Attached)return void(this.longStalledRecoverInfo=null);if(this.engine!==ql.NATIVE)return;if(null===this.longStalledRecoverInfo)return void(this.longStalledRecoverInfo={getTime:(0,xa.u)(),planned:!1});if(this.longStalledRecoverInfo.planned)return;const e=4*this.getFragmentsData().fragmentDuration;if(!isNaN(e)&&this.longStalledRecoverInfo.getTime()>1e3*e){this.longStalledRecoverInfo.planned=!0;const{videoType:e}=this.state.controller,t=e!==jc.Z.VOD;this.recoverHelper.planTask(()=>this.recoverStream(t),{delay:0,reason:"Stalled longer than 4 segments."})}}addVideoEventListener(e,t,r){let{once:i}=void 0===r?{}:r,n=t;const{video:s}=this,a=()=>{s.removeEventListener(e,n)};return i&&(n=e=>{this.off("Destroy",a),a(),t.call(s,e)}),this.on("Destroy",a),this.video.addEventListener(e,n),a}addEventListener(e,t,r,i){const n=(0,yh.O)(e,t,r,i);this.once("Destroy",n)}getSeekableRange(){return{start:0,end:this.getDuration()||0}}setNativeTimeControlVisibility(e){this.video.classList.toggle(jy().video_hiddenTime,!e)}setNativeTimelineControlVisibility(e){this.video.classList.toggle(jy().video_hiddenTimeline,!e)}getVisibleTextTrackMode(){return os(this.state.skin.useNativeSubtitles)}getHiddenTextTrackMode(){return"disabled"}getCurrentTextTrack(){if(!this.video)return;const e=this.getVisibleTextTrackMode();return as(this.video.textTracks).find(t=>void 0!==t&&t.mode===e)}restoreUserTextTrack(){const{userTextTrackEnabled:e}=this.state.controller;if(void 0!==e)if(e){const e=function(e){const{userTextTrackName:t,userTextTrackLang:r,textTracks:i}=e.controller;return is(i,{name:t,lang:r})}(this.state);e&&this.setTextTrack(e)}else this.disableTextTrack()}restoreUserAudioTrack(){const e=function(e){const{userAudioTrackName:t,userAudioTrackLang:r,audioTracks:i}=e.controller;return Yn(i,{name:t,lang:r})}(this.playerStore.getState());e&&(mf.log("Set audio track by user params audioTrack=["+JSON.stringify(e)+"]"),this.setAudioTrack(e))}restoreUserVideoTrack(){const e=function(e){const{videoTracks:t,userVideoTrackName:r,userVideoTrackHeight:i}=e.controller;return Gn(t,{name:r,height:i})}(this.playerStore.getState());e&&(mf.log("Set video track by user params videoTrack=["+JSON.stringify(e)+"]"),this.setVideoTrack(e))}updateSkinDvrParameters(e){const t=e/1e3,{skin:{skinDVRStartTime:r,skinDVRDuration:i},controller:{videoType:n,dvrDuration:s,duration:a}}=this.state;if(n===jc.Z.LIVE){const e=Math.min(r+t,a||0);this.playerStore.setSkinStateField(Nm.skinDVRStartTime,e),this.emit("DVRStartTimeChange",e)}else if(n===jc.Z.EVENT){const e=Math.min(i+t,s);this.playerStore.setSkinStateField(Nm.skinDVRDuration,e),this.emit("DVRDurationChange",e)}}async destroyUnsafe(){this.emit("Destroy",void 0),await this.detachEncoder(),super.destroy();const{error:e}=this.state.controller.errorInfo;e&&e.isFatal&&this.video.src&&this.video.removeAttribute("src")}async preventPauseAsync(e,t){const{paused:r}=e,i=t();this.preventPauseState||(this.preventPauseState={promises:[],shouldPlayAfterEnd:!r}),this.preventPauseState.promises.push(i);const n=await i;if(this.preventPauseState){const e=this.preventPauseState.promises.length;Promise.all(this.preventPauseState.promises).catch(Yl.Z).then(()=>{this.preventPauseState&&e===this.preventPauseState.promises.length&&(this.preventPauseState.shouldPlayAfterEnd&&(0,Pd.v)(this.playInternal()),this.preventPauseState=void 0)})}return n}getVideoOwnerDocument(){return this.video.ownerDocument||document}logLoadToRum(){ui(this.engine,this.state.ad.adSyncInit)}subscribeYabroRum(){this.once("Detach",this.addVideoEventListener("firstframedecoded",()=>{hi(this.engine,{},this.state.ad.adSyncInit)},{once:!0})),this.once("Detach",this.addVideoEventListener("firstframeshown",()=>{pi(this.engine,{},this.state.ad.adSyncInit)},{once:!0}))}getStreamUrl(){return this.props.stream.url}shouldUseLowBuffer(){const{startStage:e,autoplay:t,preload:r,feed:i}=this.state.controller;return!(!this.video.paused||!i)||e!==Gd.started&&!t&&r}isBufferingOnPreload(e){if(e!==Wl.X.BUFFERING)return!1;if(!this.state.controller.preload)return!1;const{startStage:t}=this.state.controller;return t!==Gd.started&&(t!==Gd.starting&&(t!==Gd.init||!this.state.controller.initialAutoplay||!this.state.controller.autoplay))}getMaxBufferLength(){return this.shouldUseLowBuffer()?5:this.bufferGoalManager.getBufferGoal({watchedTime:this.state.controller.watchedTime,currentTime:this.getCurrentTime()})}handleVideoElementPlayEvent(){this.video.paused||(this.wasPausedAfterQualityChanged=!1,this.emit("InternalPlayingStateChange",Wl.X.PLAY))}updateBufferGoal(){}isLowLatencyLive(){return!1}onVideoResize(){this.updateVideoSize()}onPause(){this.video.paused&&(this.isPauseHandlerCalled||(this.isPauseHandlerCalled=!0,this.wasPausedAfterQualityChanged||this.video.ended||this.getCurrentTime()>=this.getDuration()||this.emit("InternalPlayingStateChange",Wl.X.PAUSE)))}calculateDVRParams(){const{fragmentDuration:e,startTime:t,totalDuration:r}=this.getFragmentsData();return{fragmentDuration:e,dvrDuration:r,dvrStartTime:t,skinDVRDuration:r,skinDVRStartTime:t}}updateDVRParams(){if(isNaN(this.video.duration))return;const{fragmentDuration:e,dvrStartTime:t,dvrDuration:r,skinDVRStartTime:i,skinDVRDuration:n}=this.calculateDVRParams();this.playerStore.setControllerStateField(Lm.fragmentDuration,e);const{dvrDuration:s,dvrStartTime:a}=this.state.controller;qd()(s,r)||(this.playerStore.setControllerStateField(Lm.dvrDuration,r),this.playerStore.setSkinStateField(Nm.skinDVRDuration,n),this.emit("DVRDurationChange",n)),qd()(a,t)||(this.playerStore.setControllerStateField(Lm.dvrStartTime,t),this.playerStore.setSkinStateField(Nm.skinDVRStartTime,i),this.emit("DVRStartTimeChange",i))}setPlaybackRateCatchup(){const e=function(e,t,r,i){if(xy||!rs(e)||$r(e)||!r)return;const{controller:{playingState:n,playbackRate:s}}=e;if(n!==Wl.X.PLAY)return;const a=t.total;let o;if(a<2){const e=5*(a-2);o=.97+.06/(1+Math.exp(-e))}else{const e=.02;if(Math.abs(r-i)<=e*i)return 1;const t=5*(r-i);o=.97+.06/(1+Math.exp(-t))}const l=Math.abs(s-o)<=My,d=Math.abs(s-o)>=.06;return l||d||s===o?void 0:o}(this.state,this.getRemainingBufferedTime(),this.getLiveLatency(),this.targetLatency);void 0!==e&&this.isLowLatencyLive()&&this.setPlaybackRate(e,xm.PlaybackRateCatchupSelection)}handleSubtitles(){const{textTracks:e}=this.video;this.on("Destroy",(0,yh.O)(e,"addtrack",e=>{"subtitles"===(null==e?void 0:e.track.kind)&&this.on("Destroy",(0,yh.O)(e.track,"cuechange",()=>this.refreshSubtitles()))})),this.on("TextTrackValueChange",e=>{void 0===e?this.emptySubtitles():this.refreshSubtitles()}),this.on("Detach",()=>{for(let t=0;t<e.length;t++)ss(e[t])&&(e[t].mode="disabled")})}refreshSubtitles(){const e=function(e){try{if(void 0===e)return[];const{activeCues:t}=e;let r=[];for(let e=0;e<((null==t?void 0:t.length)||0);e++){const i=null==t?void 0:t[e];i&&i.text&&r.push(i.text)}return r}catch(TE){return[]}}(this.getCurrentTextTrack());qd()(this.currentSubtitles,e)||(this.currentSubtitles=e,this.props.onSubtitlesChange(e))}emptySubtitles(){this.currentSubtitles.length>0&&(this.currentSubtitles=[],this.props.onSubtitlesChange([]))}dispatchOnDurationChange(){if(this.state.controller.encoderState===Cm.Detached)return;const e=this.getDuration();isNaN(e)||this.state.controller.duration!==e&&this.emit("DurationChange",e)}playInternal(){const e=ns(this.video);return e.then(()=>{var e;return null==(e=this.playDeferred)?void 0:e.resolve()}).catch(e=>{var t;-1!==String(e).indexOf("no supported sources")&&this.props.onError(new Fl({code:Ga.UNSUPPORTED_MEDIA_TYPE,isFatal:!0})),null==(t=this.playDeferred)||t.reject(e)}),e.then(Yl.Z)}shouldLogStalledDebugInfo(){return!1}}class rS extends tS{initInternalSubscribe(){super.initInternalSubscribe(),this.on("VideoPlayingStateChange",e=>{e===Wl.X.PLAY?this.recoverHelper.reset("play"):e===Wl.X.END?this.stopLoad():e===Wl.X.BUFFERING&&this.tryRecoverOnBuffering()}),this.subscribeVideoBuffering()}constructor(e){super(e),this.props=e,this.engine=ql.HLS,this.preloadSourceHLSEncoder=void 0,this.preloadSourceHandlers=[],this.preloadPosition={},this.HLSEncoder=void 0,this.lastKnownLevelDetails=void 0,this.HLSEncoderAttachTime=1/0,this.loadStarted=!1,this.recoverOnBufferingReason=null,this.initHlsEncoderPromise=void 0,this.maxHeightCapping=void 0,this.levelForcingInterval=void 0,this.bufferGoalUpdateInterval=void 0,this.stallDetector=void 0,this.gapJumpTimer=void 0,this.updateBufferGoal=()=>{this.HLSEncoder&&(this.HLSEncoder.config.maxMaxBufferLength=this.getMaxBufferLength())},this.restoreUserTracksWhenPossible=()=>{const{HLSEncoder:e}=this;if(!e)return;if(!e.levels||0===e.levels.length)return void e.once(Hls.Events.MANIFEST_LOADED,this.restoreUserTracksWhenPossible);(0,Hl.z)(this.HLSEncoderAttachTime)?this.restoreUserTracks():e.once(Hls.Events.MEDIA_ATTACHED,this.restoreUserTracks)},this.restoreUserTracks=()=>{this.restoreUserTextTrack(),this.restoreUserAudioTrack(),this.restoreUserVideoTrack()},this.onLevelUpdated=()=>{this.emit("VideoTypeChange",this.getVideoType());const e=this.getHlsEncoderLevelDetails();if(e&&e.fragments&&e.fragments.length>0){const[t]=e.fragments;t.programDateTime&&this.emit("ProgramDateTimeChange",1e3*this.getUtcStartTime())}},this.onSubtitleTracksUpdated=()=>{this.HLSEncoder&&this.emit("TextTracksChange",function(e){const t=[];return Array.isArray(e)&&e.forEach(e=>{const r=Bn(e);r&&t.push(r)}),t}(this.HLSEncoder.subtitleTracks))},this.onAudioTracksUpdated=()=>{const{HLSEncoder:e}=this;if(!e)return;const{audioTracks:t}=e;e.config.maxBufferSize=t.length>0?12e6:Hls.DefaultConfig.maxBufferSize,this.emit("AudioTracksChange",function(e){const t=[];return Array.isArray(e)?(e.forEach(e=>{const r=Vn(e);r&&t.push(r)}),t):[]}(t))},(0,Pd.v)(F()),this.playerStore.setIsAbrSupported(!0)}getEngine(){return ql.HLS}getFragmentsData(){const e=this.getHlsEncoderLevelDetails();if(!e)return super.getFragmentsData();const{totalduration:t,targetduration:r,fragments:i}=e,[n]=i;return n?{totalDuration:Math.min(t,this.getDuration()),fragmentDuration:r,startTime:n.start}:super.getFragmentsData()}play(){return this.startLoadOnce(),super.play()}getUtcStartTime(){const e=this.getHlsEncoderLevelDetails();if(!e||!e.hasProgramDateTime)return 0;const[t]=e.fragments;return t&&t.programDateTime?t.programDateTime/1e3-t.start:0}getUtcPosition(){const e=this.getUtcStartTime();return e>0?e+this.getCurrentTime():super.getUtcPosition()}setVideoTrack(e){const{HLSEncoder:t}=this;if(void 0===t)return;const{levels:r}=t;if(void 0===r)return;const i=e.value===Hm.value?-1:r.findIndex(t=>t.url.some(t=>t===e.value));-1===i?this.startLevelForcingWithSizeCap():this.stopLevelForcingWithSizeCap();const n=this.isPaused();t.currentLevel=i,!n&&this.isPaused()&&(this.wasPausedAfterQualityChanged=!0,this.emit("InternalPlayingStateChange",Wl.X.BUFFERING))}setAudioTrack(e){const{HLSEncoder:t}=this;if(void 0===t)return;const r=t.audioTracks.find(t=>e.value===String(t.id));r&&(t.audioTrack=Number(r.id))}setTextTrack(e){const{HLSEncoder:t}=this;if(void 0===t)return;const r=this.getHlsTextTrack(e);r&&(this.emit("InternalTextTrackValueChange",e&&e.value),t.subtitleTrack=r.id)}disableTextTrack(){this.emit("InternalTextTrackValueChange",void 0)}toggleNativeSubtitles(e){super.toggleNativeSubtitles(e);const{HLSEncoder:t}=this;void 0!==t&&(t.subtitleDisplay=e)}async preloadSource(){let e=!1;const t=()=>{e=!0};this.once("Destroy",t),this.once("Detach",t);try{await F()}catch(io){return void this.props.onError(Fl.from(io,{code:Ga.SCRIPT_INIT_ERROR,isFatal:!1}))}if(e||this.HLSEncoder||this.initHlsEncoderPromise||this.preloadSourceHLSEncoder)return;const r=gs({},this.getHlsJsConfig(),{liveSyncDuration:Pm}),i=window.hls=this.preloadSourceHLSEncoder=new Hls(r),n=(e,t)=>{this.preloadSourceHandlers.push([e,t]),i.once(e,t)};((e,t)=>{this.preloadSourceHandlers.push([e,t]),i.on(e,t)})(Hls.Events.ERROR,(e,t)=>{if(!t)return;const r=On(t),n=Nn(t);void 0!==n&&(this.props.onError(new Fl(gs({},n,{isFatal:!1}))),r&&(this.props.onError(new Fl({code:Ga.PRELOAD_SOURCE_FAILED,isFatal:!1,details:{reason:n}})),this.unsubscribePreloadSourceHandlers(),i.destroy(),this.clearPreloadSourceHlsEncoder()))});const s=()=>{this.preloadPosition=this.state.controller.startPosition,i.config.startFragPrefetch=!0,this.loadStarted=!0};n(Hls.Events.MANIFEST_PARSED,(e,t)=>{let{levels:r=[],audioTracks:a=[]}=t;const o=this.getStartVideoLevelIndex(r);i.startLevel=o,this.state.controller.isAbrEnabled||(i.loadLevel=o);this.getStartAudioTrackIndex(a)>-1&&(i.audioTrack=this.getStartAudioTrackIndex(a));const l=this.getStartLoadPosition();n(Hls.Events.LEVEL_UPDATED,(e,t)=>{let{details:r}=t;const n=this.getStartLoadPosition(r);l!==n&&void 0!==n&&i.streamController.startLoad(n),s()}),i.startLoad(l)}),i.loadSource(this.getStreamUrl())}async attachEncoder(){if(await super.attachEncoder(),!Ay){const e=new Fl({code:Ga.HLS_JS_NOT_SUPPORTED_ERROR});return this.props.onError(e),Promise.reject(se(e,this.state.ad.adblockDetected))}return this.initHlsEncoderPromise=this.initHlsEncoder(),await this.initHlsEncoderPromise,this.initHlsEncoderPromise=void 0,this.subscribeContentImpression(),this.startLevelForcingWithSizeCap(),this.attachMedia()}async destroyUnsafe(){await super.destroyUnsafe(),this.preloadSourceHLSEncoder&&this.preloadSourceHLSEncoder.destroy(),this.HLSEncoder&&this.HLSEncoder.destroy()}canSeek(){return void 0!==this.HLSEncoder&&Boolean(this.HLSEncoder.media)&&super.canSeek()}async detachEncoder(){var e,t;if((0,Rd.w)(this.video.textTracks).forEach(zn),this.stopLevelForcingWithSizeCap(),this.stopBufferGoalAutoUpdate(),await super.detachEncoder(),this.loadStarted=!1,this.preloadSourceHLSEncoder&&(this.preloadSourceHLSEncoder.destroy(),this.clearPreloadSourceHlsEncoder()),!this.HLSEncoder){var r,i;if(!this.initHlsEncoderPromise)return null==(r=this.stallDetector)||r.release(),void(null==(i=this.gapJumpTimer)||i.stop());await this.initHlsEncoderPromise}null==(e=this.stallDetector)||e.release(),null==(t=this.gapJumpTimer)||t.stop();const{video:n,HLSEncoder:s}=this;if(void 0!==s)return this.recoverOnBufferingReason=null,new Promise(e=>{s.media?s.once(Hls.Events.MEDIA_DETACHED,()=>{this.HLSEncoderAttachTime=1/0,e()}):e(),this.lastKnownLevelDetails=void 0,Kn(n,()=>{s.destroy(),this.HLSEncoder=void 0})})}getMaxCapAllowedVideoTrack(){const{HLSEncoder:e}=this;if(!e||!e.levels||!e.autoLevelEnabled)return;const t=e.levels[e.autoLevelCapping];if(!t)return;const r=this.state.controller.videoTracks.find(e=>{let{value:r}=e;return r===t.url[0]});return r&&r.width&&r.height?{width:r.width,height:r.height}:void 0}onVideoTagError(e){if(super.onVideoTagError(e),!this.video.error||$r(this.state))return;const t=Tn(this.video);if(t.code!==my.MEDIA_ERR_DECODE&&t.code!==my.MEDIA_ERR_SRC_NOT_SUPPORTED)return;const r=t.code===my.MEDIA_ERR_SRC_NOT_SUPPORTED,i=new Fl({code:my[t.code],details:t,isFatal:r});if(this.props.onError(i),r)return;const n="VideoTagError MEDIA_ERR_DECODE";mf.log(n),this.props.onExpectedStalledChange({reason:Bp.k.MediaError,details:void 0}),this.isPaused()&&this.recoverHelper.planTask(()=>this.recoverCurrentFrag(),{reason:n,delay:1e3})}calculateDVRParams(){const{videoType:e}=this.state.controller;if(e===jc.Z.VOD||void 0===e)return super.calculateDVRParams();const{fragmentDuration:t,startTime:r,totalDuration:i}=this.getFragmentsData(),{liveOffset:n}=this.props,s=1*t,a=e===jc.Z.EVENT?n:s+n;return{fragmentDuration:t,dvrStartTime:r,dvrDuration:i,skinDVRStartTime:e===jc.Z.EVENT?r:s+r,skinDVRDuration:i-a}}onTick(e){super.onTick(e),this.updateSkinDvrParameters(e)}getStreamUrl(){const e=super.getStreamUrl(),t={session_data:"1"};return st(e)||(t.preview="1"),(0,Yu.Sr)(e,t,{saveOriginalPath:!0})}getBandwidthEstimate(){if(!this.HLSEncoder)return super.getBandwidthEstimate();const e=(0,Wa.Y)(()=>this.HLSEncoder.abrController._bwEstimator.getEstimate());return(0,Hl.z)(e)?{value:e,source:"hlsjs"}:super.getBandwidthEstimate()}getUtcEndTime(){const e=this.getUtcStartTime();return e?e+this.getDuration():0}stopLoad(){this.HLSEncoder&&(this.HLSEncoder.stopLoad(),this.loadStarted=!1)}tryRecoverOnBuffering(){if(!this.recoverOnBufferingReason)return;const{type:e,url:t,details:r,frag:i}=this.recoverOnBufferingReason,{controller:{bufferingRanges:n,fragmentDuration:s}}=this.state,a=this.getCurrentTime();if(n.some(e=>{let{start:t,end:r}=e;return t+s<a&&r-s>a}))return void mf.log("skip recover",{currentTime:a,bufferingRanges:n});const{recoverHelper:o}=this;o.planTask(()=>this.recoverCurrentFrag(),{reason:"HlsJs "+e,rawData:{details:r,type:e,url:t,isFatal:!0,frag:kn(i)},delay:100})}getHlsJsConfig(){const e="true"!==Nu.t.getItem(Oy.WAS_WORKER_INTERNAL_ERROR);return{manifestLoadingTimeOut:Ty.d4,levelLoadingTimeOut:Ty.e8,fragLoadingTimeOut:Ty.C,fragLoadingMaxRetry:5,debug:this.props.debug,enableWorker:e,autoStartLoad:!1,capLevelToPlayerSize:!1,liveSyncDuration:this.props.liveOffset,levelLoadingMaxRetry:25,levelLoadingMaxRetryTimeout:100,enableCEA708Captions:!1,xhrSetup:(e,t)=>{this.withCredentials&&(e.withCredentials=!0);const r=(0,Yu.lm)(t);("m3u8"===r||"ts"===r)&&e.open("GET",(0,qg.c)(t),!0)},fetchSetup:(e,t)=>(this.withCredentials&&(t.credentials="include"),new Request(e.url,t)),maxMaxBufferLength:this.getMaxBufferLength()}}preparePreloadSourceHlsEncoderToAttach(){const e=this.preloadSourceHLSEncoder;if(!e)return;this.HLSEncoder=e;const{preloadPosition:t}=this;if(this.unsubscribePreloadSourceHandlers(),this.clearPreloadSourceHlsEncoder(),e.config.liveSyncDuration=this.props.liveOffset,!e.levels||0===e.levels.length)return e;this.onLevelsUpdated(),this.onLevelUpdated(),this.updateThumbnailTileMeta(),this.onAudioTracksUpdated(),this.onAudioTrackUpdated(e.audioTrack),this.onSubtitleTracksUpdated();const{videoTime:r,utc:i}=this.state.controller.startPosition;if(!(t.utc!==i||t.videoTime!==r))return e;const n=this.getStartLoadPosition(this.getHlsEncoderLevelDetails());return void 0!==n&&e.streamController.startLoad(n),e}async initHlsEncoder(){if(this.HLSEncoder)return;if(this.HLSEncoder=this.preparePreloadSourceHlsEncoderToAttach(),this.HLSEncoder)this.props.logEvent({event:$d.UsePreloadedHlsJs,params:{}});else{try{await F()}catch(io){const t=Fl.from(io,{code:Ga.SCRIPT_INIT_ERROR});throw this.props.onError(t),t}this.HLSEncoder=new Hls(this.getHlsJsConfig())}const{HLSEncoder:e}=this;window.hls=e,this.subscribeHlsEncoderEvents(e),this.restoreUserTracksWhenPossible(),this.initBufferGoalAutoUpdate();const t=r=>{r!==Wl.X.BUFFERING&&r!==Wl.X.PLAY||(e.config.maxMaxBufferLength=this.getMaxBufferLength(),this.off("VideoPlayingStateChange",t))};this.on("VideoPlayingStateChange",t)}subscribeHlsEncoderEvents(e){e.subtitleDisplay=this.state.skin.useNativeSubtitles;const t=t=>{if(!e.levels)return;const r=e.levels[t];if(!r)return;const i=Wn(r,this.videoTrackLabels);i&&this.emit("InternalVideoTrackValueChange",i.value)};e.on(Hls.Events.LEVEL_SWITCHING,(e,r)=>{t(r.level)}),e.on(Hls.Events.LEVEL_SWITCHED,(e,r)=>{t(r.level)}),e.levels&&0!==e.levels.length||e.on(Hls.Events.MANIFEST_PARSED,(r,i)=>{let{levels:n=[],audioTracks:s=[]}=i;this.onLevelsUpdated(),this.updateThumbnailTileMeta();const a=this.getStartVideoLevelIndex(n);e.startLevel=a,this.state.controller.isAbrEnabled||(e.loadLevel=a);this.getStartAudioTrackIndex(s)>-1&&(e.audioTrack=this.getStartAudioTrackIndex(s)),e.once(Hls.Events.LEVEL_LOADED,(e,r)=>{let{level:i}=r;t(i)})}),e.on(Hls.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated),e.on(Hls.Events.AUDIO_TRACK_SWITCHING,(e,t)=>{this.onAudioTrackUpdated(t.id)}),e.on(Hls.Events.AUDIO_TRACK_SWITCHED,(e,t)=>{this.onAudioTrackUpdated(t.id)}),e.on(Hls.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated),e.on(Hls.Events.SUBTITLE_TRACK_SWITCH,(t,r)=>{const{subtitleTrack:i}=e;if(i>-1){const t=Bn(e.subtitleTracks.find(e=>e.id===r.id));if(!t)return;this.emit("InternalTextTrackValueChange",t.value)}else this.emit("InternalTextTrackValueChange",void 0)}),e.on(Hls.Events.FRAG_PARSING_METADATA,async(e,t)=>{const{samples:r,frag:i}=t;if(!r||0===r.length)return;const n=r.map(e=>{let{data:t}=e;return(0,vy.parseV2Tag)(t)}).filter(e=>!1!==e&&void 0!==e.writer).map(e=>e.writer).filter(e=>void 0!==e),{data:s,index:a,reason:o}=function(e){const[t,r]=e.reduce((e,t)=>{let[r,i]=e;try{return!function(e){return"object"===typeof e&&e.id&&"number"===typeof e.offset&&(void 0===e.cutoff||"number"===typeof e.cutoff)}(JSON.parse(t))?i.push(t):r.push(t),[r,i]}catch(TE){return[r,i]}},[[],[]]);if(t.length>0){const r=t[t.length-1];return{data:r,index:e.indexOf(r),reason:Dy.HasAd}}if(r.length>0){const t=r[r.length-1];return{data:t,index:e.indexOf(t),reason:Dy.NoAd}}return{data:"",index:-1,reason:Dy.NoData}}(n);mf.log("choose metadata: ",s,a,o);Math.random()<.01&&this.props.logEvent({event:$d.StreamPlayerChooseMetadata,params:{fragmentMetadataArray:s,chosenIndex:a,chosenReason:o}}),this.emit("MetadataChange",{fragmentMetadataArray:[s],fragmentStart:i.start,fragmentDuration:i.duration,src:i?i.url:this.getStreamUrl()})}),e.on(Hls.Events.MANIFEST_LOADED,()=>{this.onLevelsUpdated(),this.forceLevel(),this.onAudioTracksUpdated(),this.onSubtitleTracksUpdated()}),e.on(Hls.Events.LEVEL_UPDATED,this.onLevelUpdated),e.on(Hls.Events.ERROR,(e,t)=>{t&&this.onEncoderError(t)}),e.on(Hls.Events.FRAG_PARSED,(e,t)=>this.handleFragParsed(e,t)),this.on("VideoPlayingStateChange",e=>{"play"!==e&&"buffering"!==e||this.startLoadOnce()})}initBufferGoalAutoUpdate(){this.stopBufferGoalAutoUpdate(),this.bufferGoalUpdateInterval=window.setInterval(()=>{this.updateBufferGoal()},1e3)}stopBufferGoalAutoUpdate(){window.clearInterval(this.bufferGoalUpdateInterval)}getStartVideoLevelIndex(e){const{userVideoTrackHeight:t,userVideoTrackName:r}=this.playerStore.getState().controller,i=Gn(e,{name:r,height:t});if(i){const t=e.indexOf(i);return mf.log("User level found, start loading by index=["+t+"]"),t}return Jn({levels:e,maxHeightCapping:this.maxHeightCapping,video:this.video,bandwidth:this.state.controller.isAbrEnabled?this.getBandwidthEstimate().value:1/0})}getStartAudioTrackIndex(e){const{userAudioTrackName:t,userAudioTrackLang:r}=this.playerStore.getState().controller,i=Yn(e,{name:t,lang:r});if(!i)return-1;const n=e.indexOf(i);return mf.log("User audio track found, start loading by index=["+n+"]"),n}handleFragParsed(e,t){let{frag:r}=t;const{duration:i}=r;if(0===i&&this.state.controller.videoType===jc.Z.VOD){const e=this.getHlsEncoderLevelDetails(),t=e?e.fragments:[];if(t[t.length-1]===r)return}(i<=0||i>=2*this.fragDuration)&&this.props.logEvent({event:"InvalidFragDuration",params:kn(r)})}startLoadOnce(e){const{HLSEncoder:t}=this;this.loadStarted||void 0===t||(t.levels&&t.levels.length>0?(t.startLoad(e),this.loadStarted=!0):t.once(Hls.Events.MANIFEST_PARSED,()=>{this.startLoadOnce(e)}))}getHlsEncoderLevelDetails(){const{HLSEncoder:e}=this;if(void 0===e)return;const{currentLevel:t,levels:r}=e;if(!r)return;const i=r[t];if(i&&i.details)return this.lastKnownLevelDetails=i.details,this.lastKnownLevelDetails;const n=r.find(e=>{let{details:t}=e;return Boolean(t)});if(n){const{details:e}=n;this.lastKnownLevelDetails=e}return this.lastKnownLevelDetails}computeRecoverJumpGap(){const{controller:{bufferingRanges:e}}=this.state,t=this.getCurrentTime();return Math.max(...e.map(e=>{let{end:t}=e;return t}))+1.1*this.fragDuration<t?(mf.log("use 0 as recoverJumpGap",{currentTime:t,bufferingRanges:e}),0):1.1*this.fragDuration}computeRecoverPositionFromStartPosition(){const{startPosition:e}=this.state.controller,t={},r=this.computeRecoverJumpGap();return void 0!==e.utc&&e.utc>0&&(t.utc=e.utc+r),t.videoTime=(e.videoTime||0)+r,t}computeRecoverPositionFromCurrentTime(){const e={},{lastRecoverPosition:t}=this.state.controller,r=this.getCurrentTime(),i=this.getUtcPosition(),n=this.computeRecoverJumpGap(),{utc:s=0,videoTime:a=0}=t||{};return(i>0||s>0)&&(e.utc=Math.max(i,s)+n),e.videoTime=Math.max(r,a)+n,e}async recoverCurrentFrag(){const{lastRecoverPosition:e,bufferingRanges:t}=this.state.controller,r=this.getDuration()>0||void 0!==e?this.computeRecoverPositionFromCurrentTime():this.computeRecoverPositionFromStartPosition();this.playerStore.setControllerStateField(Lm.lastRecoverPosition,r),this.playerStore.setControllerStateField(Lm.startPosition,r),await this.detachEncoder(),this.emit("BufferingRangesChange",t),await this.attachEncoder()}attachMedia(){mf.log("attachMedia"),this.logLoadToRum();const{video:e,HLSEncoder:t}=this;if(void 0===t){const e=new Fl({code:Ga.NO_HLS_JS_INSTANCE,isFatal:!1});return this.props.onError(e),Promise.reject(e)}const r=new Promise(e=>{t.once(Hls.Events.MEDIA_ATTACHED,()=>{this.HLSEncoderAttachTime=(0,Fa.no)(),t.url||t.loadSource(this.getStreamUrl()),e()})});t.once(Hls.Events.MANIFEST_PARSED,()=>{if(this.loadStarted)return;const e=this.getStartLoadPosition();t.startLoad(e),this.loadStarted=!0,t.once(Hls.Events.LEVEL_UPDATED,(r,i)=>{let{details:n}=i;const s=this.getStartLoadPosition(n);s!==e&&void 0!==s&&t.streamController.startLoad(s)})});const i=t.levels&&t.levels.length>0?Promise.resolve():new Promise(e=>{t.once(Hls.Events.MANIFEST_PARSED,()=>{e()})});return Kn(this.video,()=>{t.attachMedia(e)}),this.stallDetector=new iy(this.video,()=>{this.props.logEvent({event:"HlsJsStallDetected",params:{}})}),this.gapJumpTimer=new Gv(()=>{var e;null==(e=this.stallDetector)||e.poll()}).tickEvery(.25),Promise.all([r,i]).then(()=>{})}onAudioTrackUpdated(e){const{HLSEncoder:t}=this;if(!t)return;const r=Vn(t.audioTracks.find(t=>t.id===e));r&&this.emit("InternalAudioTrackValueChange",r.value)}getVideoType(){const e=this.getHlsEncoderLevelDetails();if(e)return Xn(e);return(this.HLSEncoder&&this.HLSEncoder.levels||[]).some(e=>{let{details:t}=e;return Boolean(t&&t.live)})||this.getDuration()===1/0?jc.Z.LIVE:jc.Z.VOD}onLevelsUpdated(){const{sessionData:e={},levels:t=[]}=this.HLSEncoder||{};this.videoTrackLabels=$n(e),this.maxHeightCapping=function(e){const{VALUE:t=""}=e["com.yandex.video.capping.maxheight"]||{},r=parseInt(t,10);return r>0?r:void 0}(e),this.emit("VideoTracksChange",qn(t,this.videoTrackLabels))}updateThumbnailTileMeta(){const{sessionData:e={}}=this.HLSEncoder||{},t=e=>{this.props.logEvent({event:e,params:void 0})},r=Fn(e,wy.LOWRES,t),i=Fn(e,wy.HIGHRES,t);if(void 0===i)return;const n=r?Mn(r,t):void 0,s=Mn(i,t),a=function(e){const{VALUE:t=""}=e["com.yandex.video.thumbnail.version"]||{};return parseFloat(t)||0}(e);this.props.onThumbnailTileGeneralMetaInfoChange({version:a,lowRes:n,highRes:s})}onEncoderError(e){const{details:t,type:r,url:i,frag:n}=e;if(!t)return;if((s=e).networkDetails&&423===s.networkDetails.status&&s.details===Hls.ErrorDetails.LEVEL_LOAD_ERROR){this.props.logEvent({event:$d.HlsJsForceCappingStart,params:{}});const{recoverHelper:n}=this;return void n.planTask(()=>this.recoverCurrentFrag(),{force:xn(e),reason:"HlsJs "+r,rawData:{details:t,type:r,url:i,isFatal:!1},delay:0})}var s;const a=On(e),o=Nn(e);if(void 0!==o&&(a||r===Hls.ErrorTypes.MEDIA_ERROR))if(this.recoverHelper.allowed&&!o.isFatal){if(this.props.onError(o),Ln(e)){if(this.currentState!==Wl.X.BUFFERING&&function(e){const{details:t}=e;return!!t&&(Hls.ErrorDetails.FRAG_LOAD_ERROR===t||Hls.ErrorDetails.FRAG_LOAD_TIMEOUT===t||Hls.ErrorDetails.FRAG_PARSING_ERROR===t||Hls.ErrorDetails.LEVEL_LOAD_TIMEOUT===t)}(e))return void(this.recoverOnBufferingReason=e);let s;e.details===Hls.ErrorDetails.INTERNAL_EXCEPTION&&"demuxerWorker"===e.event?(Nu.t.setItem(Oy.WAS_WORKER_INTERNAL_ERROR,"true"),s=()=>this.recoverStream()):s=()=>this.recoverCurrentFrag(),this.recoverHelper.planTask(s,{force:xn(e),reason:"HlsJs "+r,rawData:{details:t,type:r,url:i,isFatal:a,frag:kn(n)},delay:1e3})}}else this.props.onError(new Fl(gs({},o,{isFatal:!0})))}getHlsTextTrack(e){if(this.HLSEncoder)return this.HLSEncoder.subtitleTracks.find(t=>e.value===String(t.id))}unsubscribePreloadSourceHandlers(){const{preloadSourceHLSEncoder:e}=this;e&&(this.preloadSourceHandlers.forEach(t=>{let[r,i]=t;e.off(r,i)}),this.preloadSourceHandlers.length=0)}clearPreloadSourceHlsEncoder(){this.preloadSourceHLSEncoder=void 0,this.preloadPosition={}}getStartLoadPosition(e){const{startPosition:t}=this.state.controller,{liveOffset:r}=this.props;return function(e){let{details:t,startPosition:r,liveOffset:i}=e,{videoTime:n}=r;if(void 0===t)return n;if(t.hasProgramDateTime&&Zn(r.utc)){const e=t.fragments[0].programDateTime/1e3;n=r.utc-e}if(!Zn(n))return;const s=Xn(t)===jc.Z.VOD?0:i,[a]=t.fragments;return zt(n,void 0===a?0:a.start,t.totalduration-s)}({details:e,startPosition:t,liveOffset:r})}startLevelForcingWithSizeCap(){clearInterval(this.levelForcingInterval),this.levelForcingInterval=window.setInterval(()=>{this.forceLevel()},1e3)}stopLevelForcingWithSizeCap(){clearInterval(this.levelForcingInterval)}forceLevel(){if(!this.HLSEncoder||!this.HLSEncoder.autoLevelEnabled||!this.HLSEncoder.levels||!this.HLSEncoder.levels.length)return;const{width:e,height:t,maxWidth:r,maxHeight:i}=this.getCapSizes(),n=Math.min(e,r||1/0),s=Math.min(t,i||1/0),a=Math.min(...[this.maxHeightCapping,s].filter(Hl.z)),{levels:o}=this.HLSEncoder,l=o.reduce((e,t,r)=>{if((t.height<e.smallestLevel.height||t.width<e.smallestLevel.width)&&(e.smallestLevel=t,e.smallestLevelIndex=r),t.height>a||t.width>n)return e;const i=(o[e.index]||{}).height||0;return t.height>i?gs({},e,{index:r}):e},{index:-1,smallestLevel:o[0],smallestLevelIndex:0});this.HLSEncoder.autoLevelCapping=-1===l.index?l.smallestLevelIndex:l.index}}var iS=r(9178);class nS{static fromXHR(e){return new nS(e)}constructor(e){this.status=void 0,this.status=e.status}isFatalError(){return this.isRegionLimitationError()||this.isSignatureExpiredError()||this.isBannedError()}toPlayerError(){return new Fl({code:this.getErrorCode(),isFatal:this.isFatalError(),details:JSON.parse((0,ih.Y)(this))})}isRegionLimitationError(){return 451===this.status}isSignatureExpiredError(){return _y.includes(this.status)}isBannedError(){return 454===this.status}getErrorCode(){return this.isRegionLimitationError()?Ga.REGIONAL_LIMITATION_MANIFEST:this.isSignatureExpiredError()?Ga.SIGNATURE_EXPIRED_MANIFEST:this.isBannedError()?Ga.BANNED_MANIFEST:Ga.DEFAULT_ERROR}}const sS=e=>(0,qa.H)(e)&&(0,cc.n)(Ga,e);class aS{constructor(){this.serverTimestamp=void 0,this.getElapsedTimeFromServerDate=()=>0}parseServerTime(e,t){if(!e.date&&!e["x-server-time-ms"])return;let r=NaN;if(e["x-server-time-ms"]){r=new Date(parseInt(e["x-server-time-ms"],10)).getTime()}else if(e.date){r=new Date(e.date).getTime()}(0,Hl.z)(r)&&(this.serverTimestamp=r+t/2,this.getElapsedTimeFromServerDate=(0,xa.u)())}getServerTime(){if(void 0!==this.serverTimestamp)return this.serverTimestamp+this.getElapsedTimeFromServerDate()}}const oS=["loadstart","progress","durationchange","loadedmetadata","loadeddata","canplay","playing"];class lS extends tS{subscribeVideoTracksChange(){this.addEventListener(this.video.videoTracks,"addtrack",this.createAddTrackCallback(()=>{this.emit("VideoTracksChange",ks(this.video.videoTracks)),this.restoreUserVideoTrack()})),this.addEventListener(this.video.videoTracks,"removetrack",()=>{this.emit("VideoTracksChange",ks(this.video.videoTracks))}),this.addEventListener(this.video.videoTracks,"change",()=>{const{videoHeight:e,videoWidth:t,videoTracks:r}=this.video,i=ws(Rs({videoTracks:r,videoHeight:e,videoWidth:t}));this.emit("InternalVideoTrackValueChange",i&&i.value)})}createAddTrackCallback(e){return(0,iS.D)(e,0)}subscribeAudioTracksChange(){this.addEventListener(this.video.audioTracks,"addtrack",this.createAddTrackCallback(e=>{this.emit("AudioTracksChange",Ts(this.video.audioTracks)),this.actualizeNativeAudioTrack(),this.restoreUserAudioTrack()})),this.addEventListener(this.video.audioTracks,"removetrack",()=>{this.emit("AudioTracksChange",Ts(this.video.audioTracks)),this.actualizeNativeAudioTrack()}),this.addEventListener(this.video.audioTracks,"change",e=>{this.actualizeNativeAudioTrack(),this.saveUserAudioTrack(e)})}subscribeTextTracksChange(){this.addEventListener(this.video.textTracks,"addtrack",()=>{this.emit("TextTracksChange",_s(this.video.textTracks)),this.restoreUserTextTrack()})}initInternalSubscribe(){super.initInternalSubscribe(),this.subscribeVideoBuffering();const e=(0,La.I)(()=>{this.emit("VideoTracksChange",ks(this.video.videoTracks)),this.emit("AudioTracksChange",Ts(this.video.audioTracks)),this.emit("TextTracksChange",_s(this.video.textTracks));const{videoHeight:e,videoWidth:t,videoTracks:r}=this.video,i=ws(Rs({videoTracks:r,videoHeight:e,videoWidth:t}));i&&this.emit("InternalVideoTrackValueChange",i.value),this.setFirstAudioTrack()});this.initTextTracks(),this.once("CanPlay",e),this.once("Destroy",()=>{this.off("CanPlay",e)}),this.video.videoTracks&&this.subscribeVideoTracksChange(),this.video.audioTracks&&this.subscribeAudioTracksChange(),this.video.textTracks&&this.subscribeTextTracksChange(),this.addVideoEventListener("progress",()=>{const{videoType:e}=this.state.controller;e!==jc.Z.LIVE&&e!==jc.Z.EVENT||this.emit("DvrChange")}),this.subscribeCueChange()}constructor(e){super(e),this.props=e,this.serverTimeEstimator=void 0,this.estimatorPollingInterval=void 0,this.isRecoverablePlaylistHTTPStatus=!0,this.checkPlaylistHTTPStatusPromise=void 0,this.applyStartPosition=()=>{if(!this.canSeek())return;const e=this.getCurrentTime(),t=this.getStartPosition();(0,Hl.z)(t)&&e!==t&&this.seekInternal(t)},this.saveUserAudioTrack=e=>{if(!e.isTrusted)return;const t=Ss(this.video);t&&this.playerStore.setUserAudioTrackParams({name:t.name||void 0,lang:t.lang||void 0})},this.actualizeNativeAudioTrack=()=>{const e=Ss(this.video);this.emit("InternalAudioTrackValueChange",e&&e.value)},this.notifyTextTracksChanged=e=>{this.saveUserTextTrack(e);const t=As(this.video,this.getVisibleTextTrackMode());this.emit("InternalTextTrackValueChange",t&&t.value)},this.saveUserTextTrack=e=>{if(!e||!e.isTrusted)return;const t=As(this.video,this.getVisibleTextTrackMode());t&&this.playerStore.setUserTextTrackParams({enabled:!0,lang:t.lang,name:t.name})},this.playerStore.setIsAbrSupported(!0),this.stateController.putIsAbrEnabled(!0),this.serverTimeEstimator=new aS,this.estimateLatency(),this.on("VideoTypeChange",e=>{this.startLatencyPolling(e)}),this.on("Detach",()=>this.stopLatencyPolling()),this.once("Destroy",()=>this.stopLatencyPolling())}getServerTime(){const e=this.serverTimeEstimator.getServerTime();return e?e/1e3:void 0}setAudioTrack(e){if(""===e.value)return;const t=(0,Rd.w)(this.video.audioTracks),r=t.find(t=>t.id===e.value);void 0!==r&&(r.enabled=!0,t.forEach(e=>{e!==r&&(e.enabled=!1)}))}setTextTrack(e){""!==e.lang&&this.renderTextTrack(e.lang)}disableTextTrack(){this.renderTextTrack(void 0)}renderTextTrack(e){as(this.video.textTracks).forEach((t,r)=>{t&&(bs(t,r).lang===e?t.mode=this.getVisibleTextTrackMode():t.mode=this.getHiddenTextTrackMode())})}seekInternal(e){cs(this.video,zt(e,0,this.getDuration()||0))}getSeekableRange(){const e=this.video.seekable;return{start:e.start(0),end:e.end(e.length-1)}}getFragmentsData(){if(!this.isDvrEnabled()||!this.video||!this.video.seekable.length)return super.getFragmentsData();const{start:e,end:t}=this.getSeekableRange();return{totalDuration:t-e,fragmentDuration:Pm,startTime:e}}shouldSkipVideoTagError(e){return e.code!==my.MEDIA_ERR_DECODE&&e.code!==my.MEDIA_ERR_ENCRYPTED&&e.code!==my.MEDIA_ERR_SRC_NOT_SUPPORTED||$r(this.state)}async onVideoTagError(){const e=Tn(this.video);if(this.shouldSkipVideoTagError(e))return;this.video.poster=uf,this.checkPlaylistHTTPStatus();const t=!this.recoverHelper.allowed||!this.isRecoverablePlaylistHTTPStatus,r=new Fl({code:vs(e),details:e,isFatal:t});if(!t)return this.props.onError(r),void this.recoverHelper.planTask(()=>this.recoverStream(),{delay:500,reason:"VideoTagError ["+e.code+"]["+e.message+"]"});const i=await this.checkPlaylistHTTPStatusPromise;i&&i.isFatalError()?this.props.onError(i.toPlayerError()):this.props.onError(r)}onTick(e){super.onTick(e),this.isDvrEnabled()&&this.updateSkinDvrParameters(e)}async attachEncoder(){await super.attachEncoder();const e=e=>(this.props.onError(e),Promise.reject(se(e,this.state.ad.adblockDetected)));if(this.engine===ql.NATIVE&&!ag)return e(new Fl({code:Ga.NATIVE_HLS_NOT_SUPPORTED_ERROR}));const{video:t}=this;this.subscribeContentImpression();try{await this.initDrm(this.props.stream.drmConfig)}catch(io){return e(Fl.from(io))}if(this.establishStartPosition(),this.initVideoTypeQualifier(),this.logLoadToRum(),py.isYaspVideoElement(t)){const e=t,{streamsWithSupportInfo:r}=this.playerStore.getState().controller;if(r){const t=r.find(e=>{let{supportInfo:t,stream:r}=e;return lg(r.url)&&t.supported});t?e.airplaySrc=t.stream.url:(e.disableRemotePlayback=!0,e.airplaySrc="")}}Kn(t,()=>t.src=this.getStreamUrl()),this.startLatencyPolling(this.state.controller.videoType)}getStreamUrl(){const e=this.getStartPosition();return Sn(super.getStreamUrl(),e)}establishStartPosition(){const e=[];oS.forEach(t=>{e.push(this.addVideoEventListener(t,()=>{this.canSeek()&&(this.applyStartPosition(),X(e))},{once:!0}))}),this.once("Detach",()=>{X(e)})}canSeek(){const{video:e}=this.props;return e.readyState>0&&e.duration>0}getStartPosition(){const{videoTime:e,utc:t}=this.state.controller.startPosition;if(!(0,Hl.z)(e)&&!(0,Hl.z)(t))return;const r=this.getUtcStartTime();return r>0&&(0,Hl.z)(t)&&t>0?t-r:(0,Hl.z)(e)?e:void 0}getUtcPosition(){const e=this.getUtcStartTime();return e>=0?e+this.getCurrentTime():super.getUtcPosition()}checkPlaylistHTTPStatus(){this.checkPlaylistHTTPStatusPromise||(this.checkPlaylistHTTPStatusPromise=this.loadPlaylistInfo().then(nS.fromXHR).then(e=>(this.isRecoverablePlaylistHTTPStatus=!e.isFatalError(),e)).catch(()=>{}))}estimateLatency(){const e=Jv();(0,Qc.W)({url:this.getStreamUrl(),method:"HEAD",timeout:5e3}).then(t=>{this.serverTimeEstimator.parseServerTime({"x-server-time-ms":t.getResponseHeader("x-server-time-ms"),date:t.getResponseHeader("date")},Jv()-e)},()=>{})}startLatencyPolling(e){this.estimatorPollingInterval||e!==jc.Z.EVENT&&e!==jc.Z.LIVE||(this.estimatorPollingInterval=window.setInterval(()=>this.estimateLatency(),1e4))}stopLatencyPolling(){clearInterval(this.estimatorPollingInterval),this.estimatorPollingInterval=void 0}initTextTracks(){let e=!1,t=!1;const{textTracks:r}=this.video;if(!r)return;const i=(0,La.I)(()=>{this.castTextTracksModeOnInit(),this.restoreUserTextTrack(),this.addEventListener(r,"change",this.notifyTextTracksChanged),this.notifyTextTracksChanged()}),n=()=>{e&&t&&i()};this.addEventListener(this.video,"loadedmetadata",()=>{e=!0,n()}),this.addEventListener(r,"addtrack",this.createAddTrackCallback(()=>{t=!0,n()}))}setFirstAudioTrack(){this.restoreUserAudioTrack();const e=Ss(this.video);e&&this.emit("InternalAudioTrackValueChange",e.value)}loadPlaylistInfo(){return(0,Qc.W)({method:"GET",url:this.getStreamUrl()+"&xhr=1",timeout:3e3,checkStatus:()=>!0})}subscribeCueChange(){const{textTracks:e}=this.video;if(!e||"function"!==typeof e.addEventListener)return;const t=e=>{const t=e.track;t&&"metadata"===t.kind&&(t.mode="hidden",this.addEventListener(t,"cuechange",e=>{const{activeCues:t}=e.target,{length:r}=t;if(!r)return;const i=t[r-1];if(!i)return;const{value:n,startTime:s,endTime:a}=i;if(!n)return;const o="number"===typeof a&&isFinite(a)?a-s:Pm,l=(0,Rd.w)(t).map(e=>{if(e&&e.value){const{data:t}=e.value;if("string"===typeof t)return t}return""});this.emit("MetadataChange",{fragmentMetadataArray:l,fragmentStart:s,fragmentDuration:o,src:this.video.src})}))};e.addEventListener("addtrack",t),this.on("Destroy",()=>e.removeEventListener("addtrack",t))}castTextTracksModeOnInit(){if(this.state.skin.useNativeSubtitles)return;void 0!==as(this.video.textTracks).find(e=>Boolean(e&&"disabled"===e.mode))||as(this.video.textTracks).forEach(e=>{e&&(e.mode="showing"===e.mode?this.getVisibleTextTrackMode():this.getHiddenTextTrackMode())})}}class dS extends lS{constructor(e){super(e),this.props=e,this.engine=ql.MP4;const t=(0,La.I)(()=>{this.emit("VideoTracksChange",function(e){const{videoWidth:t,videoHeight:r}=e;return[{name:jn({width:t,height:r}),value:"0",bitrate:Vm,width:t,height:r}]}(e.video))});this.once("CanPlay",t),this.once("Destroy",()=>this.off("CanPlay",t))}async attachEncoder(){await super.attachEncoder(),mf.log("mp4 native mode")}establishStartPosition(){const e=this.addVideoEventListener("durationchange",()=>{this.canSeek()&&(this.applyStartPosition(),e())});this.once("Detach",()=>{e()})}initVideoTypeQualifier(){this.emit("VideoTypeChange",jc.Z.VOD)}initDrm(){return Promise.resolve()}setVideoTrack(){}}var uS=r(9066);let cS;!function(e){e.EXPIRED_SIGNATURE="EXPIRED_SIGNATURE",e.NEED_COOKIE="NEED_COOKIE",e.NEED_YATEAM_LOGIN="NEED_YATEAM_LOGIN",e.NEED_VIEW_PERMISSION="NEED_VIEW_PERMISSION"}(cS||(cS={}));const hS={error:"",isFatal:!1,helpLink:""};var pS=r(5052);class fS extends np{constructor(e,t,r,i){var n;super(),n=this,this.drmConfig=t,this.errorCallback=r,this.withCredentials=i,this.video=void 0,this.loadCertificate=(0,La.I)(async()=>{try{const{promise:e,abort:t}=Cs({method:"GET",url:this.drmConfig.servers["com.apple.fps.1_0"],responseType:"arraybuffer",retries:3,timeout:1e4,onRetry:this.onRequestRetry(e=>{this.onError(new Fl({code:Ga.FAIRPLAY_CERT_LOAD_ERROR,isFatal:!1,details:e}))}),withCredentials:this.withCredentials});this.addDestroyHandler(t);const{response:r}=await e;return new Uint8Array(r)}catch(io){return this.onError(new Fl({isFatal:!0,code:Ga.FAIRPLAY_CERT_LOAD_ERROR,details:(0,Za.K)(io)?io:void 0})),new Uint8Array(0)}}),this.onNeedKey=async function(e){let{initData:t}=void 0===e?{}:e;const{video:r}=n;if(!t||n.isDestroyed)return;const i=n.extractContentId(t);await n.waitForLoadedMetaData(),r.webkitKeys||"function"!==typeof WebKitMediaKeys||r.webkitSetMediaKeys(new WebKitMediaKeys("com.apple.fps.1_0")),r.webkitKeys||n.onError(new Fl({code:Ga.FAIRPLAY_CREATE_MEDIA_KEYS_ERROR}));const s=await n.getWebKitMediaKeySessionInitData(t,i),a=n.video.webkitKeys.createSession("video/mp4",s);a||n.onError(new Fl({code:Ga.FAIRPLAY_CREATE_KEY_SESSION_ERROR})),n.addDestroyHandler(()=>a.close());n.addDestroyHandler((0,yh.O)(a,"webkitkeymessage",e=>{let{message:t}=e;if(n.isDestroyed)return;const r=t||new ArrayBuffer(0),s=xs({},n.drmConfig.headers),o=(0,Pp.l)();let l=0;const d=async()=>{if(n.isDestroyed)return;const{abort:e,promise:t,getStatus:u}=Cs({responseType:"json",method:"POST",url:n.drmConfig.advanced["com.apple.fps.1_0"].processSPCPath,data:JSON.stringify(xs({assetId:i,spc:btoa(Ms(new Uint8Array(r)))},n.drmConfig.requestParams)),headers:s,timeout:1e4,withCredentials:n.withCredentials});n.addDestroyHandler(e);try{const{response:{ckc:e}}=await t,r=Vs(atob(e));return void a.update(new Uint8Array(r))}catch(io){const t=l>=3;if(n.onError(new Fl({isFatal:t,code:Ga.FAIRPLAY_SPC_LOAD_ERROR,details:io})),t)return;o.addLock((0,pS._)(Ls(u(),l++))),o.waitAndLock(d)}};o.waitAndLock(d)}));n.addDestroyHandler((0,yh.O)(a,"webkitkeyerror",e=>{let t;const{error:r}=a;if(r){const{code:e,systemCode:i}=r;t={code:e,systemCode:i}}n.onError(new Fl({code:Ga.FAIRPLAY_CREATE_KEY_ERROR,isFatal:!1,details:t}))}))},this.onError=e=>{this.isDestroyed||(this.errorCallback.call(this.errorCallback,e),e.isFatal&&this.destroy())},this.onRequestRetry=e=>(t,r)=>{const i=r.status;if(418!==i)return e(t),!0;const n=Ns(r.response,i);return this.onError(Os(n)),!n.isFatal},this.video=e,this.addDestroyHandler((0,yh.O)(e,"webkitneedkey",this.onNeedKey)),this.loadCertificate()}async getWebKitMediaKeySessionInitData(e,t){const r=await this.loadCertificate(),i=new Uint16Array(Vs(t));let n=0;const s=e.byteLength+4+i.byteLength+4+r.byteLength,a=new ArrayBuffer(s),o=new DataView(a);new Uint8Array(a,n,e.byteLength).set(new Uint8Array(e)),n+=e.byteLength,o.setUint32(n,i.byteLength,!0),n+=4;const l=new Uint16Array(a,n,i.length);l.set(i),n+=l.byteLength,o.setUint32(n,r.byteLength,!0),n+=4;return new Uint8Array(a,n,r.byteLength).set(r),new Uint8Array(a,0,a.byteLength)}extractContentId(e){const t=new Uint8Array(e),r=Ms(new Uint16Array(t.buffer)),[,i]=r.split("//");return i||(this.onError(new Fl({isFatal:!1,code:Ga.FAIRPLAY_INVALID_CONTENT_ID})),"")}async waitForLoadedMetaData(){if(!(this.video.readyState>=HTMLMediaElement.HAVE_METADATA))return new Promise(e=>{this.addDestroyHandler((0,yh.O)(this.video,"loadedmetadata",()=>e(),{once:!0}))})}}fS.IS_SUPPORTED="undefined"!==typeof WebKitMediaKeys&&(0,Ql.m)(WebKitMediaKeys.isTypeSupported)&&WebKitMediaKeys.isTypeSupported("com.apple.fps.1_0","video/mp4");class mS extends Bc.v{constructor(e){super(),this.video=void 0,this.unsubscribers=[],this.isStrmCatchUpStream=void 0,this.seekableEndFifo=new Zg(2),this.destroy=()=>{X(this.unsubscribers)},this.handleProgressEvent=()=>{if(!this.video||!this.video.seekable.length)return;const e=this.video.seekable,t=e.end(e.length-1),r=this.seekableEndFifo.getAll();t!==r[r.length-1]&&(this.seekableEndFifo.push(t),this.updateVideoType({reason:"progress"}))},this.updateVideoType=e=>{let{reason:t}=e;this.emit("VideoTypeChange",{videoType:this.getVideoType(),videoTagDuration:this.video?this.video.duration:null,reason:t})},this.isStrmCatchUpStream=function(e){if(!Li(e))return!1;const t=(0,Yu.dD)((0,Yu.en)(e).search);return Boolean(t.start)}(e)}setHTMLVideoElement(e){this.destroy(),this.video=e,this.unsubscribers.push((0,yh.O)(e,"timeupdate",()=>{this.updateVideoType({reason:"timeupdate"})})),this.unsubscribers.push((0,yh.O)(e,"durationchange",()=>{this.updateVideoType({reason:"durationchange"})})),this.unsubscribers.push((0,yh.O)(e,"progress",this.handleProgressEvent))}getVideoType(){if(!this.video||isFinite(this.video.duration))return jc.Z.VOD;if(this.isStrmCatchUpStream)return jc.Z.EVENT;const e=this.seekableEndFifo.getAll();if(!this.video.seekable.length||e.length<2)return jc.Z.LIVE;const t=this.video.seekable.start(0);return e[1]>e[0]&&t?jc.Z.LIVE:jc.Z.EVENT}}class gS{constructor(e){let{retries:t=3,nudgeDelay:r=2e3,nudge:i,shouldNudge:n,onNudgeFailed:s=Yl.Z}=e;this.retries=void 0,this.nudge=void 0,this.shouldNudge=void 0,this.nudgeDelay=void 0,this.onNudgeFailed=void 0,this.currentRetries=0,this.timer=void 0,this.retries=t,this.nudge=i,this.shouldNudge=n,this.nudgeDelay=r,this.onNudgeFailed=s}schedule(){this.timer||(this.currentRetries++,this.timer=window.setTimeout(()=>{this.timer=void 0,this.shouldNudge()&&(this.currentRetries>this.retries?this.onNudgeFailed():(this.nudge(),this.schedule()))},this.nudgeDelay))}clear(){this.currentRetries=0,window.clearTimeout(this.timer),this.timer=void 0}}var vS=r(6588);class yS extends lS{initInternalSubscribe(){super.initInternalSubscribe(),this.recoverSleepMode(),this.activateVideoTagIosWorkaround(),this.subscribeStalledNudger()}constructor(e){super(e),this.props=e,this.engine=ql.NATIVE,this.stalledNudger=void 0,this.fairPlayController=void 0,this.isLowLatencyLiveStream=!1,this.isStuck=function(e){let{getCurrentTime:t,getPlayingState:r}=e;const i=new Zg(5);let n=0,s=t();return e=>{const a=t();if(r()!==vS.X.PLAY)return n=0,i.clear(),!1;n=e+n;let o=!1;if(n>1e3&&s!==a&&(i.push(a),n=0,5===i.size())){const e=i.getAll(),t=Math.max(...e)-Math.min(...e);o=t>0&&t<1}return s=a,o}}({getCurrentTime:()=>this.getCurrentTime(),getPlayingState:()=>this.getPlayingState()}),this.stalledNudger=new gS({nudge:()=>{this.state.controller.playbackRate>1&&this.setPlaybackRate(1,xm.Recover),this.onNudge()},shouldNudge:()=>this.getPlayingState()===Wl.X.BUFFERING&&(!!this.shouldNudge()&&this.getRemainingBufferedTime().total>0),onNudgeFailed:()=>{this.props.logEvent({event:$d.NudgeStalledFailed,params:{}})}}),this.updateIsLowLatencyLiveStream(),this.seekToLiveEdgeForSafariWithM4s()}getUtcStartTime(){const e=this.video;if(!this.video.src||0===e.readyState||"function"!==typeof e.getStartDate)return super.getUtcStartTime();const t=e.getStartDate();if(!t||"function"!==typeof t.getTime)return super.getUtcStartTime();const r=t.getTime();return isNaN(r)?super.getUtcStartTime():r/1e3}async attachEncoder(){this.emit("BufferingRangesChange",[]),await super.attachEncoder(),mf.log("hls native mode")}async detachEncoder(){await super.detachEncoder(),this.video.src&&this.video.removeAttribute("src")}shouldSkipVideoTagError(e){return super.shouldSkipVideoTagError(e)||Boolean(this.fairPlayController&&this.fairPlayController.isDestroyed)}shouldNudge(){return!$r(this.state)&&this.canSeek()}onNudge(){this.seek(this.state.controller.currentTime+.001)}getStartPosition(){const{videoTime:e,utc:t}=this.state.controller.startPosition;if((0,Hl.z)(e)||(0,Hl.z)(t)){if(this.state.controller.videoType===jc.Z.LIVE){const e=this.getUtcStartTime();if(e>0&&(0,Hl.z)(t)&&t>0)return t-e}return(0,Hl.z)(e)?e:void 0}}isDvrEnabled(){if(xy&&!Cc)return!0;const{skin:{nativeControlsVisibility:e}}=this.state;return!e}setVideoTrack(){mf.log("Unable to set video track on native encoder")}getBandwidthEstimate(){return{value:NaN,source:"default"}}async initDrm(){const{stream:{drmConfig:e}}=this.props;return this.initFairPlay(e)}calculateDVRParams(){const{videoType:e}=this.state.controller;if(e===jc.Z.VOD||void 0===e)return super.calculateDVRParams();const{fragmentDuration:t,startTime:r,totalDuration:i}=this.getFragmentsData();return{fragmentDuration:t,dvrStartTime:r,dvrDuration:i,skinDVRStartTime:r,skinDVRDuration:i-Pm}}getStreamUrl(){const e=super.getStreamUrl(),t={force_m4s:"1"};let{width:r,height:i}=this.video.getBoundingClientRect();const n=Qn();return t.video_width=String(r*n),t.video_height=String(i*n),this.isLowLatencyLiveStream&&(t.lowlatency="1"),(0,Yu.Sr)(e,t,{saveOriginalPath:!0})}isLowLatencyLive(){return this.isLowLatencyLiveStream}initVideoTypeQualifier(){const e=new mS(this.getStreamUrl());this.once("Detach",e.destroy),e.on("VideoTypeChange",e=>{if(null==e||!e.videoType)return;const{controller:{videoType:t}}=this.props.playerStore.getState();this.checkIfRecoverNecessary(e,t)&&(this.stateController.putPlaybackRate(1,xm.Recover),this.props.onRecover({reason:"currentTime is greater than duration during LIVE / EVENT in NativeController",delay:0,attempt:1}),this.recoverStream().then(()=>{this.play()})),void 0!==t&&e.videoType!==t&&this.props.logEvent({event:$d.NativeVideoTypeChange,params:Bs({},e,{previousVideoType:t})}),this.emit("VideoTypeChange",e.videoType)}),e.setHTMLVideoElement(this.video)}onTick(e){this.handleBufferingRangesUpdate(),super.onTick(e),this.checkStuckState(e),this.checkOutOfDvr(),this.updateProgramDateTime()}updateIsLowLatencyLiveStream(){const e=super.getStreamUrl(),t=tS.isLiveStreamUrl(e),r=Wg.major>=14,i=Ug.major>=15,n=r||i;this.isLowLatencyLiveStream=t&&n,this.isLowLatencyLiveStream&&this.props.logEvent({event:$d.LowLatencyDetected,params:{}})}checkIfRecoverNecessary(e,t){let{reason:r,videoTagDuration:i}=e;return(t===jc.Z.LIVE||t===jc.Z.EVENT)&&"durationchange"!==r&&i&&isFinite(i)}checkStuckState(e){this.video.error||this.isStuck(e)&&this.recoverHelper.planTask(()=>this.recoverStream(),{delay:100,reason:"Stuck on time "+this.getCurrentTime()})}checkOutOfDvr(){if(this.video.error)return;const e=this.getCurrentTime(),{startTime:t}=this.getFragmentsData(),{videoType:r,playingState:i}=this.state.controller;this.recoverHelper.started||e>=t||i===Wl.X.PLAY&&r===jc.Z.LIVE&&this.recoverHelper.planTask(()=>this.recoverStream(!0),{delay:0,reason:"Out of DVR. CurrentTime="+e+" startTime="+t})}handleBufferingRangesUpdate(){const e=Wg.major>=15,t=Ug.major>=15;if(e||t){const e=this.props.video.buffered,t=this.props.video.buffered.length;if(!t)return;const r=this.state.controller.currentTime,i=this.state.controller.bufferingRanges.find(e=>r>=e.start&&r<=e.end);if(!i)return;for(let n=0;n<t;n++)if(e.start(n)<=r&&e.end(n)>r)return void(e.end(n)>i.end&&this.emit("BufferingRangesChange",(0,Nv.w)(this.props.video)))}}async initFairPlay(e){var t;if(!gi(e))return R("drm","none"),void this.emit("DrmSystemChange",kg.none);if(R("drm","fairplay"),!fS.IS_SUPPORTED)throw new Fl({code:Ga.FAIRPLAY_NOT_SUPPORTED});const{video:r,onError:i}=this.props;null==(t=this.fairPlayController)||t.destroy();const n=new fS(r,e,i,this.withCredentials);this.fairPlayController=n,this.emit("DrmSystemChange",kg.fairplay),this.once("Detach",()=>n.destroy()),this.once("Destroy",()=>n.destroy())}recoverSleepMode(){const e=(0,Bl.Y)(this.getVideoOwnerDocument(),e=>{e&&this.shouldNudge()&&this.video.paused&&(this.video.currentTime-=.001)});this.once("Destroy",e)}subscribeStalledNudger(){this.on("VideoPlayingStateChange",e=>{var t,r;e===Wl.X.BUFFERING?null==(t=this.stalledNudger)||t.schedule():null==(r=this.stalledNudger)||r.clear()})}updateProgramDateTime(){const{videoType:e}=this.state.controller,t=this.getUtcStartTime(),r=(e===jc.Z.LIVE||e===jc.Z.EVENT)&&t?1e3*t:void 0;this.emit("ProgramDateTimeChange",r)}activateVideoTagIosWorkaround(){Cc&&this.once("Destroy",(0,yh.O)(this.video,"touchstart",()=>{this.video.paused?this.video.pause():Promise.resolve(this.video.play()).catch(Yl.Z)},{once:!0}))}handleVideoElementPlayEvent(){this.props.video.buffered.length&&super.handleVideoElementPlayEvent()}isStalledLiveEdge(){return!1}seekToLiveEdgeForSafariWithM4s(){const e=super.getStreamUrl();!tS.isLiveStreamUrl(e)||xy&&Ug.major<16||xy&&16===Ug.major&&Ug.minor<5||Cc&&Wg.major<16||Cc&&16===Wg.major&&Wg.minor<5||this.addEventListener(this.props.video,"loadeddata",()=>{this.props.video.seekable.length&&this.seek(this.props.video.seekable.end(this.props.video.seekable.length-1))},{once:!0})}}var SS=r(4893),ES=r(2918),bS=r(7817);class AS extends np{constructor(e,t,r,i){super(),this.video=e,this.config=t,this.onEvent=i,this.session=void 0,this.initPromise=void 0,this.mainEventUnsubscribers=[],this.currentDrmKeySystem=kg.none,this.keySystem=void 0,this.requestSync=(0,Pp.l)(),this.onError=void 0,this.onError=e=>{this.isDestroyed||(e.isFatal&&this.destroy(),r(e))},this.mainEventUnsubscribers.push(this.addEventListener(this.video,"encrypted",e=>{this.logEvent("DrmEncrypted",{initDataType:e.initDataType}),this.removeSubscriptions(),this.onEncrypted(e.target)},{once:!0})),this.mainEventUnsubscribers.push(this.addEventListener(this.video,"waitingforkey",e=>{this.logEvent("DrmWaitingForKey",void 0),this.removeSubscriptions(),this.onEncrypted(e.target)},{once:!0})),this.keySystem=null,this.logEvent("CreateDrmController",{config:t})}removeSubscriptions(){this.mainEventUnsubscribers.forEach(e=>e()),this.mainEventUnsubscribers.length=0}async getMediaKeySessionInitData(){return Promise.resolve({})}static async getMediaKeySystemAccess(e){let t=AS.mediaKeySystemAccessMap.get(e);return t||(t=await window.navigator.requestMediaKeySystemAccess(e,Ig),AS.mediaKeySystemAccessMap.set(e,t),t)}async loadCertificate(e){if(this.keySystem===Gu.dn)return new ArrayBuffer(0);if(e)try{this.logEvent("DrmCertificateLoad",{url:e});const t=(0,xa.u)(),{response:r}=await this.requestDrmProxy({method:"get",responseType:"arraybuffer",url:e,withCredentials:this.config.withCredentials},0);return this.logEvent("DrmCertificateLoadEnd",{url:e,requestTime:Math.round(t())}),r}catch(io){const t=Fl.from(io);this.onError(new Fl(js({},t.toJSON(),{code:Ga.DRM_CERT_LOAD_ERROR,message:"Failed to get certificate via direct link: "+t,isFatal:!1})))}return new ArrayBuffer(0)}async init(){return this.initPromise||(this.initPromise=this.initInternal()),this.initPromise}async initInternal(){var e;if(this.currentDrmKeySystem!==kg.none)return;if(!this.video)return;if(this.keySystem=this.getDrmKeySystem(this.config),!this.keySystem)return void this.onError(new Fl({code:Ga.DRM_NO_SUPPORTED_KEY_SYSTEM,message:"No supported drm server specified",isFatal:!0}));if(this.video.mediaKeys)return;const{serverCertificateUrl:t}=(null==(e=this.config.advanced)?void 0:e[this.keySystem])||{},r=this.loadCertificate(t);let i;try{const e=await AS.getMediaKeySystemAccess(this.keySystem);i=await e.createMediaKeys()}catch(io){const t=(0,Za.K)(io)?io.message:(0,qa.H)(io)?io:"";return void this.onError(Fl.from(io,{code:Ga.DRM_FAILED_TO_CREATE_CDM,message:"Failed to create mediaKeys: "+t,isFatal:!0}))}try{if(this.isDestroyed)return;await this.video.setMediaKeys(i)}catch(io){const t=(0,Za.K)(io)?io.message:(0,qa.H)(io)?io:"";return void this.onError(Fl.from(io,{code:Ga.DRM_FAILED_TO_SET_MEDIA_KEYS,message:"Failed set mediaKeys: "+t,isFatal:!0}))}const n=await r;n.byteLength&&await i.setServerCertificate(n),this.currentDrmKeySystem=function(e){switch(e){case Gu.ly:return kg.widevine;case Gu.xE:return kg.playready;case Gu.dn:return kg.clearkey;default:return kg.none}}(this.keySystem)}async onEncrypted(e){var t;if(this.isDestroyed)return;if(await this.initPromise,!e.mediaKeys||!this.keySystem)return void this.onError(new Fl({code:Ga.DRM_INIT_ERROR,message:"MediaKeys not inited",isFatal:!0}));const r=null==(t=this.config.servers)?void 0:t[this.keySystem];if(r){try{this.session=e.mediaKeys.createSession()}catch(io){const t=(0,Za.K)(io)?io.message:(0,qa.H)(io)?io:"";return void this.onError(Fl.from(io,{code:Ga.DRM_FAILED_TO_CREATE_SESSION,message:"Failed to create session: "+t,isFatal:!0}))}if(this.session){this.addEventListener(this.session,"message",async e=>{let{message:t}=e;try{this.logEvent("DrmProxyRequest",{requestParams:this.config.requestParams,url:r,keySystem:this.keySystem});const e=(0,xa.u)(),{response:i}=await this.handleSessionMessage(this.keySystem,r,this.config.requestParams,t);if(this.logEvent("DrmProxyRequestEnd",{url:r,requestTime:Math.round(e()),keySystem:this.keySystem}),this.isDestroyed)return;await this.updateSession(i)}catch(io){var i;const t=Fl.from(io),r=null!=(i=t.details)&&i.drmProxyError?t.code:Ga.DRM_SESSION_ERROR;this.onError(new Fl(js({},t.toJSON(),{code:r,message:"Failed to handle session message: "+t})))}},!1),this.addEventListener(this.session,"error",e=>{var t,r;this.onError(new Fl(js({},e,{code:Ga.DRM_SESSION_ERROR,message:"Session error: "+e.message,isFatal:null==(t=null==(r=e.details)?void 0:r.isFatal)||t})))});try{const e=await this.getMediaKeySessionInitData();await this.generateRequest(this.session,e)}catch(io){return void this.onError(Fl.from(io,{code:Ga.DRM_UNKNOWN_ERROR}))}}else this.onError(new Fl({code:Ga.DRM_FAILED_TO_CREATE_SESSION,message:"session is "+this.session,isFatal:!0}))}else this.onError(new Fl({code:Ga.DRM_NO_LICENSE_SERVER,message:"No valid url to license server",isFatal:!0}))}async updateSession(e){var t;this.keySystem===Gu.dn?await this.updateClearKeyLicense(e):await(null==(t=this.session)?void 0:t.update(e))}createClearKeyObject(e,t){return{kty:"oct",kid:e,k:t,alg:"A128KW"}}async updateClearKeyLicense(e){var t;if(this.keySystem!==Gu.dn)return;const r=JSON.parse((new TextDecoder).decode(e)).keys.map(e=>{let{key_id:t,key:r}=e;return this.createClearKeyObject(t,r)}),i=(new TextEncoder).encode(JSON.stringify({keys:r}));await(null==(t=this.session)?void 0:t.update(i))}async generateRequest(e,t){let{initData:r,initDataType:i}=t;if(!this.isDestroyed)if(r)try{const t=ES.P.fromBase64(r).buffer;await e.generateRequest(i,t)}catch(io){const t=(0,Za.K)(io)?io.message:(0,qa.H)(io)?io:"";this.onError(Fl.from(io,{code:Ga.DRM_FAILED_TO_GENERATE_REQUEST,message:"Failed to generate request: "+t+"}",isFatal:!0}))}else this.onError(new Fl({code:Ga.DRM_NO_INIT_DATA,message:"No drm initialization data in initialization info",isFatal:!0}))}addEventListener(e,t,r,i){const n=(0,yh.O)(e,t,r,i);return this.addDestroyHandler(n),n}requestDrmProxy(e,t){return this.requestSync.waitAndLock(()=>new Promise((r,i)=>{(0,uS.W)(js({},e,{onSuccess:r,onError:(e,r)=>{const n=Ns(bS.x.fromUTF8(r.response),r.status),s=Ls(r.status,t);return this.requestSync.addLock((0,pS._)(s)),i(Os(n))}}))}))}handleSessionMessage(e,t,r,i,n){void 0===n&&(n=0);let s=i;const a=js({},r),o={method:"post",data:"",responseType:"arraybuffer",url:t,withCredentials:this.config.withCredentials};if(e===Gu.xE){const e=this.unpackPlayReadyRequest(i);o.headers=js({},e.headers,o.headers),delete o.headers["Content-Type"],s=e.data}if(this.keySystem===Gu.dn){const e=JSON.parse((new TextDecoder).decode(i));a.key_ids=e.kids}return o.data=(()=>{if(!r)return s;const e=js({},a,{rawLicenseRequestBase64:ES.P.toBase64(new Uint8Array(s))});return bS.x.toUTF8(JSON.stringify(e))})(),this.requestDrmProxy(o,n).catch(s=>{var a;const o=Fl.from(s),l=new Fl(js({},o.toJSON(),{isFatal:o.isFatal||n>3,code:null!=(a=o.details)&&a.drmProxyError?o.code:Ga.DRM_SESSION_ERROR,message:"Failed to handle session message: "+o}));if(this.onError(l),l.isFatal)throw l;return this.handleSessionMessage(e,t,r,i,n+1)})}unpackPlayReadyRequest(e){const t=bS.x.fromUTF16(e,!0,!0),r={};let i=e;if(!t.includes("PlayReadyKeyMessage"))return{headers:r,data:i};const n=(new DOMParser).parseFromString(t,"application/xml"),s=n.getElementsByTagName("HttpHeader");for(let o=0;o<s.length;++o){const e=s[o].getElementsByTagName("name")[0],t=s[o].getElementsByTagName("value")[0];e.textContent&&t.textContent&&(r[e.textContent]=t.textContent)}const a=n.getElementsByTagName("Challenge")[0];return a&&"base64encoded"===a.getAttribute("encoding")&&(i=ES.P.fromBase64(a.textContent).buffer),{headers:r,data:i}}getDrmKeySystem(e){var t,r,i;return null!=(t=e.servers)&&t[Gu.ly]?Gu.ly:null!=(r=e.servers)&&r[Gu.xE]?Gu.xE:null!=(i=e.servers)&&i[Gu.dn]?Gu.dn:null}async destroy(){super.destroy(),this.logEvent("DestroyDrmControllerCalled",void 0),this.currentDrmKeySystem=kg.none;try{var e,t;const r=df(1e3).promise;await Promise.race([Promise.all([null==(e=this.session)?void 0:e.closed,null==(t=this.session)?void 0:t.close()]),r])}catch(io){}if(this.session=void 0,""===this.video.src)try{await this.video.setMediaKeys(null)}catch(io){}this.logEvent("DestroyDrmController",void 0)}logEvent(e,t){this.onEvent({name:e,data:t})}}AS.mediaKeySystemAccessMap=new Map;class TS extends AS{constructor(e,t,r){super(e,t,r,t=>{null==e.yaspDispatchEvent||e.yaspDispatchEvent("yasp-event",t)}),this.drmInfoReceivedDeferred=new Zc.B,this.addEventListener(this.video,"yasp-drmInfoReceived",t=>{const r=t.detail.map(e=>{let{keySystem:t}=e;return t});null==e.yaspDispatchEvent||e.yaspDispatchEvent("yasp-event",{name:"DrmInfoReceived",data:{keySystems:r}}),this.drmInfoReceivedDeferred.resolve(t)},{once:!0})}async getMediaKeySessionInitData(){var e,t;const r=(await this.drmInfoReceivedDeferred.promise).detail.find(e=>e.keySystem===this.keySystem);if(!r)throw new Fl({code:Ga.DRM_INIT_ERROR,message:"No drm initialization info",isFatal:!0});if(null==(e=r.initData)||null==(t=e[0])||!t.initData)throw new Fl({code:Ga.DRM_INIT_ERROR,message:"No drm initialization data in initialization info",isFatal:!0});return r.initData[0]}}const _S={sourceLimit:Number.MAX_SAFE_INTEGER},wS=5*Math.random();var kS=r(1841);const RS=document.createElement("canvas"),PS=RS.getContext("2d");var CS=r(6702);class IS extends lS{constructor(e){super(e),this.props=e,this.engine=ql.YASP,this.yaspVideoElement=null,this.preloader=void 0,this.initEncoderPromise=void 0,this.drmController=void 0,this.targetLatency=(0,CS.c)(7),this.handleVideoTypeChange=e=>{let{detail:t}=e;const r=t;r&&this.emit("VideoTypeChange",r);const i=1e3*this.getUtcStartTime();switch(r){case jc.Z.LIVE:this.emit("ProgramDateTimeChange",0);break;case jc.Z.EVENT:this.emit("ProgramDateTimeChange",i);break;default:this.emit("ProgramDateTimeChange",i||void 0)}},this.handleYaspEvent=e=>{let{detail:{name:t,data:r}}=e;this.props.logEvent({event:t,params:r}),"YaspLargeGap"===t&&mf.log("-> Yasp LargeGapEvent",r)},this.handleTargetLatencyUpdate=e=>{let{detail:t}=e;this.targetLatency=t/1e3,this.emitTargetLatencyChanged()},this.handleDebug=e=>{let{detail:t}=e;"string"===typeof t&&mf.log("[PLAYER] [YASP]",t)},this.reportEmsg=e=>{const{startTime:t,messageData:r,segmentDuration:i}=e.detail,n=(0,vy.parseV2Tag)(r);n&&n.writer&&this.emit("MetadataChange",{fragmentMetadataArray:[n.writer],fragmentStart:t,fragmentDuration:i,src:this.getStreamUrl()})},this.reportError=e=>{const t=e.detail;if("YASP_FETCH_SEGMENT_BAD_HTTP_STATUS"===t.code||"YASP_FETCH_MANIFEST_BAD_HTTP_STATUS"===t.code){const e=(r=t.details.status,n="YASP_FETCH_MANIFEST_BAD_HTTP_STATUS"===t.code,451===r?n?Ga.REGIONAL_LIMITATION_MANIFEST:Ga.REGIONAL_LIMITATION_SEGMENT:_y.includes(r)?n?Ga.SIGNATURE_EXPIRED_MANIFEST:Ga.SIGNATURE_EXPIRED_SEGMENT:454===r?n?Ga.BANNED_MANIFEST:Ga.BANNED_SEGMENT:404===r&&n?Ga.MANIFEST_NOT_FOUND:void 0);e&&(t.code=e,t.category=i(e),t.isFatal=!0)}var r,n;this.props.onError(Fl.from(t))},function(e){try{if(!navigator.requestMediaKeySystemAccess)return;const t=Us(e);if(t===window)return;if(!t.navigator.requestMediaKeySystemAccess)return;navigator.requestMediaKeySystemAccess=function(){return t.navigator.requestMediaKeySystemAccess(...arguments)}}catch(TE){}}(this.video),this.initDetachedVideoElementErrorHandling()}async requestDebugInfo(){return this.yaspVideoElement&&this.yaspVideoElement.yasp?this.yaspVideoElement.yaspRequestDebugInfo():{noYasp:!0}}async attachEncoder(){this.initEncoderPromise=this.preventPauseAsync(this.video,async()=>{if(this.yaspVideoElement=py.attach(this.video,Hs({},_S,{perfLogUrl:this.props.perfLogUrl})),this.configureSource(this.getYaspConfig()),this.initTextTracks(),this.subscribeVideoTracksChange(),this.subscribeAudioTracksChange(),this.subscribeTextTracksChange(),this.yaspVideoElement.addEventListener("yasp-event",this.handleYaspEvent),this.yaspVideoElement.addEventListener("yasp-error",this.reportError),this.yaspVideoElement.addEventListener("yasp-debug",this.handleDebug),this.yaspVideoElement.addEventListener("yasp-videoTypeChange",this.handleVideoTypeChange),this.yaspVideoElement.addEventListener("yasp-emsg",this.reportEmsg),this.yaspVideoElement.addEventListener("yasp-updateTargetLatency",this.handleTargetLatencyUpdate),await super.attachEncoder(),this.preventPauseState){const e=this.yaspVideoElement.checkShouldPlay();this.preventPauseState.shouldPlayAfterEnd=null!=e?e:this.preventPauseState.shouldPlayAfterEnd}this.initVideoSizesUpdater()}),await this.initEncoderPromise,this.initEncoderPromise=void 0}async play(){return this.yaspVideoElement?(this.configureSource({videoSizes:this.getVideoElementSizes()}),this.yaspVideoElement.play()):super.play()}async detachEncoder(){var e,t,r,i;if(this.isRecoverablePlaylistHTTPStatus=!0,null==(e=this.yaspVideoElement)||e.removeEventListener("yasp-event",this.handleYaspEvent),null==(t=this.yaspVideoElement)||t.removeEventListener("yasp-error",this.reportError),null==(r=this.yaspVideoElement)||r.removeEventListener("yasp-debug",this.handleDebug),null==(i=this.yaspVideoElement)||i.removeEventListener("yasp-videoTypeChange",this.handleVideoTypeChange),this.initEncoderPromise)try{await this.initEncoderPromise}catch(io){}await this.preventPauseAsync(this.video,async()=>{this.yaspVideoElement=null,await super.detachEncoder()})}reportYaspUnexpectedMethodCall(e,t){const{encoderState:r}=this.state.controller;this.props.onError(new Fl({code:Ba.YASP_UNEXPECTED_METHOD_CALL,details:{encoderState:r,method:e,message:(0,Xa.V)(t)?t.message:void 0},isFatal:!1}))}isStalledLiveEdge(e){var t;if(!this.yaspVideoElement)return super.isStalledLiveEdge(e);const r=null!=(t=(0,Wa.Y)(()=>this.yaspVideoElement?this.yaspVideoElement.getStreamEndTime():null,e=>this.reportYaspUnexpectedMethodCall("getStreamEndTime",e)))?t:null;if(!r)return!1;const{controller:{videoType:i}}=this.state,{currentTime:n}=this.yaspVideoElement,s=e===Wl.X.BUFFERING,a=i===jc.Z.EVENT||i===jc.Z.LIVE;return s&&a&&r-n<2.5}handleVideoElementPlayEvent(){if(0!==this.video.buffered.length)return super.handleVideoElementPlayEvent()}async destroyUnsafe(){var e;const t=this.getStreamUrl();await super.destroyUnsafe(),this.props.feed||await py.releaseSrc(t),this.video.src&&this.video.removeAttribute("src"),await(null==(e=this.drmController)?void 0:e.destroy())}initDetachedVideoElementErrorHandling(){py.messenger.on("yasp-error",e=>{this.props.onError(Fl.from(e))}),this.once("Destroy",()=>py.messenger.off("yasp-error"))}initInternalSubscribe(){super.initInternalSubscribe(),this.on("InternalPlayingStateChange",e=>{var t;e===Wl.X.END&&(null==(t=this.yaspVideoElement)||t.forceTimeUpdate())}),this.addVideoEventListener("resize",()=>{const{videoTracks:e,videoWidth:t,videoHeight:r}=this.video,i=ws(Rs({videoTracks:e,videoWidth:t,videoHeight:r}));this.emit("InternalVideoTrackValueChange",i?i.value:void 0)}),this.addVideoEventListener("loadedmetadata",()=>{this.currentState===Wl.X.END&&this.video.paused&&0===this.video.currentTime&&this.seek(0)}),this.once("ContentImpression",()=>{var e,t;this.emit("DrmSystemChange",null!=(e=null==(t=this.drmController)?void 0:t.currentDrmKeySystem)?e:kg.none)})}setVideoTrack(e){if(!this.yaspVideoElement||!this.yaspVideoElement.videoTracks)return;const t=this.yaspVideoElement.videoTracks.getTrackById(e.value);t&&(t.selected=!0,this.stateController.putIsAbrEnabled(e.value===Hm.value),this.configureSource({userQuality:(0,SS.nK)(),maxAutoQuality:this.props.defaultQuality}))}getStreamUrl(){return En(super.getStreamUrl())}async initDrm(e){var t,r;if(!this.yaspVideoElement)return;if(!e)return void this.addEventListener(this.yaspVideoElement,"encrypted",()=>{this.props.onError(new Fl({code:Ga.NO_DRM_CONFIG,isFatal:!0}))},{once:!0});this.preloadSource();const i=(null==(t=this.playerStore.getState().controller.errorInfo.error)?void 0:t.category)===Ya.q.DRM;if(this.drmController&&!i)return;await(null==(r=this.drmController)?void 0:r.destroy());const n=Hs({},e,{withCredentials:this.withCredentials});this.drmController=new TS(this.video,n,e=>{this.props.onError(e)}),await this.drmController.init()}getMaxCapAllowedVideoTrack(){if("function"!==typeof py.getStats)return super.getMaxCapAllowedVideoTrack();const e=py.getStats()||{},{maxCapAllowedVideoTrack:t}=e;return t||super.getMaxCapAllowedVideoTrack()}seekInternal(e){const{start:t,end:r}=this.getSeekableRange();cs(this.video,zt(e,t,r||0))}getSeekableRange(){if(!this.video.seekable.length)return{start:0,end:this.getDuration()||0};return{start:this.video.seekable.start(0),end:this.video.seekable.end(0)}}updateSkinDvrParameters(e){const t=e/1e3,{skin:{skinDVRStartTime:r,skinDVRDuration:i},controller:{videoType:n,dvrDuration:s}}=this.state;if(n===jc.Z.LIVE){const e=r+t;this.playerStore.setSkinStateField(Nm.skinDVRStartTime,e),this.emit("DVRStartTimeChange",e)}else if(n===jc.Z.EVENT){const e=Math.min(i+t,s);this.playerStore.setSkinStateField(Nm.skinDVRDuration,e),this.emit("DVRDurationChange",e)}}startLatencyPolling(){}getDuration(){return this.video.duration}isLowLatencyLive(){return this.yaspVideoElement?this.yaspVideoElement.isLowLatencyLive():super.isLowLatencyLive()}getUtcStartTime(){var e;if(!this.yaspVideoElement)return super.getUtcStartTime();const t=null!=(e=(0,Wa.Y)(()=>this.yaspVideoElement?this.yaspVideoElement.getStartDate():null,e=>this.reportYaspUnexpectedMethodCall("getStartDate",e)))?e:null;if(!t)return super.getUtcStartTime();const r=t.getTime();return isNaN(r)?super.getUtcStartTime():r/1e3}onTick(e){const{controller:{videoType:t}}=this.state;t&&super.onTick(e)}getServerTime(){return this.yaspVideoElement?this.yaspVideoElement.getServerTime():super.getServerTime()}getFragmentsData(){const{start:e,end:t}=this.getSeekableRange();return{totalDuration:t-e,fragmentDuration:Pm,startTime:e}}isDvrEnabled(){return!0}getBandwidthEstimate(){if("function"!==typeof py.getStats)return super.getBandwidthEstimate();const e=py.getStats()||{},{bandwidth:t}=e;if(t){const e=hn(t);if(e&&(0,Hl.z)(e.value))return e}return super.getBandwidthEstimate()}canSeek(){const{video:e}=this.props;return e.readyState>0&&e.duration>0}async onVideoTagError(){if(this.state.controller.encoderState!==Cm.Attached)return super.onVideoTagError();const e=this.video.error;if(!e||!e.yaspError)return super.onVideoTagError();this.video.poster=uf,this.checkPlaylistHTTPStatus();const t=Fl.from(e.yaspError),r=await this.checkPlaylistHTTPStatusPromise;r&&r.isFatalError()?this.props.onError(r.toPlayerError()):this.props.onError(t)}initVideoTypeQualifier(){}configureSource(e){py.configureSource(this.getStreamUrl(),e)}async preloadSource(){if(this.isDestroyed||this.preloader&&!this.preloader.isDestroyed)return;const e=An({source:this.props,engine:this.engine,getState:()=>this.state,getCapSizes:()=>this.getCapSizes(),getVideoElementSizes:()=>this.getVideoElementSizes(),defaultQuality:this.props.defaultQuality});e&&(this.preloader=e,e.on("Destroy",()=>{this.preloader=void 0}),await e.preload(this.getYaspConfig()))}getYaspConfig(){var e;return{defaultBandwidthEstimate:null!=(e=py.getStats().bandwidth)?e:this.getBandwidthEstimate(),presentationDelay:1e3*(this.props.liveOffset+wS),userQuality:(0,SS.nK)(),maxAutoQuality:this.props.defaultQuality,withCredentials:this.props.sourceParams.withCredentials,skippableFragments:this.props.sourceParams.skippableFragments,maxStartTime:(0,kS.p)()}}captureScreenshot(){return(e=>{if(!PS||0===e.videoHeight||0===e.videoWidth)return Promise.reject();RS.width=e.videoWidth,RS.height=e.videoHeight;try{PS.drawImage(e,0,0,e.videoWidth,e.videoHeight)}catch(t){return Promise.reject(t)}return new Promise((e,r)=>{try{RS.toBlob(t=>{if(null===t)return r(new Error("Empty blob"));e(t)},"image/jpeg")}catch(t){r(t)}})})(this.video).then(e=>{this.previousScreenshotBlobUrl=URL.createObjectURL(e)}).catch(()=>{this.previousScreenshotBlobUrl=void 0}).then(()=>this.previousScreenshotBlobUrl)}initVideoSizesUpdater(){let e=NaN,t=NaN;this.configureSource({videoSizes:this.getVideoElementSizes()});const r=setInterval(()=>{const r=this.getVideoElementSizes(),{width:i,height:n}=r;i===e&&n===t||(e=i,t=n,(0,Wa.Y)(()=>{this.configureSource({videoSizes:r})},e=>{this.reportYaspUnexpectedMethodCall("configureSource",e)}))},1e3);this.once("Detach",()=>{clearInterval(r)})}shouldLogStalledDebugInfo(){return!0}estimateLatency(){}}const OS=p(window),DS={};var NS=r(4661),LS=r.n(NS);var xS=r(2741);const MS=[hf.midroll,hf.postroll,hf.preroll],FS=()=>Zs((e,t,r)=>{const i=function(e){const{ad:{nextAdInfo:t},controller:{videoType:r}}=e;if(void 0!==t&&("postroll"!==t.adBreakType||r===jc.Z.VOD))return t.remainingTime}(e.getState());t.callbacks.onNextAdRemainingTimeChange(i)});var VS=r(3487);const BS=["ewma","hlsjs","yabro"];var US=r(4204);const jS=()=>{let e=0;return(t,r)=>{const i=t.getState(),{ad:{adInfo:n,originalBroadcastAdCueId:s},controller:{watchedTime:a}}=i,o=lr(i);if(o&&ar(n)){const e=or(i,o);if(e){const{startProgramDateTime:i,startVideoTime:s,startTimestamp:a}=n.params,o=e.end+15,l=Date.now()/1e3-a,d=i+s;if(o<l+d){const e={utc:d+l,videoTime:(0,Hl.z)(s)?s+l:void 0};return t.setControllerStateField(Lm.startPosition,e),void r.stopAd({stopAdReason:pf.CutOff})}}}if(o===s)return;t.setAdStateField(Dm.originalBroadcastAdCueId,o);let l;void 0!==o?e=a:l=a-e,r.callbacks.onOriginalBroadcastAdStateChange({cueId:o,originalBroadcastAdDuration:l})}};var HS=r(6394);var WS=r(7154);class qS{constructor(e){let{playerApi:t,store:r}=e;this.playerApi=void 0,this.store=void 0,this.destroyed=!1,this.lastSourceId=void 0,this.prevVolumeInfoPayload=void 0,this.prevIsAbrEnabled=void 0,this.prevVideoTrackValue=void 0,this.waitingForVideoTracks=!1,this.currentPostPauserollInterval=void 0,this.watchedTimeCounter=void 0,this.effects={putAdblockDetected:Zs((e,t)=>{e.callbacks.onAdblockDetected(t)}),putVideoSize:Zs((e,t)=>{e.callbacks.onVideoSizeChange(t)}),putAudioTrackValue:Zs((e,t,r)=>{const i=e.getState();t.callbacks.onAudioTrackChange(Zr(i))}),putAudioTracks:Zs((e,t)=>{e.callbacks.onAudioTracksChange(t)}),putBufferingRanges:Zs((e,t)=>{e.callbacks.onBufferingRangesChange(t)}),putIsFullscreen:Zs((e,t,r)=>{t.callbacks.onFullScreenChange(r),Js(e,t),Qs(e,t)}),putTextTracks:Zs((e,t)=>{e.callbacks.onTextTracksChange(t)}),putStream:Zs((e,t)=>{e.callbacks.onChangeStream(t)}),putStreamsWithSupportInfo:Zs((e,t)=>{e.callbacks.onStreamsWithSupportInfoChange(t)}),putVideoType:Zs((e,t)=>{e.callbacks.onVideoTypeChange(t)}),putAdInfo:Zs((e,t)=>{t||e.updateVideoControllerNativeControlsVisibility()}),putNextAdInfo:FS(),putStartStage:Zs((e,t,r)=>{t.callbacks.onStartStageChange(r)}),putLastKnownBandwidthEstimate:Zs((e,t,r)=>{BS.includes(r.source)&&t.callbacks.onBandwidthEstimateChange(r)}),updateOriginalAdState:jS(),putResourcesIdle:Zs(async(e,t)=>{if(!t)return;e.callbacks.onResourcesIdle(),e.callbacks.logEvent({event:$d.ResourcesIdle,params:{}}),await(0,US._)(5e3);const r=(0,Wa.Y)(()=>(0,HS.getGpu)()),i=yi();e.callbacks.logEvent({event:$d.ClientInfo,params:{gpu:r?{renderer:r.renderer,vendor:r.vendor}:null,codecs:i}})})},this.putVolumeInfo=e=>{var t,r;(this.store.setVolumeInfo(e),t=this.prevVolumeInfoPayload,r=e,t.volume!==r.volume||t.muted!==r.muted)&&(this.prevVolumeInfoPayload=e,function(e,t){let{volume:r,muted:i,changeReason:n}=t;e.callbacks.onVolumeChange({volume:r,muted:i,changeReason:n})}(this.playerApi,e),Js(this.store,this.playerApi))},this.updateAdInfo=Zs(e=>{const{ad:{adInfo:t}}=this.store.getState();this.putAdInfo(e),function(e,t,r){r&&t&&r.adType!==t.adType?(e.callbacks.onAdStateChange({state:tu.NOT_PLAYING,type:r.adType,adParams:{}}),e.callbacks.onAdStateChange({state:tu.PLAYING,type:t.adType,adParams:{}})):r&&!t?e.callbacks.onAdStateChange({state:tu.NOT_PLAYING,type:r.adType,adParams:{}}):!r&&t&&e.callbacks.onAdStateChange({state:tu.PLAYING,type:t.adType,adParams:{}})}(this.playerApi,e,t),void 0!==e&&ar(e)&&this.requestMetaInfo(e,Qc.W)}),this.putInStreamPlayingState=Zs(e=>{this.store.setAdStateField(Dm.inStreamPlayingState,e),this.handlePlayingStateChange()},km.inStreamPlayingState),this.putPlayingState=Zs(e=>{this.store.setControllerStateField(Lm.playingState,e),this.handlePlayingStateChange(),this.handleMidroll(),Js(this.store,this.playerApi),this.handlePostPauseroll()},Im.playingState),this.putCurrentTime=Zs(e=>{this.store.setControllerStateField(Lm.currentTime,e),this.updateWatchedTime(),$s(this.store,this.playerApi),this.playerApi.callbacks.onCurrentTimeChange(e),this.store.setControllerStateField(Lm.currentTimeLowGranularity,ea(e))}),this.handleMidroll=function(e){let t=!1;return async function(){if(!t){t=!0;try{await e(...arguments)}finally{t=!1}}}}(async()=>{const e=this.store.getState(),{controller:{currentTimeLowGranularity:t,duration:r,videoType:i,watchedTime:n}}=e;if(isNaN(r))return;const s=this.playerApi.getMultiroll(),a={watchedTime:n,sourceWatchedTime:n,currentTime:t,duration:r,videoType:i||jc.Z.VOD},o=await s.midroll.loadViewers(a);if(this.destroyed)return;const l=s.getNextAdInfo(a);this.putNextAdInfo(l),o.length<=0||await this.playerApi.playAdViewers(hf.midroll,tr(o,hf.midroll),{})}),this.handlePostPauseroll=function(e){let t;const r=e=>{t=e};return function(){t&&(t(),t=void 0);for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return e(r,...n)}}(e=>{const{controller:{duration:t,playingState:r,watchedTime:i}}=this.store.getState();if(isNaN(t)||0===i||r!==Wl.X.PAUSE)return;if($r(this.store.getState()))return;const n=(0,xa.u)();let s;const a=async()=>{const e=n()/1e3,t=await this.playerApi.getMultiroll().postPauseroll.loadViewers({pausedTime:e});this.destroyed||this.currentPostPauserollInterval===s&&(0===t.length||this.playerApi.planAdViewers(tr(t,hf.postPauseroll)))};a(),s=window.setInterval(()=>{a()},15e3),e(()=>{clearInterval(s),this.currentPostPauserollInterval=void 0}),this.currentPostPauserollInterval=s}),this.putResourcesIdle=e=>{this.effects.putResourcesIdle(this.playerApi,e)},this.playerApi=t,this.store=r;const{controller:{volume:i,muted:n,isAbrEnabled:s,videoTrackValue:a}}=this.store.getState();this.prevVideoTrackValue={isAbrEnabled:s,videoTrackValue:a},this.prevIsAbrEnabled=s,this.prevVolumeInfoPayload={volume:i,muted:n,changeReason:void 0},this.watchedTimeCounter=new WS.p}refreshCue(e){let{cueId:t,start:r,end:i}=e;const{ad:{originalBroadcastAdCues:n}}=this.store.getState(),s=Td(n),a=s[t]||{start:r,end:i};void 0!==r&&(a.start=r),void 0!==i&&(a.end=i),s[t]=a,this.putOriginalBroadcastAdCues(s)}putOriginalBroadcastAdCues(e){this.store.setAdStateField(Dm.originalBroadcastAdCues,e),this.updateOriginalAdState()}putIsAbrEnabled(e){if(this.prevIsAbrEnabled===e)return;this.prevIsAbrEnabled=e,this.store.setIsAbrEnabled(e);const{controller:{videoTrackValue:t}}=this.store.getState();this.putVideoTrackParams({videoTrackValue:t,isAbrEnabled:e})}putVideoTracks(e){const t=[...e].sort(ia);this.store.setControllerStateField(Lm.videoTracks,t),this.waitingForVideoTracks&&this.handleVideoTrackChange(),this.playerApi.callbacks.onVideoTracksChange(t)}putVideoTrackParams(e){let{isAbrEnabled:t,videoTrackValue:r}=e;const i={isAbrEnabled:t,videoTrackValue:r};if(qd()(i,this.prevVideoTrackValue))return;this.store.setVideoTrackParams({videoTrackValue:r,isAbrEnabled:t}),this.prevVideoTrackValue=i;const{controller:{videoTracks:n}}=this.store.getState();0!==n.length||void 0===i.videoTrackValue?this.handleVideoTrackChange():this.waitingForVideoTracks=!0}async handleVideoTrackChange(){this.waitingForVideoTracks=!1,await(0,US._)(0),this.playerApi.callbacks.onVideoTrackChange(Jr(this.store.getState()))}handlePlayingStateChange(){const{controller:{playingState:e},ad:{inStreamPlayingState:t}}=this.store.getState();this.updateWatchedTime(),void 0===t||t===Wl.X.END?this.playerApi.callbacks.onStateChange(e):this.playerApi.callbacks.onStateChange(t)}async requestMetaInfo(e,t){if(await(0,US._)(5e3),this.destroyed)return;const r=this.store.getState(),{ad:{adInfo:i},controller:{stream:n}}=r,s=function(e){const{controller:{stream:t}}=e;if(t)return void 0!==t.metaInfoUrl?t.metaInfoUrl:Li(t.url)?ra(t.url).metaInfoUrl:void 0}(r);if(!i||!ar(i)||i.params.startTimestamp!==e.params.startTimestamp||!n||!s)return;const{startProgramDateTime:a,startVideoTime:o,startTimestamp:l}=i.params,d=a+o,u=d+300,c=Math.round(1e3*(d+(Date.now()/1e3-l))),h=Me(s,"video-timestamp",String(c));let p;try{if(p=await t({method:"GET",url:h}),this.destroyed)return}catch(y){return this.playerApi.callbacks.onError(new Fl({code:Ga.META_INFO_REQUEST_FAILED,details:{url:h},isFatal:!1}).toJSON()),void this.refreshCue({end:u,cueId:i.params.cueId})}const f=function(e){try{return(0,qa.H)(e)?JSON.parse(e):void 0}catch(io){return}}(p.responseText);if(!(0,Za.K)(f))return;const{cutoff:m,cue_id:g}=f;if(g!==i.params.cueId)return;const v=(0,Hl.z)(m)?(c+m)/1e3:u;this.refreshCue({end:v,cueId:g}),this.requestMetaInfo(e,t)}updateWatchedTime(){const{controller:{currentTime:e,playingState:t,playbackRate:r,sourceId:i}}=this.store.getState();this.lastSourceId!==i&&(this.watchedTimeCounter.restoreLastUpdate(),this.lastSourceId=i);const n=function(e){let{ad:{adInfo:t}}=e;return void 0!==t&&MS.includes(t.adType)}(this.store.getState());this.watchedTimeCounter.calc(e,r,t===Wl.X.PLAY&&!n),this.putWatchedTime(this.watchedTimeCounter.get())}async handlePostroll(){const e=this.playerApi.getMultiroll(),t=await e.postroll.loadViewers({});this.destroyed||(t.length>0&&await this.playerApi.playAdViewers(hf.postroll,tr(t,hf.postroll),{}),this.playerApi.stop(),this.putPlayingState(Wl.X.END))}handleVideoTagPlayingStateChange(e){const{controller:{playingState:t,watchedTime:r}}=this.store.getState();if(t===e||t===Wl.X.END&&e===Wl.X.PAUSE)return;if(e===Wl.X.BUFFERING)return void this.putPlayingState(Wl.X.BUFFERING);if(t===Wl.X.BUFFERING&&e===Wl.X.PAUSE&&0===r||this.putStartStage(Gd.started),e!==Wl.X.END)return void this.putPlayingState(e);const i=this.store.getState(),{ad:{adInfo:n}}=i;$r(i)?mf.log("putPlayingState("+Wl.X.END+") has not been dispatched because ad("+(n&&n.adType)+") is playing"):this.handlePostroll()}putAdblockDetected(e){this.store.setAdStateField(Dm.adblockDetected,e),this.effects.putAdblockDetected(this.playerApi,e)}putVideoSize(e){this.store.setVideoSize(e),this.effects.putVideoSize(this.playerApi,e)}putPlaybackRate(e,t){this.store.setControllerStateField(Lm.playbackRate,e),t!==xm.PlaybackRateCatchupSelection&&function(e,t){e.callbacks.onPlaybackRateChange(t)}(this.playerApi,e)}enableTextTrack(){Xs(this.store,this.playerApi)}putAudioTrackValue(e){this.store.setControllerStateField(Lm.audioTrackValue,e),this.effects.putAudioTrackValue(this.store,this.playerApi,e)}putAudioTracks(e){this.store.setControllerStateField(Lm.audioTracks,e),this.effects.putAudioTracks(this.playerApi,e)}putBufferingRanges(e){this.store.setControllerStateField(Lm.bufferingRanges,e),this.effects.putBufferingRanges(this.playerApi,e)}putErrorInfo(e){this.store.setControllerStateField(Lm.errorInfo,e),function(e,t){let{error:r}=t;if(void 0===r)return;const{code:i,isFatal:n,details:s}=r;n?(mf.error(i,s),e.setFullscreen(!1)):mf.warn(i,s),e.callbacks.onError(r.toJSON())}(this.playerApi,e)}putIsFullscreen(e){this.store.setControllerStateField(Lm.isFullscreen,e),this.effects.putIsFullscreen(this.store,this.playerApi,e)}putIsPip(e){this.store.setControllerStateField(Lm.isPip,e),Qs(this.store,this.playerApi)}putTextTrackEnabled(e){this.store.setControllerStateField(Lm.textTrackEnabled,e),Qs(this.store,this.playerApi)}putNativeTextTrackVisibility(e){this.store.setControllerStateField(Lm.nativeTextTrackVisible,e),Qs(this.store,this.playerApi)}putTextTracks(e){this.store.setControllerStateField(Lm.textTracks,e),this.effects.putTextTracks(this.playerApi,e)}putStream(e){this.store.setControllerStateField(Lm.stream,e),this.effects.putStream(this.playerApi,e)}putLastKnownBandwidthEstimate(e){this.store.setControllerStateField(Lm.lastKnownBandwidthEstimate,e),this.effects.putLastKnownBandwidthEstimate(this.store,this.playerApi,e)}putStreamsWithSupportInfo(e){this.store.setControllerStateField(Lm.streamsWithSupportInfo,e),this.effects.putStreamsWithSupportInfo(this.playerApi,e)}putVideoType(e){this.store.setControllerStateField(Lm.videoType,e),this.effects.putVideoType(this.playerApi,e)}putAdInfo(e){this.store.setAdStateField(Dm.adInfo,e),this.effects.putAdInfo(this.playerApi,e)}putNextAdInfo(e){this.store.setAdStateField(Dm.nextAdInfo,e),this.effects.putNextAdInfo(this.store,this.playerApi,e)}putWatchedTime(e){this.store.setControllerStateField(Lm.watchedTime,e),this.handleMidroll()}putStartStage(e){this.store.setControllerStateField(Lm.startStage,e),this.effects.putStartStage(this,this.playerApi,e)}putEncoderState(e){this.store.setControllerStateField(Lm.encoderState,e),function(e,t){const{controller:{encoderState:r}}=e.getState();r===Cm.Attached&&ta(e,t)}(this.store,this.playerApi)}putAutoplay(e){this.store.setControllerStateField(Lm.autoplay,e),ta(this.store,this.playerApi)}updateOriginalAdState(){this.effects.updateOriginalAdState(this.store,this.playerApi)}destroy(){this.destroyed=!0,clearInterval(this.currentPostPauserollInterval)}}let YS,GS;!function(e){e.ExternalApi="ExternalApi",e.InternalApi="InternalApi"}(YS||(YS={})),function(e){e.OnAdStart="OnAdStart",e.BeforeAdEnd="BeforeAdEnd",e.BeforeAdSkip="BeforeAdSkip"}(GS||(GS={}));class KS{constructor(e){let{initialState:t}=e;this.state=void 0,this.state=t}getState(){return this.state}removeCue(e){const{ad:t}=this.state,r=Td(t.originalBroadcastAdCues);delete r[e],t.originalBroadcastAdCues=r}updateSourceId(){const{controller:e}=this.state;e.sourceId=e.sourceId+1}setVolumeInfo(e){let{volume:t,muted:r}=e;const{controller:i}=this.state;i.volume=t,i.muted=r}setVideoSize(e){let{videoWidth:t,videoHeight:r}=e;const{controller:i}=this.state;i.videoWidth=t,i.videoHeight=r}setIsAbrEnabled(e){const{controller:t}=this.state;t.isAbrEnabled=t.isAbrSupported&&e}setIsAbrSupported(e){const{controller:t}=this.state;t.isAbrSupported=e,t.isAbrEnabled=t.isAbrEnabled&&e}setVideoTrackParams(e){let{isAbrEnabled:t,videoTrackValue:r}=e;const{controller:i}=this.state;i.videoTrackValue=r,i.isAbrEnabled=t&&i.isAbrSupported}setUserAudioTrackParams(e){let{name:t,lang:r}=e;const{controller:i}=this.state;i.userAudioTrackName=t,i.userAudioTrackLang=r}setUserTextTrackParams(e){let{enabled:t,name:r,lang:i}=e;const{controller:n}=this.state;n.userTextTrackEnabled=t,n.userTextTrackName=r,n.userTextTrackLang=i}setUserVideoTrackParams(e){let{name:t,height:r}=e;const{controller:i}=this.state;i.userVideoTrackName=t,i.userVideoTrackHeight=r}setErrorInfo(e){const{controller:t}=this.state;var r;(!e||(r=e,!(0,Au.Z)(r).length)||e.error&&e.error.isFatal)&&(t.errorInfo=e)}setSkinStateField(e,t){this.state.skin[e]=t}setAdStateField(e,t){this.state.ad[e]=t}setControllerStateField(e,t){const{controller:r}=this.state;r[e]=t}}const zS=function(e){return void 0===e&&(e=window),te(e)&&(0,Md.i)(e).toLowerCase().indexOf("iphone")>-1}(),ZS=Dd(),XS=!Vd&&sg("video/webm")?"data:video/webm;base64,GkXfowEAAAAAAAAfQoaBAUL3gQFC8oEEQvOBCEKChHdlYm1Ch4EEQoWBAhhTgGcBAAAAAAAByhFNm3RAHU27i1OrhBVJqWZTrIHlTbuMU6uEFlSua1OsggEj7AEAAAAAAAC5AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmAQAAAAAAADIq17GDD0JATYCNTGF2ZjU3Ljc2LjEwMFdBjUxhdmY1Ny43Ni4xMDBEiYhASwAAAAAAABZUrmsBAAAAAAAAYq4BAAAAAAAAWdeBAXPFgQGcgQAitZyDdW5khoZBX09QVVNWqoNjLqBWu4QExLQAg4EC4QEAAAAAAAARn4ECtYhA53AAAAAAAGJkgSBjopNPcHVzSGVhZAECOAGAuwAAAAAAH0O2dQEAAAAAAAAt54EAo4eBAACA/P/+o4eBABWA/P/+oAEAAAAAAAAPoYeBACkA/P/+daKDa3KD":"data:video/mp4;base64,AAAAHGZ0eXBpc29tAAACAGlzb21pc28ybXA0MQAAAAhmcmVlAAAAMm1kYXTeBABMYXZjNTcuMTA3LjEwMABCIAjBGDghEARgjBwhEARgjBwhEARgjBwAAAMbbW9vdgAAAGxtdmhkAAAAAAAAAAAAAAAAAAAD6AAAAEsAAQAAAQAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAkV0cmFrAAAAXHRraGQAAAADAAAAAAAAAAAAAAABAAAAAAAAAEsAAAAAAAAAAAAAAAEBAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAkZWR0cwAAABxlbHN0AAAAAAAAAAEAAAA1AAAEAAABAAAAAAG9bWRpYQAAACBtZGhkAAAAAAAAAAAAAAAAAAC7gAAADgZVxAAAAAAALWhkbHIAAAAAAAAAAHNvdW4AAAAAAAAAAAAAAABTb3VuZEhhbmRsZXIAAAABaG1pbmYAAAAQc21oZAAAAAAAAAAAAAAAJGRpbmYAAAAcZHJlZgAAAAAAAAABAAAADHVybCAAAAABAAABLHN0YmwAAABqc3RzZAAAAAAAAAABAAAAWm1wNGEAAAAAAAAAAQAAAAAAAAAAAAIAEAAAAAC7gAAAAAAANmVzZHMAAAAAA4CAgCUAAQAEgICAF0AVAAAAAAH0AAAAEYwFgICABRGQVuUABoCAgAECAAAAMHN0dHMAAAAAAAAABAAAAAEAAAQAAAAAAQAABBgAAAABAAAEAAAAAAEAAAHuAAAAHHN0c2MAAAAAAAAAAQAAAAEAAAAEAAAAAQAAACRzdHN6AAAAAAAAAAAAAAAEAAAAGAAAAAYAAAAGAAAABgAAABRzdGNvAAAAAAAAAAEAAAAsAAAAGnNncGQBAAAAcm9sbAAAAAIAAAAB//8AAAAcc2JncAAAAAByb2xsAAAAAQAAAAQAAAABAAAAYnVkdGEAAABabWV0YQAAAAAAAAAhaGRscgAAAAAAAAAAbWRpcmFwcGwAAAAAAAAAAAAAAAAtaWxzdAAAACWpdG9vAAAAHWRhdGEAAAABAAAAAExhdmY1Ny44My4xMDA=",QS=document.createElement("video"),JS=Vp(window);class $S extends Bc.v{get state(){return this.playerStore.getState()}constructor(e,t,r,i){var n;super(),n=this,this.plannedAdViewers=[],this.callbacks=void 0,this.videoController=void 0,this.multiroll=Yg,this.defineAutoplaySettingsDeferred=new Zc.B,this.abortRequestAutoplaySettings=Yl.Z,this.playbackProgressStorage=new Jg,this.visualState=void 0,this.container=void 0,this.video=void 0,this.videoSizeSensor=void 0,this.div=void 0,this.adDiv=void 0,this.playbackQualityController=void 0,this.playerStore=void 0,this.stateController=void 0,this.broadcastAd=void 0,this.playCallbacks=[],this.config=void 0,this.mediaInternalsHistory=void 0,this.currentAdPlaybackQueue=void 0,this.stopLoadSource=Yl.Z,this.onReady=void 0,this.playDeferred=void 0,this.becameStarting=!1,this.canMuteForPlay=!0,this.destroyed=!1,this.handleAdEnd=void 0,this.stopAd=()=>Promise.resolve(),this.setHiddenControls=e=>{e.indexOf(Tu.ALL)>-1?this.playerStore.setSkinStateField(Nm.hiddenControls,_u):this.playerStore.setSkinStateField(Nm.hiddenControls,e),this.videoController&&!this.playerStore.getState().ad.adInfo&&this.videoController.updateNativeControlsVisibility()},this.setPlaybackRate=e=>{var t;const{max:r,min:i}=function(e){let{controller:{videoType:t,currentTime:r},skin:{skinDVRStartTime:i,skinDVRDuration:n}}=e;return tt({videoType:t,currentTime:r,dvrStartTime:i,dvrDuration:n})}(this.state);null==(t=this.videoController)||t.setPlaybackRate(zt(e,i,r),xm.Other)},this.seek=function(e,t){let{videoTime:r,utc:i}=e;if(void 0===t&&(t=!1),"number"===typeof i){const e=i-n.videoController.getUtcStartTime();n.seekToVideoPosition(e,t)}else"number"===typeof r&&n.seekToVideoPosition(r,t)},this.setVolume=e=>{if(void 0===this.videoController)return this.stateController.putVolumeInfo({muted:this.state.controller.muted,volume:e,changeReason:iu.SetVolume}),void this.abortRequestAutoplaySettings(Mm.VolumeChange);const{muted:t,volume:r}=this.state.controller;let i=e,n=t;if(0===e){const{userVolume:e}=this.state.controller;i=e||r||1,n=!0}this.stateController.putVolumeInfo({volume:i,muted:n,changeReason:iu.SetVolume}),this.currentAdPlaybackQueue&&$r(this.state)?this.currentAdPlaybackQueue.setVolume(e):this.videoController&&(this.videoController.setVolume(i),this.videoController.setMuted(n))},this.setMuted=e=>{const t={volume:this.state.controller.volume,muted:e,changeReason:iu.SetMuted};if(!this.videoController)return this.stateController.putVolumeInfo(t),void this.abortRequestAutoplaySettings(Mm.MuteChange);this.stateController.putVolumeInfo(t),this.currentAdPlaybackQueue&&$r(this.state)?this.currentAdPlaybackQueue.setVolume(e?0:this.state.controller.volume):this.videoController&&this.videoController.setMuted(e)},this.playInrollAd=e=>{this.multiroll.inroll.schedule(ca({},e,{timeOffset:(null==e?void 0:e.timeOffset)||0}))},this.playAdViewers=async(e,t,r,i)=>{Yr("player.adsdk.empty."+e),Yr("player.adsdk.start."+e),Yr("player.adsdk.fail."+e);try{await this.initAdPlaybackQueue(e),await this.playAdViewersInternal(e,t,r,i)}catch(io){Yr("player.adsdk.fail."+e),li({reason:"PLAY_AD_VIEWERS_ERROR",adSdkVersion:mr(),adSdkLoaderVersion:fr(),adblockDetected:this.state.ad.adblockDetected,adType:e,bandwidth:Vi(void 0)}),this.onError(Fl.from(io,{code:Ga.PLAY_AD_VIEWERS_ERROR,isFatal:!1,details:{adType:e,adViewersWithData:t,adDisplayConfig:r}}))}},this.defineAutoplaySettingsAndLoadSource=()=>{const e=this.config.source,t=this.playerStore.getState(),{initialAutoplay:r,allowMuted:i,muted:s,volume:a,togglePlaybackOnVisibilityChangeSetting:o}=t.controller;this.defineAutoplaySettings(this.video,{autoplay:r,muted:s||0===a,allowMuted:!(!o||!o.forceAutoplay)||i}),this.loadSource(e,{shouldSaveProgress:!1}).catch(e=>{mf.error("load source error",e),Yi(e,ru.INIT),this.onError(e)}).then(()=>{this.onReady(),this.state.controller.autoplay||this.stateController.putResourcesIdle(!0)}).then(()=>{void 0!==e.params.adConfig&&(ef?(0,Qc.W)({method:"GET",url:$p,retries:2,checkStatus:e=>e>=200&&e<400}).then(e=>{if(-1===e.responseText.trim().indexOf('<VAST version="3.0">'))throw new Error("Invalid XML in response from ["+$p+"]")}):Promise.resolve()).catch((function(e){let{message:t}=void 0===e?{}:e;n.stateController.putAdblockDetected(!0),n.onError(new Fl({code:Ga.STRM_ABD_INVALID_RESPONSE,isFatal:!0,details:{reason:t}}))}))})},this.subscribeHandlers=()=>{this.on("VideoTypeChange",e=>{this.stateController.putVideoType(e)}),this.on("DurationChange",e=>{this.playerStore.setControllerStateField(Lm.duration,e),this.videoController.updateDVRParams(),this.updateVideoInfo()}),this.on("DvrChange",()=>{this.updateVideoInfo()}),this.on("ProgramDateTimeChange",e=>{this.playerStore.setControllerStateField(Lm.programDateTime,e)}),this.on("CurrentTimeChange",this.handleVideoControllerCurrentTimeChange),this.on("BufferingRangesChange",e=>{this.stateController.putBufferingRanges(e)}),this.on("VideoTrackValueChange",e=>{this.stateController.putVideoTrackParams({videoTrackValue:e,isAbrEnabled:this.state.controller.isAbrEnabled})}),this.on("VideoTracksChange",e=>{this.stateController.putVideoTracks(e)}),this.on("AudioTrackValueChange",e=>{this.stateController.putAudioTrackValue(e)}),this.on("AudioTracksChange",e=>{this.stateController.putAudioTracks(e)}),this.on("TextTrackValueChange",e=>{const{controller:{textTrackEnabled:t,textTrackValue:r}}=this.state,i=void 0!==e,n=void 0===e?r:e;this.stateController.putTextTrackEnabled(i),this.playerStore.setControllerStateField(Lm.textTrackValue,n);if((t?r:void 0)===(i?e:void 0))return;const s=i?Xr(this.state):void 0;this.callbacks.onTextTrackChange(s)}),this.on("TextTracksChange",e=>{this.stateController.putTextTracks(e)}),this.on("VideoPlayingStateChange",e=>{this.stateController.handleVideoTagPlayingStateChange(e)});const e=this.logCanPlay(ru.INIT);this.once("CanPlay",e),this.once("SetSource",()=>this.off("CanPlay",e));const t=this.logLoadStartHavingCurrentData(ru.INIT);this.once("LoadedData",t),this.once("SetSource",()=>this.off("LoadedData",t)),this.once("Destroy",()=>{this.off("ContentImpression")});const r=(0,Bl.Y)(this.getContainerDocument(),e=>{this.playerStore.setControllerStateField(Lm.isDocumentVisible,e)});var i;this.once("Destroy",r),this.once("Destroy",(i=e=>{this.callbacks.logEvent({event:$d.DrmSystemsSupportDetected,params:e})},void 0===Lg?(Ng.push(i),()=>{const e=Ng.indexOf(i);-1!==e&&Ng.splice(e,1)}):(i(Lg),Yl.Z)))},this.setBackgroundImage=e=>{this.div.style.backgroundImage=e?"url('"+e+"')":""},this.setBackgroundVisibility=e=>{this.div.style.backgroundSize=e?"contain":"0  0"},this.shouldCaptureScreenshot=()=>{var e;return(0,hu.RW)("web_yasp_screenshot_capturing")&&this.videoController&&this.videoController.engine===ql.YASP&&this.state.controller.videoType===jc.Z.VOD&&!(null!=(e=this.state.controller.stream)&&e.drmConfig)},this.playAdViewersInternal=async(e,t,r,i)=>{if(!this.currentAdPlaybackQueue)return;const n=this.currentAdPlaybackQueue,{ad:{adInfo:s}}=this.state,a=this.getAdViewersWithData(t),o=a.map(e=>{let{adViewer:t}=e;return t}),l=function(e){return e.reduce((e,t)=>e+Math.max(Math.floor(t.getAdPodsCount())),Math.max(Math.floor(0)))}(o);if(0===l)return Gr("player.adsdk.empty."+e),li({reason:"NO_AD_PODS_TO_PLAY_AD",adSdkVersion:mr(),adSdkLoaderVersion:fr(),adblockDetected:this.state.ad.adblockDetected,adType:e,bandwidth:Vi(void 0)}),void this.callbacks.logEvent({event:"NoAdPodsToPlayAd",params:void 0});s&&!i&&this.onError(new Fl({code:Ga.AD_IS_ALREADY_PLAYING,isFatal:!1,details:{currentAdType:s.adType,adType:e}})),this.prepareBeforeOrAfterAd(!1,e),this.callbacks.logEvent({event:"PlayAdViewers",params:{adType:e,adPodsCount:l}});const d=e===hf.inroll?{cueId:this.getAdViewersCueId(e,t),startProgramDateTime:this.state.controller.programDateTime/1e3,startVideoTime:this.videoController?this.videoController.getCurrentTime():this.state.controller.currentTime,startTimestamp:Date.now()/1e3}:{};let u=!1;const c=(0,La.I)(async t=>{let{stopAdReason:r}=t;this.shouldCaptureScreenshot()&&(this.resetPosterFitStyle(),this.setBackgroundVisibility(!0),this.once("CanPlay",()=>{this.setBackgroundImage(),this.videoController.clearScreenshot()}));const i=this.state.ad.inStreamPlayingState;u=!0,this.currentAdPlaybackQueue&&(this.currentAdPlaybackQueue.destroy(r),this.currentAdPlaybackQueue=void 0),this.stateController.updateAdInfo(void 0),this.callbacks.onExpectedStalledChange({reason:Bp.k.AdEnd,details:{adType:e}}),this.prepareBeforeOrAfterAd(!0,e);const n=async()=>{Yr("encoder.attach");try{await this.attachEncoder()}catch(io){mf.error(io)}finally{Gr("encoder.attach",{additional:{engine:this.state.controller.engine}})}};r!==pf.LoadSource&&r!==pf.PlayerDestroy&&await n(),e!==hf.postroll&&(mf.log("videoController.play()"),i!==Wl.X.PAUSE&&(0,Pd.v)(this.videoController.play()))});this.stopAd=c;const h=nr(o)+n.getQueueDuration(),p=this.currentAdPlaybackQueue.getUtcPositionBeforeAd(),f=this.getSeekPositionAfterAd({adType:e,adViewersDuration:h,utcPosition:p});this.playerStore.setControllerStateField(Lm.startPosition,f),this.prepareBeforeAd(e),(()=>{this.stateController.updateAdInfo({adType:e,params:d})})(),u||(a.forEach(t=>{let{adViewer:i,additionalData:s,adType:a}=t;n.playAdViewers({adType:e,adPodType:a,adViewer:i,additionalData:s,adDisplayConfig:r,adElement:this.adDiv,posterUrl:this.getPosterUrlForAd()})}),this.plannedAdViewers=[],await n.getDestroyPromise(),this.handleAdEnd&&await this.handleAdEnd(),u||await this.stopAd({stopAdReason:pf.AdCompleted}))},this.handleVideoControllerCurrentTimeChange=e=>{if(this.state.controller.encoderState!==Cm.Attached)return;!(e<.5&&this.state.controller.engine===ql.NATIVE&&this.state.controller.videoType===jc.Z.LIVE)&&(this.stateController.putCurrentTime(e),this.playerStore.getState().ad.adInfo||this.playbackProgressStorage.saveProgress(e)),this.videoController.updateDVRParams(),this.updateVideoInfo()},this.handleVisualStateChange=e=>{let{isPip:t,isFullScreen:r,isVisible:i}=e;this.stateController.putIsFullscreen(r);const{isSupportedPipMode:n,isYandexPipMode:s,isVisibilitySupported:a}=this.visualState;this.emit("VisualStateChange",ca({isPip:t,isVisible:i,isFullScreen:r,isSupportedPipMode:n,isYandexPipMode:s,isVisibilitySupported:a},this.videoSizeSensor.getSize())),n&&!s&&(this.stateController.putIsPip(t),a&&this.playerStore.setControllerStateField(Lm.isVisible,i))},this.onRecover=e=>{this.callbacks.onRecover(ca({},e,this.getSyncDebugInfo()))},this.logLoadStartHavingCurrentData=e=>()=>{if(!sf){if(this.video.readyState<this.video.HAVE_CURRENT_DATA){const t=this.logLoadStartHavingCurrentData(e);return this.once("LoadedData",t),void this.once("SetSource",()=>this.off("LoadedData",t))}this.isCanPlayAndStartHavingCurrentDataLog()&&this.emit("ContentImpression")}},this.logCanPlay=e=>()=>{sf||this.isCanPlayAndStartHavingCurrentDataLog()&&(this.callbacks.logEvent({event:$d.CanPlay,params:{stage:e}}),this.emit("ContentImpression"))},this.isCanPlayAndStartHavingCurrentDataLog=()=>!this.state.ad.hasPreroll&&this.state.controller.preload,this.startStream=()=>this.state.controller.encoderState===Cm.Attached?Promise.resolve():this.attachEncoder().catch(mf.error),this.handleFirstContentImpression=()=>{this.resetPosterFitStyle();const{controller:e}=this.playerStore.getState(),t=e.videoTracks.find(t=>{let{value:r}=t;return r===e.videoTrackValue});k({browserRtt:Ui((0,cf.n)()),calcRtt:Ui(Xi())}),ci(this.videoController.engine,{videoType:e.videoType,bandwidth:Vi(t&&t.bitrate),startWithCapping:ii(t,this.videoController)},this.state.ad.adSyncInit),this.callbacks.logEvent({event:$d.ContentImpression,params:{}}),this.callbacks.onContentImpression({hasPreroll:this.state.ad.adSyncInit,engine:this.state.controller.engine}),this.stateController.putResourcesIdle(!0),this.hidePoster()},this.setMaxListeners(14),this.container=e,this.config=t,this.onReady=(0,La.I)(i);const s=t.source,{params:a}=s,{additionalParams:o}=a,l=t.volume,{togglePlaybackOnVisibilityChange:d}=t;this.callbacks=t.callbacks;const{autoplay:u}=t,c=t.hidden;t.debug&&mf.enableConsole(),this.div=document.createElement("div"),this.div.className=LS().locals.StreamPlayer,(0,qa.H)(t.backgroundColor)&&(this.div.style.backgroundColor=t.backgroundColor),this.adDiv=document.createElement("div"),this.adDiv.className=LS().locals.StreamPlayer_ui,this.div.tabIndex=-1,this.container.appendChild(this.div),this.container.appendChild(this.adDiv);const h=Boolean(t.allowMuted),p=ca({},t);delete p.callbacks;const f={controller:ca({},Im,{autoplay:u,initialAutoplay:u,allowMuted:h,preload:t.preload,from:o.from,vsid:o.vsid,volume:t.volume,muted:t.muted,userVolume:void 0===t.volume?NaN:l,isFullscreen:!1,togglePlaybackOnVisibilityChangeSetting:d,isDocumentVisible:(0,Vl.s)(this.getContainerDocument()),isAbrEnabled:t.autoQuality,defaultQuality:t.defaultQuality,feed:t.feed,shouldEmitFrameRendered:t.shouldEmitFrameRendered,preview:a.preview,posterStyle:a.posterStyle,playerConfig:p}),ad:ca({},km,{adblockDetected:ef,nativeAdControlsVisibility:t.useNativeAdControls}),skin:ca({},Om,{hiddenControls:c,useNativeSubtitles:!0,nativeControlsVisibility:!er(c)})},m=new KS({initialState:f}),g=new qS({store:m,playerApi:this});this.playerStore=m,this.stateController=g,this.once("Destroy",()=>this.stateController.destroy()),this.updateRumInfo();const v=document.createElement("video");this.video=this.handleVideoNode(v),v.poster||(v.poster=uf),this.playbackQualityController=new kv(v),this.mediaInternalsHistory=new Xg(v);const y=de(v);this.div.appendChild(v),y();const S=this.getContainerDocument().getElementsByTagName("head")[0];Ot(LS().toString(),S),It(v,LS().locals.player__video),this.videoSizeSensor=new lf(v),(0,Wa.Y)(()=>(Yl.Z||window.Ya.Rum.sendHeroElement)()),v.setAttribute("playsinline","playsinline"),v.setAttribute("webkit-playsinline","webkit-playsinline"),this.visualState=r.visualState,this.visualState.setVideoElement(v),this.on("VisualStateChange",e=>{e&&this.callbacks.onVisualStateChange(e)});const E=function(e,t,r){let i,n=0;const s=function(){for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];e.call(r,...i)};return function(){const e=Date.now(),r=e-n;clearTimeout(i);for(var a=arguments.length,o=new Array(a),l=0;l<a;l++)o[l]=arguments[l];r<t?i=window.setTimeout(s,t-r,...o):(n=e,s(...o))}}(e=>{let{width:t,height:r}=e;this.emit("VisualStateChange",ca({},this.visualState.getState(),{width:t,height:r}))},500);this.videoSizeSensor.onResize.add(e=>{let{width:t,height:r}=e;return E({width:t,height:r})}),E(this.videoSizeSensor.getSize()),this.once("Destroy",()=>this.videoSizeSensor.destroy()),(!t.allowPip||d&&this.visualState.isYandexPipMode)&&Ki(window,!1,this.video),this.visualState.observe(this.handleVisualStateChange),this.handleVisualStateChange(this.visualState.getState()),this.defineAutoplaySettingsAndLoadSource(),this.initTelemetryTracking(),this.iosLandscapeScreenOrientationWorkaround(),Promise.resolve().then(()=>{this.initEventSubscribes(t,v)})}handleVideoNode(e){const{logEvent:t}=this.callbacks;return function(e,t,r,i){if(!py.isSupported())return e;if(py.isYaspElement(e))return e;const n=e=>{let{name:r,data:i}=e;return t({event:r,params:i})};return py.messenger.on("yasp-event",n),r(async()=>{py.isYaspElement(e)&&await e.detach(),py.messenger.off("yasp-event",n),(0,hu.RW)("web_destroy_yasp_only_with_no_instances")&&py.hasActiveInstance()||await py.destroy()}),py.attach(e,i)}(e,t,e=>{this.once("Destroy",e)},ca({},_S,{perfLogUrl:this.config.perfLogUrl}))}initTelemetryTracking(){this.callbacks.onCapSizeChange(this.getMaxCapAllowedVideoTrack());const e=()=>{const e=this.getMaxCapAllowedVideoTrack();this.callbacks.onCapSizeChange(e)},t=()=>{const e=this.getBandwidthEstimate();e&&this.callbacks.onBandwidthEstimateChange(e)},r=e=>{this.callbacks.onPlaybackQualityUpdate(e)};this.once("Destroy",()=>{this.off("CanPlay",t),this.off("CanPlay",e),this.off("VideoTracksChange",e),this.off("VisualStateChange",e),this.off("VideoTrackValueChange",e),this.off("PlaybackQualityUpdate",r)}),this.on("PlaybackQualityUpdate",r),this.on("CanPlay",t),this.on("CanPlay",e),this.on("VideoTracksChange",e),this.on("VisualStateChange",e),this.on("VideoTrackValueChange",e)}recoverStream(){return this.videoController?this.videoController.recoverStream():Promise.resolve()}getRecoverHelper(){var e;if(this.videoController)return null==(e=this.videoController)?void 0:e.recoverHelper}toggleNativeSubtitles(e){var t;null==(t=this.videoController)||t.toggleNativeSubtitles(e)}updateVideoControllerNativeControlsVisibility(){var e;null==(e=this.videoController)||e.updateNativeControlsVisibility()}getMultiroll(){return this.multiroll}setPictureInPictureEnabled(e){Ki(window,e,this.video)}getRemainingBufferedTime(){var e,t;return null!=(e=null==(t=this.videoController)?void 0:t.getRemainingBufferedTime())?e:{total:0}}getVideoPlaybackQuality(){return this.playbackQualityController.getPlaybackQuality()}getCapSizes(){var e;return null==(e=this.videoController)?void 0:e.getCapSizes()}getMaxCapAllowedVideoTrack(){if(this.videoController)return this.videoController.getMaxCapAllowedVideoTrack()}getContainerSize(){var e;const t=null!=(e=this.visualState.getPipWindowSize())?e:this.videoSizeSensor.getSize();return{width:t.width*devicePixelRatio,height:t.height*devicePixelRatio}}getVideoTrack(){return Jr(this.state)}getAudioTrack(){return Zr(this.state)}getTextTrack(){return function(e){const{textTrackEnabled:t}=e.controller;if(t)return Xr(e)}(this.state)}setNativeTextTrackVisibility(e){this.stateController.putNativeTextTrackVisibility(e)}setNativeAdControlsVisibility(e){this.playerStore.setAdStateField(Dm.nativeAdControlsVisibility,e)}getLiveLatency(){var e;return null==(e=this.videoController)?void 0:e.getLiveLatency()}getVideoType(){return this.state.controller.videoType}getTimelineInfo(){const{controller:{duration:e,currentTime:t},skin:{skinDVRStartTime:r,skinDVRDuration:i}}=this.state;return{currentTime:t,duration:e,utcStartTime:this.getUtcStartTime(),dvrStartTime:r,dvrDuration:i}}getBandwidthEstimate(){var e,t;return null!=(e=null==(t=this.videoController)?void 0:t.getBandwidthEstimate())?e:this.state.controller.lastKnownBandwidthEstimate}setVideoStyle(e){this.playerStore.setControllerStateField(Lm.videoElementStyle,e),ua(this.video,e)}setSource(e,t){let{shouldSaveProgress:r=!1}=void 0===t?{}:t;this.loadSource(e,{shouldSaveProgress:r}).catch(e=>{Yi(e,ru.SET_SOURCE),this.onError(e)}),this.emit("SetSource",e);const i=this.logCanPlay(ru.SET_SOURCE);this.once("CanPlay",i),this.once("SetSource",()=>this.off("CanPlay",i));const n=this.logLoadStartHavingCurrentData(ru.SET_SOURCE);this.once("LoadedData",n),this.once("SetSource",()=>this.off("LoadedData",n))}getSourceId(){return this.playerStore.getState().controller.sourceId}getUtcPosition(){var e,t;return null!=(e=null==(t=this.videoController)?void 0:t.getUtcPosition())?e:0}planAdViewers(e){this.plannedAdViewers=e}play(){var e,t;if(this.performPlayCallbacks(),(0,Pd.v)(this.video.play()),this.state.controller.startStage!==Gd.started&&this.stateController.putStartStage(this.becameStarting?Gd.starting:Gd.init),this.currentAdPlaybackQueue&&$r(this.state))return this.currentAdPlaybackQueue.resumeAd(),null==(e=this.playDeferred)||e.resolve(),Promise.resolve();if(this.plannedAdViewers.length>0)return this.playAdViewers(hf.postPauseroll,this.plannedAdViewers,{}),null==(t=this.playDeferred)||t.resolve(),Promise.resolve();if(this.state.controller.autoplay||(this.stateController.putAutoplay(!0),this.abortRequestAutoplaySettings(Mm.ApiPlay)),!this.videoController||this.state.controller.encoderState!==Cm.Attached)return this.playDeferred||(this.playDeferred=new Zc.B,this.playDeferred.promise.catch(Yl.Z).then(()=>this.playDeferred=void 0)),this.playDeferred.promise;const r=this.videoController.getCurrentTime(),i=this.videoController.getDuration();i>0&&r>=i&&this.seek({videoTime:0}),mf.log("StreamPlayer.play() -> videoController.play()");const n=this.state.controller.startStage===Gd.starting||this.state.controller.startStage===Gd.started?this.videoController.play():this.tryToPlay(this.videoController);return n.then(()=>{var e;return null==(e=this.playDeferred)?void 0:e.resolve()},()=>{var e;null==(e=this.playDeferred)||e.reject(void 0),this.state.controller.startStage===Gd.init&&this.stateController.putStartStage(Gd.waitForUserPlay)}),n}pause(){var e;oi(),this.stateController.putResourcesIdle(!0),this.emit("PauseCalled"),this.video.pause(),this.state.controller.startStage!==Gd.started&&(this.stateController.putAutoplay(!1),this.stateController.putStartStage(Gd.waitForUserPlay)),null==(e=this.playDeferred)||e.reject(new Error("playing rejected cause of #pause()")),this.currentAdPlaybackQueue&&$r(this.state)?this.currentAdPlaybackQueue.pauseAd():(this.stateController.putAutoplay(!1),this.videoController&&this.state.controller.encoderState===Cm.Attached&&this.videoController.pause())}setVideoTrack(e){const t=this.getVideoTrack();if(zs(t,e))return;this.stateController.putIsAbrEnabled(e===Hm.value);const r=e===Hm.value&&this.state.controller.isAbrSupported?Hm:this.state.controller.videoTracks.find(t=>t.value===String(e));if(r===Hm&&(0,hu.RW)("web_userquality_ttl")&&xS.ZP.removeItem("videoplayer-user-quality-choice"),r&&r!==Hm&&r.height&&r.width){const e={height:Math.min(r.height,r.width),width:Math.max(r.height,r.width)};(0,hu.RW)("web_userquality_ttl")&&(e.timestamp=Date.now()),xS.ZP.setItem("videoplayer-user-quality-choice",JSON.stringify(e))}this.playerStore.setUserVideoTrackParams({name:r&&r.value!==Hm.value&&r.name||void 0,height:r&&r.height?r.height:void 0}),r&&(this.videoController.setVideoTrack(r),this.callbacks.onExpectedStalledChange({reason:Bp.k.VideoTrackChange,details:{newTrack:r,oldTrack:t}}),mf.log("SELECTED VIDEO TRACK: ",r))}setAudioTrack(e){const t=this.getAudioTrack();if(zs(t,e))return;const r=this.state.controller.audioTracks.find(t=>t.value===String(e));r&&(this.playerStore.setUserAudioTrackParams({name:r.name||void 0,lang:r.lang||void 0}),this.videoController.setAudioTrack(r),this.callbacks.onExpectedStalledChange({reason:Bp.k.AudioTrackChange,details:{newTrack:r,oldTrack:t}}),mf.log("SELECTED AUDIO TRACK: ",r))}getSyncDebugInfo(){var e,t;return{recoverHelperState:null!=(e=null==(t=this.videoController)?void 0:t.getRecoverHelperState())?e:ig.OFF,state:this.state,remainingBufferedTime:ei(this.state),mediaInternalsHistory:this.mediaInternalsHistory.getHistory()}}async requestDebugInfo(){return ca({},this.getSyncDebugInfo(),{videoController:this.videoController?await this.videoController.requestDebugInfo():{noController:!0}})}getState(){return this.state}setTextTrack(e){const{textTracks:t,userTextTrackLang:r,userTextTrackName:i,textTrackEnabled:n,textTrackValue:s}=this.state.controller;if(n&&s===e)return;if(e===jm.A)return void this.stateController.enableTextTrack();const a=void 0===e?void 0:t.find(t=>t.value===e),o={enabled:Boolean(a),lang:a?a.lang||void 0:r,name:a?a.name||void 0:i};this.playerStore.setUserTextTrackParams(o),a?(this.videoController.setTextTrack(a),mf.log("SELECTED TEXT TRACK: ",a)):(this.videoController.disableTextTrack(),mf.log("DISABLE TEXT TRACK"))}setFullscreen(e){if(e)try{this.visualState.changeFullscreenState({isFullScreen:!0})}catch(io){mf.error("Request fullscreen for element:",io)}else try{this.visualState.changeFullscreenState({isFullScreen:!1})}catch(io){mf.error("Exit fullscreen for element:",io)}}async destroy(){this.stopAd({stopAdReason:pf.PlayerDestroy}),this.stopLoadSource(ng.destroy),this.multiroll.destroy(),this.currentAdPlaybackQueue&&this.currentAdPlaybackQueue.destroy(pf.PlayerDestroy),this.visualState.destroy(),this.mediaInternalsHistory.destroy(),this.playbackQualityController.destroy(),this.destroyed=!0,await this.destroyVideoController(),this.emit("Destroy"),function(e){for(;e.firstChild;)e.removeChild(e.firstChild)}(this.container)}skipAdPod(){var e;null==(e=this.currentAdPlaybackQueue)||e.skipAdPod()}stop(){this.seek({videoTime:0}),this.pause(),this.videoController.engine===ql.NATIVE&&0===this.video.buffered.length&&this.video.load()}preloadSource(e){this.callbacks.logEvent({event:$d.PreloadSource,params:{source:e,reason:YS.ExternalApi},sourceIndex:e.sourceIndex});let t=Yl.Z,r=Yl.Z,i=!1;return{promise:this.preloadSourceImpl(e,()=>i,e=>t=e,e=>r=e),abort:()=>{i||(i=!0,t())},end:()=>{i||(i=!0,r())}}}initEventSubscribes(e,t){this.waitForPlayOccurred().then(()=>{const{startStage:e}=this.state.controller;[Gd.started,Gd.broken,Gd.destroyed].includes(e)||(this.stateController.putStartStage(Gd.starting),this.becameStarting=!0)}).catch(Yl.Z),Jh&&this.once("Destroy",Mt(()=>this.destroy())),this.once("Destroy",(0,yh.O)(this.div,"selectstart",e=>{e.preventDefault(),e.stopPropagation()})),this.once("Destroy",Zt(()=>{this.stateController.updateOriginalAdState()})),this.once("Destroy",(0,yh.O)(this.getMainContainer(),"click",t=>{this.state.controller.watchedTime>0||void 0===this.state.ad.inStreamPlayingState&&e.shouldPlayOnFirstClick&&this.play()},{once:!0})),Jh&&this.once("Destroy",Mt(()=>this.destroy())),this.once("Destroy",()=>this.off("VisualStateChange")),this.once("Destroy",(0,yh.O)(this.video,"volumechange",()=>{(this.videoController||this.currentAdPlaybackQueue)&&this.updateVolumeInfo()})),this.subscribeHandlers()}updateRumInfo(){const{controller:e}=this.state;k({apiVersion:2,bundle:"modern",slowConnection:this.config.slowConnection,vsid:e.vsid,from:e.from,saveData:(0,zg.R)()})}requestAutoplaySettings(e,t){const r={stopped:!1},i=()=>{r.stopped=!0},n=la(e,{initialMuted:t.muted,checkUnmuted:t.autoplay&&!t.muted,checkMuted:t.autoplay&&(t.muted||t.allowMuted),process:r});return kd(n)?{promise:n.then(e=>({autoplay:e.allowed,muted:e.muted||t.muted,detectionMethod:e.detectionMethod})),abort:i}:{promise:{autoplay:n.allowed,muted:n.muted||t.muted,detectionMethod:n.detectionMethod},abort:i}}defineAutoplaySettings(e,t){if(this.state.controller.autoplay&&!this.state.controller.isDocumentVisible)return this.stateController.putStartStage(Gd.waitForDocumentVisibility),this.stateController.putAutoplay(!1),void this.defineAutoplaySettingsDeferred.resolve();let r;L("detect.autoplay");const{promise:i,abort:n}=this.requestAutoplaySettings(e,t);kd(i)?i.then(()=>{x("detect.autoplay")}):x("detect.autoplay");const{promise:s,clear:a}=df(500);s.then(()=>{this.state.controller.startStage===Gd.init&&this.stateController.putStartStage(Gd.waitForUserPlay)});const o=(0,xa.u)();this.abortRequestAutoplaySettings=e=>{void 0===r&&this.callbacks.logEvent({event:"PlayWithoutRAAResults",params:{delay:o(),reason:e}}),a(),n()};const l=e=>{r=e,this.callbacks.logEvent({event:e.autoplay?"AutoplayAllowed":"AutoplayDisabled",params:{message:JSON.stringify(null!=e?e:t),autoplaySettingsRequestResult:e,initialAutoplayParams:t}}),a();const{isVisible:i}=this.state.controller;mf.log("Autoplay settings defined",r);const{muted:n,autoplay:s,autoplayImpossible:o,requireAllowMutedToAutoplay:l}=(()=>{const i=e.muted&&(t.muted||t.allowMuted),n=e.autoplay&&(e.muted?i:t.autoplay);return ca({},r,{muted:i,autoplay:n})})();this.stateController.putVolumeInfo({muted:n,volume:this.state.controller.volume,changeReason:iu.RequestAutoplaySettings});const d=function(e){const{controller:{togglePlaybackOnVisibilityChangeSetting:t,muted:r}}=e;return!!t&&!(t.onlyMuted&&!r)}(this.state)&&!1===i;d&&this.callbacks.logEvent({event:"HiddenAutoplayPrevented",params:{autoplaySettingsRequestResult:r}});const u=s&&!d&&this.state.controller.autoplay;var c;(mf.log("autoplay status:",s),mf.log("isVisible",i),mf.log("preventHiddenAutoplay",d),u||this.stateController.putStartStage(Gd.waitForUserPlay),u)?this.playerStore.setControllerStateField(Lm.preload,!0):(oi(),null==(c=this.playDeferred)||c.reject(new Error("playing rejected cause of autoplay-false")));if(this.playerStore.setControllerStateField(Lm.autoplay,u),o){this.playerStore.setControllerStateField(Lm.autoplayImpossible,!0),this.callbacks.logEvent({event:"AutoplayImpossible",params:{message:JSON.stringify(r),autoplaySettingsRequestResult:r}});try{console.warn("Cannot autoplay video"+(l?" with sound":"")+" in this environment."+(l?" Use autoplay={allowMuted: true} if you prefer mute video and enable autoplay.":""))}catch(TE){}}};if(kd(i))i.then(l).catch(Yl.Z).then(()=>{this.defineAutoplaySettingsDeferred.resolve()});else try{l(i)}finally{this.defineAutoplaySettingsDeferred.resolve()}}createVideoController(e,t){let{stream:r,supportInfo:i}=e;const n={playerStore:this.playerStore,stateController:this.stateController,video:this.video,videoSizeSensor:this.videoSizeSensor,stream:r,sourceParams:t,debug:this.config.debug,liveOffset:this.config.liveOffset,slowConnection:this.config.slowConnection,maxBufferLength:this.config.maxBufferLength,defaultQuality:this.state.controller.defaultQuality,skippableFragments:t.skippableFragments,feed:t.feed,shouldEmitFrameRendered:t.shouldEmitFrameRendered,bandwidthEstimateOffset:this.config.bandwidthEstimateOffset,perfLogUrl:this.config.perfLogUrl,setPlayerBackgroundImage:this.setBackgroundImage,setPlayerBackgroundVisibility:this.setBackgroundVisibility,onError:e=>this.onError(e),onRecover:this.onRecover,logEvent:this.callbacks.logEvent,onSubtitlesChange:this.callbacks.onSubtitlesChange,onThumbnailTileGeneralMetaInfoChange:this.callbacks.onThumbnailTileGeneralMetaInfoChange,onExpectedStalledChange:this.callbacks.onExpectedStalledChange,getPipWindowSize:()=>this.visualState.getPipWindowSize()},s=(a=i.engine,o=n,a===ql.HLS?new rS(o):a===ql.MP4?new dS(o):a===ql.YASP?new IS(o):new yS(o));var a,o;const l=e=>{this.videoController=e,this.playerStore.setControllerStateField(Lm.engine,i.engine),this.callbacks.onEngineChange(i.engine,this.playerStore.getState().controller.sourceId),R("engine",i.engine),e.on("VideoPlayingStateChange",e=>this.emit("VideoPlayingStateChange",e)),e.on("MetadataChange",e=>this.emit("MetadataChange",e)),e.on("CurrentTimeChange",e=>this.emit("CurrentTimeChange",e)),e.on("FrameRendered",e=>{this.callbacks.onFrameRendered(e)}),e.on("TargetLatencyChanged",e=>{this.callbacks.onTargetLatencyChange(e)}),e.on("DurationChange",e=>this.emit("DurationChange",e)),e.on("DvrChange",()=>this.emit("DvrChange")),e.on("DVRDurationChange",e=>this.callbacks.onDVRDurationChange(e)),e.on("DVRStartTimeChange",e=>this.callbacks.onDVRStartTimeChange(e)),e.on("ProgramDateTimeChange",e=>this.emit("ProgramDateTimeChange",e)),e.on("BufferingRangesChange",e=>this.emit("BufferingRangesChange",e)),e.on("CanPlay",()=>this.emit("CanPlay")),e.on("ContentImpression",()=>this.emit("ContentImpression")),e.on("DrmSystemChange",this.callbacks.onDrmSystemChange),e.on("LoadedData",()=>this.emit("LoadedData")),e.on("VideoTypeChange",e=>this.emit("VideoTypeChange",e)),e.on("VideoTrackValueChange",e=>{this.emit("VideoTrackValueChange",e)}),e.on("AudioTrackValueChange",e=>this.emit("AudioTrackValueChange",e)),e.on("TextTrackValueChange",e=>this.emit("TextTrackValueChange",e)),e.on("VideoTracksChange",e=>this.emit("VideoTracksChange",e)),e.on("AudioTracksChange",e=>this.emit("AudioTracksChange",e)),e.on("TextTracksChange",e=>this.emit("TextTracksChange",e))};return kd(s)?Promise.resolve().then(async()=>l(await s)):l(s)}getPreparedSourceParams(e,t,r){return ca({},Fm,t,{startPosition:this.getInitialStartPosition(t,r),withCredentials:Bi(e,t)})}getInitialStartPosition(e,t){const r=e&&e.startPosition||Fm.startPosition;if(r){if((0,Au.Z)(r).some(e=>(0,Hl.z)(r[e])))return r}const i=null==t?void 0:t.getProgress();return void 0===i?r:{videoTime:i}}async loadSource(e,t){let{shouldSaveProgress:r}=t;mf.log("loadSource start",e),this.callbacks.onEngineChange(void 0,this.playerStore.getState().controller.sourceId),this.callbacks.onDrmSystemChange(void 0);const i=r?"LoadSourceWithSaveProgress":"LoadSource";this.callbacks.logEvent({event:i,params:{source:e}}),di(),this.shouldCaptureScreenshot()&&(this.setBackgroundImage(),this.setBackgroundVisibility(!1),this.videoController.clearScreenshot()),this.stopAd({stopAdReason:pf.LoadSource}),this.plannedAdViewers=[],this.stopLoadSource(ng.setSource),this.playbackProgressStorage.clearVideoContentId(),this.stateController.putStreamsWithSupportInfo(void 0),this.stateController.putStream(void 0),this.playerStore.setControllerStateField(Lm.sourceParams,void 0),this.playerStore.setControllerStateField(Lm.streams,e.streams),this.stateController.putResourcesIdle(!1);const{preferredAudioLangs:n,preferredTextLangs:s}=e.params.preferredTracks;n.length>0&&this.playerStore.setUserAudioTrackParams({lang:n[0],name:void 0}),s.length>0&&this.playerStore.setUserTextTrackParams({lang:s[0],name:void 0,enabled:!0});const a=new Rf;this.stopLoadSource=e=>a.stop(e);try{this.multiroll.destroy()}catch(E){!function(e,t){(0,Wa.Y)(()=>(ed.Z||window.Ya.Rum.logError)(ri({},e,{additional:w()}),(0,Za.K)(t)?t:new Error("NOT_AN_OBJECT_ERROR")))}({message:"Can not destroy multiroll instance",method:"loadSource",source:"multiroll",sourceMethod:"destroy",type:"logic"},E)}this.multiroll=Yg;const o=!this.videoController,{streams:l}=e,d=Ni({streams:l,video:this.video,preferNative:this.config.preferNative}),u=Fi(e.params),c=function(e){return(0,Za.K)(e)&&!1===e.hasPreroll}(u);this.playerStore.setAdStateField(Dm.adSyncInit,(0,Za.K)(u)&&(!c||!1!==u.hasPreroll));let h=c?null:this.initMultirollModule(u,a);R("hasPreroll",!c);const p=this.destroyVideoController(),f=await d;if(this.stateController.putStreamsWithSupportInfo(f.streamsWithSupportInfo),a.stopReason)return void this.callbacks.logEvent({event:$d.StreamStopWhileChoosingStream,params:void 0});if("error"===f.status)throw f.error;const{supportedStream:m}=f;Ys(m,{perfLogUrl:this.config.perfLogUrl});const{stream:g}=m;this.playbackProgressStorage.setVideoContentId(this.config.restoreTabSessionPlaybackProgress?e.params.videoInfo.videoContentId:void 0);const v=this.getPreparedSourceParams(g,e.params,this.playbackProgressStorage);if(await p,a.stopReason)return void this.callbacks.logEvent({event:$d.StreamStopWhileDestroyVideoController,params:void 0});if(this.resetPlayerStore(g,v,{shouldSaveProgress:r,isFirstLoad:o}),await Promise.race([this.defineAutoplaySettingsDeferred.promise,a.stopPromise]),a.stopReason)return void this.callbacks.logEvent({event:$d.StreamStopDuringDefineAutoplaySettings,params:void 0});const y=this.createVideoController(m,v);if(kd(y)&&(await Promise.race([y,a.stopPromise]),a.stopReason))return;R("bandwidthEstimate",Vi(this.videoController.getBandwidthEstimate().value/1e3)),R("drm","none"),o?(Promise.resolve().then(()=>{this.initBroadcastAd()}),xi(g.url,Boolean(v.withCredentials)).then(e=>{this.stateController.putAdblockDetected(e||ef)}),this.setMuted(this.state.controller.muted),this.setVolume(this.state.controller.volume)):this.prepareNextSource(g,v),this.playerStore.getState().skin.nativeControlsVisibility&&this.setPosterFitStyle(),this.once("ContentImpression",this.handleFirstContentImpression),this.once("SetSource",()=>this.off("ContentImpression",this.handleFirstContentImpression));const S=async()=>{h||(h=this.initMultirollModule(u,a));const e=await h;if(a.stopReason)return this.callbacks.logEvent({event:$d.StreamStopWhileLoadingMultiroll,params:{streamStopReason:a.stopReason}}),void e.destroy();this.multiroll=e};if(c){const{adInitOffset:e=0}=u||{};new Promise(t=>{let r=!1;const i=()=>{this.off("CurrentTimeChange",n),this.off("ContentImpression",s)},n=()=>{if(!r)return;this.state.controller.watchedTime<=e||(i(),t())},s=()=>r=!0;this.on("ContentImpression",s),this.on("CurrentTimeChange",n),this.once("SetSource",i)}).then(()=>{a.stopReason||S()})}else await S();a.stopReason||this.startPrerollAndContent(a,o)}async preloadSourceImpl(e,t,r,i){const{streams:n}=e,s=Ni({streams:n,video:QS,preferNative:this.config.preferNative}),a=await s;if(t())throw new Error("abort preloadSource");if("error"===a.status)throw a.error;const{supportedStream:o}=a,{stream:l,supportInfo:d}=o;if(d.engine!==ql.YASP)throw new Error("can not create preloader");const u=new Jg;u.setVideoContentId(this.config.restoreTabSessionPlaybackProgress?e.params.videoInfo.videoContentId:void 0);const c=this.getPreparedSourceParams(l,e.params,u);Ys(o,{perfLogUrl:this.config.perfLogUrl});const h=An({engine:d.engine,source:{stream:l,sourceParams:c},getState:()=>this.playerStore.getState(),getCapSizes:()=>{var e;return null==(e=this.videoController)?void 0:e.getCapSizes()},getVideoElementSizes:()=>{var e;return null==(e=this.videoController)?void 0:e.getVideoElementSizes()},defaultQuality:this.config.defaultQuality});if(!h)throw new Error("can not create preloader");return r(()=>h.destroy()),i(()=>h.destroy()),h.preload()}async initMultirollModule(e,t){let r=Yg;if(!e)return r;ui("AD",!0);try{const i=zr(window,e,this.state.controller.vsid,ef),n=await Promise.race([i,t.stopPromise.then(()=>{})]);if(void 0===n)return r;const{loadMultiroll:s}=n,a=s(ca({},e,{secureMode:"Safe"}),{preroll:{shouldPreload:()=>{const{preload:e,startStage:t}=this.state.controller;return e&&(t===Gd.waitForUserPlay||t===Gd.waitForDocumentVisibility)}},midroll:{preloadOffset:20,preloadMinTime:5},postroll:{preloadOffset:20,preloadMinTime:5},getPreloadParams:()=>{const e={videoSlot:this.video},t=this.getBandwidthEstimate();return null!=t&&t.value?ca({},e,{desiredBitrate:t.value/1e3}):e},adLoaded:e=>{let{adBreakType:t}=e;const r=(()=>{switch(t){case hf.preroll:return hf.preroll;case hf.midroll:return hf.midroll;case hf.postroll:return hf.postroll;case hf.inroll:return hf.inroll;case hf.postPauseroll:return hf.postPauseroll}})();void 0!==r&&this.callbacks.onAdLoaded({adType:r})}});(0,Pd.v)(t.stopPromise.then(()=>a).then(e=>e.destroy()));const o=await Promise.race([a,t.stopPromise.then(()=>{})]);if(void 0===o)return r;r=o}catch(i){li({reason:"MULTIROLL_INIT_ERROR",adSdkVersion:mr(),adSdkLoaderVersion:fr(),adblockDetected:this.state.ad.adblockDetected,bandwidth:Vi(void 0)});const t=new Fl({isFatal:(0,Ql.m)(JS)&&(!(0,Za.K)(i)||"0"===String(i.code)||!i.code),code:Ga.MULTIROLL_INIT_ERROR,details:{error:i,adConfig:e}});this.callbacks.onAdError(ca({},t,{code:String(t.code)})),this.onError(t)}return r}async startPrerollAndContent(e,t){mf.log("startPrerollAndContent");let r=[];const i=(0,La.I)(()=>this.startStream()),n=(0,La.I)(async()=>{this.multiroll!==Yg&&Yr("adsdk.loadviewers.preroll");const t=this.multiroll.preroll.loadViewers({}),i=await Promise.race([t,e.stopPromise.then(()=>{})]);if(void 0===i)return;r=i,this.multiroll!==Yg&&Gr("adsdk.loadviewers.preroll");const n=r.length>0;this.playerStore.setAdStateField(Dm.hasPreroll,n),n&&this.callbacks.logEvent({event:$d.PrerollInit,params:{}})}),{startStage:s,preload:a}=this.state.controller;if(s===Gd.waitForUserPlay||s===Gd.waitForDocumentVisibility){if(mf.log("Waiting for "+(s===Gd.waitForUserPlay?"user gesture":"document visibility")),this.callbacks.logEvent({event:s===Gd.waitForUserPlay?$d.WaitForUserGesture:$d.WaitForDocumentVisibility,params:{preload:a}}),a){if(mf.log("Preload preroll in player"),await Promise.race([n(),e.stopPromise]),e.stopReason)return void this.callbacks.logEvent({event:$d.StreamStopWhilePreloadingPreroll,params:{streamStopReason:e.stopReason}});this.state.ad.hasPreroll||(mf.log("No preroll, preload content"),i())}if(s===Gd.waitForDocumentVisibility&&await function(e,t){return(0,Vl.s)(e)===t?Promise.resolve():new Promise(r=>{(0,Bl.Y)(e,e=>{e===t&&r()})})}(this.getContainerDocument(),!0),this.state.controller.startStage===Gd.waitForUserPlay&&await this.waitForPlay(),e.stopReason)return void this.callbacks.logEvent({event:s===Gd.waitForUserPlay?$d.StreamStopWhileWaitingForPlay:$d.StreamStopWhileWaitingForDocumentVisibility,params:{streamStopReason:e.stopReason}})}if(mf.log("Start playing"),t&&this.stateController.putAutoplay(!0),await Promise.race([n(),e.stopPromise]),e.stopReason)this.callbacks.logEvent({event:$d.StreamStopWhileLoadingPreroll,params:{streamStopReason:e.stopReason}});else{if(!this.state.ad.hasPreroll)return await i(),void this.logPlayAfterWaitingForDocumentVisibility();this.playerStore.setControllerStateField(Lm.preload,!0),mf.log("Start preroll"),this.playAdViewers(hf.preroll,tr(r,hf.preroll),{videoSlotCanAutoPlay:s!==Gd.waitForDocumentVisibility||void 0})}}waitForPlay(){const e=(0,xa.u)();return new Promise(t=>{this.waitForPlayOccurred().then(r=>{this.callbacks.logEvent({event:$d.WaitForPlayCompleted,params:{reason:r,timeout:e()}}),t()}).catch(Yl.Z),this.playCallbacks.push(t)})}async waitForPlayOccurred(){return new Promise((e,t)=>{let r=Yl.Z,i=Yl.Z,n=0;const s=()=>{r(),i(),clearInterval(n)},a=t=>{void 0!==this.videoController&&(s(),e(t))};this.video.paused?(r=(0,yh.O)(this.video,"play",()=>{a(Wm.VideoPlayEvent)}),i=(0,yh.O)(this.video,"timeupdate",()=>{this.video.paused||a(Wm.DetectByInterval)}),n=window.setInterval(()=>{this.video.paused||a(Wm.DetectByInterval)},100),this.once("Destroy",()=>{s(),t()})):a(Wm.VideoIsNotPausedOnInit)})}initBroadcastAd(){const{video:e}=this;if(this.broadcastAd=new kf({video:e,slot:e.parentElement,playerApi:this,stateController:this.stateController,onError:e=>this.onError(e),playerStore:this.playerStore}),this.videoController&&this.videoController.engine===ql.NATIVE){let t=0;e.addEventListener("timeupdate",()=>{const{currentTime:r}=e;this.state.controller.videoType===jc.Z.LIVE&&r<t&&this.broadcastAd&&this.stateController.putOriginalBroadcastAdCues({}),t=r})}this.on("MetadataChange",e=>{const{fragmentMetadataArray:t,fragmentStart:r}=e;if(mf.log("receive metadata: ",t),!this.broadcastAd)return;const{programDateTime:i}=this.state.controller;if(void 0===i)return;const n=i+1e3*r;let s;Math.random()<.01&&this.callbacks.logEvent({event:$d.StreamPlayerReceivedMetadata,params:e}),t.forEach(e=>{try{const t=JSON.parse(e);if(!function(e){return(0,Za.K)(e)&&(0,qa.H)(e.cue_id)&&(0,Hl.z)(e.offset)}(t))return;s=ca({},t,{pts:n})}catch(io){mf.log("metadata is not valid ["+e+"]")}}),s&&(this.callbacks.onInrollFrame(s),this.state.ad.adConfig&&this.broadcastAd.handleInrollFrame(s).catch(e=>{mf.error(e),this.onError(new Fl(ca({},e,{code:Ga.BROADCAST_AD_BLOCK_INIT_ERROR,isFatal:!1,details:{code:e.code,message:e.message,id:e.id,details:e.details,stack:e.stack,metadata:{cueId:s.cue_id,podStart:n+s.offset}}})))}))}),this.broadcastAd.on("AdIntervalRemoved",e=>{this.playerStore.removeCue(e)}),this.broadcastAd.on("AdIntervalUpdated",e=>{let{cueId:t,start:r,end:i}=e;this.stateController.refreshCue({cueId:t,start:r/1e3,end:i/1e3})}),this.broadcastAd.on("InrollAdPlayRequest",e=>{this.playAdViewers(hf.inroll,e,{})})}getPosterUrlForAd(){var e;const t=null==(e=this.state.controller.sourceParams)?void 0:e.preview;return t&&t!==uf?t:null}prepareBeforeOrAfterAd(e,t){this.broadcastAd&&t!==hf.inroll&&this.broadcastAd.setEnabled(e)}getSeekPositionAfterAd(e){let{adType:t,adViewersDuration:r,utcPosition:i}=e;if(t===hf.inroll){return{utc:i?i+r:void 0,videoTime:this.state.controller.currentTime+r}}return t===hf.preroll?this.state.controller.startPosition:t===hf.midroll||t===hf.postPauseroll?{utc:i||void 0,videoTime:this.state.controller.currentTime}:t===hf.postroll?{videoTime:0}:{}}getAdViewersWithData(e){const{controller:{isFullscreen:t,isPip:r}}=this.state,i=t&&$t(this.getContainerDocument().defaultView,this.video)===this.video;return i||r?e.filter(e=>{const{adViewer:t}=e;return t.filterAdPodsIndependentOnHtmlControls("StreamPlayer can't play CPC ads: ["+(r?"PiP":i?"FullScreen":"unknown")+"] mode"),t.getAdPodsCount()>0}):e}getAdViewersCueId(e,t){var r;if(e!==hf.inroll)return this.state.ad.originalBroadcastAdCueId;const i=t.find(e=>e.additionalData.cueId);return null!=(r=null==i?void 0:i.additionalData.cueId)?r:this.state.ad.originalBroadcastAdCueId}prepareBeforeAd(e){const{ad:{adInfo:t}}=this.state;t||(this.handleAdEnd=(0,La.I)(async()=>{Yr("adsdk.player.start."+e),this.once("ContentImpression",()=>{Gr("adsdk.player.start."+e),this.handleAdEnd=void 0})}))}async initAdPlaybackQueue(e){if(this.currentAdPlaybackQueue)return;const{ad:{adSyncInit:t}}=this.state,r=[(0,yh.O)(this.video,"firstframedecoded",()=>{hi("AD",{},t)},{once:!0}),(0,yh.O)(this.video,"firstframeshown",()=>{pi("AD",{},t)},{once:!0})],i=this.getUtcPosition();e!==hf.preroll&&(this.shouldCaptureScreenshot()&&(Yr("capture.screenshot"),this.videoController.captureScreenshot().then(e=>{Gr("capture.screenshot"),e&&(this.setBackgroundImage(e),this.setBackgroundVisibility(!1))})),Yr("encoder.detach")),await this.detachEncoder(),e!==hf.preroll&&Gr("encoder.detach",{additional:{engine:this.state.controller.engine}});const n=(0,La.I)((e,t)=>this.preloadVideoControllerSource({rule:e,ruleValue:t,whileAd:!0}));let s=!1;const a=new vf({video:this.handleVideoNode(this.video),utcPositionBeforeAd:i,onAdStartRejected:e=>{var t;null==(t=this.playDeferred)||t.reject(e)},onAdSkippableStateChange:e=>{this.callbacks.onAdSkippableStateChange(e)},onAdPodCloseStateChange:e=>{this.callbacks.onAdPodCloseStateChange(e)},onAdVolumeAvailabilityStateChange:e=>{this.callbacks.onAdVolumeAvailabilityStateChange(e)},onAdPodError:e=>{this.callbacks.onAdError(e)},onAdPodDurationChange:e=>{this.callbacks.onAdPodDurationChange(e)},onAdPodCurrentTimeChange:t=>{if(this.callbacks.onAdPodCurrentTimeChange(t),(0,hu.RW)("yasp_preload_content_5_sec_before_ad_end")){var r,i;const t=null==(r=this.currentAdPlaybackQueue)?void 0:r.getCurrentAdPodRemainingTime();null!=(i=this.currentAdPlaybackQueue)&&i.getIsLastAdPod()&&e!==hf.postroll&&t&&t<=5&&n(GS.BeforeAdEnd,t)}},onAdPodTimeToSkipChange:t=>{var r;(this.callbacks.onAdPodTimeToSkipChange(t),(0,hu.RW)("yasp_preload_content_5_sec_before_ad_skip"))&&(null!=(r=this.currentAdPlaybackQueue)&&r.getIsLastAdPod()&&e!==hf.postroll&&t&&-1!==t&&t<=5&&n(GS.BeforeAdSkip,t))},onAdInteraction:()=>{this.callbacks.onAdInteraction()},onFirstAdPodStarted:()=>{var t;ci("AD",{adblockDetected:this.state.ad.adblockDetected,adType:e,bandwidth:Vi(void 0)},this.state.ad.adSyncInit),Gr("player.adsdk.start."+e),this.hidePoster(),(0,hu.RW)("yasp_preload_content_5_sec_before_ad_end")||(0,hu.RW)("yasp_preload_content_5_sec_before_ad_skip")||e!==hf.postroll&&this.preloadVideoControllerSource({rule:GS.OnAdStart,ruleValue:0,whileAd:!0}),null==(t=this.playDeferred)||t.resolve()},onLastAdPodStopped:e=>{this.multiroll.dispatchEvent({event:"AdBreakEnd",data:e})},onBeforeAdPodStart:e=>{this.callbacks.onBeforeAdPodStart(e)},onAdPodStarted:()=>{this.stateController.putResourcesIdle(!0),this.callbacks.onAdPodStart(),s&&Gr("adsdk.creative.switch."+e)},onAdPodSkipped:()=>{this.callbacks.onAdPodSkip()},onAdPodStopped:()=>{X(r),s=!0,Yr("adsdk.creative.switch."+e),this.stateController.putInStreamPlayingState(void 0),this.callbacks.onAdPodEnd()},onAdPodPlayingStateChange:e=>{let{playingState:t,expectedStalledReason:r,adType:i}=e;t===Wl.X.BUFFERING&&this.callbacks.onExpectedStalledChange({reason:r,details:{adType:i}}),this.stateController.putInStreamPlayingState(t)},onAdClickThru:()=>{this.callbacks.onAdPodClick()},onAdSizeChange:e=>{this.stateController.putVideoSize({videoWidth:void 0===e.width?NaN:e.width,videoHeight:void 0===e.height?NaN:e.height})},onRequestFullscreenStateChange:e=>{this.callbacks.onRequestFullscreenChange(e)},getControlsSettings:()=>function(e){const{ad:{nativeAdControlsVisibility:t}}=e;return{controlsVisibility:t?{}:{mute:!1,timeline:!1,play:!1,loader:!1}}}(this.playerStore.getState()),logEvent:this.callbacks.logEvent,onError:e=>{this.onError(e)},adConfig:this.state.ad.adConfig,playerContainer:Ks(this.state.controller.vsid,document),lang:this.config.lang});this.currentAdPlaybackQueue=a}updateVideoInfo(){$r(this.state)?this.playbackQualityController.persist():(this.playbackQualityController.update(),this.emit("PlaybackQualityUpdate",this.playbackQualityController.getPlaybackQuality()))}resetPlayerStore(e,t,r){let{shouldSaveProgress:i,isFirstLoad:n}=r;this.playerStore.updateSourceId(),this.stateController.putStream(e),this.playerStore.setControllerStateField(Lm.sourceParams,t);const s=this.getStartPositionForLoadSource(t,{shouldSaveProgress:i});if(this.playerStore.setControllerStateField(Lm.startPosition,s),this.playerStore.getState().controller.autoplay||this.playerStore.setControllerStateField(Lm.autoplay,gt(this.playerStore.getState().controller)),i||(this.playerStore.setControllerStateField(Lm.duration,Im.duration),this.playerStore.setControllerStateField(Lm.dvrDuration,Im.dvrDuration),this.playerStore.setSkinStateField(Nm.skinDVRDuration,Om.skinDVRDuration),this.stateController.watchedTimeCounter=new WS.p,this.stateController.putWatchedTime(Im.watchedTime)),this.stateController.putCurrentTime(Math.max(0,s.videoTime||Im.currentTime)),!n){const{additionalParams:e=Wu}=t,{from:r=Hu}=e;this.playerStore.setControllerStateField(Lm.from,r),this.playerStore.setControllerStateField(Lm.preview,t.preview||Fm.preview),this.stateController.putBufferingRanges(Im.bufferingRanges),this.stateController.putVideoType(void 0),this.playerStore.setControllerStateField(Lm.programDateTime,void 0),this.playerStore.setControllerStateField(Lm.dvrStartTime,Im.dvrStartTime),this.playerStore.setSkinStateField(Nm.skinDVRStartTime,Om.skinDVRStartTime),this.stateController.putVideoTracks(Im.videoTracks),this.stateController.putAudioTrackValue(Im.audioTrackValue),this.stateController.putAudioTracks(Im.audioTracks),this.stateController.putTextTrackEnabled(Im.textTrackEnabled),this.playerStore.setControllerStateField(Lm.textTrackValue,Im.textTrackValue),this.stateController.putTextTracks(Im.textTracks),this.callbacks.onSubtitlesChange([]),this.callbacks.onThumbnailTileGeneralMetaInfoChange(void 0),this.stateController.putOriginalBroadcastAdCues({}),this.state.controller.playingState===Wl.X.END&&(this.stateController.putPlayingState(Wl.X.PAUSE),this.stateController.putAutoplay(!1)),this.stateController.putInStreamPlayingState(void 0),this.playerStore.setAdStateField(Dm.hasPreroll,!1),this.stateController.putNextAdInfo(void 0),this.playerStore.setControllerStateField(Lm.preload,!0)}this.playerStore.setAdStateField(Dm.adConfig,Fi(t))}prepareNextSource(e,t){this.stateController.putErrorInfo({}),this.emit("DurationChange",NaN),this.playerStore.setControllerStateField(Lm.preload,!0),this.playbackQualityController.reset(),this.playCallbacks=[],this.stateController.putVideoTrackParams({videoTrackValue:Im.videoTrackValue,isAbrEnabled:this.state.controller.isAbrEnabled}),this.broadcastAd&&this.stateController.putOriginalBroadcastAdCues({})}performPlayCallbacks(){this.playCallbacks.length>0&&(X(this.playCallbacks),this.playCallbacks=[])}seekToVideoPosition(e,t){Number.isNaN(e)||($r(this.state)&&!t?this.playerStore.setControllerStateField(Lm.startPosition,{videoTime:e}):this.videoController.seek(e))}getStartPositionForLoadSource(e,t){let{shouldSaveProgress:r}=t;const{controller:{currentTime:i,watchedTime:n}}=this.state,s=this.getUtcStartTime(),a=void 0===s?void 0:s+i,o=(0,Za.K)(e.startPosition)?e.startPosition:{};return r&&n>0?{videoTime:i,utc:a}:o}getUtcStartTime(){const{controller:{programDateTime:e}}=this.state;return void 0===e?void 0:e/1e3}onError(e){const t=e instanceof Fl?e:new Fl(ca({},e,{code:e.code||Ga.DEFAULT_ERROR}));this.stateController.putErrorInfo({error:t}),t.isFatal&&(this.callbacks.logEvent({event:"MediaInternalsHistoryOnFatal",params:{history:this.mediaInternalsHistory.getHistory()}}),!$r(this.state)&&this.currentAdPlaybackQueue&&this.currentAdPlaybackQueue.destroy(pf.PlayerError),this.stateController.handleVideoTagPlayingStateChange(Wl.X.PAUSE),this.destroyVideoController())}async detachEncoder(){this.videoController&&(await this.videoController.detachEncoder(),this.stateController.putEncoderState(Cm.Detached))}async attachEncoder(){this.stateController.putEncoderState(Cm.Attaching);try{await this.videoController.attachEncoder()}catch(r){throw this.stateController.putEncoderState(Cm.Detached),r}this.stateController.putEncoderState(Cm.Attached),this.updateVolumeInfo();const e=this.state.controller.playingState,t=this.videoController.getPlayingState();t&&e!==t&&this.emit("VideoPlayingStateChange",t)}async destroyVideoController(){this.videoController&&(await this.videoController.destroy(),this.stateController.putEncoderState(Cm.Detached))}async tryToPlay(e){var t;let r=!1;this.once("PauseCalled",()=>r=!0);try{return void await e.play()}catch(i){}if(this.destroyed)return Promise.reject();if(r)return Promise.reject();if(null!=(t=this.state.controller.errorInfo.error)&&t.isFatal)return Promise.reject();if(this.video.muted)return Promise.reject();if(!this.state.controller.allowMuted)return Promise.reject();if(!this.canMuteForPlay)return Promise.reject();if(this.setMuted(!0),zS&&!xy){const e=new Promise(e=>{this.once("Destroy",(0,yh.O)(this.video,"volumechange",e,{once:!0}))}),t=new Promise((e,t)=>{this.once("Destroy",t)});await Promise.race([e,t])}try{return void await e.play()}catch(n){return this.canMuteForPlay=!1,this.setMuted(!1),Promise.reject()}}async logPlayAfterWaitingForDocumentVisibility(){const{videoController:e}=this,{startStage:t,initialAutoplay:r}=this.state.controller;t===Gd.waitForDocumentVisibility&&r&&e&&this.callbacks.logEvent({event:$d.PlayAfterWaitingForDocumentVisibility,params:{}})}getContainerDocument(){return this.container.ownerDocument||document}getMainContainer(){return this.container}setPosterFitStyle(){var e,t;const{videoElementStyle:r,posterStyle:i}=this.playerStore.getState().controller,n=null!=(e=null!=(t=null==r?void 0:r.objectFit)?t:null==i?void 0:i.objectFit)?e:"cover";ua(this.video,ca({},this.playerStore.getState().controller.videoElementStyle,{objectFit:n}))}resetPosterFitStyle(){ua(this.video,ca({objectFit:"contain"},this.playerStore.getState().controller.videoElementStyle))}hidePoster(){this.video.poster=uf}preloadVideoControllerSource(e){let{rule:t,ruleValue:r,whileAd:i}=e;void 0!==this.videoController&&(this.callbacks.logEvent({event:$d.PreloadSource,params:{reason:YS.InternalApi,rule:GS[t],ruleValue:r,whileAd:i}}),(0,Pd.v)(this.videoController.preloadSource()))}updateVolumeInfo(){this.stateController.putVolumeInfo({volume:this.video.volume,muted:this.video.muted,changeReason:iu.VolumeChangeEvent})}iosLandscapeScreenOrientationWorkaround(){if(!Cc)return;const e=()=>{if(this.state.controller.currentTime<=0)return;this.off("CurrentTimeChange",e);(0,Wa.Y)(()=>0===screen.orientation.type.indexOf("landscape-"))&&(It(this.video,LS().locals.StreamPlayer_iosLandscapeWorkaround),setTimeout(()=>Ep(this.video,LS().locals.StreamPlayer_iosLandscapeWorkaround),10))};this.on("CurrentTimeChange",e)}}class eE{constructor(e,t){void 0===e&&(e=window),this.handlers=[],this.names=void 0,this.namesOnVideo=void 0,this.onDestroy=new jd,this.win=void 0,this.video=void 0,this.fullscreenElement=null,this.setFullScreenElementFromAPI=()=>{const e=$t(this.win,this.video);this.setFullscreenElement(e)},this.win=e,this.video=t,t&&Cc&&(this.onDestroy.addOne((0,yh.O)(t,"webkitbeginfullscreen",()=>{this.setFullscreenElement(t)})),this.onDestroy.addOne((0,yh.O)(t,"webkitendfullscreen",()=>{this.setFullscreenElement(null)}))),this.names=Jt(e,t),this.namesOnVideo=Qt(e,t)[0],this.names&&(this.onDestroy.addOne((0,yh.O)(this.win.document,this.names.events.change,this.setFullScreenElementFromAPI)),this.setFullScreenElementFromAPI())}requestFullscreenForElement(e,t){if(void 0===this.names)throw new this.win.Error("Fullscreen is not supported");{const{request:r}=this.names;if(!(r in e))throw new this.win.Error("Fullscreen is not supported");e[r](t)}}isFullscreen(){return null!==this.fullscreenElement}exit(){if(void 0===this.names)throw new Error("Fullscreen is not supported");{let e,t=this.names;this.video&&this.fullscreenElement===this.video?(e=this.video,t=this.namesOnVideo||t):e=this.win.document;try{(0,Pd.v)(e[t.exit]().catch(e=>{mf.error("Exit fullscreen for element:",e)}))}catch(io){mf.error("Exit fullscreen for element:",io)}}}getFullscreenElement(){return this.fullscreenElement}addHandler(e){if("function"!==typeof e)throw new this.win.Error("Fullscreen handler must be a function");this.handlers.push(e)}removeHandler(e){this.handlers=this.handlers.filter(t=>t!==e)}destroy(){this.handlers.length=0,this.onDestroy.dispatch(void 0)}setFullscreenElement(e){this.fullscreenElement=e,this.handlers.forEach(t=>t(e))}}let tE;!function(e){e.PiP="PiP",e.YaBroEarly="YaBroEarly",e.YaBroAttrLegacy="YaBroAttrLegacy",e.YaBroAttrCurrent="YaBroAttrCurrent",e.OperaPopOut="OperaPopOut",e.SafariPresentationMode="SafariPresentationMode"}(tE||(tE={}));const rE={[tE.PiP]:{isSupported:e=>{if("pictureInPictureEnabled"in e.document){if(pa()){const t=ha(e);return 20===t.major&&t.minor>4||t.major>20}return!0}return!1},getCurrent:e=>e.document.pictureInPictureElement||null,observe:(e,t,r)=>t?(t.addEventListener("enterpictureinpicture",r),t.addEventListener("leavepictureinpicture",r),()=>{t.removeEventListener("enterpictureinpicture",r),t.removeEventListener("leavepictureinpicture",r)}):Yl.Z,getPipWindow:e=>e.pictureInPictureWindow||null},[tE.YaBroEarly]:{isSupported:(e,t)=>"broughtOut"in t,getCurrent:(e,t)=>t&&"broughtOut"in t&&t.broughtOut?t:null,observe:(e,t,r)=>t?(t.addEventListener("oowvideobringin",r),t.addEventListener("oowvideobringout",r),()=>{t.removeEventListener("oowvideobringin",r),t.removeEventListener("oowvideobringout",r)}):Yl.Z},[tE.YaBroAttrCurrent]:{isSupported:e=>{if(pa()){const t=ha(e);return 18===t.major&&t.minor>=6||t.major>18}return!1}},[tE.YaBroAttrLegacy]:{isSupported:e=>pa()&&ha(e).major<18},[tE.SafariPresentationMode]:{isSupported:(e,t)=>"webkitPresentationMode"in t,getCurrent:(e,t)=>t&&"picture-in-picture"===t.webkitPresentationMode?t:null,observe:(e,t,r)=>t?(t.addEventListener("webkitpresentationmodechanged",r),()=>t.removeEventListener("webkitpresentationmodechanged",r)):Yl.Z},[tE.OperaPopOut]:{isSupported:(e,t)=>"onoperadetachedviewcontrol"in t&&"onoperadetachedviewchange"in t}},iE=[tE.PiP,tE.YaBroEarly,tE.YaBroAttrCurrent,tE.YaBroAttrLegacy,tE.SafariPresentationMode,tE.OperaPopOut];class nE extends Bc.v{constructor(e,t){void 0===e&&(e=window),super(),this.api=null,this.apiName=null,this.window=void 0,this.pipWindow=null,this.currentElement=null,this.unsubscribeFromApi=Yl.Z,this.handlePipEvent=e=>{var t;const r=e.target;this.digestCurrentElement(r);const i=Boolean(this.getCurrentElement());this.pipWindow=(null==(t=this.api)||null==t.getPipWindow?void 0:t.getPipWindow(e))||null,this.emit("Change",i)},this.window=e;const r=t||window.HTMLVideoElement.prototype;for(let i=0;i<iE.length;i++){const e=iE[i],t=rE[e];try{if(t.isSupported(this.window,r)){this.api=t,this.apiName=e;break}}catch(io){}}this.digestCurrentElement(t),this.api&&this.api.observe&&(this.unsubscribeFromApi=this.api.observe(this.window,t,this.handlePipEvent))}getSupportedApiName(){return this.apiName}getCurrentElement(){return this.currentElement}addHandler(e){return this.api&&this.api.observe?(this.on("Change",e),()=>this.off("Change",e)):null}getPipWindowSize(){if(!this.pipWindow)return null;const{width:e,height:t}=this.pipWindow;return e&&t?{width:e,height:t}:null}destroy(){this.currentElement=null;const e=this.window.document;null!=e&&e.pictureInPictureElement&&(null==e.exitPictureInPicture||e.exitPictureInPicture()),this.off("Change"),this.unsubscribeFromApi()}digestCurrentElement(e){this.api&&this.api.getCurrent&&(this.currentElement=this.api.getCurrent(this.window,e))}}class sE extends Bc.v{constructor(e,t){super(),this.isSupportedPipMode=!0,this.isYandexPipMode=!1,this.isVisibilitySupported=void 0,this.window=void 0,this.element=void 0,this.fullscreenApi=void 0,this.pipApi=void 0,this.video=void 0,this.state={isPip:!1,isFullScreen:!1,isVisible:!0},this.observe=e=>(this.on("Change",e),()=>this.off("Change")),this.fireVisualStateHandlers=()=>{const{isPip:e,isVisible:t,isFullScreen:r}=this.state,i={isPip:e,isVisible:t,isFullScreen:r,isSupportedPipMode:this.isSupportedPipMode,isVisibilitySupported:this.isVisibilitySupported,isYandexPipMode:this.isYandexPipMode};this.emit("Change",i)},this.handleVisibilityChange=e=>{this.state.isVisible!==e&&(this.state.isVisible=e,this.fireVisualStateHandlers())},this.handlePipChange=e=>{this.state.isPip!==e&&(this.state.isPip=e,this.state.isFullScreen=this.getFullscreenStateProperty(this.fullscreenApi.getFullscreenElement()),this.fireVisualStateHandlers())},this.getFullscreenStateProperty=e=>nt(this.video.ownerDocument,this.video)||this.video===e,this.handleFullscreenChange=e=>{const t=this.getFullscreenStateProperty(e);this.state.isFullScreen!==t&&(this.state.isFullScreen=t,this.fireVisualStateHandlers())},this.element=e,this.window=Us(this.element),this.isVisibilitySupported=t}setVideoElement(e){void 0===this.video&&(this.video=e,this.observeFullscreen(),this.observePip())}setExternalVisibility(e){this.handleVisibilityChange(e)}setExternalFullscreen(e){this.state.isFullScreen!==e&&(this.state.isFullScreen=e,this.fireVisualStateHandlers())}changeFullscreenState(e){e.isFullScreen!==this.state.isFullScreen&&(e.isFullScreen?this.fullscreenApi.requestFullscreenForElement(this.video,{navigationUI:"hide"}):this.fullscreenApi.exit())}changePipState(e){e.isPip!==this.state.isPip&&(e.isPip||this.pipApi.destroy())}destroy(){this.emit("Destroy"),this.off("Destroy")}getState(){const{isPip:e,isVisible:t,isFullScreen:r}=this.state;return{isPip:e,isVisible:t,isFullScreen:r,isSupportedPipMode:this.isSupportedPipMode,isVisibilitySupported:this.isVisibilitySupported,isYandexPipMode:this.isYandexPipMode}}getPipWindowSize(){return this.pipApi.getPipWindowSize()}observePip(){this.pipApi=new nE(Us(this.video),this.video),this.pipApi.addHandler(this.handlePipChange),this.once("Destroy",()=>{this.pipApi.destroy()});const e=this.pipApi.getSupportedApiName();this.isSupportedPipMode=e!==tE.OperaPopOut,this.isYandexPipMode=e===tE.YaBroAttrCurrent||e===tE.YaBroAttrLegacy}observeFullscreen(){this.fullscreenApi=new eE(this.window,this.video),this.fullscreenApi.addHandler(this.handleFullscreenChange),this.once("Destroy",()=>{this.fullscreenApi.destroy()})}}const aE={sourceId:NaN,data:void 0};Kt("internal_start");let oE=eu.l.Unknown,lE=ef,dE=vS.X.PAUSE,uE=du;const cE={};var hE=r(5654);const pE=(0,La.I)(()=>Ot(hE.toString()));var fE=r(8825);const mE=["contentId"],gE=["contentId"],vE=Vp(window);class yE extends Yh.h{publicEmit(e,t){if(e.indexOf("/")>-1)return this.emit(e,t);const r=new Error("Event "+e+" is invalid. Namespace is required: NAMESPACE/"+e);setTimeout(()=>{throw r},0)}emit(e,t){this.debug.logEvents&&console.log("[PLAYER] [EVENT]",e,t),super.emit(e,t)}getDebugConfig(){return this.debug}constructor(e){var t,r,i,n,s,a;if(super(e),this.skin=void 0,this.container=void 0,this.vhHelper=void 0,this.initStreamPlayerDeferred=new Zc.B,this.performOnInitStreamPlayer=(0,fE.P)(this.initStreamPlayerDeferred.promise),this.isInitStreamPlayer=!1,this.playingStateSynchronization=(0,Pp.l)(),this.playerNode=void 0,this.postMessenger=void 0,this.visiblePlaybackController=void 0,this.screenWakeLockController=void 0,this.getSourceConfigForRecover=()=>{},this.completeInitAfterGettingSourceConfig=void 0,this.store=void 0,this.errorScreen=void 0,this.preloadSkin=void 0,this.reportConfig=void 0,this.additionalParams=void 0,this.setSourceDeferred=void 0,this.telemetry=void 0,this.resourceTimingsMonitor=void 0,this.playerAliveData={bandwidthEstimate:0},this.playerTracker=void 0,this.setSourceStage=cu.LOADING,this.sourceIdSignal=new Hd(NaN,(e,t)=>!!isNaN(t)||!isNaN(e)&&t<=e),this.debugPanel=void 0,this.externalPlaybackCsrfToken=void 0,this.externalPlaybackTokenExpireTimeout=void 0,this.playerApiSourceConfig=void 0,this.loggingForExternalToolsAllowed=void 0,this.isReady=!1,this.debug={logCalls:!1,logEvents:!1,logInternals:!1,showDebugPanel:!1},this.destroyed=!1,this.config=void 0,this.readyPendingEvents=[],this.nextPreloadRequestId=0,this.loadComponents=(0,La.I)(()=>{return E({src:(e=Jl.f.i18nLang,V("components_"+e+(bc?".modern":"")+".js",parseInt("1.0-12103".slice(4),10),!1)),retries:3,dropCacheOnRetry:!0,onBeforeLoad:e=>{e.crossOrigin="anonymous"},checkLoad:()=>(0,Ql.m)(Jl.f.initErrorScreen)&&(0,Ql.m)(Jl.f.initDebugPanel)}).catch(e=>{const t=new Fl(e).toJSON(),r=new Fl(Aa({},t,{details:{errorDetails:t.details},code:Ba.ERROR_SCREEN_LOAD_ERROR,isFatal:!1}));throw this.emitError(r,We(qe(document))),r});var e}),this.onPanelInitCallbacks=[],this.sendReportToTelemetry=async e=>{let{reportId:t,reported:r}=e;const i=await this.getReportData();return this.telemetry.sendReportLog(i,t,r)},this.getReportData=async()=>{var e;const t=this.isReady?await this.requestDebugInfo():{vsid:this.additionalParams.vsid,version:"1.0-12103",clientTimestamp:Date.now(),streamUrl:null==(e=this.getState().stream)?void 0:e.url,system:et(),playerApiState:this.getState()};return(0,ih.Y)(t)||""},!(0,Za.K)(e))throw new Fl("Params is not an object");(0,hu.Vc)(e);const o=e;o.useNativeAdControls=!0;const l=(0,Gc.lY)(12103,"WEB"),d=(0,Wa.Y)(()=>{var e;const t=null==o||null==(e=o.source.additionalParams)?void 0:e.from;return t&&(0,qa.H)(t)?t:void 0})||Hu;this.additionalParams={vsid:l,from:d};const u=void 0!==o.vhParams,c=(0,Ql.m)(vE),h={vsid:l,vpuid:Gc.M0.getVpuid(),version:"1.0-12103",service:"StreamPlayer",isVideoADB:c},p=(f=e.logUrl,!(0,qa.H)(f)||f.startsWith("https://"));var f;const m=p?e.logUrl:void 0;this.telemetry=new Gc.M0({playerInfo:h,sendLog:(e,t)=>{const r=(0,ih.Y)(e);if(!r)return;const i=((0,qa.H)(m)?m:void 0)||(c?Ht():Up);Fe({url:i===Up||"https://log.strm.yandex.ru"===i?(0,Yu.Sr)(i,t):i,data:r})},getState:()=>{const e=this.getState();if(!e)return;const t=e.audioTrack,r=e.videoTrack,i=e.videoTracks.map(e=>Aa({},e,{selected:(null==r?void 0:r.value)===e.value,auto:Boolean(null==r?void 0:r.auto)})),n={total:qt(e.bufferedRanges,e.currentTime)||0};return Aa({},e,this.playerAliveData,{videoTracks:i,remainingBufferedTime:n,audioTrack:t})}}),this.telemetry.setStaticParams({labels:{from:d}});const g=(0,qa.H)(e.perfLogUrl)?e.perfLogUrl:"https://log.strm.yandex.ru/perf";this.resourceTimingsMonitor=new Kp.$({sendLog:(e,t)=>{const r=(0,ih.Y)(e);r&&Fe({url:(0,Yu.Sr)(g,t),data:r})}}),this.resourceTimingsMonitor.attach(window),this.once(Xl.Destroy,()=>this.resourceTimingsMonitor.destroy());{!function(e){let{vsid:t}=e;xe((0,Yu.Sr)("https://mc.yandex.ru/watch/37773110",{vsid:t}))}({vsid:l});const e=t=>{let{watchedTime:r}=t;r>0&&(this.off(Xl.WatchedTimeChange,e),(0,Wa.Y)(()=>function(e){let{vsid:t}=e;return xe((0,Yu.Sr)("https://mc.yandex.ru/watch/37773110",{vsid:t,"page-url":"goal://"+window.location.hostname+"/start"}))}({vsid:l}),Wp.L))};this.on(Xl.WatchedTimeChange,e)}this.container=(()=>{try{return this.createInternalContainer(function(e){if(!(0,Za.K)(e))throw new Fl("paramsObject must be an object");if(!e.element)throw new Fl("paramsObject must have property [element]");const{element:t}=e;let r;if("string"===typeof t){const e=document.getElementById(t);if(!e)throw new Fl("cannot find element with id: ["+t+"]");r=e}else{if(!_d(t))throw new Fl("paramsObject.element must be a string or HTMLElement id");r=t}return r}(e))}catch(t){const e=Fl.from(t,{code:Ba.INVALID_CONFIG_ELEMENT_IN_CREATE_PLAYER,isFatal:!0});throw this.emitError(e,We(qe(document))),e}})(),this.savePlayerAliveData({containerHeight:this.container.clientHeight*devicePixelRatio,containerWidth:this.container.clientWidth*devicePixelRatio});const v=(()=>{try{return function(e){if(!(0,Za.K)(e))throw new Fl("paramsObject must be an object");return fu.parse(e.lang)}(e)}catch(t){const e=Fl.from(t,{code:Ba.INVALID_CONFIG_LANG_IN_CREATE_PLAYER,isFatal:!1});return this.emitError(e,We(qe(document))),"ru"}})();if(Jl.f.i18nLang=v,this.initErrorScreen(),this.initDebugPanel(),!p){const t=new Fl({code:Ba.INVALID_LOG_URL,isFatal:!0,details:{logUrl:e.logUrl}});throw this.emitError(t),t}this.prepareContainerNode(),this.playerNode=this.createPlayerNode(),Z(this.container,this.playerNode);const y=function(e){pE();const t=document.createElement("yaplayertag");return t.id=Gs(e),W(t,{width:"100%",height:"100%",position:"relative",overflow:"hidden",display:"block"}),t}(l);this.playerNode.appendChild(y);const S=(()=>{try{return function(e){return ju.parse(e)}(e)}catch(t){const r=t instanceof so?Fl.from(t,{details:t.issues}):Fl.from(t),i=new Fl(Aa({},r,{details:{errorDetails:r.details,config:(0,Wa.Y)(()=>(0,ih.Y)(e))||"UNSERIALIZABLE"},code:Ba.INVALID_CONFIG_IN_CREATE_PLAYER,isFatal:!0}));throw this.emitError(i,We(qe(document))),(0,Wp.L)(t),(0,Wp.L)(i),i}})();this.config=Aa({},S,{vsid:l,vpuid:Gc.M0.getVpuid()}),S.objectFit&&this.setVideoStyle({objectFit:S.objectFit}),this.store=this.initPlayerStore({config:S,vsid:l}),this.initOnlyOnePlayingUnmutePlayerControl();const b=(t,r)=>{try{return Ie(t,this.config,this.telemetry.getSourceIndex())}catch(i){if(r)return;const t=i instanceof so?Fl.from(i,{details:i.issues}):Fl.from(i),n=new Fl(Aa({},t,{details:{errorDetails:t.details,config:(0,Wa.Y)(()=>(0,ih.Y)(e))||"UNSERIALIZABLE"},code:Ba.INVALID_CONFIG_IN_CREATE_PLAYER,isFatal:!0}));throw this.emitError(n,We(qe(document))),(0,Wp.L)(i),(0,Wp.L)(n),n}},A=(()=>{try{return b(o.source,u)}catch(TE){return}})();this.once(Xl.Destroy,Mt(()=>this.destroyInternal(au.Unload))),this.reportConfig=S.reportConfig,this.debug=S.debugConfig,this.initPlaybackTracking(),this.playerTracker=this.initPlayerTracker(),this.once(Xl.Destroy,()=>this.playerTracker.destroy()),this.postMessenger=this.initPostMessenger(),this.once(Xl.Destroy,()=>this.postMessenger.destroy()),this.subscribeExternalFullscreenChange(this.container),this.once(Xl.Destroy,()=>{clearTimeout(this.externalPlaybackTokenExpireTimeout)}),S.savedMutedRestored&&this.emit(Xl.VolumeChangeReasonChange,{volumeChangeReason:iu.RestoreSavedMuted}),this.on(Xl.VolumeChangeReasonChange,e=>{let{volumeChangeReason:t}=e;if((r=t)===iu.RequestAutoplaySettings||void 0===r)return;var r;const{volume:i,muted:n}=this.store.getState();Lu.setSavedVolume(i),Lu.setSavedMuted(n)}),this.once(Xl.Ready,()=>{this.initTrackChangeLogging()}),A&&(A.source.params.additionalParams=this.addRequiredFieldsToAdditionalParams(A.source.params.additionalParams),this.additionalParams=A.source.params.additionalParams,this.applySourceInfoToTelemetry(A)),this.telemetry.setStaticParams({device:S.streamPlayerParams.device?S.streamPlayerParams.device:{}}),this.telemetry.enableRemoteProgressSaving(Ut(this.playerApiSourceConfig));const T=Aa({},e,{element:void 0,v2:!0});if(this.telemetry.onCreatePlayer(T,We(qe(document))),this.on(Xl.Ready,()=>{this.isReady=!0,this.setSourceStage=cu.READY,this.readyPendingEvents.forEach(e=>this.postMessenger.emit("Event",e)),this.readyPendingEvents.length=0}),this.visiblePlaybackController=this.initVisiblePlaybackController(S.streamPlayerParams.togglePlaybackOnVisibilityChange,S.streamPlayerParams.autoplay),this.screenWakeLockController=new Xp({playerContainer:this.container,playerApi:this,onError:(0,La.I)(e=>{const t=Fl.from(e);this.telemetry.logError({error:new Fl(Aa({},t,{code:Ba.SCREEN_WAKE_LOCK_ERROR,isFatal:!1,details:{errorDetails:t.details,allowedFeaturePolicies:Yt(),locationData:We(qe(document))}}))})})}),this.once(Xl.Destroy,()=>{var e;return null==(e=this.screenWakeLockController)?void 0:e.destroy()}),this.loggingForExternalToolsAllowed=void 0===e.loadSkin,this.preloadSkin=this.initPreloadSkin(S),A){var _,w,k;const e=S.streamPlayerParams.autoplay&&(!A.source.params.adConfig||!1===A.source.params.adConfig.hasPreroll)&&!A.source.params.startPosition.videoTime;null==(_=this.preloadSkin)||_.setPoster(A.source.params.preview,e?A.source.params.firstFrameHash:"",e?A.source.params.firstFrameUrl:""),null==(w=this.preloadSkin)||w.setStyle(Aa({},A.source.params.posterStyle,{objectFit:e?S.objectFit||"contain":null==(k=A.source.params.posterStyle)?void 0:k.objectFit}))}if(function(e){let t=!1,r=!1,i="start";const n=()=>t&&r,s=(0,La.I)(()=>{e.emit(Xl.UserReady,{type:i})}),a=()=>{n()&&(i="poster",s())},o=()=>{if(e.off(Xl.ContentImpression,s),e.off(Xl.BeforeAdPodStart,c),e.off(Xl.AdPodStart,u),n())return i="poster",s();t||e.once(Xl.PosterReady,a),r||e.once(Xl.SkinReady,a)},l=()=>{t=!0},d=()=>{t=!0,r=!0},u=()=>(i="start",s()),c=()=>{e.off(Xl.ResourcesIdle,o),e.once(Xl.AdPodStart,u)};e.once(Xl.BeforeAdPodStart,c),e.once(Xl.PosterReady,l),e.once(Xl.SkinReady,d),e.once(Xl.ResourcesIdle,o),e.once(Xl.ContentImpression,s),e.once(Xl.UserReady,()=>{e.off(Xl.BeforeAdPodStart,c),e.off(Xl.ResourcesIdle,o),e.off(Xl.AdPodStart,u),e.off(Xl.ContentImpression,s),e.off(Xl.PosterReady,l),e.off(Xl.SkinReady,d)})}(this),this.setFiltersForSourceRelatedEvents(),this.completeInitAfterGettingSourceConfig=(e,t)=>{var r,i,n,s;if(this.playerApiSourceConfig||this.destroyed)return;const{source:a}=e;this.playerApiSourceConfig=e,this.emit(Xl.SourceChange,{source:a});const d=t&&(!a.params.adConfig||!1===a.params.adConfig.hasPreroll)&&!a.params.startPosition.videoTime;null==(r=this.preloadSkin)||r.setPoster(a.params.preview,d?a.params.firstFrameHash:"",d?a.params.firstFrameUrl:""),null==(i=this.preloadSkin)||i.setStyle(Aa({},a.params.posterStyle,{objectFit:d?S.objectFit||"contain":null==(n=a.params.posterStyle)?void 0:n.objectFit}));const u=this.visiblePlaybackController.getVisualState(),c=Aa({},S.streamPlayerParams,{isVisibilitySupported:u.isVisibilitySupported,initialVisibility:u.isElementVisible,source:e.source});null!=(s=c.togglePlaybackOnVisibilityChange)&&s.forceAutoplay||void 0===t||(c.autoplay=!0===t||(0,Za.K)(t),c.allowMuted=(0,hu.RW)("web_forbid_allow_muted_autoplay")?c.muted:!0===t||t&&t.allowMuted),this.playerTracker.setTrackings(e.trackings),this.telemetry.startInitBufferingTimer(),this.telemetry.setExternalStalledDuration(c.source.externalStalledDuration||(0,Fa.no)()-Math.min(o.timeLoaderInit||1/0,Na.timeAPIInit||1/0)),a.params.additionalParams=this.addRequiredFieldsToAdditionalParams(a.params.additionalParams),this.additionalParams=a.params.additionalParams,this.applySourceInfoToTelemetry(e);try{!function(e){let{container:t,streamPlayerParams:r,vsid:i,vpuid:n}=e;const s=new dh({id:i,sender:lh,receiver:oh});try{Sa({container:t,postMessenger:s,streamPlayerParams:r,vsid:i,vpuid:n})}catch(a){s.sendEvent("onInitError",{sourceId:1,data:fa(new Fl(ma({},a,{isFatal:"boolean"!==typeof a.isFatal||a.isFatal,code:a.code||Ba.ON_PLAYER_INIT_ERROR})))})}}({streamPlayerParams:c,container:y,vpuid:Gc.M0.getVpuid(),vsid:l}),this.isInitStreamPlayer=!0,this.initStreamPlayerDeferred.resolve()}catch(h){this.playerApiSourceConfig=void 0;const e=Fl.from(h);this.emitError(e),(0,Wp.L)(e)}Ea({source:a})&&void 0!==a.params.adConfig&&(0,Pd.v)(zr(window,a.params.adConfig,l,S.useAbdBundle)),this.getSourceConfigForRecover=S.useFallbackStream?this.createSourceConfigForRecoverGetter(e):Yl.Z},A&&void 0===A.source.contentId&&!u)return void this.completeInitAfterGettingSourceConfig(A,void 0);const R=this.initVhHelper({contentId:(null==A?void 0:A.source.contentId)||(null==(t=o.vhParams)||null==(r=t.content)?void 0:r.content_id),poster:null==A?void 0:A.source.params.preview,vhParams:o.vhParams,queryParams:Aa({autoplay:!1===o.autoplay?0:void 0,hidden:(0,Za.K)(o.skinParams)&&"skinConfig"in o.skinParams&&(0,Za.K)(null==(i=o.skinParams)?void 0:i.skinConfig)?null==(n=o.skinParams)||null==(s=n.skinConfig)?void 0:s.hiddenControls:void 0},null==(a=o.source)?void 0:a.queryParams)});this.vhHelper=R,R.on("SetSource",e=>{let{sourceConfig:t,skinConfig:r,externalPlayerConfig:i,autoplay:n}=e;this.configureSkin(r,i);const s=ba(Aa({},t,o.source),mE);this.completeInitAfterGettingSourceConfig(b(s,!1),n)})}getState(){var e;return null==(e=this.store)?void 0:e.getState()}async destroy(){return this.destroyInternal(au.PublicApiCall)}async sendReportLog(){const e=await this.getReportData();return{reportId:this.telemetry.sendReportLog(e)}}openReportWindow(){const e=this.telemetry.generateReportId(),t=function(e,t,r){let{reportUrl:i}=e,{from:n=Hu}=t;const s={"form-logId":r,"form-from":n},a=function(e){switch(e){case"ott-kp":case"discovery":case"kinopoisk":return"10463870";case"disk":return"58127089";case"telemost":return"58141887";case"yavideo":case"ottwidget_ya-serp":case"serp":case"ya-market":case"ya-music":case"ya-music-android":case"quantum":case"vconf":return"10491213";case"partner":case"turbo":case"zen":case"yanews":case"yanewstragic":case"woman.ru":case"ru.tv":case"tvrain.ru":return"10491214";default:return}}(n);void 0!==a&&(s["form-from_group"]=a);const o=(0,Yu.Sr)(i,s).substr(0,2048)+Yc;return{reportId:r,reported:null!==window.open(o,"_blank")}}(this.reportConfig,this.additionalParams,e);this.sendReportToTelemetry(t)}play(e){void 0===e&&(e=eu.l.ExternalApi);const{error:t,playingState:r}=this.getState();if(null!=t&&t.isFatal)return Promise.reject();this.emit(Xl.RequestPlayingState,{playingState:Wl.X.PLAY,playingStateReason:e}),(!this.config.streamPlayerParams.autoplay&&this.telemetry.getExpectedStalled().reason===Bp.k.Init||r===Wl.X.PAUSE&&this.telemetry.getExpectedStalled().reason===Bp.k.SetSource)&&this.emit(Xl.RequestPlayingState,{playingState:Wl.X.BUFFERING,playingStateReason:eu.l.Unknown});const i=new Promise((t,r)=>{this.performOnInitStreamPlayer(()=>{this.postMessenger.sendRequest(ah.play,e).then(e=>e?t():r()).catch(()=>r())},r)});return i.catch(()=>{this.emit(Xl.RequestPlayingState,{playingState:Wl.X.PAUSE,playingStateReason:eu.l.PlayRejected})}),this.playingStateSynchronization.addLock(i)}pause(e){void 0===e&&(e=eu.l.ExternalApi),this.emit(Xl.RequestPlayingState,{playingState:Wl.X.PAUSE,playingStateReason:e}),this.performOnInitStreamPlayer(()=>{this.playingStateSynchronization.addLock(this.postMessenger.sendRequest(ah.pause,e))})}seek(e){this.postMessenger.sendCommand(ah.seek,e)}setDebugPanelVisibility(e){var t;this.debug.showDebugPanel=e,null==(t=this.debugPanel)||t.setVisibility(e)}async requestDebugInfo(){var e;return Aa({},await this.postMessenger.sendRequest(ah.requestDebugInfo,void 0),{playerApiState:this.getState(),streamUrl:null==(e=this.getState().stream)?void 0:e.url})}async requestExternalPlay(e){this.logEventInternal($d.ExternalPlaybackPlayerActivate);const t=await this.requestExternalCsrfToken();try{return await th(e,t),this.logEventInternal($d.ExternalPlaybackPlayerActivateSucceed),e.externalPlayerId}catch(r){throw this.updateExternalPlaybackCsrfToken(void 0),this.logEventInternal($d.ExternalPlaybackPlayerActivateFailed),new Error(e.externalPlayerId)}}async requestExternalPlayerList(e){let{currentPlayerListLength:t}=e,r=!1;await this.requestExternalCsrfToken();try{if(0===t){r=!0,this.logEventInternal($d.ExternalPlaybackPlayerListFetching,{cachedList:r});const e=await $c();if(this.logEventInternal($d.ExternalPlaybackPlayerListFetchSuccess,{cachedList:r}),!e.length)return[];this.logEventInternal($d.ExternalPlaybackPlayerListHasAnyDevice)}r=!1,this.logEventInternal($d.ExternalPlaybackPlayerListFetching,{cachedList:r});const e=await eh();return this.logEventInternal($d.ExternalPlaybackPlayerListFetchSuccess,{cachedList:r}),e.filter(e=>e.screen_capable).map(e=>({id:e.id,name:e.name,status:e.online?Yd.IDLE:Yd.OFFLINE})).sort(Ye)}catch(i){throw this.logEventInternal($d.ExternalPlaybackPlayerListFetchError,{cachedList:r,status:(0,Za.K)(i)?i.status:0}),i}}setVolume(e){this.postMessenger.sendCommand(ah.setVolume,e)}setMuted(e){this.postMessenger.sendCommand(ah.setMuted,e)}setVideoTrack(e){this.postMessenger.sendCommand(ah.setVideoTrack,e)}setAudioTrack(e){this.postMessenger.sendCommand(ah.setAudioTrack,e)}setTextTrack(e){this.postMessenger.sendCommand(ah.setTextTrack,e)}changeAdditionalParams(e){(e=>{if(!(0,Za.K)(e))throw new Fl("changeAdditionalParams payload must be an Object");if((0,Au.Z)(e).some(e=>-1===Eh.indexOf(e)))throw new Fl("changeAdditionalParams payload must contain only following keys: "+Eh.toString())})(e),this.telemetry.flushStates(),this.additionalParams=Aa({},this.additionalParams,e),this.telemetry.setStaticParams({additionalParameters:Wt(this.additionalParams)})}setNativeTextTrackVisibility(e){this.postMessenger.sendCommand(ah.setNativeTextTrackVisibility,e)}setPlaybackRate(e){this.postMessenger.sendCommand(ah.setPlaybackRate,e)}async setSource(e){var t,r,i;null==(t=this.setSourceDeferred)||t.reject(new Error("SetSource rejected cause of new #setSource()")),this.setSourceDeferred=new Zc.B;const n=this.setSourceDeferred;(0,Pd.v)(n.promise),this.isReady||this.store.getState().error||await Promise.race([this.waitForEvent(Xl.Ready),this.waitForEvent(Xl.ErrorChange),n.promise]),null==(r=this.vhHelper)||r.destroy(),this.vhHelper=void 0;const s=e=>{try{const t=this.telemetry.onBeforeSetSource();return Ie(e,this.config,t)}catch(t){const e=Fl.from(t,{code:Ba.INVALID_CONFIG_IN_SET_SOURCE,isFatal:!0});throw this.emitError(e),e}},a=s(e);this.emit(Xl.ErrorChange,{error:void 0}),null==(i=this.errorScreen)||i.removeErrorMessage();const o=async e=>{if(this.telemetry.onSetSource(e,{streams:e.source.streams,params:e.source.params,externalStalledDuration:e.source.externalStalledDuration?e.source.externalStalledDuration/1e3:void 0},this.getTelemetryStaticParams(e)),this.telemetry.enableRemoteProgressSaving(Ut(e)),!ye(e.source))throw new Fl("setSource method receive a serializable object");if(void 0===this.playerApiSourceConfig)return this.completeInitAfterGettingSourceConfig(e,void 0),void await Promise.race([this.waitForEvent(Xl.Ready),this.waitForEvent(Xl.ErrorChange).then(e=>{let{error:t}=e;throw t})]);this.playerTracker.setTrackings(Pe(e.trackings)),await this.setSourceInternal(e)};if(a.source.contentId){const t=this.initVhHelper({contentId:a.source.contentId,poster:a.source.params.preview,vhParams:void 0,queryParams:Aa({autoplay:0},e.queryParams)});return this.vhHelper=t,void t.on("SetSource",async t=>{var r;let{sourceConfig:i,skinConfig:n,externalPlayerConfig:a,autoplay:l}=t;this.configureSkin(Aa({},void 0!==n.title?{title:n.title}:{}),a),null!=i&&i.additionalParams&&(i.additionalParams.from=this.additionalParams.from,i.additionalParams.from_block=this.additionalParams.from_block);const d=ba(Aa({},i,e),gE);try{await o(s(d)),(!0===l||(0,Za.K)(l))&&(0,Pd.v)(this.play()),await this.waitForPlay()}catch(u){}null==(r=this.preloadSkin)||r.setVisibility(!1)})}await Promise.race([o(a),n.promise])}async preloadSource(e,t){const{signal:r}=t||{},i=(()=>{try{const r=null!=t&&t.ignoreSourceIndexIncreasing?this.telemetry.getSourceIndex():this.telemetry.onBeforePreload();return Ie(e,this.config,r)}catch(r){return}})();if(void 0===i)return Promise.reject(new Error("source is invalid"));if(i.source.params.additionalParams=this.addRequiredFieldsToAdditionalParams(i.source.params.additionalParams),null!=r&&r.aborted)return Promise.reject(new Error("preload was aborted"));if(!ye(i))return console.warn("preloadSource: sourceConfig is not serializable"),Promise.reject(new Error("sourceConfig is not serializable"));const n=String(this.nextPreloadRequestId++),s=new Promise((e,t)=>{let i=Yl.Z;const s=()=>{i(),t(),this.postMessenger.sendCommand(ah.abortPreloadSource,n)};null==r||r.addEventListener("abort",s);const a=r=>{switch(r.eventName){case"onPreloadSourceResolve":r.data===n&&(i(),e());break;case"onPreloadSourceReject":r.data===n&&(i(),t())}};this.postMessenger.on("Event",a);const o=()=>this.postMessenger.off("Event",a);i=()=>{o(),null==r||r.removeEventListener("abort",s)}});return this.postMessenger.sendCommand(ah.preloadSource,{sourceConfig:i.source,requestId:n}),s}async requestVideoElementFullscreen(){this.postMessenger.sendCommand(ah.setFullscreen,!0)}exitVideoElementFullscreen(){this.postMessenger.sendCommand(ah.setFullscreen,!1)}setNativeControlsVisibility(e){this.postMessenger.sendCommand(ah.setHiddenControls,function(e){return(0,Za.K)(e)?!1===e.showTimeline?[Tu.TIMELINE]:[]:e?[]:[Tu.ALL]}(e))}setNativeAdControlsVisibility(e){this.postMessenger.sendCommand(ah.setNativeAdControlsVisibility,e)}setPictureInPictureAllowed(e){this.postMessenger.sendCommand(ah.setPictureInPictureEnabled,e)}setVideoStyle(e){this.performOnInitStreamPlayer(()=>{this.postMessenger.sendCommand(ah.setVideoStyle,e)})}playInrollAd(e){this.postMessenger.sendCommand(ah.playInrollAd,e)}skipAdPod(){this.postMessenger.sendCommand(ah.skipAdPod,{})}async playAdViewers(e,t,r){if("inroll"===e&&!r)throw new Error("playAdViewers error: no cueId for inroll");const i=t.map(t=>({adViewer:t,additionalData:"inroll"===e?{cueId:r}:{},adType:e})),{success:n}=await this.postMessenger.sendRequest(ah.playAdViewers,{adType:e,adViewers:i});if(!n)throw new Error("playAdViewers error")}logEvent(e){let{event:t,params:r={}}=e;this.loggingForExternalToolsAllowed&&this.logEventInternal(t,r)}logError(e){this.loggingForExternalToolsAllowed&&this.telemetry.logError({error:e})}logSkinDelta(e,t,r){this.loggingForExternalToolsAllowed&&this.postMessenger.sendCommand(ah.logDelta,{deltaId:e,value:t,params:r})}logDelta(e,t,r){this.postMessenger.sendCommand(ah.logDelta,{deltaId:e,value:t,params:r})}async insertInto(e){var t;const{playingState:r}=this.getState();await this.postMessenger.sendRequest(ah.stopAd,{});const i=(0,Rd.w)(this.container.querySelectorAll("video")).map(e=>de(e));e.appendChild(this.container),X(i),this.visiblePlaybackController.restartVisibilityObserver(),null==(t=this.screenWakeLockController)||t.restartVisibilityObserver(),r!==Wl.X.PLAY&&r!==Wl.X.BUFFERING||this.play(eu.l.RestoreAfterInsertInto)}getReadyState(){return this.destroyed?zc.k.destroyed:zc.k.ready}getContainer(){return this.container}async setSourceInternal(e,t){let{shouldSaveProgress:r=!1}=void 0===t?{}:t;const{source:i}=e;this.logEventInternal("SetSourceInternal",Aa({},i,{shouldSaveProgress:r})),i.params.additionalParams=this.addRequiredFieldsToAdditionalParams(i.params.additionalParams),this.playerApiSourceConfig=e,this.updateStateForSetSource(i,{shouldSaveProgress:r});const n=this.waitForSetSourceComplete();this.setSourceStage=cu.LOADING,this.resetPlayerAliveData(),await this.postMessenger.sendRequest(ah.setSource,{sourceConfig:i,shouldSaveProgress:r}),this.additionalParams=i.params.additionalParams,await n,this.playerTracker.onSetSourceComplete(i)}async destroyInternal(e){var t;this.destroyed||(this.destroyed=!0,this.telemetry.logEvent({name:"DestroyCalled",data:{message:e}}),this.emit(Xl.StartStageChange,{startStage:Gd.destroyed}),null==(t=this.setSourceDeferred)||t.reject(new Error("SetSource rejected cause destroy player")),await this.destroyStreamPlayer(e),Q(this.container),this.emit(Xl.Destroy,{}),super.destroy(),this.telemetry.destroy({reason:e}))}initTrackChangeLogging(){let e=this.getState().videoTrack,t=this.getState().audioTrack,r=this.getState().textTrack;this.on(Xl.VideoTrackChange,t=>{let{videoTrack:r}=t;const i=e;e=r,!(0,Za.K)(i)||!(0,Za.K)(r)||i.auto&&r.auto||i.value===r.value&&i.auto===r.auto||this.telemetry.logEvent({name:"SetVideoTrack",data:{previous:Xe(i),next:Xe(r)}})}),this.on(Xl.AudioTrackChange,e=>{let{audioTrack:r}=e;(0,Za.K)(t)&&(0,Za.K)(r)&&t.name!==r.name&&this.telemetry.logEvent({name:"SetAudioTrack",data:{previous:ze(t),next:ze(r)}}),t=r}),this.on(Xl.TextTrackChange,e=>{let{textTrack:t}=e;void 0===r&&void 0===t||this.telemetry.logEvent({name:"SetTextTrack",data:{previous:Ze(r),next:Ze(t)}}),r=t})}initVisiblePlaybackController(e,t){const r=new qh(this);this.once(Xl.Destroy,()=>{r.destroy()});const i=new Wh({play:()=>{this.playingStateSynchronization.waitAndLock(()=>this.play(eu.l.VisiblePlayback))},pause:()=>{this.playingStateSynchronization.waitAndLock(async()=>{this.pause(eu.l.VisiblePlayback)})},togglePlaybackVisibilitySetting:e,autoplay:t,playerStateAdaptor:r,logEvent:e=>this.telemetry.logEvent({name:e})}),n=e=>{let{playingState:t,playingStateReason:r}=e;r!==eu.l.VisiblePlayback&&i.actualizeAutoplay(t===Wl.X.PLAY)};this.on(Xl.RequestPlayingState,n),this.once(Xl.WatchedTimeChange,()=>{this.off(Xl.RequestPlayingState,n)}),this.once(Xl.Destroy,()=>{i.destroy()});const s=new Hh({element:this.container,togglePlaybackVisibilitySetting:e,playerStateAdaptor:r,playPauseController:i});this.once(Xl.Destroy,()=>{s.destroy()}),s.observeVisualState(e=>{this.performOnInitStreamPlayer(()=>{this.postMessenger.sendCommand(ah.setExternalVisualState,{isVisible:e.isElementVisible})})}),this.postMessenger.on("Command",e=>{e.commandName===ah.getExternalVisualState&&e.sendAnswer({isVisible:s.getVisualState().isElementVisible})});const a=e=>{s.notifyFullScreen(e.isFullscreen)};this.on(Xl.FullscreenStateChange,a),this.once(Xl.Destroy,()=>{this.off(Xl.FullscreenStateChange,a)});const o=e=>{s.notifyPip(e.isPictureInPicture)};return this.on(Xl.PictureInPictureStateChange,o),this.once(Xl.Destroy,()=>{this.off(Xl.PictureInPictureStateChange,o)}),s}initErrorScreen(){this.once(Xl.ResourcesIdle,this.loadComponents),this.on(Xl.ErrorChange,async e=>{var t;let{error:r}=e;void 0!==r?rt(r)||(await this.loadComponents(),this.destroyed||(void 0===this.errorScreen&&(this.errorScreen=Jl.f.initErrorScreen(Aa({},this.additionalParams,{element:this.container,onReportClick:this.sendReportToTelemetry,getReportId:()=>this.telemetry.generateReportId()})),this.once(Xl.Destroy,()=>this.errorScreen.destroy())),r=void 0===this.store?r:this.store.getState().error,void 0!==r&&(null==(t=this.postMessenger)||t.sendCommand(ah.setPictureInPicture,!1),this.errorScreen.showErrorMessage(r.messageDetails||se(r))))):this.errorScreen&&this.errorScreen.changeVisibility(!1)})}addRequiredFieldsToAdditionalParams(e){return Aa({},e,{vsid:this.additionalParams.vsid,from:e.from||this.additionalParams.from,puid:e.puid||this.additionalParams.puid,folder_id:e.folder_id||this.additionalParams.folder_id})}waitForSetSourceComplete(){return new Promise((e,t)=>{const r=this.sourceIdSignal.addOne(()=>{this.setSourceStage=cu.READY,e(),s()}),i=e=>{let{error:r}=e;r&&r.isFatal&&(this.setSourceStage=cu.ERROR,t(r),s())},n=()=>{t({message:"CANCELED",isFatal:!1}),s()},s=()=>{r(),this.off(Xl.ErrorChange,i),this.off(Xl.SourceChange,n)};this.on(Xl.ErrorChange,i),this.once(Xl.SourceChange,n)})}createInternalContainer(e){const t=e.ownerDocument.createElement("div");return W(t,{width:"100%",height:"100%"}),Z(e,t),t}prepareContainerNode(){const e=Y(this.container,q(this.container)).position;W(this.container,{position:e&&"static"!==e?e:"relative"})}createPlayerNode(){const e=this.container.ownerDocument.createElement("div");return W(e,{width:"100%",height:"100%",position:"absolute",top:"0",left:"0"}),e}initPlayerStore(e){let{config:t,vsid:r}=e;return new Ip(Aa({},uu,{volume:t.streamPlayerParams.volume,muted:t.streamPlayerParams.muted,vsid:r}),(e,t)=>this.on(e,t))}initPostMessenger(){const e=new dh({id:this.getState().vsid,receiver:lh,sender:oh});return e.on("Event",e=>{var t,r;if("onInitError"===e.eventName)return this.emitError(new Fl(e.data)),void(e.data.code===Ba.PLAYER_CONTAINER_NOT_FOUND&&this.destroyInternal(au.PlayerContainerNotFound));if(!this.isReady&&"onReady"!==e.eventName)return this.debug.logInternals&&console.warn("// not ready",e.eventName,e.data),void this.readyPendingEvents.push(e);const{sourceId:i}=e;this.sourceIdSignal.dispatch(i);const n=function(e){return vh[e]}(e.eventName),s=(e=>{let{eventName:t,data:r}=e;if("onError"!==t)return!1;try{return r=r,!!r.isFatal&&("string"===typeof r.details?JSON.parse(r.details).stage===ru.SET_SOURCE:r.details.stage===ru.SET_SOURCE)}catch(TE){return!1}})(e);if(this.setSourceStage!==cu.LOADING||!n||s)if(this.setSourceStage===cu.READY&&n&&i<this.sourceIdSignal.getValue())this.debug.logInternals&&console.warn("// skip public and internal "+e.eventName+" because of old source",e.eventName,e.data);else switch(e.eventName){case"onInit":break;case"onVideoTypeChange":this.emit(Xl.VideoTypeChange,{videoType:e.data});break;case"onStateChange":const{playingState:i,reason:n}=e.data;this.getState().playingState!==i&&(this.emit(Xl.PlayingStateChange,{playingState:i,playingStateReason:n}),this.telemetry.writePlayerAliveStateManually());break;case"onExpectedStalledChange":this.telemetry.onExpectedBuffering(e.data);break;case"onAdStateChange":const{nextAdState:s,prevAdState:a}=e.data;this.emit(Xl.AdStateChange,{adState:s});a.state===tu.NOT_PLAYING&&s.state===tu.PLAYING&&this.telemetry.onAdStart({adType:s.type});a.state===tu.PLAYING&&s.state===tu.NOT_PLAYING&&this.telemetry.onAdEnd({adType:a.type});break;case"onBeforeAdPodStart":this.emit(Xl.BeforeAdPodStart,e.data);break;case"onAdLoaded":this.playerTracker.onAdLoaded(e.data),this.emit(Xl.AdLoaded,e.data);break;case"onAdError":this.playerTracker.onAdError(),this.emit(Xl.AdError,e.data);break;case"onAdPodClick":this.playerTracker.onAdPodClick(),this.emit(Xl.AdPodClick,{});break;case"onAdPodStart":const{adState:{type:o},source:{params:{adConfig:l={}}={}}={}}=this.getState();void 0!==o&&this.emit(Xl.AdPodStart,{type:o,adConfig:l});break;case"onAdPodSkip":this.emit(Xl.AdPodSkip,{});break;case"onAdPodEnd":this.emit(Xl.AdPodEnd,{}),this.telemetry.onAdBetween({adType:this.getState().adState.type});break;case"onAdSkippableStateChange":this.emit(Xl.AdSkippableStateChange,{adSkippableState:e.data});break;case"onAdVolumeAvailabilityStateChange":this.emit(Xl.AdVolumeAvailabilityStateChange,{adVolumeAvailabilityState:e.data});break;case"onAdPodCloseStateChange":this.emit(Xl.AdPodCloseStateChange,{adPodCloseState:e.data});break;case"onAdPodDurationChange":this.emit(Xl.AdPodDurationChange,{adPodDuration:e.data});break;case"onAdPodCurrentTimeChange":this.emit(Xl.AdPodCurrentTimeChange,{adPodCurrentTime:e.data});break;case"onAdPodTimeToSkipChange":this.emit(Xl.AdPodTimeToSkipChange,{adPodTimeToSkip:e.data});break;case"onAdInteraction":this.emit(Xl.AdInteraction,void 0);break;case"onNextAdRemainingTimeChange":this.emit(Xl.NextAdRemainingTimeChange,{nextAdRemainingTime:e.data});break;case"onTimelineInfoChange":const{currentTime:d,duration:u,utcStartTime:c,dvrStartTime:h,dvrDuration:p}=e.data;this.emit(Xl.CurrentTimeChange,{currentTime:d}),this.emit(Xl.DurationChange,{duration:u}),this.emit(Xl.UtcStartTimeChange,{utcStartTime:c}),this.emit(Xl.DVRStartTimeChange,{dvrStartTime:h}),this.emit(Xl.DVRDurationChange,{dvrDuration:p}),this.emit(Xl.PlaybackRateRangeChange,{playbackRateRange:tt({videoType:this.getState().videoType,currentTime:d,dvrStartTime:h,dvrDuration:p})});break;case"onPositionChange":const{watchedTime:f,liveLatency:m}=e.data;this.emit(Xl.WatchedTimeChange,{watchedTime:f}),this.emit(Xl.LiveLatencyChange,{liveLatency:m});break;case"onFullScreenChange":this.emit(Xl.FullscreenStateChange,{isFullscreen:e.data});break;case"onRequestFullscreenChange":this.emit(Xl.RequestFullscreenStateChange,{nextFullscreenState:e.data});break;case"onVolumeChange":this.emit(Xl.MutedChange,{muted:e.data.muted}),this.emit(Xl.VolumeChange,{volume:e.data.volume}),this.emit(Xl.VolumeChangeReasonChange,{volumeChangeReason:e.data.changeReason});break;case"onReady":this.emit(Xl.Ready,this);break;case"onError":this.emitError(new Fl(e.data));break;case"onRecover":this.telemetry.logEvent({name:"RecoverStreamError",data:{details:e.data}}),this.telemetry.onRecover({recoverReason:e.data.reason}),this.emit(Xl.RecoverStart,e.data);break;case"onVideoTrackChange":this.emit(Xl.VideoTrackChange,{videoTrack:e.data});break;case"onVideoTracksChange":this.emit(Xl.VideoTracksChange,{videoTracks:e.data});break;case"onAudioTrackChange":this.emit(Xl.AudioTrackChange,{audioTrack:e.data});break;case"onAudioTracksChange":this.emit(Xl.AudioTracksChange,{audioTracks:e.data});break;case"onTextTrackChange":this.emit(Xl.TextTrackChange,{textTrack:e.data});break;case"onTextTracksChange":this.emit(Xl.TextTracksChange,{textTracks:e.data});break;case"onSubtitlesChange":this.emit(Xl.SubtitlesChange,{subtitles:e.data});break;case"onPlaybackRateChange":const g=this.getState().playbackRate;this.emit(Xl.PlaybackRateChange,{playbackRate:e.data}),g!==e.data&&this.telemetry.writePlayerAliveStateManually();break;case"onBufferingRangesChange":this.emit(Xl.BufferedRangesChange,{bufferedRanges:e.data});break;case"onThumbnailTileGeneralMetaInfoChange":this.emit(Xl.TileMetaInfoChange,{tileMetaInfo:e.data});break;case"onOriginalBroadcastAdStateChange":const{cueId:v,originalBroadcastAdDuration:y}=e.data;this.logEventInternal(void 0===v?"OriginalBroadcastAdEnd":"OriginalBroadcastAdStart",{cueId:v,originalBroadcastAdDuration:y});break;case"onDrmSystemChange":this.telemetry.setStaticParams({drm:e.data}),this.emit(Xl.DrmSystemChange,{drmSystem:e.data});break;case"onChangeStream":e.data&&this.telemetry.setStaticParams({streamUrl:e.data.url}),this.emit(Xl.StreamChange,{stream:e.data}),this.emit(Xl.TileMetaInfoUrlChange,{tileMetaInfoUrl:at(e.data?e.data.url:void 0)});break;case"onStreamsWithSupportInfoChange":this.emit(Xl.StreamsWithSupportInfoChange,e.data);break;case"onContentImpression":this.emit(Xl.ContentImpression,e.data);break;case"onResourcesIdle":this.emit(Xl.ResourcesIdle,{});break;case"onVisualStateChange":const{isFullscreen:S,isPictureInPicture:E}=this.getState();S===e.data.isFullScreen&&E===e.data.isPip||this.telemetry.writePlayerAliveStateManually(),this.emit(Xl.PictureInPictureStateChange,{isPictureInPicture:e.data.isPip}),this.emit(Xl.VisibleStateChange,{isVisible:e.data.isVisible}),this.telemetry.setStaticParams({visualState:e.data}),this.savePlayerAliveData({containerWidth:e.data.width*devicePixelRatio,containerHeight:e.data.height*devicePixelRatio});break;case"onCapSizeChange":this.savePlayerAliveData({capWidth:null==(t=e.data)?void 0:t.width,capHeight:null==(r=e.data)?void 0:r.height});break;case"onPlaybackQualityUpdate":const b={droppedFrames:e.data.droppedVideoFrames,shownFrames:e.data.totalVideoFrames-e.data.droppedVideoFrames};this.savePlayerAliveData(b),this.invokeOrQueueDebugPanelCallback(()=>{var e;return null==(e=this.debugPanel)?void 0:e.onFramesInfoChange(b)});break;case"onEngineChange":this.telemetry.setStaticParams({engine:e.data}),this.invokeOrQueueDebugPanelCallback(()=>{var t;return null==(t=this.debugPanel)?void 0:t.onEngineChange(e.data)});break;case"onStartStageChange":this.emit(Xl.StartStageChange,{startStage:e.data}),e.data!==Gd.waitForDocumentVisibility&&e.data!==Gd.waitForUserPlay||this.telemetry.stopInitBufferingTimer(),e.data!==Gd.init&&e.data!==Gd.starting||this.telemetry.onInitBuffering();break;case"onVideoSizeChange":this.emit(Xl.VideoSizeChange,{videoSize:e.data});break;case"onBandwidthEstimateChange":const A=Math.round(e.data.value),T=e.data.source;this.savePlayerAliveData({bandwidthEstimate:A,bandwidthSource:T});const _=function(e){return e.value<=5e5?rh.SLOW:rh.OK}(e.data);this.getState().connectionQuality!==_&&this.emit(Xl.ConnectionQualityChange,{connectionQuality:_}),this.invokeOrQueueDebugPanelCallback(()=>{var t;return null==(t=this.debugPanel)?void 0:t.onBandwidthEstimateChange(e.data)});break;case"onInrollFrame":this.emit(Xl.InrollFrame,e.data);break;case"onLogEvent":this.telemetry.logEvent({name:e.data.event,data:e.data.params,labels:e.data.additionalStatsLabels},e.data.sourceIndex);break;case"onPreloadSourceResolve":case"onPreloadSourceReject":break;case"onFrameRendered":this.emit(Xl.FrameRendered,{currentTime:e.data});break;case"onTargetLatencyChange":this.invokeOrQueueDebugPanelCallback(()=>{var t;null==(t=this.debugPanel)||t.onTargetLatencyChange(e.data)})}else this.debug.logInternals&&console.warn("// skip public and internal "+e.eventName+" because setSource is in progress",e.eventName,e.data)}),e}async requestExternalCsrfToken(){if(this.externalPlaybackCsrfToken)return this.externalPlaybackCsrfToken;try{this.logEventInternal($d.ExternalPlaybackPlayerCsrfFetching);const{token:e}=await Jc();return this.logEventInternal($d.ExternalPlaybackPlayerCsrfFetchSuccess),this.updateExternalPlaybackCsrfToken(e),e}catch(e){return this.logEventInternal($d.ExternalPlaybackPlayerCsrfFetchError),""}}updateExternalPlaybackCsrfToken(e){this.externalPlaybackCsrfToken=e,void 0!==e&&(clearTimeout(this.externalPlaybackTokenExpireTimeout),this.externalPlaybackTokenExpireTimeout=window.setTimeout(()=>{this.externalPlaybackCsrfToken=void 0,this.logEventInternal($d.ExternalPlaybackCsrfTokenExpired)},6e4))}logEventInternal(e,t,r){void 0===t&&(t={}),this.telemetry.logEvent({name:e,data:t,extraRootFields:r})}async destroyStreamPlayer(e){if(!this.isInitStreamPlayer)return;const{isFullscreen:t}=this.getState();if(t)return new Promise(r=>{t&&(this.once(Xl.FullscreenStateChange,()=>{this.destroyStreamPlayer(e).then(r)}),this.exitVideoElementFullscreen())});await this.postMessenger.sendRequest(ah.destroy,{reason:e})}subscribeExternalFullscreenChange(e){this.once(Xl.Destroy,function(e){let{element:t,onChange:r}=e;const i=t.ownerDocument||window.document;let n=!1;r(n);const s=Sh.map(e=>(n=n||nt(i,t),(0,yh.O)(i,e.events.change,()=>{try{const e=nt(i,t);if(e===n)return;r(e),n=e}catch(e){}},{passive:!0})));return()=>{s.forEach(e=>e())}}({element:e,onChange:e=>{this.performOnInitStreamPlayer(()=>{this.postMessenger.sendCommand(ah.setExternalVisualState,{isFullscreen:e})})}}))}initPlaybackTracking(){this.on(Xl.PlayingStateChange,e=>{let{playingState:t}=e;return this.telemetry.setPlayingState(t)})}initPlayerTracker(){const e=new Wc({vsid:this.getState().vsid,getAdState:()=>this.getState().adState,getVideoTrack:()=>this.getState().videoTrack,getAudioTrack:()=>this.getState().audioTrack,getTextTrack:()=>this.getState().textTrack,getVideoType:()=>this.getState().videoType,getIsFullscreen:()=>this.getState().isFullscreen,getDrmSystemName:()=>this.getState().drmSystem,getIsDrmSupported:()=>{var e;if(void 0!==(null==(e=this.getState().stream)?void 0:e.drmConfig))return void 0===this.getState().error},getMuted:()=>this.getState().muted||0===this.getState().volume,getDuration:()=>this.getState().duration||0,getPlayingState:()=>this.getState().playingState,getCurrentTime:()=>this.getState().currentTime,getWatchedTime:()=>this.getState().watchedTime,getUtcPosition:()=>{const{utcStartTime:e,currentTime:t}=this.getState();return void 0===e?0:e+t}});return this.on(Xl.Ready,e.onReady),this.on(Xl.ErrorChange,t=>{let{error:r}=t;void 0!==r&&e.onError(r)}),this.on(Xl.CurrentTimeChange,t=>{let{currentTime:r}=t;return e.onCurrentTimeChange(r)}),this.on(Xl.WatchedTimeChange,t=>{let{watchedTime:r}=t;return e.onWatchedTimeChange(r)}),this.on(Xl.AdStateChange,t=>{let{adState:r}=t;return e.onAdStateChange(r)}),this.on(Xl.PlayingStateChange,t=>{let{playingState:r}=t;return e.onStateChange(r)}),this.on(Xl.AdPodStart,()=>{e.onAdPodStart()}),this.on(Xl.AdPodEnd,()=>{e.onAdPodEnd()}),this.on(Xl.AdPodSkip,()=>{e.onAdPodSkip()}),e}invokeOrQueueDebugPanelCallback(e){this.debugPanel?e():this.onPanelInitCallbacks.push(e)}initDebugPanel(){this.once(Xl.ResourcesIdle,async()=>{if(await this.loadComponents(),!this.destroyed&&void 0===this.debugPanel){this.debugPanel=Jl.f.initDebugPanel({container:this.container,getState:()=>this.getState(),getSourceId:()=>this.sourceIdSignal.getValue(),getAdditionalParams:()=>this.additionalParams,options:{qr:!0}}),this.once(Xl.Destroy,()=>{var e;return null==(e=this.debugPanel)?void 0:e.destroy()});const e=()=>{var e;return null==(e=this.debugPanel)?void 0:e.update()};this.on(Xl.CurrentTimeChange,e),this.on(Xl.DurationChange,e),this.on(Xl.WatchedTimeChange,e),this.on(Xl.PlayingStateChange,e),this.on(Xl.LiveLatencyChange,e),this.on(Xl.VideoTypeChange,e),this.on(Xl.SourceChange,e),this.on(Xl.VideoTrackChange,e),this.on(Xl.AudioTrackChange,e),this.on(Xl.BufferedRangesChange,e),this.onPanelInitCallbacks.forEach(e=>e()),this.onPanelInitCallbacks.length=0,this.debugPanel.setVisibility(this.debug.showDebugPanel)}})}requestSourceConfigForRecover(e){if(e.isFatal&&function(e){return!rt(e)&&(e.category===Ya.q.DRM?e.code===Ga.DRM_PROXY_ERROR_SIGNATURE_EXPIRED:e.category===Ya.q.REGIONAL||e.category===Ya.q.ACCESS)}(e))return Promise.resolve().then(()=>{var e;const t=null==(e=this.playerApiSourceConfig)?void 0:e.update();return kd(t)&&(this.emit(Xl.PlayingStateChange,{playingState:Wl.X.BUFFERING,playingStateReason:eu.l.WaitForSourceConfigUpdate}),t.catch(e=>{throw this.emit(Xl.PlayingStateChange,{playingState:Wl.X.PAUSE,playingStateReason:eu.l.Unknown}),e})),t})}async tryRecoverSourceConfigInAsyncMode(e){const t=await this.requestSourceConfigForRecover(e);if(void 0===t)return!1;const r=(()=>{try{return Ie(t,this.config,this.playerApiSourceConfig.source.sourceIndex)}catch(e){const t=Fl.from(e,{code:Ba.INVALID_CONFIG_IN_SOURCE_UPDATE,isFatal:!1});return void this.emitError(t)}})();return void 0!==r&&(setTimeout(()=>{this.logEventInternal("UpdateSourceConfig"),this.setSourceInternal(r,{shouldSaveProgress:!0})}),!0)}tryRecoverSourceConfigInSyncMode(e){const t=this.getSourceConfigForRecover(e);return!!t&&(setTimeout(()=>{this.logEventInternal("UpdateSourceConfigSync"),this.setSourceInternal(t,{shouldSaveProgress:!0})}),!0)}async tryRecoverSourceConfig(e){try{if(this.tryRecoverSourceConfigInSyncMode(e))return!0;if(await this.tryRecoverSourceConfigInAsyncMode(e))return!0}catch(t){}return!1}async emitError(e,t){if(e.isFatal&&e.category===Ya.q.DRM&&!Yp&&(e=new Fl({code:Ud?Ba.IFRAME_DOES_NOT_ALLOW_DRM:Ba.DRM_IS_NOT_ALLOWED,isFatal:!0,details:{originalCode:e.code,originalDetails:e.details,allowedFeaturePolicies:Yt()}},this.additionalParams.vsid)),(e=new Fl(Aa({},e.toJSON(),{isFatal:e.isFatal&&!this.destroyed&&z(this.container)}),this.additionalParams.vsid)).isFatal&&this.emit(Xl.PlayingStateChange,{playingState:Wl.X.PAUSE,playingStateReason:eu.l.Unknown}),e.isFatal&&function(e){return-1===gh.indexOf(e.category)}(e)){let t=gt(this.getState())?Wl.X.PLAY:Wl.X.PAUSE;const r=e=>{let{playingState:r}=e;t=r};this.on(Xl.RequestPlayingState,r);const i=await this.tryRecoverSourceConfig(e);this.off(Xl.RequestPlayingState,r),i&&(e=new Fl(Aa({},e.toJSON(),{isFatal:!1})),gt({playingState:t})&&this.play(eu.l.CompletedRecoverSourceConfig))}var r,i;e.isFatal&&(null==(r=this.setSourceDeferred)||r.reject(new Error("SetSource rejected cause fatal error")),null!=(i=this.getState())&&i.error?e=new Fl(Aa({},e.toJSON(),{isFatal:!1})):this.emit(Xl.ErrorChange,{error:e}));this.telemetry.logError({error:e,extraRootFields:t})}initPreloadSkin(e){if(!1===e.loadSkin)return;if(this.getState().playingState===Wl.X.PLAY)return;const t=Lt({document:this.container.ownerDocument,poster:void 0,firstFrameHash:void 0,firstFrameUrl:void 0,style:void 0,hiddenControls:e.originalHiddenControls,primaryColor:e.primaryColor,backgroundColor:e.streamPlayerParams.backgroundColor,onReady:()=>{this.emit(Xl.PosterReady,{})}});return this.container.appendChild(t.element),this.once(Xl.SkinReady,()=>{var e;!(this.vhHelper&&null!=(e=this.getState().error)&&e.isFatal)&&t.setVisibility(!1)}),this.once(Xl.Destroy,()=>t.destroy()),this.waitForPlay().then(()=>{t.setVisibility(!1)}).catch(Yl.Z),t}updateStateForSetSource(e,t){let{shouldSaveProgress:r=!1}=void 0===t?{}:t;this.unsetFiltersForSourceRelatedEvents(),this.emit(Xl.StreamChange,{stream:void 0}),this.emit(Xl.SourceChange,{source:e}),this.emit(Xl.StreamsWithSupportInfoChange,void 0),this.emit(Xl.DrmSystemChange,{drmSystem:void 0}),this.emit(Xl.VideoTrackChange,{videoTrack:void 0}),this.emit(Xl.VideoTracksChange,{videoTracks:[]}),this.emit(Xl.AudioTrackChange,{audioTrack:void 0}),this.emit(Xl.AudioTracksChange,{audioTracks:[]}),this.emit(Xl.TextTrackChange,{textTrack:void 0}),this.emit(Xl.TextTracksChange,{textTracks:[]}),this.emit(Xl.TileMetaInfoChange,{tileMetaInfo:void 0}),this.emit(Xl.CurrentTimeChange,{currentTime:uu.currentTime}),this.emit(Xl.DurationChange,{duration:uu.duration}),this.emit(Xl.UtcStartTimeChange,{utcStartTime:uu.utcStartTime}),this.emit(Xl.DVRStartTimeChange,{dvrStartTime:uu.dvrStartTime}),this.emit(Xl.DVRDurationChange,{dvrDuration:uu.dvrDuration}),r||this.emit(Xl.WatchedTimeChange,{watchedTime:uu.watchedTime}),this.emit(Xl.VideoTypeChange,{videoType:uu.videoType}),this.emit(Xl.AdStateChange,{adState:uu.adState}),this.setFiltersForSourceRelatedEvents()}setFiltersForSourceRelatedEvents(){this.setFilter(Xl.CurrentTimeChange,e=>{let{currentTime:t}=e;return!qd()(t,this.getState().currentTime)}),this.setFilter(Xl.WatchedTimeChange,e=>{let{watchedTime:t}=e;return!qd()(t,this.getState().watchedTime)}),this.setFilter(Xl.DurationChange,e=>{let{duration:t}=e;return!qd()(t,this.getState().duration)}),this.setFilter(Xl.UtcStartTimeChange,e=>{let{utcStartTime:t}=e;return!qd()(t,this.getState().utcStartTime)}),this.setFilter(Xl.DVRStartTimeChange,e=>{let{dvrStartTime:t}=e;return!qd()(t,this.getState().dvrStartTime)}),this.setFilter(Xl.DVRDurationChange,e=>{let{dvrDuration:t}=e;return!qd()(t,this.getState().dvrDuration)}),this.setFilter(Xl.PlaybackRateRangeChange,e=>{let{playbackRateRange:t}=e;return!qd()(t,this.getState().playbackRateRange)}),this.setFilter(Xl.AdStateChange,e=>{let{adState:t}=e;return!qd()(t,this.getState().adState)}),this.setFilter(Xl.VolumeChange,e=>{let{volume:t}=e;return!qd()(t,this.getState().volume)}),this.setFilter(Xl.VideoTracksChange,e=>{let{videoTracks:t}=e;return!(0===this.getState().videoTracks.length&&0===t.length)}),this.setFilter(Xl.AudioTracksChange,e=>{let{audioTracks:t}=e;return!(0===this.getState().audioTracks.length&&0===t.length)}),this.setFilter(Xl.TextTracksChange,e=>{let{textTracks:t}=e;return!(0===this.getState().textTracks.length&&0===t.length)})}unsetFiltersForSourceRelatedEvents(){this.unsetFilter(Xl.CurrentTimeChange),this.unsetFilter(Xl.WatchedTimeChange),this.unsetFilter(Xl.DurationChange),this.unsetFilter(Xl.UtcStartTimeChange),this.unsetFilter(Xl.DVRStartTimeChange),this.unsetFilter(Xl.DVRDurationChange),this.unsetFilter(Xl.PlaybackRateRangeChange),this.unsetFilter(Xl.VolumeChange),this.unsetFilter(Xl.VideoTracksChange),this.unsetFilter(Xl.AudioTracksChange),this.unsetFilter(Xl.TextTracksChange)}savePlayerAliveData(e){this.playerAliveData=Aa({},this.playerAliveData,e)}resetPlayerAliveData(){this.playerAliveData={bandwidthEstimate:0,containerHeight:this.playerAliveData.containerHeight,containerWidth:this.playerAliveData.containerWidth}}applySourceInfoToTelemetry(e){try{this.telemetry.setStaticParams(this.getTelemetryStaticParams(e)),this.telemetry.enableRemoteProgressSaving(Ut(e))}catch(io){setTimeout(()=>{throw io})}}getTelemetryStaticParams(e){var t;const{source:r}=e,{puid:i,from:n}=r.params.additionalParams;return{additionalParameters:Wt(r.params.additionalParams),slots:(s=r.params.additionalParams,void 0===s?"":s.slots||""),testIds:le(r.params.additionalParams),videoContentId:r.params.videoInfo.videoContentId,streamUrl:null==(t=r.streams[0])?void 0:t.url,labels:{from:n},engine:void 0,drm:void 0,puid:i};var s}createSourceConfigForRecoverGetter(e){let t,r=e.source;return this.on(Xl.SourceChange,e=>{let{source:t}=e;r=t}),this.on(Xl.StreamsWithSupportInfoChange,e=>{t=e}),i=>{const n=void 0===t?void 0:nu(t);if(!this.canRecoverBySourceUpdate(i,r,n))return;const s=Td(r),a=n.map(e=>{let{stream:t}=e;return t});return s.streams=this.removeCurrentStream(a),Aa({},e,{source:s})}}canRecoverBySourceUpdate(e,t,r){if(!e.isFatal||!t||!r)return!1;const i=r.map(e=>{let{stream:t}=e;return t}),n=this.removeCurrentStream(i);return 0!==n.length&&n.length!==t.streams.length}removeCurrentStream(e){const{stream:t}=this.getState();return e.filter(e=>!qd()(e,t))}waitForEvent(e){return new Promise(t=>this.once(e,t))}initVhHelper(e){let{contentId:t,poster:r,vhParams:i,queryParams:n}=e;const s=new mh({contentId:t,vhParams:i,queryParams:(0,Gp.r)(Aa({},n),this.container),playerApi:this});return s.on("ShowAnnotation",async e=>{var t,r,i;await this.loadComponents(),null==(t=this.preloadSkin)||t.setSpinnerVisibility(!1),null==(r=this.preloadSkin)||r.setAnnotationText(Jl.f.i18nTranslateSandbox(e)),null==(i=this.preloadSkin)||i.setVisibility(!0)}),s.on("SetPoster",e=>{var t,i;null==(t=this.preloadSkin)||t.setPoster(r||e||"","",""),null==(i=this.preloadSkin)||i.setVisibility(!0)}),s.on("Destroy",()=>{var e,t,r;null==(e=this.preloadSkin)||e.setVisibility(!1),null==(t=this.preloadSkin)||t.setSpinnerVisibility(!1),null==(r=this.preloadSkin)||r.setPoster("","","")}),s.on("SetSource",()=>{var e,t;null==(e=this.preloadSkin)||e.setAnnotationText(""),null==(t=this.preloadSkin)||t.setSpinnerVisibility(!0)}),s.on("Error",e=>{var t;e.code===Ba.REQUEST_SOURCE_ERROR&&(null==(t=this.preloadSkin)||t.setVisibility(!1));this.emitError(e)}),s.on("UgcLiveStatusChange",e=>{this.emit(Xl.UgcLiveStatusChange,{ugcLiveStatus:e})}),s}waitForPlay(){return new Promise((e,t)=>{var r;this.once(Xl.Destroy,t),null==(r=this.setSourceDeferred)||r.promise.catch(t);const i=()=>{const e=this.getState();if(!e)return!1;const{playingState:t,adState:{state:r}}=e;return t===Wl.X.PLAY||r===tu.PLAYING};if(i())return void e();const n=()=>{i()&&(e(),this.off(Xl.PlayingStateChange,n),this.off(Xl.AdStateChange,n))};this.on(Xl.PlayingStateChange,n),this.on(Xl.AdStateChange,n)})}configureSkin(e,t){if(void 0!==this.config.loadSkin)return;const r=()=>{this.skin&&(this.skin.configure(e),this.skin.updateExternalPlayerConfig(t))};this.skin?r():this.once(Xl.SkinReady,e=>{let{error:t}=e;t||r()})}initOnlyOnePlayingUnmutePlayerControl(){const{vsid:e}=this.getState(),t=()=>{sessionStorage.setItem("videoplayer-playing-vsid",e),dispatchEvent(new StorageEvent("storage",{key:"videoplayer-playing-vsid"}))};addEventListener("storage",t=>{let{key:r}=t;if("videoplayer-playing-vsid"!==r)return;const i=sessionStorage.getItem("videoplayer-playing-vsid");if(!i)return;const{muted:n}=this.getState();i===e||n||this.pause(eu.l.StartPlayingAnotherPlayer)}),this.on(Xl.PlayingStateChange,e=>{let{playingState:r}=e;const{muted:i}=this.getState();r!==Wl.X.PLAY||i||t()}),this.on(Xl.MutedChange,e=>{let{muted:r}=e;const{playingState:i}=this.getState();i!==Wl.X.PLAY||r||t()})}}let SE,EE;!function(e){e.PLAYER_API="player-api.js",e.PLAYER_API_MODERN="player-api.modern.js"}(SE||(SE={}));const bE=["setReadyInstance","setInstance"],AE=e=>e.usePlayerApiMock?Ra(e):H(e,e=>new yE(e));Na.create=AE;{const{createVhPlayerApi:e}=r(8484);Na.createVhPlayerApi=e}Da.init=AE,Da.preloadScripts=()=>Promise.resolve([])},9150:(e,t,r)=>{"use strict";function i(e){const t=[];for(let i=0;i<e.buffered.length;i++)try{t.push({start:e.buffered.start(i),end:e.buffered.end(i)})}catch(r){}return(0,n.l)(t)}r.d(t,{w:()=>i});var n=r(520);r(7881)},8493:(e,t,r)=>{"use strict";r.d(t,{S:()=>i,e:()=>n});r(7881);const i=1e6,n=1e5},9591:(e,t,r)=>{"use strict";r.d(t,{T:()=>i});r(7881);const i=360},3564:(e,t,r)=>{"use strict";function i(e){const t=new URL(e);return t.searchParams.set(n,String(Date.now())),t.href}r.d(t,{c:()=>i,j:()=>n});const n="t"},6513:(e,t,r)=>{"use strict";function i(e,t,r){let{videoWidth:i,videoHeight:n}=e;const{width:s,height:a}=r;if(!i||!n)return{width:s,height:a};switch(t){case"none":return{width:i,height:n};case"cover":{const e=Math.floor(n*s/i);return e>=a?{width:s,height:e}:{height:a,width:Math.floor(i*a/n)}}case"contain":case"scale-down":{const e=Math.floor(n*s/i);return e<=a?{width:s,height:e}:{height:a,width:Math.floor(i*a/n)}}case"fill":default:return{width:s,height:a}}}r.d(t,{k:()=>i});r(7881)},4893:(e,t,r)=>{"use strict";r.d(t,{k:()=>s,nK:()=>a});var i=r(9396),n=r(2067);const s={width:null,height:null,timestamp:null},a=()=>{const e=i.t.getItem("videoplayer-user-quality-choice");if(!e)return s;try{const t=JSON.parse(e);return t?(0,n.RW)("web_userquality_ttl")&&(t.timestamp||(t.timestamp=Date.now()-2592e6+Math.round(6048e4*Math.random()),i.t.setItem("videoplayer-user-quality-choice",JSON.stringify(t))),t.timestamp+2592e6<Date.now())?s:t:s}catch(t){return s}}},442:(e,t,r)=>{"use strict";r.d(t,{C:()=>s,d4:()=>i,e8:()=>n});r(7881);const i=8e3,n=1e4,s=1e4},2248:(e,t,r)=>{"use strict";r.d(t,{T:()=>i});const i=["strm.yandex.net","strm.yandex.ru","strm-ott.akamaized.net","media.strm.yandex.net","cdn.ngenix.net","streaming.tst.strm.yandex.net"]},8682:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});const i="auto"},8172:(e,t,r)=>{"use strict";let i;r.d(t,{l:()=>i}),function(e){e.Unknown="Unknown",e.ExternalApi="ExternalApi",e.VisiblePlayback="VisiblePlayback",e.PlayRejected="PlayRejected",e.RestoreAfterInsertInto="RestoreAfterInsertInto",e.WaitForSourceConfigUpdate="WaitForSourceConfigUpdate",e.CompletedRecoverSourceConfig="CompletedRecoverSourceConfig",e.StartPlayingAnotherPlayer="StartPlayingAnotherPlayer",e.PlayerListSdkPauseOnActiveItemChange="PlayerListSdkPauseOnActiveItemChange"}(i||(i={}))},2786:(e,t,r)=>{"use strict";function i(e){void 0===e&&(e=window);const{navigator:t}=e,{connection:r={}}=t;return Boolean(r.saveData)}r.d(t,{R:()=>i})},9034:(e,t,r)=>{"use strict";function i(e){const{hostname:t}=(0,o.en)(e),r=t.split(".");return r.length<=2?t:r.slice(-2).join(".")}function n(e,t,r){void 0===t&&(t=s),void 0===r&&(r=a);const{locationChain:n}=(0,l.T)(window),d=n.map(i),{hostname:u}=(0,o.en)(e),c=i(e);let h=!1;return(t.includes(u)||t.includes(c)||d.some(e=>r.includes(e)))&&(h=!0),h}r.r(t),r.d(t,{getSecondLevelDomain:()=>i,isStreamValid:()=>n});const s=["yandex.ru","yandex.net","yastatic.net","yandex-team.ru","kinopoisk.ru","strm-ott.akamaized.net","playlists-strm-yango.akamaized.net","media-strm-yango.akamaized.net"],a=["yandex.com","yandex.ru","yandex.md","yasmina.yango.com"].concat([]);var o=r(9223),l=r(7633)},9278:(e,t,r)=>{"use strict";function i(e){const t=e;return t.Ya||(t.Ya={}),t.Ya.streamPlayer||(t.Ya.streamPlayer={}),t.Ya.streamPlayer}r.d(t,{I:()=>i,f:()=>n});const n=i("object"===typeof self?self:window)},7922:(e,t,r)=>{"use strict";r.d(t,{D:()=>n,dn:()=>l,h9:()=>s,ly:()=>i,oo:()=>a,xE:()=>o});const i="com.widevine.alpha",n="com.apple.fairplay",s="com.apple.fps.1_0",a="com.apple.fps.2_0",o="com.microsoft.playready",l="org.w3.clearkey"},3539:(e,t,r)=>{"use strict";r.d(t,{f:()=>o,I:()=>d});r(7881);var i=r(9459),n=r.n(i),s=r(2067),a=n().ru.yandex.videoplayer.multiplatform;class o{static obtain(e){return o.instance||(o.instance=new o(e)),o.instance}constructor(e){this.fetchers=[],this.activeSources=new Set,this.defaultEstimate={value:NaN,source:"default"},this.mpBandwidthEstimator=void 0,this.handleFetcherProgress=e=>{let{time:t,size:r}=e;this.mpBandwidthEstimator.sample(t,r)},this.destroy=()=>{this.fetchers.forEach(e=>{e.off("Progress",this.handleFetcherProgress)}),this.fetchers.length=0},e&&(this.defaultEstimate.value=e),this.mpBandwidthEstimator=new a.estimate.BandwidthEstimator(this.defaultEstimate.value)}addActiveSource(e){this.activeSources.add(e)}removeActiveSource(e){this.activeSources.delete(e)}getActiveSourcesCount(){return this.activeSources.size}getBandwidthEstimate(){if((0,s.RW)("yasp_fair_bandwidth")){const e=this.getActiveSourcesCount();return{value:this.mpBandwidthEstimator.getBandwidthEstimate()/Math.max(e,1),source:this.mpBandwidthEstimator.hasGoodEstimate()?"ewma":this.defaultEstimate.source}}return{value:this.mpBandwidthEstimator.getBandwidthEstimate(),source:this.mpBandwidthEstimator.hasGoodEstimate()?"ewma":this.defaultEstimate.source}}appendFetcher(e){e.on("Progress",this.handleFetcherProgress),this.fetchers.push(e)}removeFetcher(e){e.off("Progress",this.handleFetcherProgress);for(let t=0;t<this.fetchers.length;t++)this.fetchers[t]===e&&(this.fetchers.splice(t,1),t--)}setDefaultEstimate(e){this.defaultEstimate=e,this.mpBandwidthEstimator.setDefaultEstimate(e.value)}getDebugInfo(){const e=this.getBandwidthEstimate();return{fetchersCount:this.fetchers.length,defaultEstimate:this.defaultEstimate,estimate:e.value,source:e.source}}}o.instance=void 0;var l=n().ru.yandex.videoplayer.multiplatform;class d{constructor(e){void 0===e&&(e=!1),this.mpEwmaBandwidthEstimator=void 0,this.mpEwmaBandwidthEstimator=new l.estimate.EwmaBandwidthEstimatorV2(NaN,e)}sample(e,t,r,i){this.mpEwmaBandwidthEstimator.sample(e,t,r,i)}getBandwidthEstimate(e){return this.hasGoodEstimate()?(this.mpEwmaBandwidthEstimator.setDefaultEstimate(e.value),{value:this.mpEwmaBandwidthEstimator.getBandwidthEstimate(),source:"ewma"}):e}hasGoodEstimate(){return this.mpEwmaBandwidthEstimator.hasGoodEstimate()}}},4910:(e,t,r)=>{"use strict";function i(e){return void 0===e||"string"!==typeof e?"":function(e){try{const t=new URL(e);return t.searchParams.delete(s.g),t.href}catch(t){return e}}(e).replace(/#.+$/,"")}function n(e){try{return new URL(e).searchParams.get(s.g)}catch(t){return null}}r.d(t,{Hi:()=>i,IN:()=>n});var s=r(123)},153:(e,t,r)=>{"use strict";r.d(t,{K:()=>i});const i=100},1911:(e,t,r)=>{"use strict";r.d(t,{d:()=>i});class i{constructor(e){this.buffer=[],this.head=0,this.capacity=void 0,this.capacity=e}push(e){this.buffer.length<this.capacity?this.buffer.push(e):this.buffer[this.head]=e,this.head=(this.head+1)%this.capacity}toArray(){return this.buffer.length<this.capacity?[...this.buffer]:[...this.buffer.slice(this.head),...this.buffer.slice(0,this.head)]}}},7817:(e,t,r)=>{"use strict";r.d(t,{x:()=>i});class i{static fromUTF8(e){if(!e)return"";let t=new Uint8Array(e);239===t[0]&&187===t[1]&&191===t[2]&&(t=t.subarray(3));let r=i.fromCharCode(t),n=escape(r);try{return decodeURIComponent(n)}catch(s){throw new Error("BAD_ENCODING")}}static fromUTF16(e,t,r){if(void 0===r&&(r=!1),!e)return"";if(!r&&e.byteLength%2!==0)throw new Error("BAD_ENCODING: Data has an incorrect length, must be even");let n;if(e instanceof ArrayBuffer)n=e;else{let t=new Uint8Array(e.byteLength);t.set(new Uint8Array(e)),n=t.buffer}let s=Math.floor(e.byteLength/2),a=new Uint16Array(s),o=new DataView(n);for(let i=0;i<s;i++)a[i]=o.getUint16(2*i,t);return i.fromCharCode(a)}static fromBytesAutoDetect(e){let t=new Uint8Array(e);if(239===t[0]&&187===t[1]&&191===t[2])return i.fromUTF8(t);if(254===t[0]&&255===t[1])return i.fromUTF16(t.subarray(2),!1);if(255===t[0]&&254===t[1])return i.fromUTF16(t.subarray(2),!0);const r=function(e,t){return e.byteLength<=t||e[t]>=32&&e[t]<=126};if(0===t[0]&&0===t[2])return i.fromUTF16(e,!1);if(0===t[1]&&0===t[3])return i.fromUTF16(e,!0);if(r(t,0)&&r(t,1)&&r(t,2)&&r(t,3))return i.fromUTF8(e);throw new Error("UNABLE_TO_DETECT_ENCODING")}static toUTF8(e){let t=encodeURIComponent(e),r=unescape(t),i=new Uint8Array(r.length);for(let n=0;n<r.length;++n)i[n]=r.charCodeAt(n);return i.buffer}static toUTF16(e,t){const r=new Uint8Array(2*e.length),i=new DataView(r.buffer);for(let n=0;n<e.length;++n){const r=e.charCodeAt(n);i.setUint16(2*n,r,t)}return r.buffer}static fromCharCode(e){if(!i.fromCharCodeImpl){const e=e=>{try{const t=new Uint8Array(e);return String.fromCharCode.apply(null,t).length>0}catch(t){return!1}};for(let t=65536;t>0;t/=2)if(e(t)){i.fromCharCodeImpl=e=>{let r="";for(let i=0;i<e.length;i+=t){const n=e.subarray(i,i+t);r+=String.fromCharCode.apply(null,n)}return r};break}}if(!i.fromCharCodeImpl)throw new Error("Unable to create a fromCharCode method");return i.fromCharCodeImpl(e)}static resetFromCharCode(){i.fromCharCodeImpl=null}}i.fromCharCodeImpl=null},2918:(e,t,r)=>{"use strict";r.d(t,{P:()=>n});var i=r(7817);class n{static concat(){let e=0;for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];for(let a=0;a<r.length;++a)e+=r[a].length;let n=new Uint8Array(e),s=0;for(let a=0;a<r.length;++a)n.set(r[a],s),s+=r[a].length;return n}static toHex(e){let t="";for(let r=0;r<e.length;++r){let i=e[r].toString(16);1===i.length&&(i="0"+i),t+=i}return t}static fromHex(e){let t=new Uint8Array(e.length/2);for(let r=0;r<e.length;r+=2)t[r/2]=parseInt(e.substr(r,2),16);return t}static toBase64(e,t){void 0===t&&(t=!0);let r=i.x.fromCharCode(e),n=btoa(r).replace(/\+/g,"-").replace(/\//g,"_");return t?n:n.replace(/=*$/,"")}static fromBase64(e){let t=atob(e.replace(/-/g,"+").replace(/_/g,"/")),r=new Uint8Array(t.length);for(let i=0;i<t.length;++i)r[i]=t.charCodeAt(i);return r}static equal(e,t){if(!e&&!t)return!0;if(!e||!t)return!1;if(e.length!==t.length)return!1;for(let r=0;r<e.length;++r)if(e[r]!==t[r])return!1;return!0}}},9473:(e,t,r)=>{"use strict";function i(e,t){return(0,n.V)(e,t,(e,t)=>e-t)}r.d(t,{U:()=>i});var n=r(7177)},7177:(e,t,r)=>{"use strict";function i(e,t,r){if(e.length<1)return;let[i]=e,n=t(i);for(let s=1;s<e.length;s++){const a=e[s],o=t(a);r(o,n)<0&&(i=a,n=o)}return i}r.d(t,{V:()=>i})},6702:(e,t,r)=>{"use strict";function i(e){const t=(0,n.jS)("web_yasp_target_latency_debug");return-1===t?e:(0,s.z)(t)?t:e}r.d(t,{c:()=>i});r(7881);var n=r(2067),s=r(1652)},1841:(e,t,r)=>{"use strict";function i(){const e=(0,n.r0)("web_yasp_time_to_start");if(!e||"null"===e)return;const t=parseFloat(e);return(0,s.z)(t)?t:void 0}r.d(t,{p:()=>i});r(7881);var n=r(2067),s=r(1652)},5052:(e,t,r)=>{"use strict";function i(e){return new Promise(t=>setTimeout(t,e))}r.d(t,{_:()=>i})},1106:(e,t,r)=>{"use strict";function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}r.d(t,{w:()=>s});var n=r(4723);class s extends n.s{constructor(e,t){super(i({isFatal:!1},e),t),this.category=void 0,this.toJSON=void 0,this.category=(null==t?void 0:t.category)||e.category,this.toJSON=()=>({message:this.message,code:this.code,isFatal:this.isFatal,details:this.details,stack:this.stack,category:this.category})}}},413:(e,t,r)=>{"use strict";r.d(t,{C:()=>i});r(7881);const i=1},1647:(e,t,r)=>{"use strict";function i(e,t){void 0===t&&(t=[]);for(const r in e)s.some(t=>{var i;return null!=(i=(0,n.Y)(()=>e[r]instanceof t))&&i})?t.push(e[r]):null!==e[r]&&"object"===typeof e[r]&&i(e[r],t);return t}r.d(t,{_:()=>i});var n=r(1729);const s=[..."undefined"!==typeof MediaSourceHandle?[MediaSourceHandle]:[]]},7926:(e,t,r)=>{"use strict";function i(e){let{id:t,method:r,params:i}=e;return t?{jsonrpc:"2.0",id:t,method:r,params:i}:{jsonrpc:"2.0",method:r,params:i}}function n(e){if(!("params"in e))return[];if(Array.isArray(e.params))return e.params;if((0,c.K)(e.params))return e.params;throw new Error("Expect #params to be an array or an object if present in "+JSON.stringify(e))}function s(e){return a(e)}function a(e){if((0,u.z)(e.id)){if(Math.floor(e.id)!==e.id)throw new Error("Expect #id to be an integer if it's a number in "+JSON.stringify(e));return e.id}if((0,h.H)(e.id)||null===e.id)return e.id;throw new Error("Expect #id to be an integer, string or null (not recommended) in "+JSON.stringify(e))}function o(e){if(!("id"in e))throw new Error("Expect #id to present in rpc response "+JSON.stringify(e));return a(e)}function l(e){if("object"!==typeof e.error||null===e.error)throw new Error("Expect #error to be an object in "+JSON.stringify(e));const t=e.error;if(!(0,u.z)(t.code))throw new Error("Expect #error#code to be an number in "+JSON.stringify(e));if(!(0,h.H)(t.message))throw new Error("Expect #error#message to be an string in "+JSON.stringify(e));return"data"in t?{code:t.code,message:t.message,data:t.data}:{code:t.code,message:t.message}}function d(e){const t=function(e){if(!(0,c.K)(e))throw new Error("Can't parse \""+e+'" as object');return e}(e);if(!function(e){return"2.0"===e.jsonrpc}(t))throw new Error("Expect "+((0,p.Y)(()=>JSON.stringify(e))||e)+" to be a json-rpc v2 message");if((0,h.H)(t.method))return function(e){return"id"in e?{jsonrpc:e.jsonrpc,method:e.method,params:n(e),id:s(e)}:{jsonrpc:e.jsonrpc,method:e.method,params:n(e)}}(t);if("result"in t)return function(e){return{jsonrpc:e.jsonrpc,result:e.result,id:o(e)}}(t);if("error"in t)return function(e){return{jsonrpc:e.jsonrpc,error:l(e),id:o(e)}}(t);throw new Error("Expect "+((0,p.Y)(()=>JSON.stringify(e))||e)+" to be a json-rpc v2 message")}r.d(t,{A:()=>b});var u=r(1652),c=r(6878),h=r(9209),p=r(1729),f=r(45),m=r(8139),g=r.n(m);class v extends Error{constructor(e,t,r){void 0===t&&(t=f.v.UNKNOWN_ERROR),super(e),this.message=void 0,this.stack=void 0,this.toJSON=void 0,this.code=void 0,g()(this,v.prototype),this.message=e,this.code=t,this.stack=null!=r?r:this.stack,this.toJSON=()=>({code:this.code,message:this.message,data:this.stack})}toString(){return JSON.stringify(this.toJSON())}}r(7881);var y=r(9002),S=r(55);class E extends y.M{constructor(e){super(),this.lastRpcRequestId=1,this.waiters=Object.create(null),this.send=void 0,this.onRun=void 0,this.serialize=void 0,this.deserialize=void 0,this.send=e.send,this.onRun=e.onRun,this.serialize=e.serialize,this.deserialize=e.deserialize}destroy(){super.destroy(),this.onRun=S.Z;for(const e in this.waiters)this.waiters[e](new Error("Stop on destroy"))}request(e,t){let{method:r,params:n}=e;void 0===t&&(t=3e4);const s=this.getUniqueRpcRequestId();return this.sendMessage(i({id:s,method:r,params:n})),this.waitForResponse(s,t,r)}sendEvent(e){let{method:t,params:r}=e;return this.sendMessage(i({method:t,params:r})),Promise.resolve()}getUniqueRpcRequestId(){return String(this.lastRpcRequestId++)}waitForResponse(e,t,r){const i=setTimeout(()=>{const i=this.waiters[e];void 0!==i&&i(new Error("Timeout fired ("+t+"ms) on method "+r+" for id="+e+"."))},t),n=()=>{clearTimeout(i),delete this.waiters[e]};return new Promise((t,r)=>{this.waiters[e]=(e,i)=>(n(),null!==e?r(e):t(i))})}sendMessage(e){this.send(this.serialize(e))}handleRpcRequest(e){let{id:t,method:r,params:i}=e;this.onRun({method:r,params:i},(e,r)=>{t&&this.sendMessage(function(e){let{id:t,error:r,result:i}=e;return r?{jsonrpc:"2.0",id:t,error:r.toJSON()}:{jsonrpc:"2.0",id:t,result:void 0===i?null:i}}({id:t,error:e,result:r}))})}handleRpcResponse(e){const t=this.waiters[e.id];if(void 0!==t)if("error"in e){t(new v(e.error.message,e.error.code,"string"===typeof e.error.data?e.error.data:void 0))}else t(null,e.result);else this.emit("Warn",new Error("Response for missed waiter for id="+JSON.stringify(e.id)))}handleMessage(e){try{const t=d(this.deserialize(e));"result"in t||"error"in t?this.handleRpcResponse(t):"method"in t&&this.handleRpcRequest(t)}catch(t){this.emit("Error",t)}}}class b{constructor(e){this.jsonRpcMessenger=void 0,this.handlers={},this.staticHandlers={};this.jsonRpcMessenger=new E({send:e,onRun:async(e,t)=>{if(!(e.method in this.handlers)&&!(e.method in this.staticHandlers))return t(new v("Unknown method: "+e.method,f.v.METHOD_NOT_FOUND));if(this.handlers[e.method])for(const i of this.handlers[e.method])try{const{done:r,value:n}=await i(e.params);if(r)return t(null,n)}catch(r){return t(new v((0,c.K)(r)?r.message:"",f.v.INTERNAL_ERROR,(0,c.K)(r)?r.stack:""))}if(this.staticHandlers[e.method]){let i=!1;for(const n of this.staticHandlers[e.method])try{const{done:r,value:s}=await n(e.params);r&&(i||(i=!0,t(null,s)))}catch(r){return t(new v((0,c.K)(r)?r.message:"",f.v.INTERNAL_ERROR,(0,c.K)(r)?r.stack:""))}if(i)return}return t(new v("No handler for existed method: "+e.method,f.v.INVALID_REQUEST))},serialize:e=>e,deserialize:e=>e}),this.jsonRpcMessenger.on("Warn",console.warn),this.jsonRpcMessenger.on("Error",console.error)}registerHandler(e,t){var r;this.handlers[e]=null!=(r=this.handlers[e])?r:[],this.handlers[e].push(t)}registerStaticHandler(e,t){var r;this.staticHandlers[e]=null!=(r=this.staticHandlers[e])?r:[],this.staticHandlers[e].push(t)}removeHandler(e,t){for(const r of["handlers","staticHandlers"])this[r][e]&&(this[r][e]=void 0===t?[]:this[r][e].filter(e=>e!==t),0===this[r][e].length&&delete this[r][e])}request(e){let{method:t,params:r}=e;return this.jsonRpcMessenger.request({method:String(t),params:r})}sendEvent(e){let{method:t,params:r}=e;return this.jsonRpcMessenger.sendEvent({method:String(t),params:r})}destroy(){this.jsonRpcMessenger.destroy()}handleMessage(e){this.jsonRpcMessenger.handleMessage(e.data)}}},6305:(e,t,r)=>{"use strict";function i(e){const t=[];for(const r of e)t.push(r);return t}function n(){return(n=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function s(){return(s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function a(){return(a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function o(e){return e.replace(/&(amp|quot|apos|lt|gt);/g,(e,t)=>{var r;return null!=(r=mt[t])?r:e})}function l(){return(l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function d(e){const t=e.children.every(e=>"string"===typeof e),r=t?e.children.join("\n"):"";return l({},e,{nodeType:t?3:1,textContent:r})}function u(e,t){return(0,Nt.V)(e,t,(e,t)=>t-e)}function c(){return(c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function h(e,t){return c({},t,{start:e.start,end:t.end})}function p(e){const t=[];return e.forEach(e=>{t.push(...e)}),function(e,t){void 0===t&&(t=h);const r=[...e];r.sort((e,t)=>e.start-t.start||e.end-t.end);for(let i=1;i<r.length;i++){const e=r[i],n=r[i-1];n.end>=e.start&&(r.splice(i,1),r[i-1]=t(n,e),i--)}return r}(t)}function f(e,t){const r=[];let i=0;return e.forEach(e=>{let{start:n,end:s}=e;for(let a=i;a<t.length;a++){if(t[a].start>s)return;i=a,t[a].end<n||r.push({start:Math.max(t[a].start,n),end:Math.min(t[a].end,s)})}}),r}function m(e){if(0===e.length)return[];const t=Math.min(...e.map(e=>e.height)),r={};for(const n of e)r[n.height]||(r[n.height]=[]),r[n.height].push(n);const i=[];return(0,Mt.Z)(r).forEach(e=>{const n=parseInt(e,10),s=r[e];if(n===t)i.push(...s);else{const e=s.reduce((e,t)=>e.bitrate>t.bitrate?e:t);i.push(e)}}),i.sort((e,t)=>t.bitrate-e.bitrate)}function g(e,t){if(!e||!t)return!1;const r=e.mimeType===t.mimeType,i=e.codecs,n=t.codecs,s=i===n,a=function(e,t){const r=e.split(".")[0];if(0===t.indexOf(r))return!0;const i=Bt[r];return!!i&&i.some(e=>0===t.indexOf(e))}(i,n);return s||a&&r}function v(){return(v=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function y(e,t){const r=parseInt(e.attributes.timescale||"1",10);if(isNaN(r))throw new gt.w({code:"YASP_PARSE_MANIFEST_ERROR",isFatal:!0,message:"Unexpected SegmentTemplate[timescale]",details:{node:e},category:vt.q.MEDIA});const i=e.attributes.media;if(!i)throw new gt.w({code:"YASP_PARSE_MANIFEST_ERROR",isFatal:!0,message:"Unexpected missed SegmentTemplate[media]",details:{node:e},category:vt.q.MEDIA});let n=Math.floor(Math.max(0,parseInt(e.attributes.startNumber||"1",10)));if(!Number.isFinite(n)||!Number.isInteger(n))throw new gt.w({code:"YASP_PARSE_MANIFEST_ERROR",isFatal:!0,message:"Unexpected SegmentTemplate[startNumber]",details:{node:e},category:vt.q.MEDIA});const s=parseInt(e.attributes.presentationTimeOffset||"0",10),a=s;if(isNaN(a))throw new gt.w({code:"YASP_PARSE_MANIFEST_ERROR",isFatal:!0,message:"Unexpected SegmentTemplate[presentationTimeOffset]",details:{node:e},category:vt.q.MEDIA});const l=e.attributes.availabilityTimeOffset?parseFloat(e.attributes.availabilityTimeOffset):0;t.availabilityTimeOffset=Math.min(t.availabilityTimeOffset,1e3*l);const d=e.children.find(e=>{let{tagName:t}=e;return"SegmentTimeline"===t}),u=[];let c=Math.max(Math.floor(0)),h=0,p=Math.max(Math.floor(0));if(d){const i=d.children.filter(e=>{let{tagName:t}=e;return"S"===t});for(let a=0;a<i.length;a++){var f;const o=i[a],l=u[u.length-1],d=parseInt(o.attributes.t,10),h=parseInt(o.attributes.d||e.attributes.duration,10);if("string"===typeof o.attributes.t&&isNaN(d))throw new gt.w({code:"YASP_PARSE_MANIFEST_ERROR",isFatal:!0,message:"Unexpected S[t]",details:{node:e},category:vt.q.MEDIA});const p=d||(l?l.originalValues.time+l.originalValues.duration*l.count:0),m=1e3*d/r||(l?l.time+l.duration*l.count:0),g=1e3*h/r;t.maxSegmentDuration=t.maxSegmentDuration?Math.max(t.maxSegmentDuration,g):g;const v=Math.max(Math.floor(parseInt(o.attributes.r||"0",10)));if(isNaN(g))throw new gt.w({code:"YASP_PARSE_MANIFEST_ERROR",isFatal:!0,message:"Unexpected S[d]",details:{node:e},category:vt.q.MEDIA});if(isNaN(v))throw new gt.w({code:"YASP_PARSE_MANIFEST_ERROR",isFatal:!0,message:"Unexpected S[r]",details:{node:e},category:vt.q.MEDIA});const y=v+Math.max(Math.floor(1));c+=y;const S=n+Math.max(Math.floor(c-1)),E=m+g*y;t.maxSegmentEndTime=t.maxSegmentEndTime?Math.max(t.maxSegmentEndTime,E):E,t.minSegmentStartTime=Math.min(null!=(f=t.minSegmentStartTime)?f:1/0,m),t.minSegmentStartTime=t.minSegmentStartTime?Math.min(t.minSegmentStartTime,m):m,u.push({endNumber:S,time:m,duration:g,count:y,originalValues:{time:p,duration:h,trackPresentationTimeOffset:s}})}p=n+Math.max(Math.floor(c-1))}else{var m,g;if(null===t.duration&&!t.isDynamic)throw new gt.w({code:"YASP_PARSE_MANIFEST_ERROR",isFatal:!0,message:"Can't compute presentation duration",details:{node:e},category:vt.q.MEDIA});let i=0;const a=1e3*parseInt(e.attributes.duration,10)/r;if(isNaN(a))throw new gt.w({code:"YASP_PARSE_MANIFEST_ERROR",isFatal:!0,message:"Unexpected S[d]",details:{node:e},category:vt.q.MEDIA});let o=Math.abs(null!=(m=t.duration)?m:t.nowWithOffset);if(isFinite(t.segmentAvailabilityDuration)){var v;const e=t.nowWithOffset-(null!=(v=t.presentationStartTime)?v:0),r=Math.max(e-t.segmentAvailabilityDuration,0),s=Math.ceil(r/a);n+=s,i=s*a,o=Math.max(e-i,0)}c=Math.floor(o/a),p=n+Math.max(Math.floor(c-1),0),h=p*a,t.maxSegmentEndTime=Math.max(t.maxSegmentEndTime||0,h),t.minSegmentStartTime=Math.min(null!=(g=t.minSegmentStartTime)?g:1/0,i),t.maxSegmentDuration=Math.max(t.maxSegmentDuration||0,a),u.push({endNumber:p,time:i,duration:a,count:c,originalValues:{time:i,duration:parseInt(e.attributes.duration,10),trackPresentationTimeOffset:s}});const l=t.duration?t.duration-h:0,d=Math.abs(Math.floor(1));l&&u.push({endNumber:p+d,time:h,duration:l,count:d,originalValues:{time:h,duration:l,trackPresentationTimeOffset:s}})}const y=u[u.length-1];return t.maxPresentationTimeOffset=void 0!==t.maxPresentationTimeOffset?Math.max(t.maxPresentationTimeOffset,a):t.maxPresentationTimeOffset,{timescale:r,initialization:e.attributes.initialization?o(e.attributes.initialization):null,media:o(i),startNumber:n,startTime:u[0].time,endNumber:y.endNumber,endTime:y.time+y.duration*y.count,presentationTimeOffset:a,segmentSequences:u}}function S(e,t){const r=e.attributes.mimeType,i=e.attributes.contentType||(null==r?void 0:r.split("/")[0]);if(!i)throw new gt.w({code:"YASP_PARSE_MANIFEST_ERROR",isFatal:!0,message:"Unexpected empty AdaptationSet[contentType] and AdaptationSet[mimeType]",details:{node:e},category:vt.q.MEDIA});t.maxHeight||(t.maxHeight=function(e){const t=e.find(e=>{var t;return"SupplementalProperty"===e.tagName&&"urn:mpeg:yandex:capping:maxheight"===(null==(t=e.attributes)?void 0:t.schemeIdUri)});return t?parseInt(t.attributes.value,10):null}(e.children));const n=e.children.filter(e=>"ContentProtection"===e.tagName);let s=new Gt(t.parser).parse(n);const a="true"===e.attributes.segmentAlignment,o=e.children.find(e=>"SegmentTemplate"===e.tagName);return{type:i,segmentAlignment:a,segmentTemplate:o?y(o,t):void 0,mimeType:r,contentProtection:s}}function E(e,t,r){var i;const n=e.attributes.id;if(!n)throw new gt.w({code:"YASP_PARSE_MANIFEST_ERROR",isFatal:!0,message:"Unexpected missed id on Representation",details:{node:e},category:vt.q.MEDIA});const s=null!=(i=e.attributes.codecs)?i:null;let a=parseInt(e.attributes.bandwidth,10);if(isNaN(a)||a<0){if("text"!==r)throw new gt.w({code:"YASP_PARSE_MANIFEST_ERROR",isFatal:!0,message:"Unexpected missed Representation[bandwidth]",details:{node:e},category:vt.q.MEDIA});a=10}const o=e.attributes.mimeType,l=e.children.find(e=>{let{tagName:t}=e;return"SegmentTemplate"===t}),d=l?y(l,t):void 0,u=e.children.filter(e=>{let{tagName:t}=e;return"InbandEventStream"===t});return"text"!==r&&u.forEach(e=>t.emsgSchemeIdUris[r].add(e.attributes.schemeIdUri)),{id:n,codecs:s,bandwidth:a,segmentTemplate:d,mimeType:o}}function b(){return(b=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function A(e,t){const r=parseInt(e.attributes.width,10),i=parseInt(e.attributes.height,10),n=Math.max(parseFloat(e.attributes.frameRate),0);if(isNaN(r))throw new gt.w({code:"YASP_PARSE_MANIFEST_ERROR",details:{node:e},message:"Unexpected Representation[width]",isFatal:!0,category:vt.q.MEDIA});if(isNaN(i))throw new gt.w({code:"YASP_PARSE_MANIFEST_ERROR",details:{node:e},message:"Unexpected Representation[height]",isFatal:!0,category:vt.q.MEDIA});const s=E(e,t,"video"),a=s.codecs;if(!a)throw new gt.w({code:"YASP_PARSE_MANIFEST_ERROR",details:{node:e},message:"Unexpected missed codecs on Representation",isFatal:!0,category:vt.q.MEDIA});return b({},s,n?{frameRate:n}:{},{codecs:a,width:r,height:i})}function T(e,t){return t.bandwidth-e.bandwidth}function _(e,t,r){const i=e.children.filter(e=>{let{tagName:t}=e;return"Representation"===t}),n=[];for(let s=0;s<i.length;s++){const e=i[s];n.push(t(e,r))}return n.sort(T)}function w(){return(w=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function k(e,t,r){const{segmentTemplate:i,mimeType:n}=t,s=function(e,t){if(null==e)return{};var r,i,n={},s=Object.keys(e);for(i=0;i<s.length;i++)r=s[i],t.indexOf(r)>=0||(n[r]=e[r]);return n}(t,Kt),a=parseInt(e.attributes.maxWidth,10),o=parseInt(e.attributes.maxHeight,10),l=Math.max(parseFloat(e.attributes.maxFrameRate),0),d=_(e,A,r).map(t=>{var r,s;const a=null!=(r=t.segmentTemplate)?r:i,o=null!=(s=t.mimeType)?s:n;if(!a)throw new gt.w({code:"YASP_PARSE_MANIFEST_ERROR",isFatal:!0,message:"Unexpected missed Representation>SegmentTemplate",details:{node:e},category:vt.q.MEDIA});if(!o)throw new gt.w({code:"YASP_PARSE_MANIFEST_ERROR",isFatal:!0,message:"Unexpected missed Representation>mimeType",details:{node:e},category:vt.q.MEDIA});return w({},t,{segmentTemplate:a,mimeType:o})});if(isNaN(a))throw new gt.w({code:"YASP_PARSE_MANIFEST_ERROR",isFatal:!0,message:"Unexpected AdaptationSet[maxWidth]",details:{node:e},category:vt.q.MEDIA});if(isNaN(o))throw new gt.w({code:"YASP_PARSE_MANIFEST_ERROR",isFatal:!0,message:"Unexpected AdaptationSet[maxHeight]",details:{node:e},category:vt.q.MEDIA});return w({},s,l?{maxFrameRate:l}:{},{maxWidth:a,maxHeight:o,representations:d,keyId:void 0,encrypted:t.contentProtection.drmInfos.length>0})}function R(){return(R=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function P(e,t){const r=Math.max(parseFloat(e.attributes.audioSamplingRate),0);if(isNaN(r))throw new gt.w({code:"YASP_PARSE_MANIFEST_ERROR",isFatal:!0,message:"Unexpected Representation[audioSamplingRate]",details:{node:e},category:vt.q.MEDIA});const i=E(e,t,"audio"),n=i.codecs;if(!n)throw new gt.w({code:"YASP_PARSE_MANIFEST_ERROR",isFatal:!0,message:"Unexpected missed codecs on Representation",details:{node:e},category:vt.q.MEDIA});return R({},i,{codecs:n,audioSamplingRate:r})}function C(){return(C=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function I(e,t,r){var i,n;const{segmentTemplate:s,mimeType:a}=t,o=function(e,t){if(null==e)return{};var r,i,n={},s=Object.keys(e);for(i=0;i<s.length;i++)r=s[i],t.indexOf(r)>=0||(n[r]=e[r]);return n}(t,zt),l=null!=(i=e.attributes.lang)?i:"und",d=null!=(n=e.attributes.label)?n:null;if(""===l)throw new gt.w({code:"YASP_PARSE_MANIFEST_ERROR",isFatal:!0,message:"Unexpected AdaptationSet[lang]",details:{node:e},category:vt.q.MEDIA});const u=_(e,P,r).map(t=>{var r,i;const n=null!=(r=t.segmentTemplate)?r:s,o=null!=(i=t.mimeType)?i:a;if(!n)throw new gt.w({code:"YASP_PARSE_MANIFEST_ERROR",isFatal:!0,message:"Unexpected missed Representation>SegmentTemplate",details:{node:e},category:vt.q.MEDIA});if(!o)throw new gt.w({code:"YASP_PARSE_MANIFEST_ERROR",isFatal:!0,message:"Unexpected missed Representation>mimeType",details:{node:e},category:vt.q.MEDIA});return C({},t,{segmentTemplate:n,mimeType:o})}),c=function(e,t){const r=t.findChildren(e,"AudioChannelConfiguration");for(const i of r){const e=i.attributes.schemeIdUri;if(!e)continue;const t=i.attributes.value;if(t)switch(e){case"urn:mpeg:dash:outputChannelPositionList:2012":return t.trim().split(/ +/).length;case"urn:mpeg:dash:23003:3:audio_channel_configuration:2011":case"urn:dts:dash:audio_channel_configuration:2012":{const e=parseInt(t,10);if(!e)continue;return e}case"tag:dolby.com,2014:dash:audio_channel_configuration:2011":case"urn:dolby:dash:audio_channel_configuration:2011":{let e=parseInt(t,16);if(!e)continue;let r=0;for(;e;)1&e&&++r,e>>=1;return r}case"urn:mpeg:mpegB:cicp:ChannelConfiguration":{const e=0,r=[e,1,2,3,4,5,6,8,2,3,4,7,8,24,8,12,10,12,14,12,14],i=parseInt(t,10);if(!i)continue;if(i>e&&i<r.length)return r[i];continue}default:continue}}}(e,r.parser);return C({},o,{lang:l,label:d,representations:u,keyId:void 0,encrypted:t.contentProtection.drmInfos.length>0,channels:c})}function O(){return(O=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function D(e,t){const r=E(e,t,"text"),i=[];return e.children.forEach(e=>{let{tagName:t,children:r}=e;if("BaseURL"===t){const e=r[0];if(!e)return;i.push(o(e))}}),O({},r,{baseUrl:i[0]})}function N(){return(N=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function L(e,t,r){var i,n,s,a;const{segmentTemplate:o,mimeType:l}=t,d=function(e,t){if(null==e)return{};var r,i,n={},s=Object.keys(e);for(i=0;i<s.length;i++)r=s[i],t.indexOf(r)>=0||(n[r]=e[r]);return n}(t,Zt),u=e.children.filter(e=>{let{tagName:t}=e;return"Role"===t});let c=null;u.forEach(e=>{["caption","subtitle"].includes(e.attributes.value)&&(c=e)});const h=null!=(i=e.attributes.lang)?i:"und",p=null!=(n=e.attributes.label)?n:null,f=_(e,D,r).map(e=>N({},e,{segmentTemplate:e.segmentTemplate||o,mimeType:e.mimeType||l}));return N({},d,{role:c?{schemeIdUri:null!=(s=c.attributes.schemeIdUri)?s:null,value:null!=(a=c.attributes.value)?a:null}:null,lang:h,label:p,representations:f,keyId:void 0,encrypted:t.contentProtection.drmInfos.length>0,segmentAlignment:!1})}function x(e,t){const r=S(e,t);switch(r.type){case"video":return k(e,r,t);case"audio":return I(e,r,t);case"text":return L(e,r,t);default:throw new gt.w({code:"YASP_PARSE_MANIFEST_ERROR",isFatal:!0,message:"Unexpected AdaptationSet[contentType="+r.type+"]",details:{node:e},category:vt.q.MEDIA})}}function M(e,t){var r,i,n,s,a,o;const l=t.type.charCodeAt(0)-e.type.charCodeAt(0);if(0!==l)return l;switch(t.type){case"video":return t.maxHeight-e.maxHeight||(null!=(r=t.maxFrameRate)?r:0)-(null!=(i=e.maxFrameRate)?i:0)||(null!=(n=t.mimeType)?n:"").localeCompare(null!=(s=e.mimeType)?s:"");case"audio":case"text":return(null!=(a=t.mimeType)?a:"").localeCompare(null!=(o=e.mimeType)?o:"")}return 0}function F(e,t){const r=e.children.filter(e=>{let{tagName:t}=e;return"AdaptationSet"===t}),i=[];for(let n=0;n<r.length;n++){const e=x(r[n],t);e&&i.push(e)}return i.sort(M)}function V(e){if(!e)return null;const t=new RegExp("^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$").exec(e);if(!t)return null;const r=31536e3*Number(t[1]||null)+2592e3*Number(t[2]||null)+86400*Number(t[3]||null)+3600*Number(t[4]||null)+60*Number(t[5]||null)+Number(t[6]||null);return isFinite(r)?1e3*r:null}function B(e){if(!e)return null;/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(e)&&(e+="Z");let t=Date.parse(e);return isNaN(t)?null:Math.floor(t)}function U(e,t,r){var i,n,s;const a=e.find(e=>{let{tagName:t}=e;return"MPD"===t});if(void 0===a)throw new gt.w({code:"YASP_PARSE_MANIFEST_ERROR",isFatal:!0,message:"Unexpected missed MPD",details:{node:{tagName:"root",attributes:{},children:e}},category:vt.q.MEDIA});const l={periods:[],baseUrls:[],maxHeight:null,isDynamic:"dynamic"===(null==(i=a.attributes)?void 0:i.type),videoType:Jt.Z.LIVE,updatePeriod:5e3,minBufferTime:0,presentationStartTime:null,segmentAvailabilityDuration:1/0,maxSegmentDuration:4e3,presentationDelay:0,availabilityTimeOffset:0,clockOffset:0,minSegmentStartTime:null,maxSegmentEndTime:null,presentationTimeOffset:0,publishTime:0,minPeriodStartTime:0,locationUrl:null},d=a.children.filter(e=>{let{tagName:t}=e;return"BaseURL"===t});for(let o=0;o<d.length;o++){const{children:e}=d[o];1===e.length&&l.baseUrls.push(e[0])}l.baseUrls.length||l.baseUrls.push(function(e){try{const t=new URL(e);t.search="";const r=t.pathname.split("/");return r[r.length-1]="",t.pathname=r.join("/"),t.href}catch(t){return""}}(t)||t);const u=a.children.filter(e=>{let{tagName:t}=e;return"Period"===t});if(void 0===u||0===u.length)throw new gt.w({code:"YASP_PARSE_MANIFEST_ERROR",isFatal:!0,message:"Unexpected missed Period",details:{node:a},category:vt.q.MEDIA});if(l.isDynamic){var c,h,p,f,m;l.minBufferTime=V(null==(c=a.attributes)?void 0:c.minBufferTime)||l.minBufferTime,l.updatePeriod=V(null==(h=a.attributes)?void 0:h.minimumUpdatePeriod)||l.updatePeriod,l.presentationStartTime=B(null==(p=a.attributes)?void 0:p.availabilityStartTime),l.segmentAvailabilityDuration=V(null==(f=a.attributes)?void 0:f.timeShiftBufferDepth)||l.segmentAvailabilityDuration,l.maxSegmentDuration=V(null==(m=a.attributes)?void 0:m.maxSegmentDuration)||l.maxSegmentDuration;const e=V(a.attributes.suggestedPresentationDelay),t=Math.max(1e4,1.5*l.minBufferTime);l.presentationDelay=null!=e?e:t;const r=a.children.filter(e=>{let{tagName:t}=e;return"UTCTiming"===t});l.clockOffset=function(e){const t=e.find(e=>Qt.includes(e.attributes.schemeIdUri));if(!t)return 0;const r=t.attributes.schemeIdUri,i=t.attributes.value;if(Xt.includes(r)){const e=Date.parse(i);return isNaN(e)?0:e-Date.now()}return 0}(r)}const g={maxHeight:null,duration:V(null==a?void 0:a.attributes.mediaPresentationDuration),maxPresentationTimeOffset:0,minPeriodStartTime:1/0,segmentAvailabilityDuration:l.segmentAvailabilityDuration,nowWithOffset:Date.now()+l.clockOffset,parser:r,availabilityTimeOffset:1/0,isDynamic:l.isDynamic,emsgSchemeIdUris:{audio:new Set,video:new Set},presentationStartTime:l.presentationStartTime};var v,y,S,E;(l.periods.push((v=u[0],(y=g).minPeriodStartTime=Math.min(V(v.attributes.start)||0,y.minPeriodStartTime),{adaptationSets:F(v,y)})),g.maxPresentationTimeOffset&&(l.segmentAvailabilityDuration=1/0,l.presentationTimeOffset=g.maxPresentationTimeOffset,l.videoType=Jt.Z.EVENT),g.maxSegmentDuration&&g.maxSegmentEndTime)&&(l.maxSegmentDuration=Math.max(g.maxSegmentDuration,l.maxSegmentDuration),l.minSegmentStartTime=null!=(S=g.minSegmentStartTime)?S:null,l.maxSegmentEndTime=null!=(E=g.maxSegmentEndTime)?E:null);g.maxHeight&&(l.maxHeight=g.maxHeight),isFinite(g.availabilityTimeOffset)&&(l.availabilityTimeOffset=g.availabilityTimeOffset),l.publishTime=B(null==(n=a.attributes)?void 0:n.publishTime)||l.publishTime,l.emsgSchemeIdUris=g.emsgSchemeIdUris;const b=a.children.find(e=>{let{tagName:t}=e;return"Location"===t});return b&&b.children.length&&(l.locationUrl=o(b.children[0])),l.minPeriodStartTime=isFinite(g.minPeriodStartTime)?g.minPeriodStartTime:null!=(s=g.minSegmentStartTime)?s:l.minPeriodStartTime,l}function j(e){try{const t=new XMLHttpRequest;return t.open("GET","https://yandex.ru"),t.responseType=e,t.responseType===e?e:""}catch(t){return""}}function H(){return(H=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function W(e,t){const r={type:"content-type",size:"content-length"},i=[];for(const n in t)i.push([r[n],t[n].toString()]);return{headers:{forEach:e=>{i.forEach(t=>{let[r,i]=t;e(i,r)})}},body:{getReader:()=>e.getReader()},text:()=>e.text(),status:200}}async function q(e,t){const r=await fr(),[i,n,s]=e.split("/"),a=await r.getDirectoryHandle(i,{create:t});return(await a.getDirectoryHandle(n,{create:t})).getFileHandle(s.replace(/\//g,"_"),{create:t})}async function Y(e){const t=await q(e,!1),r=await t.getFile();return{body:r,size:r.size}}function G(){return(G=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function K(e,t){void 0===t&&(t=.5);return(e<10?2**e*100:6e4)*(1+(2*Math.random()-1)*t)}function z(){return(z=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function Z(e,t){const r=[];e.adaptationSets.forEach(e=>{e.representations.forEach(i=>{switch(e.type){case"audio":t.obtainTimelineTrack(z({},i,i.segmentTemplate,{bitrate:i.bandwidth,language:e.lang,name:e.label,label:e.label,channels:e.channels,type:"audio"}));break;case"video":r.push(i);break;case"text":t.obtainTimelineTrack(function(e,t,r){var i,n,s,a;const o=t.segmentTemplate,l=z({},t,{kind:(null==(i=r.role)?void 0:i.value)||"subtitles",label:r.label,language:r.lang,bitrate:t.bandwidth,type:"text"});if(o)return z({},l,o);const d=e.getSeekableRange();return z({},l,{media:t.baseUrl,initialization:null,timescale:1,startNumber:Math.ceil(Math.abs(1)),endNumber:Math.ceil(Math.abs(1)),startTime:null!=(n=null==d?void 0:d.start)?n:0,endTime:null!=(s=null==d?void 0:d.end)?s:0,presentationTimeOffset:0,segmentSequences:[{time:0,duration:null!=(a=e.getDuration())?a:0,count:Math.ceil(Math.abs(1)),endNumber:Math.ceil(Math.abs(1)),originalValues:{time:0,duration:e.getDuration(),trackPresentationTimeOffset:0}}]})}(t,i,e))}})}),t.updateVideoTracks(r),t.sortTracksInTimeline()}function X(e){if(!e.length)return 1/0;let t=0;return e.forEach(e=>{t+=e.bandwidth}),t/e.length}function Q(e,t){return e+"; codecs="+JSON.stringify(t)}function J(e){return(0,Er.Q)(self).isTypeSupported(Q(e.mimeType,e.codecs))}function $(e){const t=[],r=[];for(let i of e)J(i)?t.push(i):r.push(i);return{supported:t,unsupported:r}}function ee(e){const t=new Map;for(const r of e.representations){const e=r.height,i=r.bandwidth;t.set(e,i)}return t}function te(e,t){let r=0,i=0,n=0;for(const s of e.keys()){const a=e.get(s),o=t.get(s);a&&o&&(n++,r+=a,i+=o)}return i/n<r/n?t:e}function re(){return(re=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function ie(e,t){const r={audio:[],video:[],text:[]},i={video:!1,audio:!1},n={video:new Set,audio:new Set};e.forEach(e=>{if("video"===e.type){i.video=!0;const{selected:t,unsupported:s}=function(e){const t={};let r=0;const{supported:i,unsupported:n}=$(e);i.forEach(e=>{r=Math.max(r,e.height);const i=e.codecs.split(".")[0];t[i]?t[i].push(e):t[i]=[e]}),(0,Ut.J)(t).forEach(e=>{let[i,n]=e;n.some(e=>e.height===r)||delete t[i]});const s=(0,Mt.Z)(t);return s.length?(s.length>1&&s.sort((e,r)=>X(t[e])-X(t[r])),{selected:t[s[0]],unsupported:n}):{selected:void 0,unsupported:n}}(e.representations);if(!t)return void s.forEach(e=>n.video.add(Q(e.mimeType,e.codecs)));r[e.type].push(re({},e,{representations:t,maxHeight:t[0].height,maxWidth:t[0].width}))}else if("audio"===e.type){i.audio=!0;const{selected:t,unsupported:s}=function(e){const t={},{supported:r,unsupported:i}=$(e);r.forEach(e=>{const r=e.codecs.split(".")[0];t[r]?t[r].push(e):t[r]=[e]});const n=(0,Mt.Z)(t);return n.length?(n.length>1&&n.sort((e,r)=>X(t[e])-X(t[r])),{selected:t[n[0]],unsupported:i}):{selected:void 0,unsupported:i}}(e.representations);if(!t)return void s.forEach(e=>n.audio.add(Q(e.mimeType,e.codecs)));r[e.type].push(re({},e,{representations:t}))}else r[e.type].push(e)});const s=(0,Mt.Z)(i).filter(e=>i[e]&&!r[e].length);if(s.length){const e=s.reduce((e,t)=>(e[t]=Array.from(n[t]),e),{});throw new gt.w({message:"For some types of adaptation sets, no supported codec was found.",code:"YASP_NO_CODECS",details:e,isFatal:!0,category:vt.q.NO_CODECS})}return(0,Ut.J)(r).reduce((e,t)=>{let[r,i]=t;if("video"===r){const t=function(e){if(!e.length)return null;if(1===e.length)return e[0];let t=0,r=ee(e[t]);for(let i=1;i<e.length;i++){const n=ee(e[i]);r=te(r,n),t=r===n?i:t}return e[t]}(i);t&&e.push(t)}else i.forEach(t=>e.push(t));return e},[])}function ne(e){if(!(0,Le.K)(e))return!1;const t=e;return(0,ht.H)(t.code)&&(0,ht.H)(t.category)&&"boolean"===typeof t.isFatal}function se(e,t){let r,i=0;for(let n=0;n<e.length;n++){const{start:s,end:a}=e[n];if(!(a<t)){if(void 0!==r&&s-r>=.1)break;i+=a-Math.max(s,t),r=a}}return i}function ae(){return(ae=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function oe(e,t,r){var i;return e.replace(/\$RepresentationID\$/g,t.id).replace(/\$Bandwidth\$/g,String(t.bitrate)).replace(/\$Number\$/g,String(null!=(i=null==r?void 0:r.number)?i:"")).replace(/\$Time\$/g,String((0,Vr.z)(null==r?void 0:r.originalStart)?r.originalStart:"")).replace(/\$\$/g,"$")}function le(){return(le=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function de(e,t,r){const i=1e3*r;let n=t,s=!0,a=!1;for(;s;)s=!1,e.forEach(e=>{e.forEach(e=>{e.start<=n&&n<e.end&&(n=e.end,a=!0,s=!0)})});return n>=i&&a?-1:n}function ue(e){if(-1===e.indexOf("#"))return null;let t;return e.split("#").pop().split("&").some(e=>{const[r,i]=e.split("=",2).map(decodeURIComponent);return"t"===r&&(t=i,!0)}),function(e){if("string"!==typeof e)return null;try{if(e.match(/^-?\d+(\.\d+)?$/))return ce(parseFloat(e));if(e.includes("npt:")){const t=e.split("npt:")[1];return ce(parseFloat(t))}if(e.includes(":")){const t=e.split(":"),r=parseInt(t[0],10)||0,i=parseInt(t[1],10)||0,n=parseFloat(t[2])||0;return ce(3600*r+60*i+n)}const t=e.match(/^npt:(\d+(\.\d+)?)$/);if(t)return ce(parseFloat(t[1]))}catch(t){}return null}(t)}function ce(e){return isNaN(e)?null:e}function he(){return(he=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function pe(){return(pe=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function fe(e,t){return(0,Ot.RW)("web_yasp_unify_abr_decision_hash_code")?e.trace.map(e=>{let r=null;return e.result.map(e=>e[t]===r?null:(r=e[t],e[t])).filter(Boolean).join("-")}).filter(Boolean).join("_"):e.trace.map(e=>e.result.map(e=>e[t]).filter(Boolean).join("-")).filter(Boolean).join("_")}function me(e,t,r){const i=(null==e?void 0:e.length)>0?e:[void 0],n=(null==t?void 0:t.length)>0?t:[void 0],s=(null==r?void 0:r.length)>0?r[0].bitrate:0,a=[];return i.forEach(e=>{n.forEach((t,r)=>{(function(e){let{width:t,height:r}=e;const i=Math.max(t,r),n=Math.min(t,r);if(i<=0)return 0;let s=ui[0];for(let a=0;a<ui.length;a++){const e=ui[a],t=ci[e];if(i>=1.3*Math.floor(16*t/9)||n>=1.3*t)return s;s=e}return ui[ui.length-1]})({width:(null==e?void 0:e.width)||0,height:(null==e?void 0:e.height)||0})>360&&r>0||a.push({video:e,audio:t,bandwidth:((null==e?void 0:e.bitrate)||0)+(((null==t?void 0:t.bitrate)||0)+s)})})}),a}function ge(e){return["audio","video"].some(t=>{const r=e[t];return r&&null!==r.getWaitingDuration()})}function ve(e,t,r,i){return void 0!==e&&null!==t?Math.min(null!=i?i:1/0,(e.start/1e3-t)/Math.max(r,1)):null!=i?i:0}function ye(e,t,r,i){var n,s;if(void 0===e||e.finished)return 0;const a=i-(null!=(n=null==t?void 0:t.bitrate)?n:0),o=8*e.expectedSize,l=null!=(s=e.getWaitingDuration())?s:0;return(null===e.getLoadingDuration()?(r-l)/1e3:0)+o/a}function Se(){return(Se=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function Ee(e,t){return Se(e,{currentTime:t.currentTime,duration:t.duration}),e}function be(e,t,r){const i=function(e){return e.filter(Ae)}(e);if(i.length<=1)return e;const n=[],s=function(e,t,r){const i=function(e,t,r){const{videoMaxWidthResolutionWithTrueRatio:i,videoMaxHeightResolutionWithTrueRatio:n}=function(e,t,r){const i=Te(e[0].video.width,e[0].video.height),{videoMaxWidthResolution:n,videoMaxHeightResolution:s}=function(e,t){const{defaultLongSideResolution:r,userCappingResolution:i}=t||{};let n=0,s=0;i&&i.width&&i.height&&(n=i.width,s=i.height);const a=Math.max(n,s),o=(0,Ti.R)(r),{cappedWidthResolution:l,cappedHeightResolution:d}=function(e){const{width:t=1/0,height:r=1/0,dpi:i=1}=e;return{cappedWidthResolution:t*i,cappedHeightResolution:r*i}}(e),u=a||Math.min(o,l),c=a||Math.min(o,d);return{videoMaxWidthResolution:u,videoMaxHeightResolution:c}}(t,r),a=Te(n,s);return i>a?{videoMaxWidthResolutionWithTrueRatio:n,videoMaxHeightResolutionWithTrueRatio:e[0].video.height*(n/e[0].video.width)}:{videoMaxWidthResolutionWithTrueRatio:e[0].video.width*(s/e[0].video.height),videoMaxHeightResolutionWithTrueRatio:s}}(e,t,r);return i*n}(e,t,r);return(0,gi.U)(e.slice().reverse(),e=>{let{video:{width:t,height:r}}=e;return Math.abs(i-t*r)})}(i,t,r);for(const a of i)if(n.push(a),s===a)break;return n}function Ae(e){return(0,Le.K)(e.video)&&(0,Vr.z)(e.video.width)&&(0,Vr.z)(e.video.height)}function Te(e,t){return e/t}function _e(){return(_e=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function we(){return(we=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function ke(e){return(0,yr.lm)(e.toLocaleLowerCase())||new URL(e,"https://domain.com").searchParams.get("container")||""}function Re(e){return new URL(e,"https://domain.com").searchParams.get("codec")||""}function Pe(e,t,r){const i=[];return e.forEach((e,n)=>{i.push({endNumber:Math.max(Math.floor(n+1)),time:Math.floor(e.startTime/r*1e3),duration:Math.floor(e.duration/r*1e3),count:Math.max(Math.floor(1)),isMP4:!0,startByteWithUuidOffset:t+e.startByte,endByteWithUuidOffset:t+e.endByte,originalValues:{time:e.startTime,duration:e.duration,trackPresentationTimeOffset:0,startByte:e.startByte,endByte:e.endByte}})}),i}function Ce(){return(Ce=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function Ie(){return(Ie=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function Oe(){return(Oe=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function De(e){void 0===e&&(e=self),new yn(e).init()}r.d(t,{Z:()=>Sn});class Ne{constructor(){this.timeRanges=[]}get length(){return this.timeRanges.length}start(e){if(this.timeRanges.length<=e)throw new Error("Failed to execute 'start' on 'TimeRanges': The index provided ("+e+") is greater than the maximum bound ("+this.timeRanges.length+").");return this.timeRanges[e][0]}end(e){if(this.timeRanges.length<=e)throw new Error("Failed to execute 'end' on 'TimeRanges': The index provided ("+e+") is greater than the maximum bound ("+this.timeRanges.length+").");return this.timeRanges[e][1]}update(e){this.timeRanges=e}}var Le=r(6878);class xe{constructor(e,t,r){this.sourceKey=void 0,this.mediaState=void 0,this.worker=void 0,this.buffered=void 0,this.validateAndHandleEvent=e=>{let{data:t}=e;(0,Le.K)(t)&&"string"===typeof t.method&&t.sourceKey===this.sourceKey&&this.handleEvent(t.method,t.params)},this.sourceKey=e,this.mediaState=r,this.buffered=new Ne,this.mediaState.buffered=this.buffered,this.worker=t,this.worker.addEventListener("message",this.validateAndHandleEvent)}destroy(){this.worker.removeEventListener("message",this.validateAndHandleEvent)}handleEvent(e,t){switch(e){case"updateBuffering":return this.mediaState.buffering=t,void this.mediaState.emit("BufferingChange",t);case"updateCurrentTime":return void(this.mediaState.currentTime=t);case"updateDuration":return void(this.mediaState.duration=t);case"updateLoop":return void(this.mediaState.loop=t);case"updatePaused":return void(this.mediaState.paused=t);case"updatePlaybackRate":return void(this.mediaState.playbackRate=t);case"updateBuffered":return void this.buffered.update(t)}}}class Me extends xe{handleEvent(e,t){switch(e){case"updateFrames":return void(this.mediaState.frames=t);case"updateDevicePixelRatio":return void(this.mediaState.devicePixelRatio=t);case"updateVideoSize":return void(this.mediaState.videoSize=t);case"updateContainerSize":return void(this.mediaState.containerSize=t);case"updateObjectFit":return void(this.mediaState.objectFit=t);default:super.handleEvent(e,t)}}}var Fe=r(4612),Ve=r(4910);class Be{constructor(e,t){void 0===e&&(e=1),void 0===t&&(t=Fe.Z),this.limit=e,this.onEvent=t,this.sources=new Map}getSourceCount(){return this.sources.size}getSourceLimit(){return this.limit}takeSource(e){return this.sources.get((0,Ve.Hi)(e))}putSource(e,t){const r=(0,Ve.Hi)(e);this.sources.delete(r),this.sources.set(r,t);const i=[];for(;this.sources.size>this.limit;){const e=this.sources.entries().next().value;if(!e)break;const[t,r]=e;Be.destroySource(r),this.sources.delete(t),i.push(t)}i.length&&this.onEvent(i,this.limit)}removeSource(e){const t=(0,Ve.Hi)(e),r=this.sources.get(t);return!!r&&(Be.destroySource(r),this.sources.delete(t))}getAllSources(){return Array.from(this.sources.values())}static destroySource(e){null==e||e.destroy()}}r(7881);var Ue=r(7179);class je extends Ue.v{constructor(e){super(),this.id=void 0,this.bitrate=void 0,this.language=void 0,this.type=void 0,this.initialization=void 0,this.timescale=void 0,this.media=void 0,this.mimeType=void 0,this.startNumber=void 0,this.startTime=void 0,this.endNumber=void 0,this.endTime=void 0,this.presentationTimeOffset=void 0,this.segmentSequences=void 0,this.init=null,this.segmentRanges=[],this.segments=new Map,this.id=e.id,this.bitrate=e.bitrate,this.language=e.language,this.type=e.type,this.initialization=e.initialization,this.timescale=e.timescale,this.media=e.media,this.mimeType=e.mimeType,this.startNumber=e.startNumber,this.startTime=e.startTime,this.endNumber=e.endNumber,this.endTime=e.endTime,this.presentationTimeOffset=e.presentationTimeOffset,this.segmentSequences=e.segmentSequences}updateTrack(e){this.startNumber=e.startNumber,this.startTime=e.startTime,this.endNumber=e.endNumber,this.endTime=e.endTime,this.presentationTimeOffset=e.presentationTimeOffset,this.segmentSequences=e.segmentSequences,this.bitrate=e.bitrate,this.initialization=e.initialization,this.media=e.media}getFullMimeType(){return this.mimeType}appendSegment(e){e.isInitSegment?this.init=e:this.segments.set(e.number,e);const t=()=>{e.isInitSegment?this.init=null:(this.segments.delete(e.number),this.updateSegmentRanges())};this.updateSegmentRanges(),e.finished?this.parseSegment(e):(e.once("Failed",t),e.once("Finish",()=>{this.parseSegment(e),this.updateSegmentRanges()}))}parseSegment(e){}hasSegment(e){return this.segments.has(e)}getInitSegment(){return this.init}getSegment(e){return i(this.segments.values()).find(t=>void 0!==t&&(t.number===this.endNumber&&e===this.endTime-this.presentationTimeOffset||t.start<=e&&e<t.end))||null}getBufferedRanges(e){var t;return void 0===e&&(e=!1),null===this.initialization||null!=(t=this.init)&&t.finished?e?this.segmentRanges.map(e=>{let{start:t,end:r}=e;return{start:t,end:r}}):this.segmentRanges.filter(e=>{let{finished:t}=e;return t}).map(e=>{let{start:t,end:r}=e;return{start:t,end:r}}):[]}getSeekableRanges(){return[{start:this.startTime-this.presentationTimeOffset,end:this.endTime-this.presentationTimeOffset}]}getSegmentsDebugInfo(e){let t=0,r=0,i=0,n=0;return this.segments.forEach(s=>{e>s.end-this.presentationTimeOffset?(t+=s.loadedRawSize,r+=1):(i+=s.loadedRawSize,n+=1)}),{playedRawSize:t,playedSegmentCount:r,activeRawSize:i,activeSegmentCount:n}}getDebugInfo(){return{id:this.id,bitrate:this.bitrate,language:this.language,type:this.type,initialization:this.initialization,timescale:this.timescale,media:this.media,mimeType:this.mimeType,startNumber:this.startNumber,startTime:this.startTime,endNumber:this.endNumber,endTime:this.endTime,presentationTimeOffset:this.presentationTimeOffset,initSegment:this.init,segmentSequences:this.segmentSequences,seekableRanges:this.getSeekableRanges(),segmentRanges:this.segmentRanges,segments:Array.from(this.segments.entries()).reduce((e,t)=>(e[t[0]]=t[1].getDebugInfo(),e),{})}}updateSegmentRanges(){const e=this.segmentRanges;this.segmentRanges=[];const t=i(this.segments.values()).sort((e,t)=>e.start-t.start);if(0===t.length)return void(0!==e.length&&this.emit("BufferedInfoChanged"));let r={start:t[0].start,startNumber:t[0].number,end:t[0].end,endNumber:t[0].number,finished:t[0].finished};for(let i=1;i<t.length;i++){const e=t[i];e.finished===r.finished&&e.start===r.end?(r.end=e.end,r.endNumber=e.number):(this.segmentRanges.push(r),r={start:e.start,startNumber:e.number,end:e.end,endNumber:e.number,finished:e.finished})}this.segmentRanges.push(r),this.emit("BufferedInfoChanged")}clear(e,t){return this.clearForParallel(e,t)}destroy(){this.clear(0,Number.MAX_SAFE_INTEGER)}clearForParallel(e,t){let r=!1;i(this.segments.values()).forEach(i=>{i.start>=e&&i.end<=t&&(r=!0,i.destroy(),this.segments.delete(i.number))}),r&&this.updateSegmentRanges()}}class He extends je{constructor(e){super(e),this.type="audio",this.codecs=void 0,this.label=void 0,this.channels=void 0,this.codecs=e.codecs,this.label=e.name,this.channels=e.channels}getFullMimeType(){return this.mimeType+"; codecs="+JSON.stringify(this.codecs)}getDebugInfo(){return n({},super.getDebugInfo(),{codecs:this.codecs,label:this.label})}}class We extends je{constructor(e){super(e),this.height=void 0,this.width=void 0,this.type="video",this.codecs=void 0,this.frameRate=void 0,this.label=void 0,this.height=e.height,this.width=e.width,this.codecs=e.codecs,this.frameRate=e.frameRate;const t=this.parseMediaAttribute(e.media||"");this.label=t.label||this.height+"p"}getDebugInfo(){return s({},super.getDebugInfo(),{height:this.height,width:this.width,codecs:this.codecs})}getFullMimeType(){return this.mimeType+"; codecs="+JSON.stringify(this.codecs)}parseMediaAttribute(e){const t={};return e.split(",").map(e=>{const r=e.split("=");r.length>0&&(t[r[0]]=r[1])}),t}}var qe=r(7817);let Ye,Ge,Ke,ze,Ze,Xe,Qe,Je,$e,et,tt,rt,it,nt;!function(e){e[e.BIG_ENDIAN=0]="BIG_ENDIAN",e[e.LITTLE_ENDIAN=1]="LITTLE_ENDIAN"}(Ye||(Ye={}));class st{constructor(e,t){this.dataView=e,this.littleEndian=void 0,this.position=0,this.littleEndian=t===Ye.LITTLE_ENDIAN}getDataView(){return this.dataView}hasMoreData(){return this.position<this.dataView.byteLength}getPosition(){return this.position}getLength(){return this.dataView.byteLength}readUint8(){try{let e=this.dataView.getUint8(this.position);return this.position+=1,e}catch(e){throw this.throwOutOfBounds()}}readUint16(){try{let e=this.dataView.getUint16(this.position,this.littleEndian);return this.position+=2,e}catch(e){throw this.throwOutOfBounds()}}readUint32(){try{let e=this.dataView.getUint32(this.position,this.littleEndian);return this.position+=4,e}catch(e){throw this.throwOutOfBounds()}}readInt32(){try{let e=this.dataView.getInt32(this.position,this.littleEndian);return this.position+=4,e}catch(e){throw this.throwOutOfBounds()}}readUint64(){let e,t;try{this.littleEndian?(e=this.dataView.getUint32(this.position,!0),t=this.dataView.getUint32(this.position+4,!0)):(t=this.dataView.getUint32(this.position,!1),e=this.dataView.getUint32(this.position+4,!1))}catch(r){throw this.throwOutOfBounds()}if(t>2097151)throw new Error("JS_INTEGER_OVERFLOW");return this.position+=8,t*Math.pow(2,32)+e}readBytes(e){this.position+e>this.dataView.byteLength&&this.throwOutOfBounds();let t=new Uint8Array(this.dataView.buffer,this.dataView.byteOffset+this.position,e);return this.position+=e,t}skip(e){if(this.position+e>this.dataView.byteLength)throw this.throwOutOfBounds();this.position+=e}rewind(e){if(this.position<e)throw this.throwOutOfBounds();this.position-=e}seek(e){if(e<0||e>this.dataView.byteLength)throw this.throwOutOfBounds();this.position=e}readTerminatedString(){let e=this.position;for(;this.hasMoreData();){if(0===this.dataView.getUint8(this.position))break;this.position+=1}let t=new Uint8Array(this.dataView.buffer,this.dataView.byteOffset+e,this.position-e);return this.position+=1,qe.x.fromUTF8(t)}throwOutOfBounds(){return new Error("BUFFER_READ_OUT_OF_BOUNDS")}readUUID(){const e=this.readBytes(16);return(st.byteToHex[e[0]]+st.byteToHex[e[1]]+st.byteToHex[e[2]]+st.byteToHex[e[3]]+"-"+st.byteToHex[e[4]]+st.byteToHex[e[5]]+"-"+st.byteToHex[e[6]]+st.byteToHex[e[7]]+"-"+st.byteToHex[e[8]]+st.byteToHex[e[9]]+"-"+st.byteToHex[e[10]]+st.byteToHex[e[11]]+st.byteToHex[e[12]]+st.byteToHex[e[13]]+st.byteToHex[e[14]]+st.byteToHex[e[15]]).toLowerCase()}}st.byteToHex=Array.from({length:256},(e,t)=>(t+256).toString(16).substr(1)),function(e){e[e.BASIC_BOX=0]="BASIC_BOX",e[e.FULL_BOX=1]="FULL_BOX"}(Ge||(Ge={}));class at{constructor(){this.headers=[],this.boxDefinitions=[],this.done=!1}box(e,t){let r=at.typeFromString(e);return this.headers[r]=Ge.BASIC_BOX,this.boxDefinitions[r]=t,this}fullBox(e,t){let r=at.typeFromString(e);return this.headers[r]=Ge.FULL_BOX,this.boxDefinitions[r]=t,this}stop(){this.done=!0}parse(e,t,r){void 0===t&&(t=!1),void 0===r&&(r=!1);let i=new Uint8Array(e),n=new st(new DataView(i.buffer,i.byteOffset,i.byteLength),Ye.BIG_ENDIAN);for(this.done=!1;n.hasMoreData()&&!this.done;)this.parseNext(0,n,t,r)}parseNext(e,t,r,i){void 0===r&&(r=!1),void 0===i&&(i=!1);let n=t.getPosition();if(i&&n+8>t.getLength())return void(this.done=!0);let s=t.readUint32(),a=t.readUint32();switch(s){case 0:s=t.getLength()-n;break;case 1:if(i&&t.getPosition()+8>t.getLength())return void(this.done=!0);s=t.readUint64()}let o=this.boxDefinitions[a];if(o){let l=null,d=null;if(this.headers[a]===Ge.FULL_BOX){let e=t.readUint32();l=e>>>24,d=16777215&e}let u=n+s,c=!0;if(r&&u>t.getLength()&&(u=t.getLength(),c=!1),i&&u>t.getLength())return void(this.done=!0);let h=u-t.getPosition(),p=h>0?t.readBytes(h):new Uint8Array(0);o({parser:this,partialOkay:r||!1,version:l,flags:d,reader:new st(new DataView(p.buffer,p.byteOffset,p.byteLength),Ye.BIG_ENDIAN),size:s,loadedSize:t.getPosition()-n,start:n+e,isComplete:c})}else{const e=Math.min(n+s-t.getPosition(),t.getLength()-t.getPosition());t.skip(e)}}static children(e){const t=null!==e.flags?12:8;for(;e.reader.hasMoreData()&&!e.parser.done;)e.parser.parseNext(e.start+t,e.reader,e.partialOkay)}static sampleDescription(e){const t=null!==e.flags?12:8;for(let r=e.reader.readUint32();r>0&&!e.parser.done;r-=1)e.parser.parseNext(e.start+t,e.reader,e.partialOkay)}static allData(e){return function(t){const r=t.reader.getLength()-t.reader.getPosition();e(t.reader.readBytes(r))}}static typeFromString(e){let t=0;for(let r=0;r<e.length;r++)t=t<<8|e.charCodeAt(r);return t}static typeToString(e){return String.fromCharCode(e>>24&255,e>>16&255,e>>8&255,255&e)}}class ot{parseInit(e){}parseMedia(e,t){return[]}}class lt{constructor(e){this.data_=void 0,this.position_=void 0,this.data_=e,this.position_=0}atEnd(){var e;return this.position_===(null==(e=this.data_)?void 0:e.length)}readLine(){return this.readRegexReturnCapture_(/(.*?)(\n|$)/gm,1)}readWord(){return this.readRegexReturnCapture_(/[^ \t\n]*/gm,0)}skipWhitespace(){this.readRegex(/[ \t]+/gm)}readRegex(e){let t=this.indexOf_(e);return this.atEnd()||null===t||t.position!==this.position_?null:(this.position_+=t.length,t.results)}readRegexReturnCapture_(e,t){if(this.atEnd())return null;let r=this.readRegex(e);return r?r[t]:null}indexOf_(e){e.lastIndex=this.position_;let t=e.exec(this.data_);return null===t?null:{position:t.index,length:t[0].length,results:t}}}class dt{static defaultEquals(e,t){return!("number"!==typeof e||"number"!==typeof t||!isNaN(e)||!isNaN(t))||e===t}static equal(e,t,r){if(void 0===r&&(r=dt.defaultEquals),e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(!r(e[i],t[i]))return!1;return!0}static remove(e,t){let r=e.indexOf(t);r>-1&&e.splice(r,1)}}class ut{constructor(e,t,r){this.startTime=void 0,this.endTime=void 0,this.payload=void 0,this.direction=Xe.HORIZONTAL_LEFT_TO_RIGHT,this.region=new ct,this.position=null,this.positionAlign=Ke.AUTO,this.size=0,this.textAlign=ze.CENTER,this.writingMode=Qe.HORIZONTAL_TOP_TO_BOTTOM,this.lineInterpretation=Je.LINE_NUMBER,this.line=null,this.lineHeight="",this.lineAlign=$e.START,this.displayAlign=Ze.AFTER,this.color="",this.backgroundColor="",this.backgroundImage="",this.fontSize="",this.fontWeight=et.NORMAL,this.fontStyle=tt.NORMAL,this.fontFamily="",this.textDecoration=[],this.wrapLine=!0,this.id="",this.nestedCues=[],this.lineBreak=!1,this.spacer=!1,this.cellResolution={columns:32,rows:15},this.border="",this.letterSpacing="",this.linePadding="",this.opacity=1,this.startTime=e,this.endTime=t,this.payload=r}clone(){const e=new ut(0,0,"");for(const t in this)e[t]=this[t],e[t]&&e[t].constructor===Array&&(e[t]=e[t].slice());return e}static equal(e,t){for(const r in e)if("nestedCues"===r){if(!dt.equal(e.nestedCues,t.nestedCues,ut.equal))return!1}else if("region"===r||"cellResolution"===r){for(const i in e[r])if(e[r][i]!==t[r][i])return!1}else if(Array.isArray(e[r])){if(!dt.equal(e[r],t[r]))return!1}else if(e[r]!==t[r])return!1;return!0}}!function(e){e.LEFT="line-left",e.RIGHT="line-right",e.CENTER="center",e.AUTO="auto"}(Ke||(Ke={})),function(e){e.LEFT="left",e.RIGHT="right",e.CENTER="center",e.START="start",e.END="end"}(ze||(ze={})),function(e){e.BEFORE="before",e.CENTER="center",e.AFTER="after"}(Ze||(Ze={})),function(e){e.HORIZONTAL_LEFT_TO_RIGHT="ltr",e.HORIZONTAL_RIGHT_TO_LEFT="rtl"}(Xe||(Xe={})),function(e){e.HORIZONTAL_TOP_TO_BOTTOM="horizontal-tb",e.VERTICAL_LEFT_TO_RIGHT="vertical-lr",e.VERTICAL_RIGHT_TO_LEFT="vertical-rl"}(Qe||(Qe={})),function(e){e[e.LINE_NUMBER=0]="LINE_NUMBER",e[e.PERCENTAGE=1]="PERCENTAGE"}(Je||(Je={})),function(e){e.CENTER="center",e.START="start",e.END="end"}($e||($e={})),function(e){e[e.NORMAL=400]="NORMAL",e[e.BOLD=700]="BOLD"}(et||(et={})),function(e){e.NORMAL="normal",e.ITALIC="italic",e.OBLIQUE="oblique"}(tt||(tt={})),function(e){e.UNDERLINE="underline",e.LINE_THROUGH="lineThrough",e.OVERLINE="overline"}(rt||(rt={}));class ct{constructor(){this.id="",this.viewportAnchorX=0,this.viewportAnchorY=0,this.regionAnchorX=0,this.regionAnchorY=0,this.width=100,this.height=100,this.heightUnits=it.PERCENTAGE,this.widthUnits=it.PERCENTAGE,this.viewportAnchorUnits=it.PERCENTAGE,this.scroll=nt.NONE}}!function(e){e[e.PX=0]="PX",e[e.PERCENTAGE=1]="PERCENTAGE",e[e.LINES=2]="LINES"}(it||(it={})),function(e){e.NONE="",e.UP="up"}(nt||(nt={}));var ht=r(9209);const{parse:pt}=r(3741);class ft{constructor(){this.namespaces={}}parse(e){const t=pt(e),r=Array.isArray(t)?t:[];return r.forEach(e=>{e.attributes&&Object.keys(e.attributes).forEach(t=>{if(t.startsWith("xmlns")){const[,r]=t.split(":");this.namespaces[e.attributes[t]]=r||"__global"}})}),r}static getChildren(e){return Array.from(e.children).filter(e=>!(0,ht.H)(e))}getAttributeNS(e,t,r){const i=this.namespaces[t]+":"+r;return i in e.attributes?e.attributes[i]:null}getAttributeNSList(e,t,r){for(const i of t){const t=this.getAttributeNS(e,i,r);if(t)return t}return null}findChildrenNS(e,t,r){return e.children.filter(e=>{const i=this.namespaces[t]+":"+r;return"string"!==typeof e&&e.tagName===i})}findChildren(e,t){return e.children?e.children.filter(e=>"string"!==typeof e&&e.tagName===t):[]}getContents(e){var t;return(0,ht.H)(e)?e:e.children.every(ht.H)&&null!=(t=e.children[0].trim())?t:null}findChildNS(e,t,r){let i=this.findChildrenNS(e,t,r);return 1!==i.length?null:i[0]}static getElementsByTagName(e,t){let r=[];const i=e=>{e.tagName===t&&r.push(e);for(const t of e.children)"string"!==typeof t&&i(t)};return i(e),r}static getElementByTagName(e,t){let r=null;const i=e=>{if(null===r)if(e.tagName!==t)for(const t of e.children)"string"!==typeof t&&i(t);else r=e};return i(e),r}static setParent(e){const t=a(e,{parent:null}),r=e=>{for(const t of e.children)"string"!==typeof t&&(t.parent=e,r(t))};return r(t),t}static getTextContent(e){let t="";const r=e=>{for(const i of e.children)"string"===typeof i?t+=i:r(i)};return r(e),t}}const mt={amp:"&",quot:'"',apos:"'",lt:"<",gt:">"};var gt=r(1106),vt=r(6971);class yt extends ot{constructor(){super()}parseInit(e){}parseMedia(e,t){const r=new ft,i=yt.parameterNs,n=yt.styleNs,s=qe.x.fromUTF8(e),a=[];let o=null;if(!s)return a;try{o=r.parse(function(e){return e.replace(/<br\s*><\/br\s*>/gi,"<br />")}(s))}catch(k){throw new gt.w({isFatal:!1,category:vt.q.MEDIA,code:"YASP_INVALID_SUBTITLES_XML",message:"Failed to parse TTML. "+k,details:{}})}if(!o||!o.length)throw new gt.w({isFatal:!1,category:vt.q.MEDIA,code:"YASP_INVALID_SUBTITLES_XML",message:"Failed to parse TTML.",details:{}});const l=o.filter(e=>"tt"===e.tagName),d=ft.setParent(l[0]);if(!d)throw new gt.w({isFatal:!1,category:vt.q.MEDIA,code:"YASP_INVALID_SUBTITLES_XML",message:"TTML does not contain <tt> tag.",details:{}});const u=ft.getElementByTagName(d,"body");if(!u)return[];const c=r.getAttributeNS(d,i,"frameRate"),h=r.getAttributeNS(d,i,"subFrameRate"),p=r.getAttributeNS(d,i,"frameRateMultiplier"),f=r.getAttributeNS(d,i,"tickRate"),m=r.getAttributeNS(d,i,"cellResolution"),g=d.attributes["xml:space"]||"default",v=r.getAttributeNS(d,n,"extent");if("default"!==g&&"preserve"!==g)throw new gt.w({isFatal:!1,category:vt.q.MEDIA,code:"YASP_INVALID_SUBTITLES_XML",message:"Invalid xml:space value: "+g,details:{}});const y="default"===g,S=new St(c,h,p,f),E=yt.getCellResolution(null!=m?m:""),b=ft.getElementByTagName(d,"metadata"),A=b?ft.getChildren(b).filter(e=>!(0,ht.H)(e)):[],T=ft.getElementsByTagName(d,"style"),_=ft.getElementsByTagName(d,"region"),w=[];for(const R of _){const e=yt.parseCueRegion(R,T,v,r);e&&w.push(e)}if(r.findChildren(u,"p").length)throw new gt.w({category:vt.q.MEDIA,code:"YASP_INVALID_SUBTITLES_XML",isFatal:!1,message:"<p> can only be inside <div> in TTML",details:{}});for(const R of r.findChildren(u,"div")){if(r.findChildren(R,"span").length)throw new gt.w({isFatal:!1,category:vt.q.MEDIA,code:"YASP_INVALID_SUBTITLES_XML",message:"<span> can only be inside <p> in TTML",details:{}});for(const e of r.findChildren(R,"p")){const i=yt.parseCue({cueNode:e,offset:t.periodStart,rateInfo:S,metadataElements:A,styles:T,regionElements:_,cueRegions:w,whitespaceTrim:y,isNested:!1,cellResolution:E,xmlUtils:r,parentNode:R});i&&a.push(i)}}return a}static parseCue(e){let t,{cueNode:r,offset:i,rateInfo:n,metadataElements:s,styles:a,regionElements:l,cueRegions:u,whitespaceTrim:c,isNested:h,cellResolution:p,xmlUtils:f,parentNode:m}=e,g=null;if(t=(0,ht.H)(r)?d(function(e,t){return{tagName:"span",attributes:{},children:[e],parent:t}}(r,m)):d(r),g=t.parent,!g)return null;let v=d(g);const y=/\S/.test(t.textContent),S=t.textContent&&!y,E=Boolean(t.children.length),b="br"===t.tagName,A=t.attributes.begin||t.attributes.end||t.attributes.dur;if(!A&&S&&!b){if(!h)return null;if(c)return null}if(!y&&!E&&!A&&!b)return null;let{start:T,end:_}=yt.parseTime(t,n);for(;1===(null==(w=v)?void 0:w.nodeType)&&"tt"!==(null==(k=v)?void 0:k.tagName);){var w,k;({start:T,end:_}=yt.resolveTime(v,n,T,_));const e=v.parent;if(!e)break;v=d(e)}if(null===T&&(T=0),T+=i,null===_?_=1/0:_+=i,"br"===t.tagName){const e=new ut(T,_,"");return e.lineBreak=!0,e}let R="";const P=[];if(3===t.nodeType)R=o(t.textContent),c&&(R=R.trim(),R=R.replace(/\s+/g," "));else for(const o of t.children){const e=yt.parseCue({cueNode:o,offset:i,rateInfo:n,metadataElements:s,styles:a,regionElements:l,cueRegions:u,whitespaceTrim:c,isNested:!0,cellResolution:p,xmlUtils:f,parentNode:t});e&&P.push(e)}const C=new ut(T,_,R);C.nestedCues=P,p&&(C.cellResolution=p);const I=yt.getElementsFromCollection(t,"region",l,"",f)[0];if(I&&I.attributes["xml:id"]){const e=I.attributes["xml:id"];C.region=u.filter(t=>t.id===e)[0]}const O=yt.getElementsFromCollection(t,"backgroundImage",s,"#",f,yt.smpteNs)[0],D=0===P.length;return yt.addStyle(C,t,I,O,a,h,D,f),C}static parseCueRegion(e,t,r,i){const n=new ct,s=e.attributes["xml:id"];if(!s)return null;n.id=s;let a=null;r&&(a=yt.percentValues.exec(r)||yt.pixelValues.exec(r));const o=a?Number(a[1]):null,l=a?Number(a[2]):null;let d=null,u=null;const c=yt.getStyleAttributeFromRegion(e,t,"extent",i);c&&(u=yt.percentValues.exec(c),d=u||yt.pixelValues.exec(c),null!==d&&(n.width=null!==o?100*Number(d[1])/o:Number(d[1]),n.height=null!==l?100*Number(d[2])/l:Number(d[2]),n.widthUnits=u||null!==o?it.PERCENTAGE:it.PX,n.heightUnits=u||null!==l?it.PERCENTAGE:it.PX));const h=yt.getStyleAttributeFromRegion(e,t,"origin",i);return h&&(u=yt.percentValues.exec(h),d=u||yt.pixelValues.exec(h),null!==d&&(n.viewportAnchorX=null!==l?100*Number(d[1])/l:Number(d[1]),n.viewportAnchorY=null!==o?100*Number(d[2])/o:Number(d[2]),n.viewportAnchorUnits=u||null!==o?it.PERCENTAGE:it.PX)),n}static addStyle(e,t,r,i,n,s,a,o){const l=i?d(i):i,u=s||a;"rtl"===yt.getStyleAttribute(t,r,n,"direction",u,o)&&(e.direction=Xe.HORIZONTAL_RIGHT_TO_LEFT);const c=yt.getStyleAttribute(t,r,n,"writingMode",u,o);"tb"===c||"tblr"===c?e.writingMode=Qe.VERTICAL_LEFT_TO_RIGHT:"tbrl"===c?e.writingMode=Qe.VERTICAL_RIGHT_TO_LEFT:"rltb"===c||"rl"===c?e.direction=Xe.HORIZONTAL_RIGHT_TO_LEFT:c&&(e.direction=Xe.HORIZONTAL_LEFT_TO_RIGHT);const h=yt.getStyleAttribute(t,r,n,"textAlign",u,o);h?(e.positionAlign=yt.textAlignToPositionAlign[h],e.lineAlign=yt.textAlignToLineAlign[h],e.textAlign=ze[h.toUpperCase()]):e.textAlign=ze.START;const p=yt.getStyleAttribute(t,r,n,"displayAlign",u,o);p&&(e.displayAlign=Ze[p.toUpperCase()]);const f=yt.getStyleAttribute(t,r,n,"color",u,o);f&&(e.color=f);const m=yt.getStyleAttribute(t,r,n,"backgroundColor",u,o);m&&(e.backgroundColor=m);const g=yt.getStyleAttribute(t,r,n,"border",u,o);g&&(e.border=g);const v=yt.getStyleAttribute(t,r,n,"fontFamily",u,o);v&&(e.fontFamily=v);const y=yt.getStyleAttribute(t,r,n,"fontWeight",u,o);y&&"bold"===y&&(e.fontWeight=et.BOLD);const S=yt.getStyleAttribute(t,r,n,"wrapOption",u,o);e.wrapLine=!S||"noWrap"!==S;const E=yt.getStyleAttribute(t,r,n,"lineHeight",u,o);E&&E.match(yt.unitValues)&&(e.lineHeight=E);const b=yt.getStyleAttribute(t,r,n,"fontSize",u,o);if(b){(b.match(yt.unitValues)||b.match(yt.percentValue))&&(e.fontSize=b)}const A=yt.getStyleAttribute(t,r,n,"fontStyle",u,o);if(A&&(e.fontStyle=tt[A.toUpperCase()]),l){const t=l.attributes.imagetype,r=l.attributes.encoding,i=l.textContent.trim();"PNG"===t&&"Base64"===r&&i&&(e.backgroundImage="data:image/png;base64,"+i)}const T=yt.getStyleAttribute(t,r,n,"letterSpacing",u,o);T&&T.match(yt.unitValues)&&(e.letterSpacing=T);const _=yt.getStyleAttribute(t,r,n,"linePadding",u,o);_&&_.match(yt.unitValues)&&(e.linePadding=_);const w=yt.getStyleAttribute(t,r,n,"opacity",u,o);w&&(e.opacity=parseFloat(w));const k=yt.getStyleAttributeFromRegion(r,n,"textDecoration",o);k&&yt.addTextDecoration(e,k);const R=yt.getStyleAttributeFromElement(t,n,"textDecoration",o);R&&yt.addTextDecoration(e,R)}static addTextDecoration(e,t){for(const r of t.split(" "))switch(r){case"underline":e.textDecoration.includes(rt.UNDERLINE)||e.textDecoration.push(rt.UNDERLINE);break;case"noUnderline":e.textDecoration.includes(rt.UNDERLINE)&&dt.remove(e.textDecoration,rt.UNDERLINE);break;case"lineThrough":e.textDecoration.includes(rt.LINE_THROUGH)||e.textDecoration.push(rt.LINE_THROUGH);break;case"noLineThrough":e.textDecoration.includes(rt.LINE_THROUGH)&&dt.remove(e.textDecoration,rt.LINE_THROUGH);break;case"overline":e.textDecoration.includes(rt.OVERLINE)||e.textDecoration.push(rt.OVERLINE);break;case"noOverline":e.textDecoration.includes(rt.OVERLINE)&&dt.remove(e.textDecoration,rt.OVERLINE);break;default:continue}}static getStyleAttribute(e,t,r,i,n,s){void 0===n&&(n=!0);const a=yt.getStyleAttributeFromElement(e,r,i,s);return a||(n?yt.getStyleAttributeFromRegion(t,r,i,s):null)}static getStyleAttributeFromRegion(e,t,r,i){const n=yt.styleNs;if(!e)return null;const s=i.getAttributeNS(e,n,r);return s||yt.getInheritedStyleAttribute(e,t,r,i)}static getStyleAttributeFromElement(e,t,r,i){const n=yt.styleNs,s=i.getAttributeNS(e,n,r);return s||yt.getInheritedStyleAttribute(e,t,r,i)}static getInheritedStyleAttribute(e,t,r,i){const n=yt.styleNs,s=yt.styleEbuttsNs,a=yt.getElementsFromCollection(e,"style",t,"",i);let o=null;for(let l=0;l<a.length;l++){let e=i.getAttributeNS(a[l],s,r);e||(e=i.getAttributeNS(a[l],n,r)),e||(e=yt.getStyleAttributeFromElement(a[l],t,r,i)),e&&(o=e)}return o}static getElementsFromCollection(e,t,r,i,n,s){const a=[];if(!e||r.length<1)return a;const o=yt.getInheritedAttribute(e,t,n,s);if(o){const e=o.split(" ");for(const t of e)for(const e of r)if(i+e.attributes["xml:id"]===t){a.push(e);break}}return a}static getInheritedAttribute(e,t,r,i){let n=null;for(;e&&(n=i?r.getAttributeNS(e,i,t):e.attributes[t],!n);){const t=e.parent;if(null===t)break;e=t}return n}static resolveTime(e,t,r,i){const n=yt.parseTime(e,t);return null===r?r=n.start:null!==n.start&&(r+=n.start),null===i?i=n.end:null!==n.start&&(i+=n.start),{start:r,end:i}}static parseTime(e,t){const r=yt.parseTimeAttribute(e.attributes.begin,t);let i=yt.parseTimeAttribute(e.attributes.end,t);const n=yt.parseTimeAttribute(e.attributes.dur,t);return null===i&&null!==n&&(i=r+n),{start:r,end:i}}static parseTimeAttribute(e,t){let r=null;if(yt.timeColonFormatFrames.test(e))r=yt.parseColonTimeWithFrames(t,e);else if(yt.timeColonFormat.test(e))r=yt.parseTimeFromRegex(yt.timeColonFormat,e);else if(yt.timeColonFormatMilliseconds.test(e))r=yt.parseTimeFromRegex(yt.timeColonFormatMilliseconds,e);else if(yt.timeFramesFormat.test(e))r=yt.parseFramesTime(t,e);else if(yt.timeTickFormat.test(e))r=yt.parseTickTime(t,e);else if(yt.timeHMSFormat.test(e))r=yt.parseTimeFromRegex(yt.timeHMSFormat,e);else if(e)throw new gt.w({isFatal:!1,category:vt.q.MEDIA,code:"YASP_INVALID_TEXT_CUE",details:{},message:"Could not parse cue time range in TTML"});return r}static parseFramesTime(e,t){const r=yt.timeFramesFormat.exec(t);if(!r)return null;return Number(r[1])/e.frameRate}static parseTickTime(e,t){const r=yt.timeTickFormat.exec(t);if(!r)return null;return Number(r[1])/e.tickRate}static parseColonTimeWithFrames(e,t){const r=yt.timeColonFormatFrames.exec(t);if(!r)return null;const i=Number(r[1]),n=Number(r[2]);let s=Number(r[3]),a=Number(r[4]);return a+=(Number(r[5])||0)/e.subFrameRate,s+=a/e.frameRate,s+60*n+3600*i}static parseTimeFromRegex(e,t){const r=e.exec(t);if(null===r||""===r[0])return null;const i=Number(r[1])||0,n=Number(r[2])||0,s=Number(r[3])||0;return(Number(r[4])||0)/1e3+s+60*n+3600*i}static getCellResolution(e){if(!e)return null;const t=/^(\d+) (\d+)$/.exec(e);if(!t)return null;return{columns:parseInt(t[1],10),rows:parseInt(t[2],10)}}}yt.styleNs="http://www.w3.org/ns/ttml#styling",yt.parameterNs="http://www.w3.org/ns/ttml#parameter",yt.percentValues=/^(\d{1,2}(?:\.\d+)?|100(?:\.0+)?)% (\d{1,2}(?:\.\d+)?|100(?:\.0+)?)%$/,yt.percentValue=/^(\d{1,2}(?:\.\d+)?|100)%$/,yt.unitValues=/^(\d+px|\d+em|\d*\.?\d+c)$/,yt.pixelValues=/^(\d+)px (\d+)px$/,yt.timeColonFormatFrames=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,yt.timeColonFormat=/^(?:(\d{2,}):)?(\d{2}):(\d{2})$/,yt.timeColonFormatMilliseconds=/^(?:(\d{2,}):)?(\d{2}):(\d{2}\.\d{2,})$/,yt.timeFramesFormat=/^(\d*(?:\.\d*)?)f$/,yt.timeTickFormat=/^(\d*(?:\.\d*)?)t$/,yt.timeHMSFormat=new RegExp(["^(?:(\\d*(?:\\.\\d*)?)h)?","(?:(\\d*(?:\\.\\d*)?)m(?!s))?","(?:(\\d*(?:\\.\\d*)?)s)?","(?:(\\d*(?:\\.\\d*)?)ms)?$"].join("")),yt.smpteNs="http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt",yt.styleEbuttsNs="urn:ebu:tt:style",yt.textAlignToLineAlign={left:$e.START,center:$e.CENTER,right:$e.END,start:$e.START,end:$e.END},yt.textAlignToPositionAlign={left:Ke.LEFT,center:Ke.CENTER,right:Ke.RIGHT};class St{constructor(e,t,r,i){if(this.frameRate=void 0,this.subFrameRate=void 0,this.tickRate=void 0,this.frameRate=Number(e)||30,this.subFrameRate=Number(t)||1,this.tickRate=Number(i),0===this.tickRate&&(this.tickRate=e?this.frameRate*this.subFrameRate:1),r){const e=/^(\d+) (\d+)$/g.exec(r);if(e){const t=Number(e[1])/Number(e[2]);this.frameRate*=t}}}}class Et{constructor(){this.parser=new yt}parseInit(e){let t=!1;if((new at).box("moov",at.children).box("trak",at.children).box("mdia",at.children).box("minf",at.children).box("stbl",at.children).fullBox("stsd",at.sampleDescription).box("stpp",e=>{t=!0,e.parser.stop()}).parse(e),!t)throw new Error("Can not parseInt while subtitles processing")}parseMedia(e,t){let r=!1,i=[];if((new at).box("mdat",at.allData(e=>{r=!0,i=i.concat(this.parser.parseMedia(e,t))})).parse(e,!1),!r)throw new Error("Can not parseInt while subtitles processing.");return i}}var bt=r(2918);class At extends ot{constructor(){super()}parseInit(e){}parseMedia(e,t){let r=qe.x.fromUTF8(e);r=r.replace(/\r\n|\r(?=[^\n]|$)/gm,"\n");let i=r.split(/\n{2,}/m);if(!/^WEBVTT($|[ \t\n])/m.test(i[0]))throw new Error("INVALID_TEXT_HEADER");let n=t.segmentStart;null===n&&(n=0);let s=[],a=i[0].split("\n");for(let l=1;l<a.length;l++)if(/^Region:/.test(a[l])){let e=At.parseRegion_(a[l]);s.push(e)}let o=[];for(let l=1;l<i.length;l++){a=i[l].split("\n");let e=At.parseCue_(a,n,s);e&&o.push(e)}return o}static parseRegion_(e){let t=new lt(e),r=new ct;t.readWord(),t.skipWhitespace();let i=t.readWord();for(;i;)At.parseRegionSetting_(r,i),t.skipWhitespace(),i=t.readWord();return r}static parseCue_(e,t,r){if(1===e.length&&!e[0])return null;if(/^NOTE($|[ \t])/.test(e[0]))return null;if("STYLE"===e[0])return null;let i=null;e[0].includes("--\x3e")||(i=e[0],e.splice(0,1));let n=new lt(e[0]),s=At.parseTime_(n),a=n.readRegex(/[ \t]+-->[ \t]+/g),o=At.parseTime_(n);if(null===s||null===a||null===o)return null;t&&(s+=t,o+=t);let l=e.slice(1).join("\n").trim(),d=new ut(s,o,l);n.skipWhitespace();let u=n.readWord();for(;u;)At.parseCueSetting(d,u,r),n.skipWhitespace(),u=n.readWord();return null!==i&&(d.id=i),d}static parseCueStyles(e,t){const r="<span>"+e+"</span>",i=(new ft).parse(r);if(i){const r=[],n=i;if(1===n.length){if(3===d(n[0]).nodeType)return void(t.payload=e)}for(const e of n)At.generateCueFromElement(e,t,r);t.nestedCues=r}else t.payload=e}static generateCueFromElement(e,t,r){const i=d(e),n=t.clone();if(1===i.nodeType&&i.tagName){const t=et.BOLD,r=tt.ITALIC,i=rt.UNDERLINE,s=e.tagName.split(/[ .]+/);for(const e of s)switch(e){case"b":n.fontWeight=t;break;case"i":n.fontStyle=r;break;case"u":n.textDecoration.push(i);break;default:continue}}if(3===i.nodeType)n.payload=i.textContent,r.push(n);else for(const s of i.children)(0,ht.H)(s)||At.generateCueFromElement(s,n,r)}static parseCueSetting(e,t,r){let i=null;if(i=/^align:(start|middle|center|end|left|right)$/.exec(t))At.setTextAlign_(e,i[1]);else if(i=/^vertical:(lr|rl)$/.exec(t))At.setVerticalWritingMode_(e,i[1]);else if(i=/^size:([\d.]+)%$/.exec(t))e.size=Number(i[1]);else if(i=/^position:([\d.]+)%(?:,(line-left|line-right|center|start|end))?$/.exec(t))e.position=Number(i[1]),i[2]&&At.setPositionAlign_(e,i[2]);else{if(!(i=/^region:(.*)$/.exec(t)))return At.parsedLineValueAndInterpretation_(e,t);{let t=At.getRegionById_(r,i[1]);t&&(e.region=t)}}return!0}static getRegionById_(e,t){let r=e.filter((function(e){return e.id===t}));return r.length?r[0]:null}static parseRegionSetting_(e,t){let r=null;if(r=/^id=(.*)$/.exec(t))e.id=r[1];else if(r=/^width=(\d{1,2}|100)%$/.exec(t))e.width=Number(r[1]);else if(r=/^lines=(\d+)$/.exec(t))e.height=Number(r[1]),e.heightUnits=it.LINES;else if(r=/^regionanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(t))e.regionAnchorX=Number(r[1]),e.regionAnchorY=Number(r[2]);else if(r=/^viewportanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(t))e.viewportAnchorX=Number(r[1]),e.viewportAnchorY=Number(r[2]);else{if(!(r=/^scroll=up$/.exec(t)))return!1;e.scroll=nt.UP}return!0}static setTextAlign_(e,t){e.textAlign="middle"===t?ze.CENTER:ze[t.toUpperCase()]}static setPositionAlign_(e,t){e.positionAlign="line-left"===t||"start"===t?Ke.LEFT:"line-right"===t||"end"===t?Ke.RIGHT:Ke.CENTER}static setVerticalWritingMode_(e,t){e.writingMode="lr"===t?Qe.VERTICAL_LEFT_TO_RIGHT:Qe.VERTICAL_RIGHT_TO_LEFT}static parsedLineValueAndInterpretation_(e,t){let r=null;if(r=/^line:([\d.]+)%(?:,(start|end|center))?$/.exec(t))e.lineInterpretation=Je.PERCENTAGE,e.line=Number(r[1]),r[2]&&(e.lineAlign=$e[r[2].toUpperCase()]);else{if(!(r=/^line:(-?\d+)(?:,(start|end|center))?$/.exec(t)))return!1;e.lineInterpretation=Je.LINE_NUMBER,e.line=Number(r[1]),r[2]&&(e.lineAlign=$e[r[2].toUpperCase()])}return!0}static parseTime_(e){let t=e.readRegex(/(?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{2,3})/g);if(null===t)return null;let r=Number(t[1])||0,i=Number(t[2]),n=Number(t[3]),s=Number(t[4]);return i>59||n>59?null:s/1e3+n+60*i+3600*r}}class Tt extends ot{constructor(){super(),this.timescale=null,this.parseInit=e=>{let t=!1;if((new at).box("moov",at.children).box("trak",at.children).box("mdia",at.children).fullBox("mdhd",e=>{0===e.version?(e.reader.skip(4),e.reader.skip(4),this.timescale=e.reader.readUint32(),e.reader.skip(4)):(e.reader.skip(8),e.reader.skip(8),this.timescale=e.reader.readUint32(),e.reader.skip(8)),e.reader.skip(4)}).box("minf",at.children).box("stbl",at.children).fullBox("stsd",at.sampleDescription).box("wvtt",()=>{t=!0}).parse(e),!this.timescale)throw new Error("Can not get vtt timescale");if(!t)throw new Error("No WVTT box was found")}}parseMedia(e,t){if(!this.timescale)throw new Error("No init segment for MP4+VTT!");let r=0,i=[],n=new Uint8Array,s=[],a=!1,o=!1,l=!1,d=null;if((new at).box("moof",at.children).box("traf",at.children).fullBox("tfdt",e=>{a=!0,0!==e.version&&1!==e.version||(r=0===e.version?e.reader.readUint32():e.reader.readUint64())}).fullBox("tfhd",e=>{null!==e.flags&&(d=Tt.parseTFHD(e.flags,e.reader))}).fullBox("trun",(function(e){o=!0,null!==e.version&&null!==e.flags&&(i=i.concat(Tt.parseTRUN(e.version,e.flags,e.reader)))})).box("mdat",at.allData(e=>{l=!0,n=bt.P.concat(n,e)})).parse(e),!l&&!a&&!o||!n.length)throw new Error("Can not parse mp4 vtt because required box is missing.");let u=r;const c=new DataView(n.buffer,n.byteOffset,n.byteLength),h=new st(c,Ye.BIG_ENDIAN);return i.forEach(e=>{let i=e.duration||d,n=e.timeOffset?r+e.timeOffset:u;u=n+(i||0);let a=0;do{let e=h.readUint32();a+=e;let r=h.readUint32(),o=at.typeToString(r),l=null;if("vttc"===o?e>8&&(l=h.readBytes(e-8)):h.skip(e-8),i&&l){if(null===this.timescale)throw new Error("No initial vtt segment");const e=Tt.parseVTTC(l,t.periodStart+n/this.timescale,t.periodStart+u/this.timescale);s.push(e)}}while(e.sampleSize&&a<e.sampleSize)}),s.filter(Boolean)}static parseTFHD(e,t){return t.skip(4),1&e&&t.skip(8),2&e&&t.skip(4),8&e?t.readUint32():null}static parseTRUN(e,t,r){let i=r.readUint32();1&t&&r.skip(4),4&t&&r.skip(4);let n=[];for(let s=0;s<i;s++){let i={duration:null,sampleSize:null,timeOffset:null};256&t&&(i.duration=r.readUint32()),512&t&&(i.sampleSize=r.readUint32()),1024&t&&r.skip(4),2048&t&&(i.timeOffset=0===e?r.readUint32():r.readInt32()),n.push(i)}return n}static parseVTTC(e,t,r){let i,n,s="";return(new at).box("payl",at.allData(e=>{i=qe.x.fromUTF8(e)})).box("iden",at.allData(e=>{n=qe.x.fromUTF8(e)})).box("sttg",at.allData(e=>{s=qe.x.fromUTF8(e)})).parse(e),i?Tt.assembleCue(i,n,s,t,r):null}static assembleCue(e,t,r,i,n){let s=new ut(i,n,e);if(At.parseCueStyles(e,s),t&&(s.id=t),r){let e=new lt(r),t=e.readWord();for(;t;)At.parseCueSetting(s,t,[]),e.skipWhitespace(),t=e.readWord()}return s}}class _t{constructor(){this.parser=null,this.timestampOffset=0,this.appendWindowStart=0,this.appendWindowEnd=1/0,this.bufferStart=null}static registerParser(e,t){_t.parserMap[e]=t}initParser(e){if("application/cea-608"===e)return;let t=_t.parserMap[e];this.parser=new t}appendBuffer(e,t,r){return Promise.resolve().then(()=>{if(!this.parser)return;if(null===t||null===r)return void this.parser.parseInit(e);const i={periodStart:this.timestampOffset,segmentStart:t,segmentEnd:r},n=this.parser.parseMedia(e,i).filter(e=>e.startTime>=this.appendWindowStart&&e.startTime<this.appendWindowEnd);return null===this.bufferStart&&(this.bufferStart=Math.max(t,this.appendWindowStart)),n})}}_t.parserMap={},_t.registerParser("text/vtt",At),_t.registerParser('text/vtt; codecs="vtt"',At),_t.registerParser('text/vtt; codecs="wvtt"',At),_t.registerParser("application/ttml+xml",yt),_t.registerParser('application/mp4; codecs="stpp"',Et),_t.registerParser('application/mp4; codecs="stpp.ttml.im1t"',Et),_t.registerParser('application/mp4; codecs="stpp.TTML.im1t"',Et),_t.registerParser('application/mp4; codecs="wvtt"',Tt);class wt extends je{constructor(e){super(e),this.kind=void 0,this.label=void 0,this.type="text",this.codecs=void 0,this.kind=wt.parseKind(e.kind),this.codecs=e.codecs,this.label=e.label||e.language||"Yasp Text Track"}static parseKind(e){switch(e){case"subtitle":return"subtitles";default:return e}}getFullMimeType(){return this.codecs?this.mimeType+"; codecs="+JSON.stringify(this.codecs):this.mimeType}appendInitSegment(e){this.init=e,this.parseSegment(e)}parseSegment(e){wt.textEngine.initParser(this.getFullMimeType());const t=e.isInitSegment,r=t?null:e.start,i=t?null:e.end,n=e.getChunks();let s=0;n.forEach(e=>{s+=e.length});const a=new Uint8Array(s);let o=0;n.forEach(e=>{a.set(e,o),o+=e.length}),wt.textEngine.appendBuffer(a,r,i).then(e=>{if(e){const t=this.presentationTimeOffset/1e3,r=e=>(e.startTime-=t,e.endTime-=t,e.nestedCues&&(e.nestedCues=e.nestedCues.map(r)),e),i=e.map(r);this.emit("CuesAdded",i)}})}}wt.textEngine=new _t;var kt=r(9002),Rt=r(3106);class Pt extends kt.M{constructor(e){void 0===e&&(e=Rt.identity),super(),this.destroyed=!1,this.closing=!1,this.closed=!1,this.paused=!0,this.flushing=!1,this.concatBuffer=void 0,this.buffer=[],this.flushBuffer=()=>{if(this.flushing)return;this.flushing=!0;let e=0;for(;!this.paused&&e<this.buffer.length;)this.emit("Data",this.buffer[e]),e++;this.buffer.splice(0,e),this.flushing=!1,e>0&&0===this.buffer.length&&this.emit("Drain")},this.on("Resume",this.flushBuffer),this.once("Destroy",()=>{this.destroyed=!0}),this.concatBuffer=e}isClosing(){return this.closing&&!this.destroyed}isClosed(){return this.closed&&!this.destroyed}isDestroyed(){return this.destroyed}asWritable(){return this}asReadable(){return this}write(e){if(this.destroyed)throw new Error("Unexpected write after destroy");if(this.closing)throw new Error("Unexpected write after close");return this.buffer.push(e),this.buffer=this.concatBuffer(this.buffer),this.flushBuffer(),!this.paused&&0===this.buffer.length}async read(){if(this.destroyed)throw new Error("Unexpected read after destroy");return this.closed?Promise.resolve({value:void 0,done:!0}):new Promise((e,t)=>{const r=()=>{t(new Error("Unexpected destroy while read"))},i=()=>{e({value:void 0,done:!0})};this.once("Data",t=>{this.pause(),e({value:t,done:!1}),this.off("Destroy",r),this.off("Close",i)}),this.once("Destroy",r),this.once("Close",i),this.resume()})}pipe(e){this.on("Data",t=>{t&&e.write(t)}),this.once("Close",()=>{e.close()}),this.resume()}pause(){this.paused=!0,this.emit("Pause")}resume(){this.paused=!1,this.emit("Resume")}destroy(){this.buffer=[],super.destroy()}close(){this.closing||(this.closing=!0,this.buffer.length>0?this.once("Drain",()=>{this.closed=!0,this.emit("Close")}):(this.closed=!0,this.emit("Close")))}}var Ct=r(4364),It=r(371),Ot=r(2067);class Dt extends kt.M{static concatChunks(e){return e.length<2?e:"string"===typeof e[0]?[e.join("")]:[bt.P.concat(...e)]}constructor(e){let{start:t,end:r,number:i,isInitSegment:n,trackId:s,bitrate:a,width:o,height:l,originalStart:d}=e;super(),this.trackId=void 0,this.isInitSegment=void 0,this.number=void 0,this.start=0,this.end=0,this.duration=0,this.bitrate=void 0,this.originalStart=void 0,this.width=0,this.height=0,this.expectedSize=void 0,this.loadedRawSize=0,this.getLoadingDuration=()=>null,this.getWaitingDuration=()=>null,this.chunks=[],this.expectedTimeToLoad=Number.MAX_SAFE_INTEGER,this.finishedSegment=!1,this.failedSegment=!1,this.chunkStream=null,this.start=t,this.end=r,this.duration=Math.max(r-t,0),this.number=i,this.bitrate=a,this.expectedSize=a*(this.duration/1e3)/8,this.width=o,this.height=l,this.isInitSegment=n,this.trackId=s,this.originalStart=d,this.loadedRawSize=0}waitingStarted(){this.getWaitingDuration=(0,It.u)()}loadingStarted(){this.getLoadingDuration=(0,It.u)()}get finished(){return this.finishedSegment}get failed(){return this.failedSegment}setExpectedSize(e){isNaN(e)||(this.expectedSize=e)}append(e){var t;this.chunks.push(e),null==(t=this.chunkStream)||t.write(e)}finish(){var e;this.finishedSegment=!0,null==(e=this.chunkStream)||e.close(),this.chunkStream=null,this.emit("Finish")}fail(){this.failedSegment=!0,this.emit("Failed"),this.chunkStream&&this.chunkStream.destroy()}setExpectedTimeToLoad(e){this.expectedTimeToLoad=e}getExpectedTimeToLoad(){if((0,Ot.RW)("yasp_npr_by_segment_info"))return this.expectedTimeToLoad;if(null===this.getLoadingDuration)return this.duration;const e=this.getLoadingDuration();return null===e||0===this.loadedRawSize?this.duration:e*(Math.max(this.expectedSize,this.loadedRawSize)/this.loadedRawSize)-e}getChunkStream(){this.chunkStream||(this.chunkStream=new Pt(Dt.concatChunks));const e=this.chunkStream;return this.chunks.forEach(t=>null==e?void 0:e.write(t)),this.finished&&(0===this.chunks.length&&(0,Ct.L)(new Error("Finished empty segment")),e.close(),this.chunkStream=null),e.asReadable()}getChunks(){return this.chunks}getDebugInfo(){return{chunksCount:this.chunks.length,chunksSize:this.chunks.reduce((e,t)=>e+t.length,0),start:this.start,end:this.end,duration:this.duration,finishedSegment:this.finishedSegment,number:this.number,expectedSize:this.expectedSize,loadingDuration:this.getLoadingDuration?this.getLoadingDuration():null,hasChunkStream:null!==this.chunkStream}}}var Nt=r(7177),Lt=r(8682),xt=r(106),Mt=r(8337),Ft=r(3125);class Vt extends kt.M{constructor(e){let{timeline:t,mediaState:r}=e;super(),this.timeline=void 0,this.mediaState=void 0,this.history=[],this.currentBuffering=null,this.currentTargetLatency=7e3,this.timeline=t,this.mediaState=r,r.on("BufferingChange",e=>{this.setBuffering(e)})}destroy(){super.destroy(),this.mediaState.off("BufferingChange")}notifyTargetLatency(){this.emit("TargetLatencyUpdate",this.currentTargetLatency)}checkIsLiveEdge(){const{currentTime:e}=this.mediaState;if(!e)return!1;const t=1e3*e,r=this.checkForType("audio",t);return this.checkForType("video",t)||r}checkForType(e,t){const{segment:r}=this.timeline.getSegment(e,t);if(!r)return!1;const i=this.timeline.getLastSegmentNumber(e);if(!i)return!1;const n=this.timeline.getMaxSegmentDuration(),s=Math.ceil(7e3/n);return r.number>=i-s}setBuffering(e){if(e){if(this.currentBuffering||!this.checkIsLiveEdge())return;this.currentBuffering={start:Date.now(),getTime:(0,Ft.u)()}}else{var t;if(!this.currentBuffering)return;const e=null==(t=this.currentBuffering)?void 0:t.getTime();this.history.push({start:this.currentBuffering.start,end:this.currentBuffering.start+e,duration:e}),this.currentBuffering=null,this.checkHistory()}}getAverageStalledDuration(){return this.history.reduce((e,t)=>e+t.duration,0)/this.history.length}checkHistory(){const e=Date.now();this.history=this.history.filter(t=>e-t.end<=2e4),this.history.length>=2&&(this.currentTargetLatency=this.currentTargetLatency+this.getAverageStalledDuration(),this.notifyTargetLatency(),this.timeline.setTargetLatency(this.currentTargetLatency),this.history=[])}}const Bt={avc1:["avc3"],avc3:["avc1"]};var Ut=r(3479),jt=r(6702);class Ht extends kt.M{constructor(){super(),this.audio=[],this.text=[],this.video=[],this.bufferedInfoChangedPromise=null,this.selectedVideoTrackHeight=void 0,this.selectedVideoTracks=[],this.selectedAudioLanguage=void 0,this.selectedTextTrack=void 0,this.targetLatency=void 0,this.isFirstUpdateVideoTracks=!0,this.mpd=void 0,this.externalPresentationDelay=void 0;const e=(0,jt.c)(7);this.targetLatency=1e3*e}checkTrackAvailableToLoad(e,t){var r;switch(t){case"text":return(null==(r=this.selectedTextTrack)?void 0:r.id)===e;case"video":return 0===this.selectedVideoTracks.length||this.selectedVideoTracks.some(t=>e===t.id);case"audio":if(!this.selectedAudioLanguage)return!0;const i=this.findTrackById(e,t);return(null==i?void 0:i.language)===this.selectedAudioLanguage;default:return!1}}setVideoTrack(e){const t=this.findTrackById(e,"video"),r=t?t.height:void 0;r!==this.selectedVideoTrackHeight&&(this.selectedVideoTrackHeight=r,this.updateSelectedVideoTracks(),this.emit("VideoTrackChange",t?e:"auto"))}removeVideoTrack(e){const t=this.findTrackById(e,"video");if(!t)return;const r=this.video.indexOf(t);this.video.splice(r,1),t.clear(0,1/0);const{selectedVideoTrackHeight:i}=this;var n;void 0!==i&&t.height===i&&(this.updateSelectedVideoTracks(),0===this.selectedVideoTracks.length&&this.setVideoTrack(null==(n=m(this.video).find(e=>e.height<=i))?void 0:n.id))}updateVideoTracks(e){const t=this.getVideoTracksInfo().filter(e=>{let{id:t}=e;return t!==Lt.A}).map(e=>e.height);e.forEach(e=>{this.obtainTimelineTrack(v({},e,e.segmentTemplate,{bitrate:e.bandwidth,language:"unknown",type:"video"}))});const r=[];this.video.map(e=>{let{id:t}=e;return t}).forEach(t=>{!e.some(e=>e.id===t)&&(this.removeVideoTrack(t),r.push(t))}),this.updateSelectedVideoTracks();const i=[];this.isFirstUpdateVideoTracks&&(this.isFirstUpdateVideoTracks=!1,i.push(this.getAutoVideoTrackInfo())),this.getVideoTracksInfo().filter(e=>{let{id:t}=e;return t!==Lt.A}).forEach(e=>{t.includes(e.height)||i.push({selected:e.height===this.selectedVideoTrackHeight,width:e.width,height:e.height,bitrate:e.bitrate,label:e.label,language:e.language,frameRate:e.frameRate,id:e.id,kind:"main"})}),(i.length||r.length)&&this.emit("VideoTracksChange",{added:i,removed:r})}updateSelectedVideoTracks(){this.selectedVideoTracks=this.selectedVideoTrackHeight?this.video.filter(e=>e.height===this.selectedVideoTrackHeight):m(this.video)}setAudioLanguage(e){const t=this.audio.find(e=>e.language===this.selectedAudioLanguage),r=this.audio.find(t=>t.language===e);if(!r||e===this.selectedAudioLanguage)return;const i=g(t,r);this.selectedAudioLanguage=e,i||this.emit("CodecsChange",r),this.emit("AudioLanguageChange",e)}setTextTrack(e){var t;if(this.selectedTextTrack&&this.selectedTextTrack.clear(0,1/0),null===e)return void(this.selectedTextTrack=void 0);let r=this.text.find(t=>t.language===e.language);r&&(null==r?void 0:r.language)!==(null==(t=this.selectedTextTrack)?void 0:t.language)&&(this.selectedTextTrack=r||this.selectedTextTrack,this.emit("TextTrackChange",this.selectedTextTrack))}getVideoTracksInfo(){return[this.getAutoVideoTrackInfo(),...(e=this.video,(0,xt.z)(e.reduce((e,t)=>(e[t.height]?t.bitrate>e[t.height].bitrate&&(e[t.height]=t):e[t.height]=t,e),{})).sort((e,t)=>t.bitrate-e.bitrate)).map(e=>({selected:e.height===this.selectedVideoTrackHeight,width:e.width,height:e.height,bitrate:e.bitrate,label:e.label,language:e.language,frameRate:e.frameRate,id:e.id,kind:"main"}))];var e}getAutoVideoTrackInfo(){return{id:Lt.A,selected:void 0===this.selectedVideoTrackHeight,kind:"main",language:"unknown",label:""}}getAudioTracksInfo(){const e={};return this.audio.forEach(t=>{const r=t.language;r&&(e[r]?t.bitrate>e[r].bitrate&&(e[r].bitrate=t.bitrate):e[r]={selected:r===this.selectedAudioLanguage,id:t.id,label:t.label||"",language:r,kind:"main",bitrate:t.bitrate,channels:t.channels})}),(0,xt.z)(e)}getTextTracksInfo(){return this.text.map(e=>({id:e.id,language:e.language,label:e.label,kind:e.kind}))}getSegmentsForTracks(e,t){if(null===e)return[];switch(t){case"video":return this.selectedVideoTracks.map(t=>this.getSegmentForTrack(e,t)).filter(Boolean);case"audio":return this.audio.filter(e=>{var t;return e.language===(null!=(t=this.selectedAudioLanguage)?t:e.language)}).map(t=>this.getSegmentForTrack(e,t)).filter(Boolean);case"text":return this.text.filter(e=>{var t,r;return e.label===(null==(t=this.selectedTextTrack)?void 0:t.label)||e.language===(null==(r=this.selectedTextTrack)?void 0:r.language)}).map(t=>this.getSegmentForTrack(e,t)).filter(Boolean);default:return[]}}getSegmentForTrack(e,t){const r=t.getSegment(e);if((0,Ot.RW)("yasp_abr_loading_segment")&&r)return r;if(t.endTime===e+t.presentationTimeOffset)return this.getLastSegment(t);let i=Math.max(Math.floor(0)),n=0;const s=t.segmentSequences.find((r,s)=>{n=s;const a=r.time-t.presentationTimeOffset,o=a+r.duration*r.count,l=a<=e&&e<o;return l||(i+=r.count),l});if(!s)return null;const a=s.time-t.presentationTimeOffset,o=e-a,l=Math.max(0,Math.floor(o/s.duration+1e-4)),d=t.startNumber+(i+l),u=Math.max(a+s.duration*l,0),c=d===s.endNumber,h=t.segmentSequences[n+1],p=Math.max(c&&h?h.time-t.presentationTimeOffset:a+s.duration*(l+1),0),f=t.bitrate,m=s.originalValues.time-s.originalValues.trackPresentationTimeOffset+s.originalValues.duration*l;return new Dt({start:u,end:p,bitrate:f,trackId:t.id,number:d,originalStart:m,isInitSegment:!1,width:"width"in t?t.width:0,height:"height"in t?t.height:0})}clear(e,t){this.audio.forEach(r=>r.clear(e,t)),this.video.forEach(r=>r.clear(e,t)),this.text.forEach(r=>r.clear(e,t))}getDuration(){var e,t;const r=null!=(e=this.video[0])?e:this.audio[0];if(void 0!==r)return null!=(t=this.mpd)&&t.isDynamic?1/0:r.endTime-r.startTime}getMimeTypes(){return{audio:Array.from(new Set(this.audio.map(e=>e.getFullMimeType()))),video:Array.from(new Set(this.video.map(e=>e.getFullMimeType())))}}getBufferedRanges(e){void 0===e&&(e=!1);let t=this.audio,r=this.selectedVideoTracks,i=this.text;return this.selectedAudioLanguage&&(t=t.filter(e=>e.language===this.selectedAudioLanguage)),{audio:t.map(t=>t.getBufferedRanges(e)),video:r.map(t=>t.getBufferedRanges(e)),text:i.map(t=>t.getBufferedRanges(e))}}getSeekableRanges(){return[this.getSeekableRange()]}getSegment(e,t){const r=[];return("video"===e?this.selectedVideoTracks:this.audio.filter(e=>{var t;return e.language===(null!=(t=this.selectedAudioLanguage)?t:e.language)})).forEach(e=>{const i=e.getSegment(t);i&&r.push({track:e,segment:i})}),u(r,e=>{let{track:t}=e;return t.bitrate})||{track:void 0,segment:void 0}}getInitialSegment(e,t){const r=("video"===e?this.video:this.audio).find(e=>{let{id:r}=e;return r===t});return(null==r?void 0:r.getInitSegment())||void 0}obtainTimelineTrack(e){const t=this[e.type];"audio"===e.type&&(this.selectedAudioLanguage=this.selectedAudioLanguage||e.language||void 0);const r=t.find(t=>t.id===e.id);if(r)return r.updateTrack(e),r;const i=(e=>{switch(e.type){case"audio":return new He(e);case"video":return new We(e);case"text":return new wt(e);default:throw new Error("Unexpected TimelineTrack#type="+e.type)}})(e);return t.push(i),i.on("BufferedInfoChanged",()=>this.emitBufferedInfoChanged()),"text"===i.type&&i.on("CuesAdded",e=>{this.emit("CuesAdded",{cues:e,label:i.label})}),i}sortTracksInTimeline(e){void 0===e&&(e=["video","audio","text"]),e.forEach(e=>{this.sortTracksInTimelineByType(e)})}sortTracksInTimelineByType(e){const t=this.getFirstLangsAppearanceInTimeline(e);this[e].sort((e,r)=>e.language===r.language?r.bitrate-e.bitrate:t.get(e.language)-t.get(r.language))}getFirstLangsAppearanceInTimeline(e){const t=new Map;return this[e].forEach((e,r)=>{t.has(e.language)||t.set(e.language,r)}),t}findTrackById(e,t){return this[t].find(t=>t.id===e)}emitBufferedInfoChanged(){var e;this.bufferedInfoChangedPromise=null!=(e=this.bufferedInfoChangedPromise)?e:Promise.resolve().then(()=>this.emit("BufferedInfoChanged",this.getBufferedInfo())).then(()=>{this.bufferedInfoChangedPromise=null})}getBufferedInfo(){const e=this.getBufferedRanges(),t=p(e.video),r=p(e.audio);return{video:t.map(e=>{let{start:t,end:r}=e;return{start:t/1e3,end:r/1e3}}),audio:r.map(e=>{let{start:t,end:r}=e;return{start:t/1e3,end:r/1e3}}),total:f(t,r).map(e=>{let{start:t,end:r}=e;return{start:t/1e3,end:r/1e3}})}}getLastSegment(e){const t=e.segmentSequences[e.segmentSequences.length-1];if(!t)return null;const r=Math.max(0,t.time-e.presentationTimeOffset+t.duration*(t.count-1)),i=Math.max(r+t.duration,0),n=e.bitrate,s=t.originalValues.time-t.originalValues.trackPresentationTimeOffset+t.originalValues.duration*(t.count-1);return new Dt({start:r,end:i,bitrate:n,trackId:e.id,number:e.endNumber,originalStart:s,isInitSegment:!1,width:"width"in e?e.width:0,height:"height"in e?e.height:0})}getDebugInfo(e){var t,r,i;return{audio:this.audio.map(e=>e.getDebugInfo()),video:this.video.map(e=>e.getDebugInfo()),text:this.text.map(e=>e.getDebugInfo()),selectedVideoTracks:this.selectedVideoTracks.map(e=>e.getDebugInfo()),selectedVideoTrackHeight:null!=(t=this.selectedVideoTrackHeight)?t:null,selectedAudioLanguage:null!=(r=this.selectedAudioLanguage)?r:null,selectedTextTrack:null!=(i=this.selectedTextTrack)?i:null,mpd:this.mpd,externalPresentationDelay:this.externalPresentationDelay,isLive:this.getIsDynamic(),isLowLatency:this.isLowLatencyLive(),segmentDebugInfo:void 0!==e?this.getSegmentsDebugInfo(e):void 0}}updateStreamEndTime(){var e;const t=null!=(e=this.video[0])?e:this.audio[0];t.endTime&&this.emit("StreamEndTimeUpdate",t.endTime-t.presentationTimeOffset)}applyMpd(e){var t;this.mpd=v({},e,{presentationDelay:null!=(t=this.externalPresentationDelay)?t:e.presentationDelay}),this.updateStreamEndTime()}getIsDynamic(){var e;return(null==(e=this.mpd)?void 0:e.isDynamic)||!1}isLowLatencyLive(){var e;return this.getIsDynamic()&&0!==(null==(e=this.mpd)?void 0:e.availabilityTimeOffset)}getLiveEdge(){var e;if(null==(e=this.mpd)||!e.isDynamic)return this.getDuration()||0;if(null===this.mpd.presentationStartTime)throw new Error("Cannot compute live edge without presentationStartTime");return Date.now()+this.mpd.clockOffset-this.mpd.maxSegmentDuration-this.mpd.presentationStartTime}getMaxSegmentDuration(){var e;return(null==(e=this.mpd)?void 0:e.maxSegmentDuration)||5e3}getSeekableRange(){return{start:this.getSeekRangeStart(),end:this.getSeekRangeEnd()}}getSeekRangeStart(){var e;if(null==(e=this.mpd)||!e.isDynamic)return 0;const t=!isFinite(this.mpd.segmentAvailabilityDuration),r=t?this.mpd.minSegmentStartTime-this.mpd.publishTime:this.mpd.presentationStartTime?this.mpd.minSegmentStartTime-this.mpd.presentationStartTime:this.mpd.minSegmentStartTime;if(t)return Math.max(0,r);const i=this.getLiveEdge()+this.mpd.availabilityTimeOffset-this.mpd.segmentAvailabilityDuration,n=Math.min(i,this.getSeekRangeEnd());return Math.max(r,n)}getSeekRangeEnd(){var e;if(null==(e=this.mpd)||!e.isDynamic)return this.getDuration()||0;const t=this.isLowLatencyLive()?0:this.mpd.presentationDelay,r=this.getLiveEdge()+this.mpd.availabilityTimeOffset-t;if(!this.isLowLatencyLive())return Math.max(0,r);const i=r+this.mpd.presentationStartTime,n=Date.now()+this.mpd.clockOffset,s=Math.min(i,n-this.targetLatency);return Math.max(s-this.mpd.presentationStartTime,0)}getUtcStartTime(){var e,t,r;return null!=(e=this.mpd)&&e.isDynamic?this.mpd.isDynamic&&!isFinite(this.mpd.segmentAvailabilityDuration)?this.mpd.publishTime:0:null!=(t=null==(r=this.mpd)?void 0:r.publishTime)?t:0}setPresentationDelay(e){var t;this.externalPresentationDelay=null!=(t=this.externalPresentationDelay)?t:e}getEmsgSchemeIdUris(){var e;return null==(e=this.mpd)?void 0:e.emsgSchemeIdUris}getLastSegmentNumber(e){const t=this[e][0];return t?t.endNumber:null}setTargetLatency(e){this.targetLatency=e}getSegmentsDebugInfo(e){return{audio:this.getSegmentsDebugInfoByType("audio",e),video:this.getSegmentsDebugInfoByType("video",e)}}getSegmentsDebugInfoByType(e,t){return this[e].reduce((e,r)=>((0,Ut.J)(r.getSegmentsDebugInfo(t)).forEach(t=>{let[r,i]=t;e[r]+=i}),e),{playedRawSize:0,playedSegmentCount:0,activeRawSize:0,activeSegmentCount:0})}getTotalRawSizeByType(e){return this[e].reduce((e,t)=>{const{playedRawSize:r,activeRawSize:i}=t.getSegmentsDebugInfo(0);return e+r+i},0)}getTotalRawSize(){return this.getTotalRawSizeByType("audio")+this.getTotalRawSizeByType("video")}destroy(){super.destroy(),["audio","video","text"].forEach(e=>{this[e].forEach(e=>e.destroy())}),this.audio=[],this.video=[],this.text=[]}}var Wt=r(7922);const qt=(new Map).set("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",Wt.ly).set("urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95",Wt.xE).set("urn:uuid:79f0049a-4098-8642-ab92-e65be0885f95",Wt.xE).set("urn:uuid:e2719d58-a985-b3c9-781a-b030af78d30e",Wt.dn).set("urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b",Wt.dn),Yt=(e,t)=>({keySystem:e,licenseServerUri:"",distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:null!=t?t:[]});class Gt{constructor(e){this.parser=e}parse(e){let t=this.parseElements(e),r=null,i=[],n=[];const s=new Set(t.map(e=>e.keyId).filter(e=>null!==e));if(s.size>1)throw new gt.w({code:"YASP_DASH_CONFLICTING_KEY_IDS",isFatal:!0,message:"Dash manifest has conflicting ids: "+Array.from(s).join(","),details:{},category:vt.q.DRM});n=t.filter((function(e){return"urn:mpeg:dash:mp4protection:2011"!==e.schemeUri||(r=e.init||r,!1)}));const a=Array.from(s)[0]||null;return n.length&&(i=this.convertElements(r,n,a)),{defaultKeyId:a,defaultInit:r,drmInfos:i}}convertElements(e,t,r){const i=[];for(const n of t){const t=qt.get(n.schemeUri);if(t){const s=this.getInitDataFromPro(n);let a=null;"urn:uuid:e2719d58-a985-b3c9-781a-b030af78d30e"!==n.schemeUri&&"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b"!==n.schemeUri||(a=this.getClearKeyInitData(n,r));const o=s||a||n.init||e,l=Yt(t,o);i.push(l)}}return i}parseElements(e){const t=[];for(const r of e){const e=this.parseElement(r);e&&t.push(e)}return t}getInitDataFromPro(e){const t=this.parser.findChildNS(e.node,"urn:microsoft:playready","pro");if(!t)return null;const r=this.parser.getContents(t);if(!r)return null;const i=bt.P.fromBase64(r),n=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),s=e.keyId,a=this.createPssh(i,n,s?[s]:[],0);return a?[{initData:a,initDataType:"cenc",keyId:s}]:null}createPssh(e,t,r,i){const n=new Set(r),s=e.length;let a=12+t.length+4+s;i>0&&(a+=20);const o=new ArrayBuffer(a),l=new Uint8Array(o),d=new DataView(o);let u=0;if(d.setUint32(u,a),u+=4,d.setUint32(u,1886614376),u+=4,i<1?d.setUint32(u,0):d.setUint32(u,16777216),u+=4,l.set(t,u),u+=t.length,i>0){d.setUint32(u,n.size),u+=4;for(const e of n){const t=bt.P.fromHex(e);l.set(t,u),u+=t.length}}return d.setUint32(u,s),u+=4,l.set(e,u),u+=s,u===a?bt.P.toBase64(l):null}parseElement(e){let t=e.attributes.schemeIdUri,r=this.parser.getAttributeNS(e,"urn:mpeg:cenc:2013","default_KID");const i=this.parser.findChildrenNS(e,"urn:mpeg:cenc:2013","pssh").map(e=>this.parser.getContents(e));if(!t)return null;if(t=t.toLowerCase(),r&&(r=r.replace(/-/g,"").toLowerCase(),r.includes(" ")))throw new gt.w({code:"YASP_DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED",isFatal:!0,message:"Representation with multiple keyIds is not supported: ("+r+")",details:{},category:vt.q.DRM});const n=i.map(e=>({initDataType:"cenc",initData:e,keyId:null}));return{node:e,schemeUri:t,keyId:r,init:n.length>0?n:null}}getKeyIdsForClearKey(e){if(!e)return[];const t=bt.P.fromBase64(e),r=new DataView(t.buffer),i=r.byteOffset,n=r.byteLength;let s=0;const a=r.getUint32(s);s+=4;const o=r.getUint32(s);if(s+=4,n<a)return[];if(1886614376!==o)return[];const l=r.getUint32(s)>>>24;if(s+=4,0!==l&&1!==l)return[];const d=r.buffer;s+=16;const u=r.getUint32(s);s+=4;if(!u||n<i+s+32*u)return[];const c=[];for(let h=0;h<u;h++){const e=new Uint8Array(d,i+s+32*h,32);c.push(qe.x.fromBytesAutoDetect(e))}return c}getClearKeyInitData(e,t){var r;const i=null==(r=e.init)?void 0:r[0].initData,n=t||this.getKeyIdsForClearKey(i)[0]||e.keyId;if(!n)return null;const s=new Uint8Array([16,119,239,236,192,178,77,2,172,227,60,30,82,226,251,75]),a=new Uint8Array([]);return[{initData:this.createPssh(a,s,[n],1),initDataType:"cenc",keyId:n}]}}const Kt=["segmentTemplate","mimeType"],zt=["segmentTemplate","mimeType"],Zt=["segmentTemplate","mimeType"],Xt=["urn:mpeg:dash:utc:direct:2014","urn:mpeg:dash:utc:direct:2012"],Qt=[...Xt];var Jt=r(4651),$t=r(5176);class er{constructor(e,t){this.body=void 0,this.status=void 0,this.headers=void 0,this.textPromise=void 0,this.body=t,this.status=e.status,this.headers=function(e){const t=[];return e.getAllResponseHeaders().trim().split("\r\n").forEach(e=>{const[r,...i]=e.split(":");t.push([i.join(":"),r])}),{forEach(e){t.forEach(t=>{let[r,i]=t;e(r,i)})}}}(e),this.textPromise=new Promise((t,r)=>{e.addEventListener("load",()=>{t(e.response)}),e.addEventListener("abort",()=>{const e=new Error("Stretch request aborted");e.name="AbortError",r(e)})}),(0,$t.v)(this.textPromise)}text(){return this.textPromise}}const tr={done:!0,value:void 0};class rr{constructor(e){this.dataStream=void 0,this.readRequest=void 0,this.storedError=void 0,this.onCancel=void 0,this.dataStream=new Pt,this.readRequest=null,this.storedError=null,this.onCancel=e}read(){return new Promise((e,t)=>(this.readRequest={resolve:e,reject:t},this.dataStream.isDestroyed()?t(this.storedError||new Error("Unexpected read after stream destroy")):this.dataStream.isClosed()?e(tr):(this.dataStream.once("Data",t=>{this.dataStream.pause(),e({done:!1,value:t})}),void this.dataStream.resume())))}cancel(){this.dataStream.destroy(),this.onCancel()}throw(e){this.dataStream.isDestroyed()||this.dataStream.isClosing()||(this.storedError=e,this.dataStream.destroy(),this.readRequest&&(this.readRequest.reject(e),this.readRequest=null))}write(e){this.dataStream.isDestroyed()||this.dataStream.write(e)}close(){this.dataStream.close()}}var ir=r(1729);const nr="undefined"!==typeof fetch&&"undefined"!==typeof ReadableStream&&"undefined"!==typeof(0,ir.Y)(()=>new AbortController),sr=nr?"arraybuffer":j("moz-chunked-arraybuffer")||j("ms-stream")||"arraybuffer";class ar{constructor(e){this.readerInited=!1,this.reader=void 0,this.xhr=void 0,this.xhr=e,this.reader=new rr(()=>e.abort())}throwReaderError(e){return this.reader.throw(e)}getReader(){return this.initReader(this.xhr,sr),this.reader}initReader(e,t){if(this.readerInited)throw new Error("Unexpected second call StretchBody#initReader()");switch(this.readerInited=!0,e.responseType=t,t){case"arraybuffer":e.addEventListener("load",()=>{e.response&&this.reader.write(new Uint8Array(e.response)),this.reader.close()});break;case"moz-chunked-arraybuffer":e.addEventListener("progress",()=>{this.reader.write(new Uint8Array(e.response))}),e.addEventListener("load",()=>{this.reader.close()});break;case"ms-stream":e.addEventListener("readystatechange",()=>{if(e.readyState!==XMLHttpRequest.LOADING)return;let t=0;const{MSStreamReader:r}=self,i=new r;i.onprogress=()=>{i.result.byteLength>t&&(this.reader.write(new Uint8Array(i.result,t)),t=i.result.byteLength)},i.onload=this.reader.close.bind(this.reader),i.readAsArrayBuffer(e.response)})}}}const or=nr?fetch:function(e,t){return void 0===t&&(t={}),new Promise((r,i)=>{const{method:n="GET",body:s=null}=t,a=new XMLHttpRequest;a.open(n,e);for(const e in t.headers)t.headers.hasOwnProperty(e)&&a.setRequestHeader(e,t.headers[e]);"include"===t.credentials&&(a.withCredentials=!0);const o=new ar(a),l=()=>{a.readyState===XMLHttpRequest.HEADERS_RECEIVED&&(a.removeEventListener("readystatechange",l),r(new er(a,o)))};a.addEventListener("readystatechange",l);const d=()=>{a.abort();const e=new Error("request aborted");e.name="AbortError",o.throwReaderError(e),i(e)};if(t.signal){if(t.signal.aborted)return void d();t.signal.addEventListener("abort",d)}a.addEventListener("error",()=>{const e=new Error("network error");o.throwReaderError(e),i(e)}),a.send(s)})};var lr=r(7320),dr=r(3487),ur=r(3697);const cr=["SupplementalProperty","S","AudioChannelConfiguration","Role"],hr=e=>{if(!e)return;const t=(new URL(e).pathname.split("/").pop()||"").split(".");return t.length>1?t.pop():void 0},pr=(e,t)=>e+"/"+new URL(t).pathname.split("/").pop(),fr=()=>navigator.storage.getDirectory(),mr={downloadedFragments:{},createFileWritableStream:async e=>{const t=await q(e,!0),r=await t.createWritable();return mr.downloadedFragments[e]=!0,r},fetchFromFs:async(e,t)=>{if(!e)throw new Error("Store path is not defined");const r=hr(t),{body:i,size:n}=await Y(pr(e,t));return W("mpd"===r?i:i.stream(),{size:n})},getParsedJSON:async e=>{const{body:t}=await Y(e),r=await t.text();return JSON.parse(r)},removeDirectory:async e=>{const t=await fr();return(await t.getDirectoryHandle("streams")).removeEntry(e,{recursive:!0})}},gr=(e,t,r)=>{t&&(mr.createFileWritableStream(e+"/manifest.mpd").then(e=>{e.write(function(e,t){void 0===t&&(t=cr);const r=['<?xml version="1.0" encoding="UTF-8"?>'];return function e(i,n){if(void 0===n&&(n=0),null==i||!i.tagName)return;let s="".padStart(4*n,"    ");const a=-1!==t.indexOf(i.tagName);s+="<"+i.tagName;const o=i.attributes&&Object.entries(i.attributes).map(e=>{let[t,r]=e;return" "+t+'="'+r+'"'}).join("");if(o&&(s+=""+o),a)return s+="/>",void r.push(s);s+=">",r.push(s),Array.isArray(i.children)&&1===i.children.length&&"string"===typeof i.children[0]?r.push("".padStart(4*(n+1),"    ")+i.children[0]):i.children.forEach(t=>{e(t,n+1)}),s="".padStart(4*n,"    "),s+="</"+i.tagName+">",r.push(s)}(e),r.push(""),r.join("\n")}(r?function(e,t){e.children=[{tagName:"BaseURL",attributes:{},children:["fs://streams/"]},...e.children.filter(e=>"BaseURL"!==e.tagName)];const r=e.children.find(e=>"Period"===e.tagName);if(t.videoTrackId){const e=null==r?void 0:r.children.find(e=>"video/mp4"===e.attributes.mimeType);e&&(e.children=e.children.filter(e=>"SupplementalProperty"===e.tagName||e.attributes.id===t.videoTrackId))}return t.audioLang&&r&&(r.children=r.children.filter(e=>"audio/mp4"!==e.attributes.mimeType||e.attributes.lang===t.audioLang)),t.textTrack&&r&&(r.children=r.children.filter(e=>{var r;return"text/vtt"!==e.attributes.mimeType||e.attributes.lang===(null==t||null==(r=t.textTrack)?void 0:r.language)})),e}(t,r):t)).then(()=>e.close())}),r&&mr.createFileWritableStream(e+"/config.json").then(e=>{null==e||e.write(JSON.stringify({tracks:r})).then(()=>e.close())}))},vr=async e=>{const t=e+"/config.json",r=H({},await mr.getParsedJSON(t),{downloadedFragments:mr.downloadedFragments});mr.createFileWritableStream(t).then(e=>{null==e||e.write(JSON.stringify(r)).then(()=>e.close())})};var yr=r(9223);class Sr extends kt.M{setIsLL(e){this.lowLatency=e}isLL(){return this.lowLatency}setBaseParams(e){void 0===e&&(e={}),this.baseParams=e}constructor(e){void 0===e&&(e={}),super(),this.baseParams=void 0,this.storePath=void 0,this.lowLatency=!1,this.baseParams=e,e.storePath&&(this.storePath=e.storePath)}performRequest(e,t){const r=new lr.H,i=G({},this.baseParams,t,{headers:G({},this.baseParams.headers,t.headers),signal:r.signal}),n={canceled:!1,timeout:!1,downloadedBytes:0},s=(0,It.u)();if(mr.downloadedFragments[pr(this.storePath,e)])return function(e,t,r,i){const n=new Promise(e=>{setTimeout(()=>{e({value:void 0,done:!0})},0)}),s={getReader:()=>({read:()=>n})};return{abort:e,responsePromise:Promise.resolve(W(s)),timeoutId:void 0,requestState:t,signal:r,getRtt:i,isSkipFragment:!0}}(r.abort,n,i.signal,s);const a=("fs:"===(0,yr.en)(e).protocol?mr.fetchFromFs(this.storePath,e):or(e,i)).catch(e=>{if(n.canceled)throw new Error("Request canceled");if(n.timeout)throw new Error("Request timed out");throw e}),o="number"===typeof i.timeout?setTimeout(()=>{n.timeout=!0,r.abort()},i.timeout):void 0;return a.then(e=>{const t={};e.headers.forEach((e,r)=>{t[r]=e}),this.emit("RequestTtfb",s())}).catch(dr.Z),{abort:()=>{n.canceled=!0,o&&clearTimeout(o),r.abort()},responsePromise:a,timeoutId:o,requestState:n,signal:i.signal,getRtt:s,isSkipFragment:!1}}parseServerTime(e,t){if(!e.date&&!e["x-server-time-ms"])return;let r=NaN;if(e["x-server-time-ms"]){r=new Date(parseInt(e["x-server-time-ms"],10)).getTime()}else if(e.date){r=new Date(e.date).getTime()}isFinite(r)&&this.emit("ServerTimeChange",r+t/2)}fetch(e,t){void 0===t&&(t={});const{abort:r,responsePromise:i,timeoutId:n,getRtt:s}=this.performRequest(e,t);return{abort:r,response:i.then(e=>{n&&clearTimeout(n);const t={};return e.headers.forEach((e,r)=>{t[r]=e}),this.parseServerTime(t,s()),{status:e.status,headers:t,body:e.text()}})}}progress(e,t,r){this.emit("Progress",{time:e,size:t,isLowLatency:r})}fetchDataStream(e,t){void 0===t&&(t={});const{abort:r,responsePromise:i,timeoutId:n,requestState:s,signal:a,isSkipFragment:o}=this.performRequest(e,t),l=new Pt,d=o||"fs:"===(0,yr.en)(e).protocol?void 0:this.storePath;let u=d?mr.createFileWritableStream(pr(d,e)):void 0;l.once("Close",()=>{var e;null==(e=u)||e.then(e=>e.close()),u=void 0}),l.once("Destroy",()=>{var e;null==(e=u)||e.then(e=>e.close()),u=void 0}),a.addEventListener("abort",()=>{l.destroy()});let c=!1;const h=()=>{c=!0,r(),l.destroy()};let p;return(0,Ot.RW)("yasp_enable_new_timeout")&&(p=setTimeout(()=>{s.timeout=!0,r()},Math.max((0,Ot.jS)("yasp_headers_timeout"),t.timeout||0))),{requestState:s,abort:h,response:i.then(t=>{let i;clearTimeout(p);const a=()=>{(0,Ot.RW)("yasp_enable_new_timeout")&&(clearTimeout(i),l.isClosed()||l.isClosing()||l.isDestroyed()||(i=setTimeout(()=>{s.timeout=!0,r()},(0,Ot.jS)("yasp_body_timeout"))))};a();const o={};this.on("Destroy",h),t.headers.forEach((e,t)=>{o[t]=e});const f=t.body.getReader(),m=(0,ur.I)(()=>{this.off("Destroy",h),this.emit("ResponseEnd")});l.once("Destroy",m),l.once("Close",m),this.emit("ResponseStart");const g=()=>{c||f.read().then(t=>{let{done:r,value:i}=t;if(a(),!c){var o;if(void 0!==i)if(s.downloadedBytes+=i.length,d&&"fs:"!==(0,yr.en)(e).protocol)null==(o=u)||o.then(e=>e.write(i));else l.write(i);r?(l.close(),n&&clearTimeout(n)):g()}}).catch(e=>{if("AbortError"!==(null==e?void 0:e.name)&&l.destroy(),"AbortError"!==(null==e?void 0:e.name)&&"network error"!==(null==e?void 0:e.message))throw e})};return g(),{status:t.status,headers:o,body:l}})}}getDebugInfo(){return{baseParams:this.baseParams}}}var Er=r(3480),br=r(442),Ar=r(3564),Tr=r(9117),_r=r(5052);class wr extends kt.M{parse(e){return this.parser.parse(e)}isInitiallyLoaded(){return null!==this.mpd}setSourceIndex(e){if(null===e)return;const t=new URL(this.url);t.searchParams.set("source_index",e),this.url=t.href}constructor(e){super(),this.url=void 0,this.fetcher=void 0,this.timeline=void 0,this.parser=void 0,this.mpd=null,this.xml="",this.session="",this.attempt=0,this.baseUrls=[],this.drmInfos=[],this.playlistCapHeight=null,this.lastUpdateDuration=0,this.aborted=!1,this.abortFn=null,this.url=e.url,this.timeline=e.timeline,this.parser=new ft,this.fetcher=new Sr(e.fetcherParams),this.fetcher.on("ServerTimeChange",e=>{this.emit("ServerTimeChange",e)})}getMpdXml(){return this.parse(this.xml)[1]}getPlaylistCapHeight(){return this.playlistCapHeight}isDynamicPlaylist(){var e;return(null==(e=this.mpd)?void 0:e.isDynamic)||!1}getVideoType(){if(this.mpd)return this.mpd.isDynamic?this.mpd.videoType:Jt.Z.VOD}getUpdatePeriod(){var e;return(null==(e=this.mpd)?void 0:e.updatePeriod)||null}getLastUpdateDuration(){return this.lastUpdateDuration}setFetcherBaseParams(e){this.fetcher.setBaseParams(e)}apply(e){this.xml=e;const t=this.parse(e);let r;try{r=U(t,this.url,this.parser)}catch(n){throw ne(n)&&"YASP_PARSE_MANIFEST_ERROR"===n.code&&(n.details.manifest=e),n}this.playlistCapHeight=r.maxHeight,this.baseUrls=r.baseUrls;const i=r.periods[0];return i.adaptationSets=ie(i.adaptationSets),this.checkTracksLengthDifference(i.adaptationSets),this.checkDrm(i.adaptationSets),Z(i,this.timeline),this.timeline.applyMpd(r),r}checkDrm(e){const t=e.find(e=>e.encrypted);t&&(this.drmInfos=t.contentProtection.drmInfos,this.mpd||this.emit("DrmInfoReceived",t.contentProtection.drmInfos))}getBaseUrls(){return this.baseUrls}getDrmInfos(){return this.drmInfos}getEmsgSchemeIdUris(){var e;return null==(e=this.mpd)?void 0:e.emsgSchemeIdUris}async update(){this.aborted=!1;const e=this.session?function(e){const t=new URL(e);return t.searchParams.delete(Ar.j),t.href}(this.url):(0,Ar.c)(this.url),t=(0,Ft.u)();try{const r={};this.session&&(r["x-strm-session"]=this.session,r["x-client-timestamp"]=String(Date.now()));const{response:i,abort:n}=this.fetcher.fetch(e,{timeout:br.d4,headers:r});this.abortFn=n;const{body:s,status:a,headers:o}=await i;this.session=o["x-strm-session"];if(!(a>=200&&a<300||304===a)){const t=this.attempt>=10;throw 0===a?new gt.w({code:"YASP_FETCH_MANIFEST_HTTP_ERROR",message:"Network Error",details:{url:e},category:vt.q.NETWORK_MEDIA,isFatal:t}):new gt.w({code:"YASP_FETCH_MANIFEST_BAD_HTTP_STATUS",message:"Error: "+a,details:{status:a,url:e},isFatal:t,category:vt.q.NETWORK_MEDIA})}this.attempt=0;const l=await s;this.abortFn=null,this.mpd=this.apply(l),this.updateManifestUrl(),this.lastUpdateDuration=t(),this.emit("ManifestUpdate")}catch(r){let t;const i=this.attempt>=10;if(this.abortFn=null,(0,Tr.V)(r)){if("Request canceled"===r.message||"Abort error"===r.message)return;t=ne(r)?r:new gt.w({code:"Request timed out"===r.message?"YASP_FETCH_MANIFEST_TIMEOUT":"YASP_FETCH_MANIFEST_HTTP_ERROR",details:{url:e},message:r.message,isFatal:i,category:"Request timed out"===r.message?vt.q.NETWORK_TIMEOUT:vt.q.NETWORK_MEDIA})}else t=new gt.w({code:"YASP_UNKNOWN_ERROR",details:{url:e,error:r},message:"Unknown error. Expect error to be an instance of Error.",isFatal:i,category:vt.q.NETWORK_MEDIA});if(this.emit("Error",t),i||t.isFatal)return;const n=(0,_r._)(K(this.attempt++));if(this.aborted)return;return n.then(()=>{if(!this.aborted)return this.update()})}}abort(){this.abortFn&&this.abortFn(),this.aborted=!0}destroy(){this.abort(),super.destroy()}getDebugInfo(){return{url:this.url,xml:this.xml,attempt:this.attempt,baseUrls:this.baseUrls,mpd:this.mpd,playlistCapHeight:this.playlistCapHeight,lastUpdateDuration:this.lastUpdateDuration}}checkTracksLengthDifference(e){if(!e.length)return;const t=new Set,r={};if(e.forEach(e=>{"text"!==e.type&&e.representations.forEach(e=>{r[e.id]=e.segmentTemplate.endTime,t.add(e.segmentTemplate.endTime)})}),1===t.size)return;const i=new gt.w({code:"YASP_DIFFERENT_TRACKS_LENGTH",details:r,message:"Different track lengths detected",isFatal:!1,category:vt.q.MEDIA});this.emit("Error",i)}updateManifestUrl(){var e,t;this.url=null!=(e=null==(t=this.mpd)?void 0:t.locationUrl)?e:this.url}}var kr=r(55);class Rr{constructor(e){this.manifesto=e,this.processing=!1,this.promise=null,this.timer=0}async update(){if(this.processing)return this.promise;if(!this.shouldUpdate())return;this.processing=!0;return this.promise=this.manifesto.update().then(()=>{if(!this.processing)return;this.processing=!1;const e=this.getUpdatePeriod();e&&(this.timer=self.setTimeout(()=>{this.timer=0,this.update()},e))}).catch(kr.Z).then(()=>{this.promise=null}),this.promise}forceUpdate(){this.disableTimer(),this.update()}disable(){this.processing=!1,this.disableTimer(),this.manifesto.abort()}getDebugInfo(){return{processing:this.processing}}disableTimer(){self.clearTimeout(this.timer),this.timer=0}shouldUpdate(){return!this.timer&&(!this.manifesto.isInitiallyLoaded()||this.manifesto.isDynamicPlaylist())}getUpdatePeriod(){if(!this.manifesto.isDynamicPlaylist())return;const e=this.manifesto.getUpdatePeriod(),t=this.manifesto.getLastUpdateDuration();return e?Math.max(3e3,e-t):void 0}}const Pr=(0,ur.I)(()=>55),Cr=(0,ur.I)(()=>Pr()+10);var Ir=r(5636);const Or={type:"video",state:"idle",fat:!1,currentTrack:void 0,time:null,previousBufferingTime:null,nextTimeToSet:null,streamIsFinished:!1,lastTrackTimeOffset:null},Dr=["Unexpected read after destroy","Unexpected destroy while read"];class Nr extends kt.M{abort(){["video","audio"].forEach(e=>{this.abortForType(e)})}abortForType(e){var t,r;this.destroyed||(null==(t=(r=this.abortCallbacks)[e])||t.call(r),this.resetTime(e))}constructor(e,t,r,i){var n,s,a;super(),this.timeline=e,this.mediaState=t,this.mse=r,this.destroyed=!1,this.bufferGoal=void 0,this.totalBufferSoftCap=void 0,this.totalBufferHardCap=void 0,this.streams={},this.abortCallbacks={video:null,audio:null},this.bufferGoal=null!=(n=null==i?void 0:i.bufferGoal)?n:30,this.totalBufferSoftCap=null!=(s=null==i?void 0:i.totalBufferSoftCap)?s:Pr(),this.totalBufferHardCap=null!=(a=null==i?void 0:i.totalBufferHardCap)?a:Cr();const{video:o,audio:l}=e.getMimeTypes();o.length>0&&(this.streams.video=ae({},Or,{type:"video"})),l.length>0&&(this.streams.audio=ae({},Or,{type:"audio"})),this.mse.on("Open",()=>this.run())}destroy(){this.destroyed=!0}run(){this.destroyed||["audio","video"].some(e=>{var t;return"appending"===(null==(t=this.streams[e])?void 0:t.state)})||(this.streams.video&&this.runForStream(this.streams.video),this.streams.audio&&this.runForStream(this.streams.audio))}abortUseless(){if(this.destroyed)return;const{currentTime:e}=this.mediaState;"open"!==this.mse.getReadyState()||this.mse.isReloading()||null!==e&&["video","audio"].forEach(t=>{const r=this.streams[t];if(void 0===r)return;const i=this.mse.getSourceBufferBufferedRange(t);if(void 0===i)return;!i.some(t=>t.start<=e&&e<=t.end)&&this.abortForType(r.type)})}createAbortPromise(e){const t=new Ir.B;return this.abortCallbacks[e]=()=>{t.reject(this.createAbortError())},t.promise}createAbortError(){return new gt.w({code:"YASP_OPERATION_ABORTED",details:{},isFatal:!1,category:vt.q.EXCEPTION,message:"AppendStream operation aborted"})}resetTime(e){const t=this.streams[e];if(!t)return;const{currentTime:r}=this.mediaState;"appending"===t.state?t.nextTimeToSet=null===r?null:1e3*r:t.time=null===r?null:1e3*r}reset(){(0,xt.z)(this.streams).forEach(e=>{e&&(this.resetTime(e.type),e.currentTrack=void 0,e.lastTrackTimeOffset=null)})}runForStream(e){if("open"!==this.mse.getReadyState()||this.mse.isReloading()||"appending"===e.state)return;const{currentTime:t,buffering:r,duration:i}=this.mediaState;if(null===t)return;const n=this.mse.getSourceBufferBufferedRange(e.type);if(void 0===n)return;if(r)e.previousBufferingTime!==1e3*t&&(e.time=1e3*t,e.nextTimeToSet=null,e.previousBufferingTime=e.time);else{if(e.previousBufferingTime=null,Math.min(this.bufferGoal,i-t)<=se(n,t))return;if(this.checkGorgedBuffer(e,n))return}const{track:s,segment:a}=this.timeline.getSegment(e.type,e.time);if(void 0===s)return;const{id:o}=s;this.handleTrackPresentationTimeOffset(e,s),o===e.currentTrack?void 0!==a&&(e.nextTimeToSet=a.end,this.appendStream(e,a.getChunkStream()).then(()=>{e.time=e.nextTimeToSet,e.streamIsFinished=s.endNumber===a.number&&!this.timeline.getIsDynamic(),(0,xt.z)(this.streams).every(e=>Boolean(null==e?void 0:e.streamIsFinished))&&this.mse.endOfStream()}).catch(t=>{if("YASP_OPERATION_ABORTED"!==t.code)"YASP_QUOTA_EXCEEDED_ERROR"===t.code?(0,Ot.RW)("yasp_decrease_mse_buffer_on_quota_exceeded_error")&&this.emit("QuotaExceededError"):this.emit("Error",t);else{const{currentTime:t}=this.mediaState;e.time=null===t?null:1e3*t}})):this.appendInitialSegment(e,o).catch(t=>{const r=ne(t)?t:new gt.w({code:"YASP_UNKNOWN_ERROR",details:{error:t},isFatal:!1,category:vt.q.MEDIA,message:"Can not append initial Segment"});if("YASP_OPERATION_ABORTED"!==r.code)this.emit("Error",r);else{const{currentTime:t}=this.mediaState;e.time=null===t?null:1e3*t}}).then(()=>{})}handleTrackPresentationTimeOffset(e,t){const{presentationTimeOffset:r}=t,{lastTrackTimeOffset:i,type:n}=e;i!==r&&this.mse.setTimestampOffset(n,r/1e3).then(()=>{e.lastTrackTimeOffset=r}).catch(e=>{this.destroyed||(0,Ct.L)(e)})}setBufferGoal(e){this.bufferGoal=e}checkGorgedBuffer(e,t){const r=function(e){let t=0;for(let r=0;r<e.length;r++){const{start:i,end:n}=e[r];t+=n-i}return t}(t),i=e.fat;return e.fat=r>=this.totalBufferSoftCap,!!e.fat&&(i||this.emit("FatBuffer",e.type),r>=this.totalBufferHardCap&&(this.emit("GorgedBuffer",e.type),!0))}async appendInitialSegment(e,t){const r=this.timeline.getInitialSegment(e.type,t);if(void 0===r)return;const i=r.getChunkStream();await this.appendStream(e,i),e.currentTrack=t,this.run()}async appendChunk(e,t){try{await this.mse.appendBuffer(e.type,t)}catch(r){throw ne(r)?r:new gt.w({code:"YASP_UNKNOWN_ERROR",details:{error:r},isFatal:!1,category:vt.q.MEDIA,message:(0,Le.K)(r)?r.message:"Can not append buffer"})}}async appendStream(e,t){e.state="appending",e.streamIsFinished=!1;const r=this.createAbortPromise(e.type);try{let{value:i,done:n}=await Promise.race([t.read(),r]);for(;!n;){if(this.destroyed)return;if(i&&await Promise.race([this.appendChunk(e,i),r]),this.destroyed)return;({value:i,done:n}=await Promise.race([t.read(),r]))}}catch(i){throw(0,Le.K)(i)&&(Dr.includes(i.message)||this.mse.isReloading())?this.createAbortError():ne(i)?i:new gt.w({code:"YASP_UNKNOWN_ERROR",details:{error:i},isFatal:!1,category:vt.q.MEDIA,message:"Can not append buffer"})}finally{this.abortCallbacks[e.type]=null,e.state="idle"}}getDebugInfo(){return{bufferGoal:this.bufferGoal,totalBufferSoftCap:this.totalBufferSoftCap,totalBufferHardCap:this.totalBufferHardCap,streams:this.streams}}}var Lr=r(2248),xr=r(9761),Mr=r(7668);class Fr extends kt.M{constructor(){super(),this.blacklist=new Set,this.destroyed=!1,this.checkLoopTimeoutId=void 0,this.startLoop(),this.once("Destroy",()=>{this.destroyed=!0})}destroy(){this.stopLoop(),super.destroy()}getBlacklist(){return Array.from(this.blacklist)}addHostname(e){const t=new URL(e).host;Lr.T.indexOf(t)>-1||this.blacklist.has(e)||this.blacklist.add(e)}isBlacklisted(e){return this.blacklist.has(e)}async checkBlacklistedHosts(){await Promise.all(Array.from(this.blacklist).map(async e=>{try{await async function(e){await(0,Mr.W)({method:"GET",url:e,withCredentials:!1,timeout:2e3})}(function(e){const t=new URL(e).host,{lid:r}=function(e){const t={},r=e.split("?")[0];return r?(r.split("/").forEach(e=>{e.startsWith("ysign")&&e.split(",").forEach(e=>{const r=e.indexOf("=");-1!==r&&(t[e.slice(0,r)]=e.slice(r+1))})}),t):t}(e),i=r?"&lid="+r:"";return"https://"+t+"/ping?r="+(0,xr.a)(12)+i}(e)),this.blacklist.delete(e)}catch(t){}}))}startLoop(){this.destroyed||(this.checkLoopTimeoutId=setTimeout(async()=>{this.stopLoop(),await this.checkBlacklistedHosts(),this.startLoop()},3e4))}stopLoop(){clearTimeout(this.checkLoopTimeoutId)}}var Vr=r(1652),Br=r(8834),Ur=r(4204);var jr=r(123),Hr=r(6223),Wr=r(5776);const qr=(0,Wr.y)(self)||(0,Hr.V)(self),Yr=qr?1e4:5e3,Gr=(0,Wr.y)(self)||(0,Hr.V)(self),Kr=[429,500,502,503,504],zr={start:Math.abs(0),end:Math.abs(0),number:Math.max(Math.floor(0)),isInitSegment:!1,bitrate:0,trackId:"unknown",width:0,height:0,originalStart:0};class Zr extends kt.M{constructor(e){let{timeline:t,mediaState:r,playlist:i,abr:n,segmentFetcher:s,bufferGoal:a,bandwidthEstimator:o,ttfbEstimator:l,sourceIndex:d}=e;super(),this.segmentFetcher=void 0,this.abr=void 0,this.timeline=void 0,this.mediaState=void 0,this.playlist=void 0,this.bandwidthEstimator=void 0,this.ttfbEstimator=void 0,this.bufferGoal=void 0,this.hostnameBlackList=new Fr,this.trackToFetchFailuresCount=new Map,this.lastNonBlockedBaseUrls=[],this.isDestroyed=!1,this.inProgress=!1,this.segmentsInProgress={video:[],audio:[],text:[]},this.sourceIndex=null,this.bufferGoalBytes=(0,Ot.jS)("web_yasp_buffer_goal_bytes_size"),this.timeline=t,this.mediaState=r,this.playlist=i,this.abr=n,this.segmentFetcher=s,this.bandwidthEstimator=o,this.ttfbEstimator=l,this.bufferGoal=1e3*a,this.sourceIndex=d}abort(){["video","audio","text"].forEach(e=>{this.segmentsInProgress[e].forEach(e=>e.abort())})}setSourceIndex(e){this.sourceIndex=e}addSourceIndexInUrl(e){if(!this.sourceIndex)return e;const t=new URL(e);return t.searchParams.set(jr.g,this.sourceIndex),t.href}abortUseless(){["video","audio","text"].forEach(e=>this.abortUselessForType(e))}abortUselessForType(e){const{currentTime:t}=this.mediaState,r=1e3*(null!=t?t:-1);this.segmentsInProgress[e]=this.segmentsInProgress[e].filter(t=>{let{abort:i,segment:n,trackId:s}=t;if(n.isInitSegment)return!0;const a=n.start<=r&&r<n.end;return!(!this.timeline.checkTrackAvailableToLoad(s,e)||!a)||(i(),!1)})}run(){const e=[],t=()=>!(this.segmentsInProgress.video.length>0||this.segmentsInProgress.audio.length>0||this.segmentsInProgress.text.length>0);try{let r=t();this.runInternal(e),r=t(),r&&(this.inProgress=!1,this.emit("NoSegmentsInProgress"))}finally{Promise.all(e.map(e=>e.catch(kr.Z))).then(()=>{e.length>0&&this.emit("BandwidthEstimateUpdate",this.bandwidthEstimator.getBandwidthEstimate())})}}setVideoState(e){this.mediaState=e}setBufferGoal(e){this.bufferGoal=1e3*e}canStartDownload(e){if(!this.segmentsInProgress[e].length)return!0;const{audio:t,video:r,text:i}=this.segmentsInProgress,n=this.ttfbEstimator.getMinTtfbEstimate({value:0,source:"default"}),s=t.concat(r,i);return Gr?0===s.length:s.every(e=>{let{segment:t}=e;return t.getExpectedTimeToLoad()<=n.value})}actualizeProgress(){if(!(0,Ot.RW)("yasp_abr_loading_segment"))return;const e=Math.max(this.segmentsInProgress.audio.length,this.segmentsInProgress.video.length,this.segmentsInProgress.text.length);if(0===e)return;const t={video:e,audio:e,text:e};for(let d=0;d<e;d++){var r,i,n,s,a,o,l;const e=null==(r=this.segmentsInProgress.audio[d])?void 0:r.segment,u=null==(i=this.segmentsInProgress.video[d])?void 0:i.segment,c=null==(n=this.segmentsInProgress.text[d])?void 0:n.segment,h=this.abr.filterSegments(this.timeline.getSegmentsForTracks(null!=(s=null==e?void 0:e.start)?s:null,"audio"),this.timeline.getSegmentsForTracks(null!=(a=null==u?void 0:u.start)?a:null,"video"),this.timeline.getSegmentsForTracks(null!=(o=null==c?void 0:c.start)?o:null,"text"),this.mediaState);h.audio&&e&&h.audio!==e&&e.getExpectedTimeToLoad()>h.audio.getExpectedTimeToLoad()&&(t.audio=Math.min(t.audio,d)),h.video&&u&&h.video!==u&&u.getExpectedTimeToLoad()>h.video.getExpectedTimeToLoad()*(0,Ot.jS)("yasp_videosegment_expected_load_time_multiplier")&&(t.video=Math.min(t.video,d)),(null==c?void 0:c.getExpectedTimeToLoad())>(null==(l=h.text)?void 0:l.getExpectedTimeToLoad())&&(t.text=Math.min(t.text,d))}for(let d=e-1;d>=0;d--)this.segmentsInProgress.audio[d]&&t.audio<=d&&this.segmentsInProgress.audio[d].abort(),this.segmentsInProgress.video[d]&&t.video<=d&&this.segmentsInProgress.video[d].abort(),this.segmentsInProgress.text[d]&&t.text<=d&&this.segmentsInProgress.text[d].abort()}runInternal(e){var t,r;const{currentTime:i,duration:n,buffering:s}=this.mediaState;if(null===i)return;if(this.actualizeProgress(),!s&&n<i+.1)return;const a=1e3*i,o=this.timeline.getBufferedRanges(!0),l=o.video,d=o.audio,u=o.text,c=this.defineTracksMeta(l,a,"video"),h=this.defineTracksMeta(d,a,"audio"),p=this.defineTracksMeta(u,a,"text");if(!c.length&&!h.length&&!p.length)return;const f=Zr.syncSelectedSegments(this.abr.filterSegments(h,c,p,this.mediaState),this.segmentsInProgress),m=void 0!==f.video&&(null==(t=f.video)?void 0:t.height)===(null==(r=c[c.length-1])?void 0:r.height),g=this.getBaseUrl();g?(0,Ut.J)(f).forEach(t=>{let[r,i]=t;if(!i)return;const n=i.trackId,s=this.timeline.findTrackById(n,r);if(!s)return;let l=0;if(Number.isFinite(this.mediaState.currentTime)){const e=de(o[r],a,this.mediaState.duration);-1!==e&&(l=function(e,t){const r=Math.pow(10,t);return Math.round((e+Br.I)*r)/r}((e-a)/1e3,3))}if(!s.getInitSegment()&&s.initialization){const t=s.initialization,i={baseUrl:g,pathname:oe(t,s)},{segment:a,promise:o}=this.fetchSegment(i,n,r,le({},zr,{isInitSegment:!0}),l,m);s.appendSegment(a),e.push(o.catch(e=>{a.fail();const t=ne(e)?e:new gt.w({code:"YASP_UNKNOWN_ERROR",details:{error:e,blacklist:this.hostnameBlackList.getBlacklist()},isFatal:!0,category:vt.q.NETWORK_MEDIA});this.emitError(t)}))}const d=s.media;if(!d)return;if(s.hasSegment(i.number))return;const u={baseUrl:g,pathname:oe(d,s,i)},c={start:i.start,end:i.end,number:i.number,isInitSegment:!1,bitrate:s.bitrate,trackId:s.id,width:"width"in s?s.width:0,height:"height"in s?s.height:0,originalStart:i.originalStart,duration:i.duration},{segment:h,promise:p}=this.fetchSegment(u,n,r,c,l,m);s.appendSegment(h),e.push(p.catch(e=>{h.fail();const t=ne(e)?e:new gt.w({code:"YASP_UNKNOWN_ERROR",details:{error:e,blacklist:this.hostnameBlackList.getBlacklist()},isFatal:!0,category:vt.q.NETWORK_MEDIA});this.emitError(t)}))}):this.emitError(new gt.w({code:"YASP_NO_BASEURLS",details:{},isFatal:!0,category:vt.q.MEDIA}))}emitError(e){"YASP_OPERATION_ABORTED"!==e.code&&this.emit("Error",e)}fetchSegment(e,t,r,i,n,s){void 0===i&&(i=zr);const a=new Dt(i);let o=!1;this.handleInProgressSegment(r,a,t,()=>{o=!a.isInitSegment,this.inProgress||(this.inProgress=!0,this.emit("SegmentInProgress"))});const l=new Promise((l,d)=>{const u=t+"/"+i.number,c=this.trackToFetchFailuresCount.get(u)||0,h=new URL(e.pathname,e.baseUrl);n>=0&&h.searchParams.append("bufSize",String(n));(0,Ur._)(K(c)).then(()=>{if(this.isDestroyed)return;let i=0;i=(0,Ot.RW)("web_yasp_static_timeout_for_low_latency")&&this.timeline.isLowLatencyLive()?1e4:(s?1e4:Yr)+this.ttfbEstimator.getTtfbEstimate({value:1e3,source:"default"}).value;const n=(0,Ar.c)(this.addSourceIndexInUrl(h.toString())),p=this.hostnameBlackList.getBlacklist(),{chunkStream:f,promise:m,requestState:g,abort:v}=this.segmentFetcher.fetchChunkStream(n,i,a,r);o?v():this.handleInProgressSegment(r,a,t,v),m.then(t=>{if(t>=200&&t<300||304===t){f.on("Data",e=>{a.append(e)}),f.on("Close",()=>{a.finish(),l()});const t=()=>{if(null!=g&&g.canceled)return a.fail(),l();if(!a.finished){const t=null!=g&&g.timeout?"YASP_FETCH_SEGMENT_TIMEOUT":"YASP_FETCH_SEGMENT_HTTP_ERROR",r=null!=g&&g.timeout?"Request timed out":"Network Error",i=null!=g&&g.timeout?vt.q.NETWORK_TIMEOUT:vt.q.NETWORK_MEDIA;this.hostnameBlackList.addHostname(e.baseUrl),d(new gt.w({code:t,details:{url:n,blacklist:{before:p,after:this.hostnameBlackList.getBlacklist()},downloadedBytes:null!=g&&g.timeout?g.downloadedBytes:void 0},message:r,category:i,isFatal:!1}))}};return f.on("Destroy",t),f.resume(),this.trackToFetchFailuresCount.has(u)&&this.trackToFetchFailuresCount.delete(u),void(f.isDestroyed()&&t())}if(this.trackToFetchFailuresCount.set(u,c+1),Kr.includes(t))d(new gt.w({code:"YASP_FETCH_SEGMENT_BAD_HTTP_STATUS",message:"Error: "+t,details:{url:n,status:t,blacklist:{before:p,after:this.hostnameBlackList.getBlacklist()}},category:vt.q.NETWORK_MEDIA,isFatal:!1}));else{this.hostnameBlackList.addHostname(e.baseUrl);const r=c>=10;d(0===t?new gt.w({code:"YASP_FETCH_SEGMENT_HTTP_ERROR",message:"Network Error",details:{url:n,blacklist:{before:p,after:this.hostnameBlackList.getBlacklist()}},category:vt.q.NETWORK_MEDIA,isFatal:r}):new gt.w({code:"YASP_FETCH_SEGMENT_BAD_HTTP_STATUS",message:"Error: "+t,details:{url:n,status:t,blacklist:{before:p,after:this.hostnameBlackList.getBlacklist()}},category:vt.q.NETWORK_MEDIA,isFatal:r}))}}).catch(t=>{if(null!=g&&g.canceled)return void d(new gt.w({code:"YASP_OPERATION_ABORTED",details:{url:n,blacklist:{before:p,after:this.hostnameBlackList.getBlacklist()}},message:t.message,category:vt.q.NETWORK_MEDIA,isFatal:!1}));this.hostnameBlackList.addHostname(e.baseUrl),this.trackToFetchFailuresCount.set(u,c+1);const r="Request timed out"===t.message,i=!r&&c>=10;d(new gt.w({code:r?"YASP_FETCH_SEGMENT_TIMEOUT":"YASP_FETCH_SEGMENT_HTTP_ERROR",details:{url:n,blacklist:{before:p,after:this.hostnameBlackList.getBlacklist()},downloadedBytes:r?(null==g?void 0:g.downloadedBytes)||0:void 0},message:t.message,category:r?vt.q.NETWORK_TIMEOUT:vt.q.NETWORK_MEDIA,isFatal:i}))})})});return{segment:a,promise:l}}handleInProgressSegment(e,t,r,i){if(t.finished||t.failed)return;if((0,Ot.RW)("yasp_abr_loading_segment")&&t.isInitSegment)return;const n=this.segmentsInProgress[e].find(e=>e.segment.number===t.number&&e.trackId===r)||(()=>{const n={abort:i,segment:t,trackId:r};this.segmentsInProgress[e].push(n);const s=()=>{this.segmentsInProgress[e]=this.segmentsInProgress[e].filter(e=>e!==n),t.off("Failed",s),t.off("Finish",s)};return t.once("Failed",s),t.once("Finish",s),t.once("Destroy",s),n})(),s=n.abort;n.abort=()=>{s(),i()}}defineTracksMeta(e,t,r){if(!this.canStartDownload(r))return[];const{duration:i}=this.mediaState,n=de(e,t,i);if(-1===n)return[];const s=n-t;return this.checkIsFullBuffer(s)?[]:this.timeline.getSegmentsForTracks(n,r)}checkIsFullBuffer(e){return this.bufferGoalBytes>0&&this.timeline.getTotalRawSize()>=this.bufferGoalBytes?(this.emit("OutOfBytesLimit"),!0):e>=this.bufferGoal||0===this.bufferGoal}getDebugInfo(){return{bufferGoal:this.bufferGoal,hostnameBlackList:this.hostnameBlackList.getBlacklist(),trackToFetchFailuresCount:Array.from(this.trackToFetchFailuresCount.entries()).reduce((e,t)=>(e[t[0]]=e[t[1]],e),{}),segmentsInProgress:Object.entries(this.segmentsInProgress).reduce((e,t)=>{let[r,i]=t;return e[r]=i.map(e=>e.segment),e},{}),sourceIndex:this.sourceIndex,inProgress:this.inProgress}}static syncSelectedSegments(e,t){const r=["audio","video","text"],i=le({},e);return r.forEach(n=>{const s=e[n];if(!s)return;let a=1/0;r.forEach(r=>{var i,s;if(r===n)return;const o=null!=(i=null==(s=e[r])?void 0:s.end)?i:0,l=t[r],d=null==l?void 0:l.reduce((e,t)=>{let{segment:r}=t;return Math.max(e,r.end)},0),u=Math.max(d,o);u&&(a=Math.min(a,u))}),isFinite(a)&&s.start>=a&&(i[n]=void 0)}),i}getBaseUrl(){var e;const t=this.playlist.getBaseUrls().filter(e=>!this.hostnameBlackList.isBlacklisted(e));return function(e,t){const r=new Map;e.forEach((e,t)=>r.set(e,t)),e.sort((e,i)=>{const n=t(e,i);return 0!==n?n:Number(r.get(e))-Number(r.get(i))})}(t,(e,t)=>{const r=this.lastNonBlockedBaseUrls.indexOf(e),i=this.lastNonBlockedBaseUrls.indexOf(t);return-1!==r&&-1!==i?r-i:-1!==r&&-1===i?-1:-1===r&&-1!==i?1:0}),this.lastNonBlockedBaseUrls=t,null!=(e=t[0])?e:this.playlist.getBaseUrls()[0]}destroy(){this.isDestroyed=!0,this.abort(),super.destroy()}}class Xr{constructor(e,t,r,i){this.timeline=e,this.videoState=t,this.backWatch=r,this.getBufferGoal=i}getTotalExpectedBufferSize(){return this.backWatch+this.getBufferGoal()}setBackWatch(e){this.backWatch=e}setVideoState(e){this.videoState=e}run(){if(null===this.videoState.currentTime)return;const{currentTime:e}=this.videoState;this.timeline.clear(0,Math.max(1e3*(e-this.backWatch),0)),this.timeline.clear(1e3*(e+this.getBufferGoal()),Number.MAX_SAFE_INTEGER)}onOutOfBytesLimit(){if(null===this.videoState.currentTime)return;const{currentTime:e}=this.videoState;this.timeline.clear(0,Math.max(1e3*(e-5),0))}getDebugInfo(){return{backWatch:this.backWatch,bufferGoal:this.getBufferGoal()}}}class Qr extends kt.M{constructor(e){super(),this.fetcher=void 0,this.emsgSchemeIdUris={audio:new Set,video:new Set},this.fetcher=e}fetchChunkStream(e,t,r,i){void 0===t&&(t=0),r.waitingStarted();const{response:n,requestState:s,abort:a}=this.fetcher.fetchDataStream(e,{timeout:Math.max(Yr,t)}),o=new Pt;return{promise:new Promise(async(t,s)=>{const l=(0,It.u)();try{const s=await n,[d]=(s.headers["content-type"]||"").split(";"),u=parseInt(s.headers["content-length"]||"",10);switch(r.setExpectedSize(u),r.loadingStarted(),d.trim()){case"application/mp4":case"text/vtt":this.processVtt(s.body,o);break;case"audio/mp4":case"video/mp4":this.processMp4({readableStream:s.body,writableStream:o,getStartTime:l,segment:r,type:i,abort:a});break;default:switch(hr(e.toLocaleLowerCase())){case"vtt":this.processVtt(s.body,o);break;case"m4s":case"mp4":default:this.processMp4({readableStream:s.body,writableStream:o,getStartTime:l,segment:r,type:i,abort:a})}}t(s.status)}catch(d){o.destroy(),s(d)}}),chunkStream:o.asReadable(),requestState:s,abort:a}}processMp4(e){let t,r,i,n,{readableStream:s,writableStream:a,getStartTime:o,segment:l,type:d,abort:u}=e,c=[],h=0,p=new Uint8Array(0),f=0,m=0,g=!0,v=!0,y=0;const S=()=>{g||0===f||(v&&(c.length?(this.filterSpikes(c).forEach(e=>{let{time:t,size:r}=e;this.fetcher.progress(t,r,!0)}),c=[]):this.fetcher.progress(f,m,!0)),f=0,m=0)};let E=o,b=0,A=0;const T=e=>{if(g)if(b+=e.length,this.fetcher.isLL()){const e=E();(e>=100||b>=16e3)&&(this.fetcher.progress(e,b),E=(0,It.u)(),b=0)}else if(b>0){const e=E();this.fetcher.progress(e,b),E=(0,It.u)(),b=0}},_=(e,s)=>{p=bt.P.concat(p,e);let a=!1,o=0;const u=e=>{o=e.size+e.start,a=!0,A++};if((new at).box("uuid",e=>{if(!e.isComplete)return;o=e.size+e.start,a=!0;const s=e.reader.readUUID(),l=e.reader.readUint64();if("c4eac1fc-0ad8-4676-9656-69552eb3252f"===s&&g)t=l,r=Date.now(),i=r,g=!1;else if("bcfca253-398b-4a5b-9a92-ec8f7d89e61d"===s){n=l-t,t=l}}).box("moov",e=>{e.isComplete&&(o=e.size+e.start,a=!0)}).box("moof",e=>{e.isComplete&&(m+=e.size)}).box("mdat",e=>{if(g){if(!e.isComplete)return;u(e)}else{if(v){v=!1,y=e.loadedSize;const t=Date.now(),r=t-i;i=t,r>=n?(f+=r-n,m+=e.loadedSize):n<50&&(f+=r,m+=e.loadedSize)}else{const t=Date.now()-r;f+=t;const i=e.loadedSize-y;y=e.loadedSize;const n=i;if(m+=n,!l.isInitSegment)if(0===t)if(c.length){const e=c[c.length-1];e.size=e.size+n}else h=n;else c.push({time:t,size:n+h}),h=0}r=Date.now(),e.isComplete&&(v=!0,l.isInitSegment||S(),u(e))}}).fullBox("emsg",e=>{e.isComplete&&(this.parseEMSG(e,l,d),o=e.size+e.start,a=!0)}).parse(p,!0,!0),T(e),S(),!a)return;const E=p.subarray(0,o);p=p.subarray(o),s(E)};s.on("Data",e=>{l.loadedRawSize+=e.byteLength;try{_(e,e=>a.write(e))}catch(t){if(t instanceof RangeError)return u(),void("text"!==d&&this.emit("BufferAllocationError",{error:t,type:d}));throw t}}),s.on("Close",()=>{a.close(),this.emitSegmentLoaded(d,l,A)}),s.on("Destroy",()=>{a.destroy()}),s.resume()}emitSegmentLoaded(e,t,r){"text"===e||t.isInitSegment||this.emit("SegmentLoaded",{type:e,cmaf:r>1,number:t.number})}processVtt(e,t){let r=new Uint8Array(0);e.on("Data",e=>{r=bt.P.concat(r,e)}),e.on("Close",()=>{t.write(r),t.close()}),e.on("Destroy",()=>{t.destroy()}),e.resume()}setEmsgSchemeIdUris(e){this.emsgSchemeIdUris=null!=e?e:this.emsgSchemeIdUris}parseEMSG(e,t,r){if("text"===r)return;const i=t.start/1e3,n=e.reader.readTerminatedString(),s=e.reader.readTerminatedString(),a=e.reader.readUint32(),o=e.reader.readUint32(),l=e.reader.readUint32(),d=e.reader.readUint32(),u=e.reader.readBytes(e.reader.getLength()-e.reader.getPosition()),c=i+o/a,h=c+l/a,p=t.duration/1e3;if(this.emsgSchemeIdUris[r].has(n))if("urn:mpeg:dash:event:2012"===n)this.emit("ManifestUpdateRequired");else{const e={startTime:c,endTime:h,schemeIdUri:n,value:s,timescale:a,presentationTimeDelta:o,eventDuration:l,id:d,segmentDuration:p,messageData:u};this.emit("EmsgDetected",e)}}filterSpikes(e){if(e.length<2)return e;e.sort((e,t)=>e.time-t.time);const t=e[Math.floor(e.length/4)].time,r=e[Math.floor(e.length*(3/4))].time,i=r+3*(r-t);return e.filter(e=>e.time<i)}}class Jr{constructor(e,t,r,i){this.mse=e,this.videoState=t,this.backWatch=r,this.bufferGoal=i,this.locked=!1}setBufferGoal(e){this.bufferGoal=e}run(){this.locked||(this.locked=!0,this.runInternal().catch(kr.Z).then(()=>{this.locked=!1}))}async runInternal(){if("open"!==this.mse.getReadyState())return;const{currentTime:e}=this.videoState;if(null===e)return;const t=[this.clear(e+this.bufferGoal,this.videoState.duration)];return e>this.backWatch&&t.push(this.clear(0,e-this.backWatch)),Promise.all(t)}forceRun(e){void 0===e&&(e=null);const t=[];return(0,Ot.RW)("yasp_no_source_abort_on_fake_seek")&&null!==e&&["video","audio"].forEach(r=>{this.mse.getBufferedRangesByType(r).some(t=>t.start<=e&&t.end>=e)?t.push(Promise.resolve()):t.push(this.clear(e,this.videoState.duration))}),0===t.length&&t.push(this.clear(0,this.videoState.duration)),Promise.all(t)}clear(e,t){return e>=t?Promise.all([Promise.resolve()]):Promise.all([this.mse.clearBuffer("video",e,t),this.mse.clearBuffer("audio",e,t)])}getDebugInfo(){return{locked:this.locked}}}var $r=r(8825),ei=r(9444);class ti extends kt.M{constructor(){super(),this.accumulatedSize=0,this.timer=null,this.parallelRequests=0,this.bandwidthInfoBatch=[],this.handleProgress=e=>{this.accumulatedSize=this.accumulatedSize+e.size},this.handleResponseStart=()=>{if(this.parallelRequests++,!this.timer){let e=(0,Ft.u)();this.timer=setInterval(()=>{if(0===this.parallelRequests&&0===this.accumulatedSize)return clearInterval(this.timer),void(this.timer=null);const{accumulatedSize:t}=this;if(0===t)return;this.accumulatedSize=0;const r=e();e=(0,Ft.u)(),this.emit("Progress",{time:r,size:t})},100)}},this.handleResponseEnd=()=>{this.parallelRequests=Math.max(this.parallelRequests-1,0)},(0,Ot.RW)("web_yasp_enable_network_traces")&&this.on("Progress",e=>{this.bandwidthInfoBatch.push(he({},e,{clientTimestamp:(0,ei.no)()})),this.bandwidthInfoBatch.length>=30&&(this.emit("NetworkTrace",this.bandwidthInfoBatch),this.bandwidthInfoBatch=[])})}appendFetcher(e){e.on("Progress",this.handleProgress),e.on("ResponseStart",this.handleResponseStart),e.on("ResponseEnd",this.handleResponseEnd)}removeFetcher(e){e.off("Progress",this.handleProgress),e.off("ResponseStart",this.handleResponseStart),e.off("ResponseEnd",this.handleResponseEnd)}isLL(){return!1}}var ri=r(9459),ii=r.n(ri),ni=ii().ru.yandex.videoplayer.multiplatform;class si{constructor(){this.getTime=(0,Ft.u)()}getDurationMs(){return this.getTime()}}class ai{create(){return new si}}class oi{constructor(e){this.fetcher=e,this.progressListeners=new Map}addResponseStartListener(e){this.fetcher.on("ResponseStart",e)}removeResponseStartListener(e){this.fetcher.off("ResponseStart",e)}addResponseEndListener(e){this.fetcher.on("ResponseEnd",e)}removeResponseEndListener(e){this.fetcher.off("ResponseEnd",e)}addProgressListener(e){const t=t=>{let{time:r,size:i}=t;e(new ni.fetcher.BandwidthInfo(r,i))};this.progressListeners.set(e,t),this.fetcher.on("Progress",t)}removeProgressListener(e){const t=this.progressListeners.get(e);void 0===t&&(this.progressListeners.delete(e),this.fetcher.off("Progress",t))}}class li extends kt.M{constructor(){super(),this.fetcherProgressAccumulator=new ni.fetcher.FetcherProgressAccumulator(new ai),this.fetchers=new Map,this.bandwidthInfoBatch=[],(0,Ot.RW)("web_yasp_enable_network_traces")&&this.on("Progress",e=>{this.bandwidthInfoBatch.push(pe({},e,{clientTimestamp:(0,ei.no)()})),this.bandwidthInfoBatch.length>=30&&(this.emit("NetworkTrace",this.bandwidthInfoBatch),this.bandwidthInfoBatch=[])}),this.fetcherProgressAccumulator.addProgressListener(e=>{let{durationMs:t,sizeBytes:r}=e;this.emit("Progress",{time:t,size:r})});const e=setInterval(()=>{this.fetcherProgressAccumulator.process()},100);this.once("Destroy",()=>{clearInterval(e)})}appendFetcher(e){const t=new oi(e);this.fetchers.set(e,t),this.fetcherProgressAccumulator.appendFetcher(t)}removeFetcher(e){const t=this.fetchers.get(e);void 0!==t&&(this.fetchers.delete(t),this.fetcherProgressAccumulator.removeFetcher(t))}isLL(){return!1}}class di{constructor(){this.trace=void 0,this.trace=[]}getTrace(){return this.trace}addDecision(e,t,r){const i=[];for(const a of t){var n,s;const e=null==(n=a.audio)?void 0:n.trackId,t=null==(s=a.video)?void 0:s.trackId;i.push({audio:e,video:t})}return r?this.trace.push({name:e,result:i,input:r}):this.trace.push({name:e,result:i}),this.trace}}const ui=[4320,2880,2160,1440,1080,720,480,360,240,144,0],ci=ui.reduce((e,t)=>(e[t]=t,e),Object.create(null));class hi extends kt.M{constructor(e){let{rules:t=[]}=e;super(),this.rules=void 0,this.videoSizes=void 0,this.abrDecisionsHashCode={video:"",audio:""},this.lastAbrDecisionsLog=null,this.rules=t}setVideoElementSizes(e){this.videoSizes=e}filterSegments(e,t,r,i,n){let s;void 0===n&&(n=!0);const a=me(t,e,r),o=function(e,t){const r={};for(const i of e)r[i.trackId]||(r[i.trackId]={type:"audio",bitrate:i.bitrate});for(const i of t)r[i.trackId]||(r[i.trackId]={type:"video",bitrate:i.bitrate,height:i.height,width:i.width});return r}(e,t),l=new di,d=this.rules.reduce((e,t)=>{const r=t.filter(e,i,this.videoSizes);if(t.isCappingRule()){var n,o,d,u;const e=t.filter(a,i,this.videoSizes),r=e[e.length-1];s?null!=(n=s.video)&&n.height&&null!=(o=r.video)&&o.height&&(null==(d=s.video)?void 0:d.height)>(null==(u=r.video)?void 0:u.height)&&(s=r):s=r}let c;return"function"===typeof t.getInputData&&(c=t.getInputData()),l.addDecision(t.name,r,c),r},a.reverse())[0]||a[a.length-1];if(n){const e={tracks:o,trace:l.getTrace()},t=fe(e,"audio"),r={video:fe(e,"video")||this.abrDecisionsHashCode.video,audio:t||this.abrDecisionsHashCode.audio};this.abrDecisionsHashCode.audio===r.audio&&this.abrDecisionsHashCode.video===r.video||(this.emit("AbrDecisionChange",e),this.abrDecisionsHashCode=r,this.lastAbrDecisionsLog=e)}return s&&this.emit("MaxCapAllowedVideoTrackUpdate",s),{audio:d.audio,video:d.video,text:null==r?void 0:r[0]}}getDebugInfo(){return{rules:this.rules.map(e=>e.getDebugInfo()),abrDecisionsLog:this.lastAbrDecisionsLog}}}var pi=r(3539);class fi{constructor(){this.history=[],this.handleTtfb=e=>{isFinite(e)&&this.sample(e)}}appendFetcher(e){e.on("RequestTtfb",this.handleTtfb)}removeFetcher(e){e.off("RequestTtfb",this.handleTtfb)}sample(e){this.history.unshift(e),this.history.length=Math.min(this.history.length,20)}getMinTtfbEstimate(e){return this.hasGoodEstimate()?{value:Math.min(...this.history),source:"min"}:e}getTtfbEstimate(e){return this.hasGoodEstimate()?{value:this.getCurrentEstimate(),source:"max"}:e}hasGoodEstimate(){return this.history.length>1}getCurrentEstimate(){return Math.max(...this.history)}getDebugInfo(){return{hasGood:this.hasGoodEstimate(),value:this.getCurrentEstimate(),history:[...this.history]}}}var mi=r(9150),gi=r(9473);class vi{constructor(e,t,r){this.bandwidthEstimator=e,this.ttfbEstimator=t,this.getRemainingTimeToStart=r,this.name="NetworkParamsRule",this.inputData={bandwidth:0,ttfb:0,playbackRate:0,bufferSize:0,remainingTimeToStart:null}}filterBySegmentInfo(e,t){var r;if(e.length<=1)return e;const{value:i}=this.bandwidthEstimator.getBandwidthEstimate(),{value:n}=null==(r=this.ttfbEstimator)?void 0:r.getTtfbEstimate({value:1e3,source:"default"}),s=this.getRemainingTimeToStart();this.inputData.remainingTimeToStart=s,this.inputData.bandwidth=i,this.inputData.ttfb=n,this.inputData.playbackRate=t.playbackRate;const a=e.filter(e=>{let{video:r,audio:a}=e;const o=ve(r,t.currentTime,this.inputData.playbackRate,s),l=ve(a,t.currentTime,this.inputData.playbackRate,s),d=ye(r,a,n,i),u=ye(a,r,n,i);return null==r||r.setExpectedTimeToLoad(1e3*d),null==a||a.setExpectedTimeToLoad(1e3*u),o>=d&&l>=u});return 0===a.length?[(0,gi.U)(e,e=>{var t,r,i,n;return Math.max(null!=(t=null==(r=e.video)?void 0:r.getExpectedTimeToLoad())?t:0,null!=(i=null==(n=e.audio)?void 0:n.getExpectedTimeToLoad())?i:0)})]:a}filter(e,t){var r;if((0,Ot.RW)("yasp_npr_by_segment_info"))return this.filterBySegmentInfo(e,t);if(e.length<=1)return e;if((0,Ot.RW)("yasp_abr_loading_segment")&&e.some(ge))return e;const{value:i}=this.bandwidthEstimator.getBandwidthEstimate(),n=null==(r=this.ttfbEstimator)?void 0:r.getTtfbEstimate({value:1e3,source:"default"}).value,s=null===t.currentTime?0:(a=t,o=t.currentTime,se((0,mi.w)(a),o));var a,o;const l=this.getRemainingTimeToStart();this.inputData.remainingTimeToStart=l,this.inputData.bandwidth=i,this.inputData.ttfb=n,this.inputData.playbackRate=t.playbackRate,this.inputData.bufferSize=s;if(!(7.5>=s))return e;const d=Math.max(t.playbackRate,1),u=e.filter(e=>{var t,r,s,a;const o=Math.max(null!=(t=null==(r=e.video)?void 0:r.duration)?t:0,null!=(s=null==(a=e.audio)?void 0:a.duration)?s:0)/1e3,u=e.bandwidth*o,c=.75*o/d,h=Math.min(null!==l?l-n/1e3:1/0,c);return i*h>u});return 0===u.length?[e[0]]:u}getInputData(){return this.inputData}getDebugInfo(){return{name:this.name}}isCappingRule(){return!1}}class yi extends kt.M{constructor(){super(),this.currentTime=void 0,this.duration=void 0,this.buffering=void 0,this.buffered=void 0,this.paused=void 0,this.loop=void 0,this.playbackRate=void 0,this.currentTime=null,this.duration=Math.max(0,0),this.buffering=!0,this.buffered=new Ne,this.paused=!0,this.loop=!1,this.playbackRate=1}}class Si extends yi{constructor(){super(),this.videoSize=void 0,this.containerSize=void 0,this.devicePixelRatio=void 0,this.frames=void 0,this.objectFit=void 0,this.videoSize=null,this.containerSize=null,this.devicePixelRatio=1,this.frames={total:Math.max(Math.floor(0)),dropped:Math.max(Math.floor(0))},this.objectFit=null}}class Ei extends yi{}var bi=r(4893);const Ai=Number.MAX_SAFE_INTEGER;var Ti=r(3942),_i=r(6513);class wi{constructor(e,t){this.name="ResolutionRule",this.inputData={width:0,height:0,dpi:1,defaultQuality:Ai,userQuality:bi.k},this.getUserQuality=void 0,this.getDefaultQuality=void 0,this.getDefaultQuality=e,this.getUserQuality=t}filter(e,t,r){var i,n;let s;if(!function(e){return e instanceof Si}(t))return e;if((0,Ot.RW)("web_yasp_object_fit_in_resolution_rule")){var a,o,l,d,u,c;const{width:e,height:i}=null!=(a=null==t?void 0:t.videoSize)?a:{width:0,height:0},n={width:null!=(o=null==(l=t.containerSize)?void 0:l.width)?o:0,height:null!=(d=null==(u=t.containerSize)?void 0:u.height)?d:0},h=null!=(c=t.objectFit)?c:"contain";s=null!=r?r:(0,_i.k)({videoWidth:e,videoHeight:i},h,n)}else{var h,p;s=r||{width:null==(h=t.containerSize)?void 0:h.width,height:null==(p=t.containerSize)?void 0:p.height}}return s.dpi=t.devicePixelRatio?t.devicePixelRatio:1,this.inputData.width=null!=(i=s.width)?i:null,this.inputData.height=null!=(n=s.height)?n:null,this.inputData.dpi=s.dpi,this.inputData.userQuality=this.getUserQuality(),this.inputData.defaultQuality=this.getDefaultQuality(),be(e,s,{defaultLongSideResolution:this.inputData.defaultQuality,userCappingResolution:this.inputData.userQuality})}getInputData(){return this.inputData}getDebugInfo(){return{name:this.name}}isCappingRule(){return!0}}class ki{constructor(){this.name="MaxBandwidthRule"}filter(e,t){const r=u(e.slice(0).reverse(),e=>{var t;return(null==e||null==(t=e.audio)?void 0:t.bitrate)||0});return r?[r]:e}getDebugInfo(){return{name:this.name}}isCappingRule(){return!1}}class Ri{constructor(e){this.getServerCapHeight=e,this.name="ServerRestrictionsRule",this.inputData={maxHeight:null}}filter(e){if(e.length<=1)return e;const t=this.getServerCapHeight();return this.inputData.maxHeight=t,null===t?e:function(e,t){const r=e.filter(Ae);if(r.length<=1)return e;const i=[];for(let n=0;n<r.length;n++)r[n].video.height<=t&&i.push(r[n]);return 0===i.length?[r[0]]:i}(e,t)}getInputData(){return this.inputData}getDebugInfo(){return{name:this.name}}isCappingRule(){return!0}}class Pi{constructor(e){this.bandwidthEstimator=e,this.name="SimpleBandwidthRule",this.inputData={bandwidth:0,playbackRate:0,paused:!1}}filter(e,t){if(e.length<=1)return e;const{value:r}=this.bandwidthEstimator.getBandwidthEstimate();this.inputData.bandwidth=r,this.inputData.playbackRate=t.playbackRate,this.inputData.paused=t.paused;const i=e.filter(e=>{if((0,Ot.RW)("yasp_abr_loading_segment")&&function(e){return!(!e.video&&!e.audio)&&["audio","video"].every(t=>{const r=e[t];return!r||null!==r.getWaitingDuration()})}(e))return!0;return e.bandwidth*Math.max(t.playbackRate,1)<=r});return 0===i.length?[e[0]]:i}getInputData(){return this.inputData}getDebugInfo(){return{name:this.name}}isCappingRule(){return!1}}var Ci=r(2786),Ii=r(9591);class Oi{constructor(){this.name="SaveDataRule",this.inputData={saveData:(0,Ci.R)()}}filter(e){return this.inputData.saveData=(0,Ci.R)(),function(e){return(0,Ci.R)()?e.filter(e=>!(e.video&&e.video.height&&e.video.width)||Math.min(e.video.height,e.video.width)<=Ii.T):e}(e)}getInputData(){return this.inputData}getDebugInfo(){return{name:this.name}}isCappingRule(){return!0}}var Di=ii().ru.yandex.videoplayer.multiplatform;class Ni{constructor(e){this.fetcher=e}addRequestTtfbListener(e){this.fetcher.on("RequestTtfb",e)}removeRequestTtfbListener(e){this.fetcher.off("RequestTtfb",e)}}class Li{constructor(){this.ttfbEstimator=new Di.estimate.TtfbEstimator,this.fetchers=new Map}appendFetcher(e){const t=new Ni(e);this.fetchers.set(e,t),this.ttfbEstimator.appendFetcher(t)}removeFetcher(e){const t=this.fetchers.get(e);void 0!==t&&(this.fetchers.delete(t),this.ttfbEstimator.removeFetcher(t))}getMinTtfbEstimate(e){const{value:t,source:r}=this.ttfbEstimator.getMinTtfbEstimate(e);return{value:t,source:r}}getTtfbEstimate(e){const{value:t,source:r}=this.ttfbEstimator.getTtfbEstimate(e);return{value:t,source:r}}hasGoodEstimate(){return this.ttfbEstimator.hasGoodEstimate()}getDebugInfo(){return this.ttfbEstimator.getDebugInfo()}}var xi=r(7154);class Mi extends kt.M{constructor(e){super(),this.videoState=e,this.watchedTimeCounter=void 0,this.watchedTimeCounter=new xi.p}run(){this.videoState.currentTime&&(this.watchedTimeCounter.calc(this.videoState.currentTime,this.videoState.playbackRate,!0),this.emit("WatchedTimeUpdated",{watchedTime:this.watchedTimeCounter.get()}))}}var Fi=ii().ru.yandex.videoplayer.multiplatform;class Vi{constructor(){this.bufferGoalManager=void 0,this.constantBufferGoal=null,this.bufferGoalManager=new Fi.bgm.BufferGoalManager(new Fi.bgm.BufferGoalManagerProps(null,new Fi.bgm.BufferGoalManagerFlags(new Fi.flags.DisableDynamicBuffer(!1),new Fi.flags.LowBufferBeforeStart(!0),new Fi.flags.DefaultBuffer(30)),null))}setConstantBufferGoal(e){this.constantBufferGoal=e}getBufferGoal(e){if(null!==this.constantBufferGoal)return this.constantBufferGoal;if(e.usePreloadBufferGoal)return 2;const{watchedTime:t=0,currentTime:r=0}=e;return this.bufferGoalManager.getBufferGoal(new Fi.bgm.GetBufferGoalProps(new Fi.bgm.WatchedTime(t),new Fi.bgm.CurrentTime(r)))}setSkippableFragments(e){this.bufferGoalManager.setSkippableFragments(e?e.map(e=>{let{startTime:t,endTime:r}=e;return new Fi.bgm.SkippableFragment(t,r)}):null)}getSkippableFragments(){const e=this.bufferGoalManager.getSkippableFragments()||void 0;return e&&e.map(e=>{let{startTime:t,endTime:r}=e;return{startTime:t,endTime:r}})}}class Bi extends kt.M{constructor(e){super(),this.timeline=e}run(){this.timeline.getIsDynamic()&&this.update()}update(){const e=this.timeline.getSeekableRange(),t=e.start/1e3,r=e.end/1e3;this.emit("SeekableUpdate",{start:t,end:r})}destroy(){super.destroy()}}var Ui=r(1841),ji=r(413);class Hi{constructor(e,t){this.onChange=e,this.types={},this.queue={audio:[],video:[]},this.enabledTypes=void 0,this.enabledTypes=(0,Mt.Z)(t),this.enabledTypes.forEach(e=>{this.types[e]=!1})}update(e,t){this.enabledTypes.includes(e)&&(this.queue[e].push(t),this.checkAndUpdate())}checkAndUpdate(){if(this.enabledTypes.every(e=>this.queue[e].length)){let e=!1;this.enabledTypes.forEach(t=>{const r=this.queue[t].shift();this.types[t]!==r&&(e=!0,this.types[t]=r)}),e&&this.onChange(this.types)}}onSeek(){this.enabledTypes.forEach(e=>this.queue[e].length=0)}}var Wi=r(2390);const qi=(0,Hr.V)(self),Yi=(0,Wr.y)(self);var Gi,Ki=r(8243),zi=r(5214);!function(e){e.append="append",e.remove="remove",e.setTimestampOffset="setTimestampOffset",e.changeType="changeType"}(Gi||(Gi={}));const Zi=[[Gi.remove],[Gi.setTimestampOffset],[Gi.append,Gi.changeType]];class Xi{constructor(e,t){this.destroyed=!1,this.mimeType=void 0,this.sourceBuffer=void 0,this.mediaSource=void 0,this.sync=void 0,this.abortId=void 0,this.removeId=void 0,this.queues=void 0,this.mimeType=e,this.mediaSource=t,this.sourceBuffer=this.initSourceBuffer(),this.sync=(0,Wi.l)(),this.abortId=0,this.removeId=0,this.queues=Zi.map(e=>[])}checkIfPresent(){return(0,zi.w)(this.mediaSource.sourceBuffers).some(e=>this.sourceBuffer===e)}isFree(){return this.sync.isFree()&&this.queues.every(e=>0===e.length)}lockForExternalOperation(e){return this.sync.waitAndLock(()=>e()).then(()=>{setTimeout(()=>this.performNextOperation())}).catch(dr.Z)}initSourceBuffer(){return this.mediaSource.addSourceBuffer(this.mimeType)}getNextOperationDescriptor(){for(let e=0;e<this.queues.length;e++)if(this.queues[e].length>0)return this.queues[e].shift();return null}performNextOperation(){if(!this.sync.isFree())return;const e=this.getNextOperationDescriptor();if(null===e)return;const{abortId:t,defer:r,operation:i,type:n}=e;this.sync.waitAndLock(async()=>{if(t!==this.abortId||this.destroyed)return r.reject(new gt.w({code:"YASP_OPERATION_ABORTED",details:{},isFatal:!1,category:vt.q.EXCEPTION,message:"SourceBuffer "+n+" operation aborted before start"})),r.promise;try{await i(),r.resolve()}catch(e){r.reject(e)}return r.promise}).catch(dr.Z).then(()=>{setTimeout(()=>this.performNextOperation())})}planOperation(e,t){const{abortId:r,destroyed:i}=this;if(i)throw new Error("SourceBuffer operation with type="+e+" skipped after destroy");const n=new Ir.B,s=Zi.findIndex(t=>t.includes(e));if(-1===s)throw new Error("SourceBuffer unknown operation with type="+e);return this.queues[s].push({defer:n,abortId:r,operation:t,type:e}),this.performNextOperation(),n.promise}static isChangeTypeSupported(){return void 0===(e=self)&&(e=window),!qi&&!Yi&&Boolean(e.SourceBuffer)&&Boolean(e.SourceBuffer.prototype)&&Boolean(e.SourceBuffer.prototype.changeType);var e}changeType(e){return this.planOperation(Gi.changeType,async()=>{this.mimeType!==e&&(this.sourceBuffer.changeType(e),this.mimeType=e)})}append(e){const{removeId:t}=this;return this.planOperation(Gi.append,()=>new Promise((r,i)=>{if(t!==this.removeId)return void i(new gt.w({code:"YASP_OPERATION_ABORTED",details:{},isFatal:!1,category:vt.q.EXCEPTION,message:"SourceBuffer append operation aborted before start"}));const n=new Ir.B,s=new Ir.B,a=(0,Ki.O)(this.sourceBuffer,"updateend",()=>{n.resolve(),s.resolve()}),o=(0,Ki.O)(this.sourceBuffer,"error",()=>{s.reject(new gt.w({code:"YASP_MSE_FAILED_TO_EXECUTE_PROCEDURE",message:"Failed to execute append operation in SourceBuffer",details:{operation:"append"},isFatal:!1,category:vt.q.EXCEPTION}))}),l=(0,Ki.O)(this.sourceBuffer,"abort",()=>{s.reject(new gt.w({code:"YASP_OPERATION_ABORTED",details:{},isFatal:!1,category:vt.q.EXCEPTION,message:"SourceBuffer append operation aborted"}))});try{this.sourceBuffer.appendBuffer(e)}catch(d){const e=(0,Tr.V)(d)?d:new Error("Failed to start append operation in SourceBuffer"),t="InvalidStateError"===e.name?"YASP_INVALID_STATE_ERROR":"YASP_QUOTA_EXCEEDED_ERROR";return void i(new gt.w({code:t,message:e.message,details:{operation:"append",error:e},isFatal:!1,category:vt.q.EXCEPTION}))}n.promise.then(()=>s.promise).catch(i).then(r).then((function(){a(),o(),l()}))}))}remove(e,t){return this.planOperation(Gi.remove,()=>new Promise((r,i)=>{this.removeId++;const n=new Ir.B,s=new Ir.B,a=(0,Ki.O)(this.sourceBuffer,"updateend",()=>{n.resolve(),s.resolve()}),o=(0,Ki.O)(this.sourceBuffer,"error",()=>{s.reject(new gt.w({code:"YASP_MSE_FAILED_TO_EXECUTE_PROCEDURE",message:"Failed to execute remove operation in SourceBuffer",details:{operation:"remove"},isFatal:!1,category:vt.q.EXCEPTION}))}),l=(0,Ki.O)(this.sourceBuffer,"abort",()=>{s.reject(new gt.w({code:"YASP_OPERATION_ABORTED",details:{},isFatal:!1,category:vt.q.EXCEPTION,message:"SourceBuffer remove operation aborted"}))});try{this.sourceBuffer.remove(e,t)}catch(d){return void i(new gt.w({code:"YASP_MSE_FAILED_TO_START_OPERATION",message:(0,Tr.V)(d)?d.message:"Failed to start remove operation in SourceBuffer",details:{operation:"remove",error:d},isFatal:!1,category:vt.q.EXCEPTION}))}n.promise.then(()=>s.promise).catch(i).then(r).then((function(){a(),o(),l()}))}))}setTimestampOffset(e){return this.planOperation(Gi.setTimestampOffset,async()=>{e>0&&(e-=.001),this.sourceBuffer.timestampOffset!==-e&&(this.sourceBuffer.timestampOffset=-e)})}abort(){this.abortId++}getBufferedRange(){var e;return null!=(e=(0,ir.Y)(()=>(0,mi.w)(this.sourceBuffer)))?e:[]}getBufferEnd(){const e=this.getBufferedRange(),{length:t}=e;if(!t)return null;const{end:r}=e[t-1];return r}async destroy(){return this.abort(),this.sync.waitAndLock(async()=>{try{this.mediaSource.removeSourceBuffer(this.sourceBuffer)}catch(e){}this.destroyed=!0})}getDebugInfo(){return{abortId:this.abortId,removeId:this.removeId,mimeType:this.mimeType,locked:!this.sync.isFree(),buffered:this.getBufferedRange(),queues:this.queues.map(e=>e.map(e=>we({},e)))}}}var Qi=r(4754);class Ji extends kt.M{createMediaSource(){const e=(0,Er.Q)(self),t=this.mediaSource=new e,r=(0,Mt.Z)(this.mimeTypes),i=()=>{try{r.forEach(e=>this.createSourceBufferEngine(e))}catch(e){return this.mediaSourceOpenDeferred.reject(e),void this.destroy()}this.emit("Open"),this.mediaSourceOpenDeferred.resolve(),this.revokeObjectUrl()},n=new Ir.B,s=r.length;let a=0;return t.sourceBuffers.addEventListener("addsourcebuffer",()=>{a++,a===s&&n.resolve()}),"open"===t.readyState?i():this.addListener(t,"sourceopen",i,{once:!0}),{sourceBufferAddingPromise:n.promise}}constructor(e){super(),this.mimeTypes=e,this.destroyed=!1,this.mediaSource=void 0,this.mediaSourceOpenDeferred=new Ir.B,this.sourceBufferEngines={},this.objectUrl=void 0,this.listeners=[],this.reloadingMediaSource=!1,this.nextDurationToSet=null,(0,$t.v)(this.mediaSourceOpenDeferred.promise),this.createMediaSource(),this.objectUrl=this.createObjectUrl(),this.once("Destroy",()=>{this.destroyed=!0,this.removeListeners()})}addListener(e,t,r,i){e.addEventListener(t,r,i);const n=()=>e.removeEventListener(t,r);return this.listeners.push(n),n}removeListeners(){this.listeners.forEach(e=>e()),this.listeners.length=0}async clearBuffer(e,t,r){if(this.destroyed)throw new Error("Can not clearBuffer because CoreMediaSourceEngine is destroyed");if(!this.checkType(e))return;if("open"!==this.mediaSource.readyState&&await this.mediaSourceOpenDeferred.promise,this.reloadingMediaSource)return;const{[e]:i}=this.sourceBufferEngines;await(null==i?void 0:i.remove(t,r))}async changeCodec(e,t){if(this.checkType(e)){if("open"!==this.mediaSource.readyState&&await this.mediaSourceOpenDeferred.promise,this.mimeTypes[e]=t,Xi.isChangeTypeSupported()){const{[e]:r}=this.sourceBufferEngines;return null==r?void 0:r.changeType(t)}return this.reset()}}abort(){this.destroyed||(0,xt.z)(this.sourceBufferEngines).forEach(e=>{null==e||e.abort()})}async reset(){this.reloadingMediaSource=!0,this.removeListeners();try{var e;await this.removeSourceBuffers();const t=null!=(e=this.nextDurationToSet)?e:this.mediaSource.duration;this.mediaSource=null,this.mediaSourceOpenDeferred=new Ir.B,(0,$t.v)(this.mediaSourceOpenDeferred.promise);const{sourceBufferAddingPromise:r}=this.createMediaSource();this.objectUrl=this.createObjectUrl(),null!==t&&this.setDuration(t),this.emit("Reset",this.getObjectUrl()),await r}finally{this.reloadingMediaSource=!1}}checkType(e){return Boolean(this.mimeTypes[e])}createObjectUrl(){return self.URL.createObjectURL(this.mediaSource)||this.mediaSource.handle}revokeObjectUrl(){"string"===typeof this.objectUrl&&self.URL.revokeObjectURL(this.objectUrl)}async appendBuffer(e,t){if(this.destroyed)throw new Error("Can not appendBuffer because CoreMediaSourceEngine is destroyed");if("open"!==this.mediaSource.readyState&&await this.mediaSourceOpenDeferred.promise,this.reloadingMediaSource)throw new Error("Can not appendBuffer because CoreMediaSourceEngine is reloading");const{[e]:r}=this.sourceBufferEngines;return null==r?void 0:r.append(t)}getObjectUrl(){return this.objectUrl}isReloading(){return this.reloadingMediaSource}getReadyState(){return this.mediaSource.readyState}endOfStream(){if(!this.reloadingMediaSource&&"open"===this.mediaSource.readyState){for(const e of["audio","video"])if(void 0!==this.sourceBufferEngines[e]&&!this.sourceBufferEngines[e].isFree())return;this.mediaSource.endOfStream()}}getSourceBufferBufferedRange(e){var t;return null==(t=this.sourceBufferEngines[e])?void 0:t.getBufferedRange()}setDuration(e){isNaN(e)||(this.nextDurationToSet=e,"open"!==this.mediaSource.readyState?this.mediaSourceOpenDeferred.promise.then(()=>this.tryToSetDuration()).catch(e=>{this.destroyed||(0,Ct.L)(e)}):this.tryToSetDuration())}tryToSetDuration(){if(null===this.nextDurationToSet)return;const e=["audio","video"],t={audio:new Ir.B,video:new Ir.B};for(const i of e){var r;const{[i]:n}=this.sourceBufferEngines,s=async()=>{t[i].resolve(),await t[e[e.indexOf(i)%e.length]].promise,null!==this.nextDurationToSet&&(this.mediaSource.duration=this.nextDurationToSet,this.nextDurationToSet=null)};if(!n){s();continue}const a=null!=(r=n.getBufferEnd())?r:this.nextDurationToSet;a>this.nextDurationToSet&&n.remove(this.nextDurationToSet,a),n.lockForExternalOperation(s)}}getDuration(){return this.mediaSource.duration}async setLiveSeekableRange(e,t){if((0,Qi.m)(this.mediaSource.setLiveSeekableRange)){if(this.reloadingMediaSource)throw new Error("Can not setLiveSeekableRange because CoreMediaSourceEngine is reloading");if(this.destroyed)throw new Error("Can not setLiveSeekableRange because CoreMediaSourceEngine is destroyed");if(e<0)throw new Error("Can not setLiveSeekableRange because start value is negative");if(e>t)throw new Error("Can not setLiveSeekableRange because start value is greater then end value");"open"!==this.mediaSource.readyState&&await this.mediaSourceOpenDeferred.promise,this.mediaSource.setLiveSeekableRange(e,t)}}async setTimestampOffset(e,t){if(this.destroyed)throw new Error("Can not setTimestampOffset because CoreMediaSourceEngine is destroyed");if("open"!==this.mediaSource.readyState&&await this.mediaSourceOpenDeferred.promise,this.reloadingMediaSource)return;const{[e]:r}=this.sourceBufferEngines;return null==r?void 0:r.setTimestampOffset(t)}getBufferedRanges(){return{audio:this.getBufferedRangesByType("audio"),video:this.getBufferedRangesByType("video")}}getBufferedRangesByType(e){var t;return null!=(t=this.getSourceBufferBufferedRange(e))?t:[]}async destroy(){if(!this.destroyed){super.destroy(),this.mediaSourceOpenDeferred.reject(new Error("Can not open media source because CoreMediaSourceEngine is destroyed"));try{this.mediaSource.endOfStream()}catch(e){}await this.removeSourceBuffers()}}removeSourceBuffers(){return this.abort(),Promise.all((0,Mt.Z)(this.sourceBufferEngines).map(async e=>{try{await this.sourceBufferEngines[e].destroy()}catch(t){this.destroyed||(0,Ct.L)(t)}delete this.sourceBufferEngines[e]}))}createSourceBufferEngine(e){if(this.sourceBufferEngines[e])return;const t=this.mimeTypes[e];if(!t)throw new gt.w({code:"YASP_EMPTY_MIME",details:{},isFatal:!0,category:vt.q.MEDIA});try{this.sourceBufferEngines[e]=new Xi(t,this.mediaSource)}catch(r){throw new gt.w({code:"YASP_CANNOT_CREATE_SOURCE_BUFFER",details:{reason:r.name,mimeType:t},isFatal:!0,category:vt.q.MEDIA})}}getDebugInfo(){var e,t,r,i,n,s;return{readyState:this.getReadyState(),audio:null!=(e=null==(t=this.sourceBufferEngines)||null==(r=t.audio)?void 0:r.getDebugInfo())?e:null,video:null!=(i=null==(n=this.sourceBufferEngines)||null==(s=n.video)?void 0:s.getDebugInfo())?i:null}}}var $i=r(9881),en=r(719);let tn;!function(e){e[e.KILOBYTE=1024]="KILOBYTE",e[e.MEGABYTE=1048576]="MEGABYTE"}(tn||(tn={}));class rn extends kt.M{get offset(){return this._offset}get ftyp(){return this._ftyp}get moov(){return this._moov}get sidx(){return this._sidx}get segmentsInfo(){return this._segmentsInfo}constructor(e){super(),this.url=void 0,this.fetcher=void 0,this.timeline=void 0,this.parser=void 0,this.attempt=0,this.aborted=!1,this.abortFn=null,this._offset=void 0,this._ftyp=new ArrayBuffer(0),this._moov=new ArrayBuffer(0),this._sidx=new ArrayBuffer(0),this._segmentsInfo=[],this._timescale=1,this.url=e.url,this.timeline=e.timeline,this.parser=new at,this.fetcher=new Sr(e.fetcherParams)}async update(){this._offset=await this.requestOffset();const e=await this.requestFtypMoovSidxBoxes();e&&(this._ftyp=e.ftyp,this._moov=e.moov,this._sidx=e.sidx.buffer,this._segmentsInfo=e.sidx.segmentsInfo,this._timescale=e.sidx.timescale,this.applySegmentsInfoToTimeline())}applySegmentsInfoToTimeline(){if(void 0===this._offset)return;const e=(0,yr.UO)(this.url),t=this._segmentsInfo[this._segmentsInfo.length-1].endTime/this._timescale*1e3;var r,i;this.timeline.obtainTimelineTrack({type:"audio",name:e,codecs:Re(this.url),id:e+"_"+t,bitrate:(r=this._segmentsInfo,i=this._timescale,Math.round(8*r.reduce((e,t)=>e+t.size,0)/r.reduce((e,t)=>e+t.duration/i,0))||0),language:null,initialization:null,timescale:this._timescale,media:"",mimeType:"audio/mp4",startNumber:Math.max(Math.floor(1)),startTime:this._segmentsInfo[0].startTime/this._timescale*1e3,endNumber:Math.max(Math.floor(this._segmentsInfo.length)),endTime:t,presentationTimeOffset:0,segmentSequences:Pe(this._segmentsInfo,this._offset,this._timescale)})}isInitiallyLoaded(){return void 0!==this._offset&&0!==this._segmentsInfo.length}setFetcherBaseParams(e){this.fetcher.setBaseParams(e)}getBaseUrls(){return[this.url]}abort(){this.abortFn&&this.abortFn(),this.aborted=!0}destroy(){this.abort(),super.destroy()}getDebugInfo(){return{url:this.url,offset:this._offset,segmentsInfo:this._segmentsInfo,attempt:this.attempt}}async requestFtypMoovSidxBoxes(){try{if(!this._offset)return;const e=await this.requestDataStream(this._offset,this._offset+tn.MEGABYTE);if(!e)return;const t={ftyp:new ArrayBuffer(0),moov:new ArrayBuffer(0),sidx:{buffer:new ArrayBuffer(0),segmentsInfo:[],timescale:1}};return this.parser.fullBox("ftyp",e=>{t.ftyp=e.reader.getDataView().buffer.slice(e.start,e.start+e.size)}).fullBox("moov",e=>{t.moov=e.reader.getDataView().buffer.slice(e.start,e.start+e.size)}).fullBox("sidx",e=>{t.sidx.buffer=e.reader.getDataView().buffer.slice(e.start,e.start+e.size);const r=function(e){e.reader.skip(4);const t=e.reader.readUint32(),r=[];if(0===t)throw new Error("[parseSidx] Invalid timescale.");let i,n;0===e.version?(i=e.reader.readUint32(),n=e.reader.readUint32()):(i=e.reader.readUint64(),n=e.reader.readUint64()),e.reader.skip(2);const s=e.reader.readUint16();if(0===s)throw new Error("[parseSidx] Invalid reference count.");let a=i,o=e.start+e.size+n;for(let l=0;l<s;l++){const t=e.reader.readUint32(),i=(2147483648&t)>>>31,n=2147483647&t,s=e.reader.readUint32();if(e.reader.skip(4),1===i)throw new Error("[parseSidx] Hierarchical SIDXs are not supported.");r.push({type:i,size:n,duration:s,startByte:o,endByte:o+n-1,startTime:a,endTime:a+s}),a+=s,o+=n}return e.parser.stop(),{segmentsInfo:r,timescale:t}}(e);t.sidx.segmentsInfo=r.segmentsInfo,t.sidx.timescale=r.timescale}).parse(e),t}catch(e){let t;return t=(0,Tr.V)(e)?new gt.w({code:"YASP_PARSE_SIDX_ERROR",details:{url:this.url,error:e},message:e.message,isFatal:!0,category:vt.q.EXCEPTION}):new gt.w({code:"YASP_UNKNOWN_ERROR",details:{url:this.url,error:e},message:"Unknown error. Expect error to be an instance of Error.",isFatal:!0,category:vt.q.EXCEPTION}),void this.emit("Error",t)}}async requestOffset(){const e=await this.requestDataStream(0,tn.KILOBYTE);if(!e)return;let t=0;return this.parser.box("uuid",e=>{e.reader.readUUID(),t=e.reader.readUint64()}).parse(e),t}async requestDataStream(e,t){this.aborted=!1;try{const{response:r,abort:i}=(0,en.hj)(e)?this.fetcher.fetchDataStream(this.url,{headers:{Range:"bytes="+e+"-"+(null!=t?t:"")}}):this.fetcher.fetchDataStream(this.url);this.abortFn=i;const{body:n,status:s}=await r;if(!(s>=200&&s<300||304===s))throw s;return this.attempt=0,this.abortFn=null,await this.readDataStream(n)}catch(r){let i;const n=this.attempt>=10;if(this.abortFn=null,(0,en.hj)(r)){const e=r;i=0===e?new gt.w({code:"YASP_FETCH_RANGE_HTTP_ERROR",message:"Network Error",details:{url:this.url},category:vt.q.NETWORK_MEDIA,isFatal:n}):new gt.w({code:"YASP_FETCH_RANGE_BAD_HTTP_STATUS",message:"Error: "+e,details:{status:e,url:this.url},isFatal:n,category:vt.q.NETWORK_MEDIA})}else if((0,Tr.V)(r)){if("Request canceled"===r.message||"Abort error"===r.message)return;i=new gt.w({code:"Request timed out"===r.message?"YASP_FETCH_RANGE_TIMEOUT":"YASP_FETCH_RANGE_HTTP_ERROR",details:{url:this.url},message:r.message,isFatal:n,category:"Request timed out"===r.message?vt.q.NETWORK_TIMEOUT:vt.q.NETWORK_MEDIA})}else i=new gt.w({code:"YASP_UNKNOWN_ERROR",details:{url:this.url,error:r},message:"Unknown error. Expect error to be an instance of Error.",isFatal:n,category:vt.q.NETWORK_MEDIA});if(this.emit("Error",i),n||i.isFatal)return;const s=(0,_r._)(K(this.attempt++));if(this.aborted)return;return s.then(()=>{if(!this.aborted)return this.requestDataStream(e,t)})}}async readDataStream(e){try{let t=new Uint8Array,r=!1;for(;!r;){const{value:i,done:n}=await e.read();r=n,i&&(t=bt.P.concat(t,i))}return t}catch(t){return void this.emit("Error",new gt.w({code:"YASP_PARSE_ERROR_EXCEPTION",message:"Data stream reading exception",details:{error:t,errorString:t instanceof Error?t.message:"Data stream reading exception"},category:vt.q.EXCEPTION,isFatal:!0}))}}}const nn=(0,Hr.V)(self)||(0,Wr.y)(self)||(0,$i.F)(self);class sn extends kt.M{constructor(e,t,r,i){super(),this.cron=e,this.url=t,this.mediaState=r,this.callbacks=i,this.abr=void 0,this.bandwidthEstimator=void 0,this.ttfbEstimator=void 0,this.playlist=void 0,this.playlistUpdater=void 0,this.timeline=void 0,this.mse=void 0,this.mseFeeder=void 0,this.mseGc=void 0,this.timelineFiller=void 0,this.seekableUpdater=void 0,this.timelineGc=void 0,this.yaspWatchedTimeCollector=void 0,this.segmentFetcher=void 0,this.targetLatencyUpdater=void 0,this.cmafLogger=void 0,this.fetcher=void 0,this.fetcherParams=void 0,this.fetcherProgressAccumulator=void 0,this.attached=!1,this.startPosition=null,this.destroyed=!1,this.performOnLoad=void 0,this.watchedTime=0,this.bufferGoalManager=void 0,this.timelineFillerBufferGoalInterval=void 0,this.videoType=void 0,this.isLowLatency=!1,this.maxStartTimestamp=null,this.wasSegmentLoaded=!1,self.source=this,this.startPosition=ue(this.url),this.performOnLoad=(0,$r.P)(new Promise(e=>{this.once("ManifestLoaded",e)})),this.timeline=this.createTimeline(),this.subscribeToTrackChanges(),this.bufferGoalManager=new Vi;const{bandwidthEstimator:n,ttfbEstimator:s,abr:a}=function(e,t,r,i,n){const s=pi.f.obtain(n),a=(0,Ot.RW)("web_mp_ttfb_estimator")?new Li:new fi,o=[new Oi,new Ri(e),new Pi(s),new vi(s,a,i),new wi(r,t),new ki];return{bandwidthEstimator:s,ttfbEstimator:a,abr:new hi({rules:o})}}(()=>{var e,t;return null!=(e=null==(t=this.playlist)?void 0:t.getPlaylistCapHeight())?e:null},()=>this.callbacks.getUserQuality(),()=>this.callbacks.getMaxAutoQuality(),()=>this.getRemainingTimeToStart(),this.callbacks.getDefaultBandwidth().value);this.bandwidthEstimator=n,this.ttfbEstimator=s,this.abr=a,this.abr.on("AbrDecisionChange",e=>{const t=JSON.stringify(Ce({},e,{type:this.attached?"main":"preload"}));this.sendEvent({name:"AbrDecisionChange",data:{message:t},shouldLogWhenDetached:!0})}),this.abr.on("MaxCapAllowedVideoTrackUpdate",e=>{var t,r,i,n;e&&null!=(t=e.video)&&t.width&&null!=(r=e.video)&&r.height&&this.emit("MaxCapAllowedVideoTrackUpdate",{width:null==(i=e.video)?void 0:i.width,height:null==(n=e.video)?void 0:n.height})}),this.on("SegmentLoaded",e=>{var t;null==(t=this.mseFeeder)||t.run(),this.wasSegmentLoaded=!0});const o=(0,Ui.p)();void 0!==o&&(this.maxStartTimestamp=Date.now()+1e3*o)}getRemainingTimeToStart(){if(!this.maxStartTimestamp||this.wasSegmentLoaded)return null;const e=this.maxStartTimestamp-Date.now();return e<=0?0:e/1e3}updateSourceInfo(e){var t,r;const i=(0,Ve.IN)(e);null==(t=this.playlist)||t.setSourceIndex(i),null==(r=this.timelineFiller)||r.setSourceIndex(i)}checkTotalBufferDuration(e,t){const r=this.timelineGc?this.timelineGc.getTotalExpectedBufferSize()+10:60,i=e.reduce((e,t)=>e+(t.end-t.start),0);i>r&&this.sendEvent({name:"FatTimelineBuffer",shouldLogWhenDetached:!0,data:{type:t,expectedSize:r,size:i}})}emitManifestoError(e,t,r){var i;const n=null==(i=this.playlist)?void 0:i.getDebugInfo();if(n){const i=new gt.w({message:e.message,code:"YASP_MANIFESTO_UNHANDLED",details:Ce({},n,{start:t,end:r}),isFatal:!1,category:vt.q.EXCEPTION});this.emit("Error",i)}}createTimeline(){if(this.timeline)return this.timeline;const e=new Ht;return e.on("BufferedInfoChanged",e=>{this.checkTotalBufferDuration(e.video,"video"),this.checkTotalBufferDuration(e.audio,"audio"),this.emit("BufferedInfoChanged",e)}),e.on("CuesAdded",e=>{this.emit("CuesAdded",e)}),e.on("CodecsChange",e=>{var t;if(!this.mse)return;null==(t=this.mseFeeder)||t.abortForType(e.type);const r=e.getFullMimeType();this.mse.changeCodec(e.type,r)}),e.on("StreamEndTimeUpdate",e=>{this.emit("StreamEndTimeUpdate",e)}),e}getStartPosition(){var e;return null!==this.startPosition&&Number.isFinite(this.startPosition)?this.startPosition:null!=(e=this.timeline)&&e.getIsDynamic()?Math.floor(this.timeline.getSeekableRange().end/1e3):this.timeline.getSeekableRange().start/1e3}setDurationByVideoType(){if(!this.mse||!this.videoType)return;const e=this.timeline.getDuration();void 0!==e&&this.mse.setDuration(e/1e3)}updateStreamingParameters(){if(this.videoType&&this.emit("VideoTypeChange",this.videoType),this.playlist){const e=this.playlist.getDrmInfos();e.length>0&&this.emit("DrmInfoReceived",e)}this.emit("UtcStartTimeUpdate",this.timeline.getUtcStartTime());const e=this.timeline.getSeekableRange(),t=e.start/1e3,r=e.end/1e3;if("number"===typeof this.startPosition&&(this.startPosition=Math.min(Math.max(this.startPosition,t),r-ji.C)),this.mse){this.timeline.getIsDynamic()&&this.mse.setLiveSeekableRange(t,r).catch(e=>{this.attached&&(this.emitManifestoError(e,t,r),(0,Ct.L)(e))})}this.emit("SeekableRangeUpdate",{start:t,end:r}),this.emit("IsLowLatencyChange",this.isLowLatency)}async load(e){var t,r,i,n;if("mp4"===ke(this.url))return void await this.loadMP4(e);if(this.timeline.emitBufferedInfoChanged(),this.playlist||(this.playlist=new wr({url:this.url,timeline:this.timeline,fetcherParams:this.fetcherParams}),this.playlist.on("Error",e=>{this.emit("Error",e)}),this.playlist.on("DrmInfoReceived",e=>{this.emit("DrmInfoReceived",e)}),this.playlist.on("ServerTimeChange",e=>{this.emit("ServerTimeChange",e)}),this.playlist.on("ManifestUpdate",()=>{var e,t,r,i;this.emit("UtcStartTimeUpdate",this.timeline.getUtcStartTime());const n=this.timeline.getSeekableRange(),s=n.start/1e3,a=n.end/1e3;null==(e=this.mse)||e.setLiveSeekableRange(s,a).catch(e=>{this.attached&&(this.emitManifestoError(e,s,a),(0,Ct.L)(e))}),this.emit("SeekableRangeUpdate",{start:s,end:a});const o=null==(t=this.playlist)?void 0:t.getVideoType();this.videoType!==o&&(this.videoType=o,this.emit("VideoTypeChange",this.videoType),this.setDurationByVideoType());const l=this.timeline.isLowLatencyLive();this.isLowLatency!==l&&(this.isLowLatency=l,this.emit("IsLowLatencyChange",this.isLowLatency),this.isLowLatency&&this.sendEvent({name:"LowLatencyDetected",data:{url:this.url},shouldLogWhenDetached:!0})),null==(r=this.segmentFetcher)||r.setEmsgSchemeIdUris(null==(i=this.playlist)?void 0:i.getEmsgSchemeIdUris())})),this.playlistUpdater=null!=(t=this.playlistUpdater)?t:new Rr(this.playlist),this.playlist.isInitiallyLoaded()?this.updateStreamingParameters():(await this.playlistUpdater.update(),this.emit("ManifestLoaded")),this.destroyed)return;this.fetcher||(this.fetcher=new Sr(Ce({},this.fetcherParams,{storePath:e})),this.fetcher.setIsLL(this.timeline.isLowLatencyLive()),this.fetcher.isLL()?this.bandwidthEstimator.appendFetcher(this.fetcher):(this.fetcherProgressAccumulator=(0,Ot.RW)("web_mp_ttfb_estimator")?new li:new ti,this.fetcherProgressAccumulator.on("NetworkTrace",e=>{this.sendEvent({name:"NetworkTrace",data:e})}),this.fetcherProgressAccumulator.appendFetcher(this.fetcher),this.bandwidthEstimator.appendFetcher(this.fetcherProgressAccumulator)),null==(r=this.ttfbEstimator)||r.appendFetcher(this.fetcher));if(!this.cmafLogger){const e=e=>{this.sendEvent({name:"MediaFormatChange",data:e})};this.cmafLogger=new Hi(e,this.getMseConfig())}this.segmentFetcher||(this.segmentFetcher=new Qr(this.fetcher),this.segmentFetcher.setEmsgSchemeIdUris(null==(i=this.playlist)?void 0:i.getEmsgSchemeIdUris()),this.segmentFetcher.on("EmsgDetected",e=>{this.emit("EmsgDetected",e)}),this.segmentFetcher.on("ManifestUpdateRequired",()=>{var e;null==(e=this.playlistUpdater)||e.forceUpdate()}),this.segmentFetcher.on("SegmentLoaded",e=>{var t;null==(t=this.cmafLogger)||t.update(e.type,e.cmaf),this.emit("SegmentLoaded",e)}),this.segmentFetcher.on("BufferAllocationError",e=>{var t;const r=this.mediaState.currentTime?1e3*this.mediaState.currentTime:0,i=this.timeline.getSegmentsDebugInfo(r),n=(null==(t=this.mse)?void 0:t.getBufferedRanges())||{audio:[],video:[]};if((0,Ot.RW)("yasp_decrease_mse_buffer_on_allocation_error")){var s,a;const e=15;null==(s=this.mseFeeder)||s.setBufferGoal(e),null==(a=this.mseGc)||a.setBufferGoal(e)}const o=new gt.w({isFatal:!1,message:e.error.message,code:"YASP_BUFFER_ALLOCATION_ERROR",category:vt.q.EXCEPTION,details:{type:e.type,video:Ce({},i.video,{buffered:n.video}),audio:Ce({},i.audio,{buffered:n.audio})}});this.emit("Error",o)}));this.timelineFiller?this.timelineFiller.abortUseless():(this.timelineFiller=new Zr({timeline:this.timeline,mediaState:this.mediaState,playlist:this.playlist,bufferGoal:this.getBufferGoal(this.attached),abr:this.abr,segmentFetcher:this.segmentFetcher,bandwidthEstimator:this.bandwidthEstimator,ttfbEstimator:this.ttfbEstimator,sourceIndex:(0,Ve.IN)(this.url)}),this.timelineFiller.on("Error",e=>{this.emit("Error",e)}),this.timelineFiller.on("BandwidthEstimateUpdate",e=>{this.emit("BandwidthEstimateUpdate",e)}),this.timelineFiller.on("SegmentInProgress",()=>{this.bandwidthEstimator.addActiveSource(this.url)}),this.timelineFiller.on("NoSegmentsInProgress",()=>{this.bandwidthEstimator.removeActiveSource(this.url)}),this.timelineFiller.on("OutOfBytesLimit",()=>{var e;null==(e=this.timelineGc)||e.onOutOfBytesLimit()}),this.cron.plan(this.timelineFiller,100),this.initTimelineFillerBufferGoalAutoUpdate(),this.timelineFiller.setVideoState(Ee(this.mediaState,{currentTime:Math.max(null!=(n=this.getStartPosition())?n:0,0),duration:this.timeline.getDuration()/1e3})),this.timelineFiller.run());this.timelineGc||(this.timelineGc=new Xr(this.timeline,this.mediaState,30,()=>this.getBufferGoal()),this.cron.plan(this.timelineGc,1e3)),this.yaspWatchedTimeCollector||(this.yaspWatchedTimeCollector=new Mi(this.mediaState),this.yaspWatchedTimeCollector.on("WatchedTimeUpdated",e=>{let{watchedTime:t}=e;this.watchedTime=t}),this.cron.plan(this.yaspWatchedTimeCollector,100)),this.handleAttachedState();const s=this.getBufferGoal(this.attached),a=s===Number.MAX_SAFE_INTEGER?0:s;return await function(e,t){if(0===t)return Promise.resolve();const r=new Ir.B,i=s=>{s.total.reduce((e,t)=>{let{start:r,end:i}=t;return e+(i-r)},0)>=t&&(r.resolve(),e.off("BufferedInfoChanged",i),e.off("Destroy",n))},n=()=>{r.reject(new Error("Preloading aborted: timeline destroyed"))};return e.on("BufferedInfoChanged",i),e.on("Destroy",n),i(e.getBufferedInfo()),r.promise}(this.timeline,a),{startPosition:this.startPosition}}async loadMP4(e){var t,r,i;this.emit("ManifestLoaded");const n=new rn({url:this.url,timeline:this.timeline,fetcherParams:Ce({},this.fetcherParams,{storePath:e})});if(await n.update(),n.offset){null==(t=this.mse)||t.appendBuffer("audio",n.ftyp),null==(r=this.mse)||r.appendBuffer("audio",n.moov),null==(i=this.mse)||i.appendBuffer("audio",n.sidx);for(const e of null!=(s=n.segmentsInfo)?s:[]){var s,a;const t=await n.requestDataStream(n.offset+e.startByte,n.offset+e.endByte);if(!t)break;null==(a=this.mse)||a.appendBuffer("audio",t)}}}getBufferGoal(e){return void 0===e&&(e=!0),this.bufferGoalManager.getBufferGoal({watchedTime:this.watchedTime,currentTime:this.mediaState.currentTime||0,usePreloadBufferGoal:!e})}initTimelineFillerBufferGoalAutoUpdate(){this.stopTimelineFillerBufferGoalAutoUpdate();const e=()=>{var e;null==(e=this.timelineFiller)||e.setBufferGoal(this.getBufferGoal(this.attached))};this.timelineFillerBufferGoalInterval=setInterval(e,1e3),e()}stopTimelineFillerBufferGoalAutoUpdate(){this.timelineFillerBufferGoalInterval&&clearInterval(this.timelineFillerBufferGoalInterval)}async handleSeek(){var e,t,r,i,n,s,a,o,l;((0,Wr.y)(self)?await(0,_r._)(100):(0,Hr.V)(self)&&await(0,_r._)(0),null==(e=this.timelineFiller)||e.abortUseless(),null==(t=this.timelineFiller)||t.run(),null==(r=this.cmafLogger)||r.onSeek(),(0,Ot.RW)("yasp_no_source_abort_on_fake_seek"))?(null==(n=this.mse)||n.abort(),null==(s=this.mseFeeder)||s.abortUseless(),await(null==(a=this.mseGc)?void 0:a.forceRun(this.mediaState.currentTime).catch(e=>{if(this.attached)throw e}))):(await(null==(o=this.mseGc)?void 0:o.forceRun().catch(e=>{if(this.attached)throw e})),null==(l=this.mseFeeder)||l.abort());null==(i=this.mseFeeder)||i.run()}handleAttachedState(){var e,t,r;const i=this.attached?this.mediaState:Ee(this.mediaState,{currentTime:Math.max(null!=(e=this.startPosition)?e:0,0),duration:this.timeline.getDuration()/1e3});null==(t=this.timelineFiller)||t.setVideoState(i),null==(r=this.timelineGc)||r.setVideoState(i)}handleSeekableUpdater(){if(!this.seekableUpdater&&this.attached)return this.seekableUpdater=new Bi(this.timeline),this.seekableUpdater.on("SeekableUpdate",e=>{this.emit("SeekableRangeUpdate",e)}),void this.cron.plan(this.seekableUpdater,100);this.seekableUpdater&&!this.attached&&(this.cron.cancel(this.seekableUpdater),this.seekableUpdater.destroy(),this.seekableUpdater=void 0)}attach(e){return new Promise(t=>{this.performOnLoad(()=>{var r,i,n,s,a;if(this.attached=!0,this.updateSourceInfo(e),"mp4"===ke(this.url))return this.mse=null!=(a=this.mse)?a:new Ji({audio:'audio/mp4; codecs="'+Re(e)+'"'}),void t(this.mse.getObjectUrl());this.playlistUpdater&&this.playlistUpdater.update(),this.startPosition=null!=(r=this.startPosition)?r:ue(e),this.timelineGc&&this.cron.plan(this.timelineGc,1e3),this.handleAttachedState(),this.mse=null!=(i=this.mse)?i:new Ji(this.getMseConfig()),this.mse.on("Reset",e=>{var t;null==(t=this.mseFeeder)||t.reset(),this.emit("UpdateUrlObject",e)}),this.handleSeekableUpdater(),this.setDurationByVideoType(),this.updateStreamingParameters(),this.mseFeeder=null!=(n=this.mseFeeder)?n:new Nr(this.timeline,this.mediaState,this.mse,{bufferGoal:30,totalBufferSoftCap:Pr(),totalBufferHardCap:Cr()}),this.mseFeeder.on("QuotaExceededError",()=>{var e,t;null==(e=this.mseFeeder)||e.setBufferGoal(15),null==(t=this.mseGc)||t.setBufferGoal(15)}),this.mseFeeder.on("FatBuffer",e=>{this.sendEvent({name:"FatBuffer",data:{type:e},shouldLogWhenDetached:!0}),this.mseGc&&this.mseGc.run()}),this.mseFeeder.on("GorgedBuffer",e=>{this.sendEvent({name:"GorgedBuffer",data:{type:e},shouldLogWhenDetached:!0})}),this.mseGc=null!=(s=this.mseGc)?s:new Jr(this.mse,this.mediaState,10,Cr()),this.mseFeeder.on("Error",e=>{this.emit("Error",e)}),!this.targetLatencyUpdater&&this.timeline.isLowLatencyLive()&&(this.targetLatencyUpdater=new Vt({timeline:this.timeline,mediaState:this.mediaState}),this.targetLatencyUpdater.on("TargetLatencyUpdate",e=>{this.emit("TargetLatencyUpdated",e)}),this.targetLatencyUpdater.notifyTargetLatency()),this.cron.plan(this.mseFeeder,100),this.cron.plan(this.mseGc,1e4),this.sendEvent({name:"YaspSourceAttached",data:{url:e}}),t(this.mse.getObjectUrl())})})}setVideoTrack(e){this.timeline.setVideoTrack(e),void 0!==e&&this.handleSetTrack()}setAudioTrack(e){this.timeline.setAudioLanguage(e),void 0!==e&&this.handleSetTrack()}handleSetTrack(){var e;null==(e=this.mseGc)||e.forceRun().then(()=>{var e;null==(e=this.mseFeeder)||e.abort(),nn||this.emit("FlushMediaPipelineRequested")}).catch(e=>{var t;!this.attached||null!=(t=this.mse)&&t.isReloading()||(0,Ct.L)(e)})}setTextTrack(e){this.timeline.setTextTrack(e)}getVideoTracks(){return this.timeline.getVideoTracksInfo()}getAudioTracks(){return this.timeline.getAudioTracksInfo()}getTextTracks(){return this.timeline.getTextTracksInfo()}detach(){if(!this.attached)return;this.attached=!1,this.timelineGc&&this.cron.cancel(this.timelineGc),this.playlistUpdater&&this.playlistUpdater.disable();const{duration:e,currentTime:t}=this.mediaState;if(t&&t>=e){const e=this.timeline.getSeekableRange().start;this.startPosition=e/1e3}else this.startPosition=this.mediaState.currentTime;this.handleSeekableUpdater(),this.handleAttachedState(),this.mseFeeder&&(this.cron.cancel(this.mseFeeder),this.mseFeeder.destroy(),this.mseFeeder=void 0),this.mseGc&&(this.cron.cancel(this.mseGc),this.mseGc=void 0),this.mse&&(this.mse.destroy(),this.mse=void 0),this.yaspWatchedTimeCollector&&(this.cron.cancel(this.yaspWatchedTimeCollector),this.yaspWatchedTimeCollector.destroy(),this.yaspWatchedTimeCollector=void 0),this.targetLatencyUpdater&&(this.targetLatencyUpdater.destroy(),this.targetLatencyUpdater=void 0),this.sendEvent({name:"YaspSourceDetached",data:{url:this.url}})}setVideoElementSizes(e){null!=e.width||(e.width=1/0),null!=e.height||(e.height=1/0),this.abr.setVideoElementSizes(e)}static removeFromDisk(e){mr.removeDirectory(e)}destroy(){var e,t,r,i;(this.sendEvent({name:"YaspSourceDestroyCalled",data:{url:this.url}}),this.detach(),this.playlistUpdater&&(this.playlistUpdater.disable(),this.playlistUpdater=void 0),this.mseFeeder&&(this.cron.cancel(this.mseFeeder),this.mseFeeder.destroy(),this.mseFeeder=void 0),this.mseGc&&(this.cron.cancel(this.mseGc),this.mseGc=void 0),this.mse&&(this.mse.destroy(),this.mse=void 0),this.timelineFiller&&(this.cron.cancel(this.timelineFiller),this.timelineFiller.destroy(),this.timelineFiller=void 0,this.stopTimelineFillerBufferGoalAutoUpdate()),this.segmentFetcher&&(this.segmentFetcher.destroy(),this.segmentFetcher=void 0),this.timelineGc&&(this.cron.cancel(this.timelineGc),this.timelineGc=void 0),this.playlist&&(this.playlist.destroy(),this.playlist=void 0),this.fetcher)&&(null==(e=this.bandwidthEstimator)||e.removeFetcher(this.fetcher),null==(t=this.fetcherProgressAccumulator)||t.removeFetcher(this.fetcher),null==(r=this.ttfbEstimator)||r.removeFetcher(this.fetcher),this.fetcher.destroy(),this.fetcher=void 0);this.fetcherProgressAccumulator&&(this.fetcherProgressAccumulator.off("NetworkTrace"),null==(i=this.bandwidthEstimator)||i.removeFetcher(this.fetcherProgressAccumulator));this.yaspWatchedTimeCollector&&(this.cron.cancel(this.yaspWatchedTimeCollector),this.yaspWatchedTimeCollector.destroy(),this.yaspWatchedTimeCollector=void 0),this.fetcherProgressAccumulator=void 0,this.timeline.destroy(),this.abr.off("AbrDecisionChange"),this.destroyed=!0,this.sendEvent({name:"YaspSourceDestroyed",data:{url:this.url}}),super.destroy()}getMseConfig(){const e=this.timeline.getMimeTypes(),t=e.audio[0],r=e.video[0],i={};return t&&(i.audio=t),r&&(i.video=r),i}getDebugInfo(){const e=null!==this.mediaState.currentTime?1e3*this.mediaState.currentTime:void 0;try{var t,r,i,n,s,a,o,l,d,u,c,h,p,f,m,g,v,y;return JSON.parse(JSON.stringify({attached:this.attached,url:this.url,mediaState:this.mediaState,abr:this.abr.getDebugInfo(),bandwidthEstimator:this.bandwidthEstimator.getDebugInfo(),ttfbEstimator:null!=(t=null==(r=this.ttfbEstimator)?void 0:r.getDebugInfo())?t:null,playlist:null!=(i=null==(n=this.playlist)?void 0:n.getDebugInfo())?i:null,playlistUpdater:null!=(s=null==(a=this.playlistUpdater)?void 0:a.getDebugInfo())?s:null,mse:null!=(o=null==(l=this.mse)?void 0:l.getDebugInfo())?o:null,mseFeeder:null!=(d=null==(u=this.mseFeeder)?void 0:u.getDebugInfo())?d:null,mseGc:null!=(c=null==(h=this.mseGc)?void 0:h.getDebugInfo())?c:null,timeline:this.timeline.getDebugInfo(e),timelineFiller:null!=(p=null==(f=this.timelineFiller)?void 0:f.getDebugInfo())?p:null,timelineGc:null!=(m=null==(g=this.timelineGc)?void 0:g.getDebugInfo())?m:null,fetcher:null!=(v=null==(y=this.fetcher)?void 0:y.getDebugInfo())?v:null,userQuality:this.callbacks.getUserQuality(),maxAutoQuality:this.callbacks.getMaxAutoQuality(),wasSegmentLoaded:this.wasSegmentLoaded,maxStartTimestamp:this.maxStartTimestamp}))}catch(S){return{attached:String(this.attached),url:String(this.url),message:"failed to serialize debug info",error:String(S),stack:String(null==S?void 0:S.stack)}}}sendEvent(e){this.emit("Event",e)}getStats(){var e;return{bandwidth:null==(e=this.bandwidthEstimator)?void 0:e.getBandwidthEstimate()}}configure(e){var t,r,i,n,s;if(e.videoSizes&&this.setVideoElementSizes(e.videoSizes),null!=(t=e.tracks)&&t.videoTrackId&&this.setVideoTrack(e.tracks.videoTrackId),null!=(r=e.tracks)&&r.audioLang&&this.setAudioTrack(e.tracks.audioLang),void 0!==(null==(i=e.tracks)?void 0:i.textTrack)&&this.setTextTrack(e.tracks.textTrack),null!=(n=e.offlineParams)&&n.storePath){const{storePath:t,downloadedFragments:r}=e.offlineParams;var a;if(e.tracks&&!r)gr(t,null==(a=this.playlist)?void 0:a.getMpdXml(),e.tracks);this.getBufferGoal()===Number.MAX_SAFE_INTEGER&&0===e.bufferGoal&&vr(t),r&&(mr.downloadedFragments=r)}void 0!==e.bufferGoal&&this.bufferGoalManager.setConstantBufferGoal(e.bufferGoal),this.bandwidthEstimator&&e.defaultBandwidthEstimate&&this.bandwidthEstimator.setDefaultEstimate(e.defaultBandwidthEstimate),this.timeline.setPresentationDelay(e.presentationDelay);const o=this.bufferGoalManager.getSkippableFragments();this.bufferGoalManager.setSkippableFragments(null!=(s=e.skippableFragments)?s:o),void 0===e.maxStartTime||this.wasSegmentLoaded||(this.maxStartTimestamp=Date.now()+1e3*e.maxStartTime),this.updateFetchersParams(e)}updateFetchersParams(e){var t,r;this.fetcherParams=function(e,t){const r={};return e.offlineParams&&(r.storePath=e.offlineParams.storePath),void 0===e.withCredentials?_e({},t,r):(r.credentials=e.withCredentials?"include":"omit",r)}(e,this.fetcherParams),null==(t=this.fetcher)||t.setBaseParams(this.fetcherParams),null==(r=this.playlist)||r.setFetcherBaseParams(this.fetcherParams)}subscribeToTrackChanges(){this.timeline.on("VideoTrackChange",e=>{this.emit("VideoTrackChange",e)}),this.timeline.on("VideoTracksChange",e=>{this.emit("VideoTracksChange",e)}),this.timeline.on("AudioLanguageChange",e=>{this.emit("AudioLanguageChange",e)}),this.timeline.on("TextTrackChange",e=>{this.emit("TextTrackChange",e)})}}class an{constructor(){this.timesheet=[],this.started=!1,this.startTimesheetItem=e=>{clearInterval(e.intervalId),e.intervalId=self.setInterval(()=>{e.tasks.forEach(e=>{if(this.started)try{e.run()}catch(t){self.setTimeout(()=>{throw t})}})},e.interval)}}static stopTimesheetItem(e){clearInterval(e.intervalId),e.intervalId=void 0}obtainTimesheetItemByInterval(e){const t=this.timesheet.find(t=>t.interval===e);if(void 0!==t)return t;const r={interval:e,intervalId:void 0,tasks:[]};return this.started&&this.startTimesheetItem(r),this.timesheet.push(r),r}start(){this.started||(this.started=!0,this.timesheet.forEach(this.startTimesheetItem))}stop(){this.started&&(this.started=!1,this.timesheet.forEach(an.stopTimesheetItem))}plan(e,t){const r=this.obtainTimesheetItemByInterval(t);r.tasks.includes(e)||r.tasks.push(e)}cancel(e){for(let t=0;t<this.timesheet.length;t++){const r=this.timesheet[t],i=r.tasks.indexOf(e);-1!==i&&(r.tasks.splice(i,1),0===r.tasks.length&&(an.stopTimesheetItem(r),this.timesheet.splice(t,1),t-=1))}}destroy(){this.stop(),this.timesheet.length=0}}var on=r(7926),ln=r(45),dn=r(1647),un=r(7638),cn=r(9884),hn=r(1911),pn=r(153),fn=r(8493);class mn{constructor(e){this.storage=new Map,this.common={userQuality:bi.k,maxAutoQuality:Ai,defaultBandwidthEstimate:{value:fn.S,source:"default"}},this.onError=void 0,this.onError=e}checkAndClearConfigStorage(){if(this.storage.size<100)return;const e=this.storage.keys();for(let t=0;t<50;t++)this.storage.delete(e.next().value);this.onError(new Error("To many items in config storage! 100"))}updateCommonOptions(e){Object.keys(this.common).forEach(t=>{const r=e[t];void 0!==r&&(this.common[t]=r)})}add(e,t){const r=Ie({},this.storage.get(e),t);this.storage.set(e,r),this.updateCommonOptions(t),this.checkAndClearConfigStorage()}extract(e){const t=this.storage.get(e);return this.storage.delete(e),t}getCommonOptions(){return this.common}getDebugInfo(){return Ie({storage:this.storage,size:this.storage.size},this.common)}}class gn extends xe{}const vn=["objectUrl"];class yn{constructor(e){this.scope=e,this.yaspRpc=void 0,this.cron=new an,this.sourceManager=void 0,this.resourceTimingsMonitor=void 0,this.rpcIncomingHistory=new hn.d(pn.K),this.rpcOutgoingHistory=new hn.d(pn.K),this.handleRpcError=e=>{const t=new gt.w({code:e.code===ln.v.METHOD_NOT_FOUND?"YASP_UNKNOWN_METHOD":"YASP_UNKNOWN_ERROR",details:{error:e},isFatal:!1,category:vt.q.EXCEPTION,message:e.message});this.sendEventAndSaveHistory({method:"error",params:{source:null,error:JSON.stringify(t)}})},this.configStorage=new mn(this.handleRpcError),this.getMaxAutoQuality=()=>this.configStorage.getCommonOptions().maxAutoQuality,this.getUserQuality=()=>this.configStorage.getCommonOptions().userQuality,this.getDefaultBandwidth=()=>this.configStorage.getCommonOptions().defaultBandwidthEstimate,this.yaspRpc=new on.A(t=>{e.postMessage(t,(0,dn._)(t))})}init(){this.cron.start(),this.yaspRpc.registerHandler("initWorker",e=>((0,Ot.Vc)(e),this.sourceManager=new Be(e.sourceLimit,(e,t)=>{this.sendEventAndSaveHistory({method:"event",params:{name:"YaspReleasedSrcAutomatically",data:{sourceLimit:t,urls:e},shouldLogWhenDetached:!0}})}),setTimeout(()=>{const e="undefined"===typeof document;this.sendEventAndSaveHistory({method:"event",params:{name:e?"YaspWorkerEnabled":"YaspWorkerDisabled",data:void 0,shouldLogWhenDetached:!0}})}),this.initResourceTimingsMonitor(e.perfLogUrl),{done:!0,value:""})),this.registerHandlerWithHistorySaving("detach",e=>{let{source:t}=e;const r=this.getSourceObject(t);return r&&(r.off("VideoTrackChange"),r.off("VideoTracksChange"),r.off("AudioLanguageChange"),r.off("TextTrackChange"),r.off("BandwidthEstimateUpdate"),r.off("MaxCapAllowedVideoTrackUpdate"),r.off("ServerTimeChange"),r.detach()),{done:!0,value:void 0}}),this.registerHandlerWithHistorySaving("destroy",e=>{var t,r;let{source:i,reason:n}=e;const s="ExternalApi"===n?"YaspReleaseSrcManuallyCalled":"YaspReleaseSrcOnErrorCalled",a="ExternalApi"===n?{url:i,sourceCount:null!=(t=null==(r=this.sourceManager)?void 0:r.getSourceCount())?t:0}:{url:i};if(this.sendEventAndSaveHistory({method:"event",params:{name:s,data:a,shouldLogWhenDetached:!0}}),this.getSourceObject(i)){var o;null==(o=this.sourceManager)||o.removeSource(i);const e="ExternalApi"===n?"YaspReleasedSrcManually":"YaspReleasedSrcOnError";this.sendEventAndSaveHistory({method:"event",params:{name:e,data:a,shouldLogWhenDetached:!0}})}if(i.startsWith("streams")){const e=i.split("/").pop();e&&sn.removeFromDisk(e)}return{done:!0,value:void 0}}),this.registerHandlerWithHistorySaving("requestDebugInfo",e=>{let{source:t}=e;return this.sourceManager?{done:!0,value:{yaspSrc:null!=t?t:null,sources:this.sourceManager.getAllSources().map(e=>e.getDebugInfo()),outgoingHistory:this.rpcOutgoingHistory.toArray(),incomingHistory:this.rpcIncomingHistory.toArray(),configStorage:this.configStorage.getDebugInfo()}}:{done:!0,value:void 0}}),this.registerHandlerWithHistorySaving("configureSource",e=>{let{source:t,config:r}=e;try{const e=this.getSourceObjectOrThrowException(t,"configureSource");this.configStorage.updateCommonOptions(r),e.configure(r)}catch(i){const e=(0,Ve.Hi)(t);this.configStorage.add(e,r)}return{done:!0,value:void 0}}),this.registerHandlerWithHistorySaving("attach",async e=>{let{source:t}=e;const r=this.obtainSource(t);r.on("VideoTrackChange",e=>{this.sendEventAndSaveHistory({method:"changeSelectedVideoTrack",params:{source:t,trackId:e}})}),r.on("AudioLanguageChange",e=>{this.sendEventAndSaveHistory({method:"changeSelectedAudioLanguage",params:{source:t,language:e}})}),r.on("BandwidthEstimateUpdate",e=>{this.sendEventAndSaveHistory({method:"updateBandwidthEstimate",params:{bandwidth:e}})}),r.on("MaxCapAllowedVideoTrackUpdate",e=>{this.sendEventAndSaveHistory({method:"updateMaxCapAllowedVideoTrack",params:{maxCapAllowedVideoTrack:e}})}),r.on("DrmInfoReceived",e=>{this.sendEventAndSaveHistory({method:"applyDrmInfos",params:{source:t,drmInfos:e}})}),r.on("FlushMediaPipelineRequested",()=>{this.sendEventAndSaveHistory({method:"flushMediaPipeline",params:{source:t}})}),r.on("ServerTimeChange",e=>{this.sendEventAndSaveHistory({method:"updateServerTime",params:{source:t,time:e}})}),r.on("StreamEndTimeUpdate",e=>{this.yaspRpc.sendEvent({method:"updateStreamEndTime",params:{source:t,time:e}})});const i=await r.attach(t);return this.sendEventAndSaveHistory({method:"setStartInfo",params:{source:t,objectUrl:i,startPosition:r.getStartPosition()}}),this.yaspRpc.sendEvent({method:"changeVideoTracks",params:{source:t,added:r.getVideoTracks().map(e=>({source:t,track:Oe({},e,{bitrate:e.bitrate?e.bitrate/1e3:void 0})})),removed:[]}}),r.on("VideoTracksChange",e=>{let{added:r,removed:i}=e;this.yaspRpc.sendEvent({method:"changeVideoTracks",params:{source:t,added:r.map(e=>({source:t,track:Oe({},e,{bitrate:e.bitrate?e.bitrate/1e3:void 0})})),removed:i}})}),r.getAudioTracks().forEach(e=>{this.sendEventAndSaveHistory({method:"addAudioTrack",params:{source:t,track:Oe({},e,{bitrate:e.bitrate?e.bitrate/1e3:void 0})}})}),r.getTextTracks().forEach(e=>{this.sendEventAndSaveHistory({method:"addTextTrack",params:{source:t,track:{id:e.id,kind:e.kind,label:e.label,language:e.language||"unknown"}}})}),{done:!0,value:void 0}}),this.registerHandlerWithHistorySaving("load",async e=>{let{source:t,storePath:r}=e;const i=this.obtainSource(t);await i.load(r);return{done:!0,value:{video:i.getVideoTracks(),audio:i.getAudioTracks(),text:i.getTextTracks()}}}),this.registerHandlerWithHistorySaving("seeking",async e=>{let{source:t}=e;const r=this.obtainSource(t);return await r.handleSeek(),{done:!0,value:void 0}}),this.scope.addEventListener("message",e=>{"object"===typeof e.data&&("string"!==typeof e.data.method||"object"===typeof e.data.params&&null!==e.data.params)&&this.yaspRpc.handleMessage(e)})}initResourceTimingsMonitor(e){void 0!==e&&void 0===this.resourceTimingsMonitor&&"undefined"===typeof document&&(this.resourceTimingsMonitor=new un.$({sendLog:(t,r)=>{const i=(0,cn.Y)(t);if(!i)return;const n=new URL(e);(0,Ut.J)(r).forEach(e=>{let[t,r]=e;void 0!==r&&n.searchParams.set(t,r)}),or(n.href,{method:"POST",keepalive:!0,body:i})}}),this.resourceTimingsMonitor.attach(self))}getSourceObject(e){if(!this.sourceManager)throw new Error("Source Manager not inited!");return this.sourceManager.takeSource(e)}getSourceObjectOrThrowException(e,t){const r=this.getSourceObject(e);if(void 0===r)throw new Error("["+t+"] Unknown source "+e+".");return r}sendEventAndSaveHistory(e){const{method:t,params:r}=e;if(!["updateBufferedInfo","updateSeekableRange"].includes(t)){let e=Oe({},r);if("objectUrl"in e){e=function(e,t){if(null==e)return{};var r,i,n={},s=Object.keys(e);for(i=0;i<s.length;i++)r=s[i],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,vn)}this.rpcOutgoingHistory.push({method:t,params:e,time:Date.now()})}return this.yaspRpc.sendEvent(e)}registerHandlerWithHistorySaving(e,t){this.yaspRpc.registerHandler(e,r=>(this.rpcIncomingHistory.push({method:e,params:r,time:Date.now()}),t(r)))}obtainSource(e){var t,r,i;const n=null!=(t=null==(r=this.sourceManager)?void 0:r.takeSource(e))?t:this.createSource(e);return null==(i=this.sourceManager)||i.putSource(e,n),n}createSource(e){let t,r,i;const n=(0,Ve.Hi)(e),s={getMaxAutoQuality:this.getMaxAutoQuality,getUserQuality:this.getUserQuality,getDefaultBandwidth:this.getDefaultBandwidth};"mp4"===ke(e)?[t,r,i]=this.createAudioSource(e,n,s):[t,r,i]=this.createVideoSource(e,n,s);const a=this.configStorage.extract(n);return a&&t.configure(a),t.on("Error",t=>{this.sendEventAndSaveHistory({method:"error",params:{source:e,error:JSON.stringify(t)}})}),t.on("BufferedInfoChanged",t=>{this.sendEventAndSaveHistory({method:"updateBufferedInfo",params:{bufferedInfo:t,source:e,duration:r.duration}})}),t.on("Event",t=>{this.sendEventAndSaveHistory({method:"event",params:Oe({source:e},t)})}),t.on("IsLowLatencyChange",t=>{this.sendEventAndSaveHistory({method:"changeIsLowLatency",params:{source:e,isLowLatency:t}})}),t.on("EmsgDetected",t=>{this.sendEventAndSaveHistory({method:"emsg",params:{source:e,emsg:t}})}),t.on("SegmentLoaded",t=>{this.sendEventAndSaveHistory({method:"logSegmentLoaded",params:{source:e,info:t}})}),t.on("TargetLatencyUpdated",t=>{this.sendEventAndSaveHistory({method:"updateTargetLatency",params:{source:e,latency:t}})}),t.on("UtcStartTimeUpdate",t=>{this.sendEventAndSaveHistory({method:"updateUtcStartTime",params:{source:e,time:t}})}),t.on("SeekableRangeUpdate",t=>{let{start:r,end:i}=t;this.sendEventAndSaveHistory({method:"updateSeekableRange",params:{source:e,start:r,end:i}})}),t.on("UpdateUrlObject",t=>{this.sendEventAndSaveHistory({method:"urlObjectUpdated",params:{source:e,objectUrl:t}})}),t.on("Destroy",()=>{var e;null==(e=i)||e.destroy(),i=null}),t}createVideoSource(e,t,r){const i=new Si,n=i,s=new Me(t,this.scope,i),a=new sn(this.cron,e,n,r),o=this.configStorage.extract(t);o&&a.configure(o),a.on("VideoTypeChange",t=>{this.sendEventAndSaveHistory({method:"changeVideoType",params:{source:e,videoType:t}})}),a.on("CuesAdded",t=>{let{cues:r,label:i}=t;this.sendEventAndSaveHistory({method:"cuesAdded",params:{source:e,cues:r,label:i}})});const l=e=>{let{source:r,devicePixelRatio:n}=e;return(0,Ve.Hi)(r)!==t?{done:!1,value:void 0}:(i.devicePixelRatio=n,{done:!0,value:void 0})};return this.yaspRpc.registerHandler("setDevicePixelRatio",l),a.on("Destroy",()=>{this.yaspRpc.removeHandler("setDevicePixelRatio",l)}),[a,n,s]}createAudioSource(e,t,r){const i=new Ei,n=i,s=new gn(t,this.scope,i);return[new sn(this.cron,e,n,r),n,s]}}const Sn=De;"object"!==typeof window&&(self.window=self,De())},5207:()=>{!function(e){function t(i){if(r[i])return r[i].exports;var n=r[i]={i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,t),n.l=!0,n.exports}var r={};t.m=e,t.c=r,t.d=function(e,r,i){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:i})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var n in e)t.d(i,n,function(t){return e[t]}.bind(null,n));return i},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=5)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){void 0===e&&(e=window),"Ya"in e||(e.Ya={}),"OTT"in e.Ya||(e.Ya.OTT={}),"PlayerLoader"in e.Ya.OTT||(e.Ya.OTT.PlayerLoader={})}},function(e,t,r){"use strict";function i(){}var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},s=this&&this.__rest||function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]])}return r},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=a(r(2)),l=a(r(3)),d=(i.prototype.init=function(e){var t=(e.source||{}).context;if(!t)return this.useBasePlayer(e);var r=t.contentTypeId,i=t.licenses,n=(void 0===i?[]:i)[0];if(n&&!("active"in n))return this.usePlaceholder(e);if(20===r||21===r)return this.useWrapper(e);var s="production"===e.envName?"production":"testing",a=window.Ya.OTT.buildTrackings(e.source.context,{env:s});return e.source.trackings=o.default(a,e.source.trackings),this.useBasePlayer(e,!0)},i.prototype.usePlaceholder=function(e){var t=e.source,r=t.context,i=r.container,a=void 0===i?{}:i,o=r.licenses[0],d=s(r,["container","licenses"]),u=t.preview;e.element="string"==typeof e.element?document.getElementById(e.element):e.element;var c=this.getPlaceholderUrl();return(this.placeholderExists(a)?Promise.resolve():l.default(c,document.head)).then((function(){return window.Ya.OTT.Placeholder.main(n(n(n({container:a,thumbnail:u},d),o),{config:e}))})).then((function(t){return t.render(e.element)}))},i.prototype.useBasePlayer=function(e,t){void 0===t&&(t=!1);var r=e.version,i=e.useBetaStatic,n=this.getPlayerBundle(r,i);return(this.baseApiExists()?Promise.resolve():l.default(n,document.head)).then((function(){return window.Ya.playerApi.init(e)})).then((function(e){return{api:e,withWrapper:!1,withTrackings:t}}))},i.prototype.useWrapper=function(e){var t=this.getWrapperUrl();return(this.wrapperExists()?Promise.resolve():l.default(t,document.head)).then((function(){return window.Ya.OTT.Player.init(e)})).then((function(e){return{api:e,withWrapper:!0,withTrackings:!0}}))},i.prototype.baseApiExists=function(){return!!window.Ya&&!!window.Ya.playerApi},i.prototype.wrapperExists=function(){return!(!window.Ya||!window.Ya.OTT||!window.Ya.OTT.Player)},i.prototype.placeholderExists=function(e){return(void 0===e?{}:e).context,!!(window.Ya&&window.Ya.OTT&&window.Ya.OTT.Placeholder)&&!!window.Ya.OTT.Placeholder.main},i.prototype.getWrapperUrl=function(){return"https://yastatic.net/s3/kinopoisk-frontend/ott/player-wrapper/"+i.WRAPPER_VERSION+"/ott-player-wrapper.js"},i.prototype.getPlaceholderUrl=function(){return"https://yastatic.net/s3/kinopoisk-frontend/ott/player-placeholder/"+i.PLACEHOLDER_VERSION+"/ott-player-placeholder.js"},i.prototype.getPlayerBundle=function(e,t){return("http:"===location.protocol?"http://":"https://")+(t?"betastatic.yastatic.net":"yastatic.net")+(e?"/yandex-video-player-iframe-api-bundles/"+e+"/js/player-api-loader.js":"/yandex-video-player-iframe-api/js/player-api-loader.js")},i.WRAPPER_VERSION="4.0.1",i.PLACEHOLDER_VERSION="1.0.1",i);t.default=d},function(e,t,r){"use strict";function i(e){return n.apply(void 0,e.map((function(e){return{trackingEvents:e}}))).trackingEvents}function n(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=e[0]?e[0].trackingEvents:{};Array.isArray(r)&&(r=i(r));for(var n=1;n<e.length;n++)!function(t){var n=e[t]?e[t].trackingEvents:{};Array.isArray(n)&&(n=i(n)),Object.keys(n).forEach((function(e){var t=n[e];Array.isArray(t)&&(e in r?Array.isArray(r[e])&&(r[e]=r[e].concat(t)):r[e]=t)}))}(n);return{trackingEvents:r}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return new Promise((function(r,i){var n=document.createElement("script");n.type="text/javascript",n.src=e,n.crossOrigin="anonymous",n.onload=r,n.onerror=i,t.appendChild(n)}))}},function(e,t,r){"use strict";r.r(t);var i="__VAL__",n=["yandexuid","position","serviceName","reqid","path","sid","uuid","kpId","kpTrailerId","contentTypeId","monetizationModel","subscriptionType","puid","page","domain","vars","testIds","eventId","subProfileId","buildTimestamp","pathId","deviceId","appVersion","platformOs","platformVersion","platformVendor","platformModel","platformVendorDeviceId","platformName","psid","fromBlock","fromBlockPosition","fromBlockItemPosition","fromBlockAction","fromBlockMLSessionId","fromBlockStartPage","fromBlockEndPage","fromBlockExternalLink","isLive"],s=["setSource","init","error","adStart","adEnd","heartbeat","watchedTime","viewed"],a={film:{default:s,kp:s},trailer:{default:s},channel:{default:s},episode:{default:s},"vod-broadcast-episode":{default:s},"music-clip":{default:s},"short-video":{default:s},"ott-trailer":{default:s}},o={1:"channel-family",2:"channel",3:"episode",4:"vod-library",5:"vod-episode",6:"tv-series",7:"tv-season",8:"black-window",9:"out-of-tv-channel",10:"type-folder",11:"zen-namespace",12:"zen-library",13:"zen-episode",14:"yandex-disribution-library",15:"yandex-disribution-episode",16:"emergency-black-window",17:"cv-black-window",18:"yandex-market-library",19:"yandex-market-episode",20:"ott-movie",21:"ott-episode",22:"kd-feed-episode",24:"sport-episode",25:"announce",30:"ntv-vod-library",31:"ntv-vod-movie",32:"ntv-vod-series",33:"ntv-vod-series-season",34:"ntv-vod-series-season-episode",35:"ott-multipart",36:"ott-part",37:"ott-trailer",38:"ott-collection",39:"ott-collection-item",40:"high-light",41:"user-episode",42:"vod-news",43:"vod-broadcast",44:"vod-news-episode",45:"vod-broadcast-episode",46:"snapshot-tv-episode",47:"kp-trailer",48:"ya-news",49:"self-service-bw-window",50:"main-black-window",51:"music-clip",82:"ott_linked_video",83:"ott_music_karaoke",84:"ott_linked_video_parent",85:"ott_music_karaoke_parent",86:"ott-vod-library",87:"ott_linked_trailer",88:"ott_linked_music_clip",122:"ott-video-episode"},l="content_duration_",d=[["1","content_start"],["10000",l+"10"],["20000",l+"20"],["30000",l+"30"],["40000",l+"40"],["50000",l+"50"],["60000",l+"60"],["120000",l+"120"]],u="VIDEO_",c=[["25",u+"25"],["50",u+"50"],["75",u+"75"],["90",u+"90"],["99",u+"END"]];t.default=function(e,t){var r;"contentTypeID"in(r=e)&&(r.contentTypeId=r.contentTypeID),e=function(e){for(var t=0;t<n.length;t++){var r=n[t];void 0===e[r]&&(e[r]="domain"===r?document.location.hostname:"buildTimestamp"===r?Date.now():"-")}return e}(e=r);var s,l,u,h,p,f,m=(l={testing:{counterId:45961911,kpCounterId:48924764,vpCounterId:45151398,spCounterId:51357310},production:{counterId:45913512,kpCounterId:48924740,vpCounterId:31713861,spCounterId:51357310}})[s=t.env]?l[s]:l.testing,g=(h={testing:{ottTrackingsBackend:"https://tracking-testing.ott.yandex.net/v1/",metrikaBackend:"https://mc.yandex.ru/watch/",redirlogBackend:"https://yandex.ru/clck/jclck/"},production:{ottTrackingsBackend:"https://tracking.ott.yandex.net/v1/",metrikaBackend:"https://mc.yandex.ru/watch/",redirlogBackend:"https://yandex.ru/clck/jclck/"}})[u=t.env]?h[u]:h.testing,v={},y=e.serviceName,S=(p=e.contentTypeId)in(f={47:"trailer",20:"film",21:"film",51:"music-clip",87:"channel",88:"channel",122:"short-video",37:"ott-trailer",3:"episode",45:"vod-broadcast-episode"})?f[String(p)]:"film";return(y in a[S]?a[S][y]:a[S].default).forEach((function(e){v[e]=function(e,t,r){var i,n,s,a,o,l,u=[];"trailer"===t?(i="{{metrikaBackend}}{{vpCounterId}}?page-ref=yandex.ru&page-url=goal://{{domain}}/","init"===e?u.push('{{metrikaBackend}}{{vpCounterId}}?page-ref=yandex.ru&site-info={"kp_trailers":{"host":{"{{serviceName}}":{"{{kpId}}":{"{{uuid}}":"{{kpTrailerId}}"}}}}}&page-url=goal://{{domain}}/TRAILER_START'):"adStart"===e?u.push(i+"TRAILER_AD_START"):"adEnd"===e?u.push(i+"TRAILER_AD_END"):"viewed"===e&&u.push([i+"TRAILER_50",{percent:50}],[i+"TRAILER_90",{percent:90}])):(n='{{metrikaBackend}}<<COUNTER_NAME>>?page-ref=yandex.ru&site-info={"{{serviceName}}":{"{{fromBlock}}":{"<<EVENT_NAME>>":{"{{uuid}}":{"{{position}}":"{{monetizationModel}}"}}}}}',"setSource"!==e&&"init"!==e||(o=(a=n.replace("<<EVENT_NAME>>","video_start")).replace("<<COUNTER_NAME>>","{{counterId}}"),u.push(o+"&page-url=goal://{{domain}}/VIDEO_START"),"init"===e&&"kp"===r&&(s=a.replace("<<COUNTER_NAME>>","{{kpCounterId}}"),u.push(s+"&page-url=goal://{{domain}}/VIDEO_START"))),"adStart"!==e&&"adEnd"!==e||(o=(a=n.replace("<<EVENT_NAME>>",h="adStart"===e?"VIDEO_AD_START":"VIDEO_AD_END")).replace("<<COUNTER_NAME>>","{{counterId}}"),u.push(o),"kp"===r&&(l=a.replace("<<COUNTER_NAME>>","{{kpCounterId}}"),u.push(l))),"watchedTime"===e&&d.forEach((function(e){var t={offset:Number(e[0])},i=n.replace("<<EVENT_NAME>>",e[1]),s=i.replace("<<COUNTER_NAME>>","{{counterId}}");u.push([s,t]),"kp"===r&&u.push([i.replace("<<COUNTER_NAME>>","{{kpCounterId}}"),t]),"ya-sport"===r&&"120000"===e[0]&&u.push([i.replace("<<COUNTER_NAME>>","{{spCounterId}}")+"&page-url=goal://"+r+"/VIDEO_STREAM_2MIN",t])})),"viewed"===e&&c.forEach((function(e){var t={percent:Number(e[0])},i=(n+"&page-url=goal://{{domain}}/<<EVENT_NAME>>").replace(/<<EVENT_NAME>>/g,e[1]),s=i.replace("<<COUNTER_NAME>>","{{counterId}}");u.push([s,t]),"kp"===r&&u.push([i.replace("<<COUNTER_NAME>>","{{kpCounterId}}"),t])})));var h,p='{{ottTrackingsBackend}}watch?data={"position":"{{position}}","fromBlock":"{{fromBlock}}","serviceName":"{{serviceName}}","uuid":"{{uuid}}","puid":"{{puid}}","sid":"{{sid}}","vSid":"{{vsid}}","yaUID":"{{yandexuid}}","monetizationModel":"{{monetizationModel}}","contentTypeName":"{{contentTypeName}}","device-type":"{{device-type}}","device-type-tns":"{{device-type-tns}}","subscriptionType":"{{subscriptionType}}","page":"{{page}}","testIds":"{{testIds}}","eventId":"{{eventId}}","subProfileId":"{{subProfileId}}","deviceId":"{{deviceId}}","appVersion":"{{appVersion}}","platformOs":"{{platformOs}}","platformVersion":"{{platformVersion}}","platformVendor":"{{platformVendor}}","platformModel":"{{platformModel}}","platformVendorDeviceId":"{{platformVendorDeviceId}}","platformName":"{{platformName}}","psid":"{{psid}}","buildTimestamp":"{{buildTimestamp}}","pathId":"{{pathId}}","fromBlockPosition":"{{fromBlockPosition}}","fromBlockItemPosition":"{{fromBlockItemPosition}}","fromBlockAction":"{{fromBlockAction}}","fromBlockMLSessionId":"{{fromBlockMLSessionId}}","fromBlockStartPage":"{{fromBlockStartPage}}","fromBlockEndPage":"{{fromBlockEndPage}}","fromBlockExternalLink":"{{fromBlockExternalLink}}","isLive":"{{isLive}}"';if("setSource"!==e&&"init"!==e||u.push(p+',"eventType":"video_start","eventCount":"-","audio-track-lang":"{{audio-track-lang}}","audio-track-name":"{{audio-track-name}}","text-track-lang":"{{text-track-lang}}","text-track-name":"{{text-track-name}}"}'),"error"===e&&u.push(p+',"errorCode":"{{error-code}}","eventType":"player_error","eventCount":"-"}'),"adStart"!==e&&"adEnd"!==e||(h="adStart"===e?"VIDEO_AD_START":"VIDEO_AD_END",u.push(p+',"eventType":"'+h+'","eventCount":"-"}')),"heartbeat"===e){var f=void 0;switch(t){case"channel":case"short-video":case"ott-trailer":case"trailer":f=1e4;break;case"music-clip":f=3e4;break;default:f=6e4}u.push([p+',"timestamp":"{{timestamp}}","vts":"{{vts}}","fts":"{{fts}}","fullscreen":"{{fullscreen}}","eventType":"heartbeat","eventCount":"'+f+'","audio-track-name":"{{audio-track-name}}","audio-track-lang":"{{audio-track-lang}}","text-track-name":"{{text-track-name}}","text-track-lang":"{{text-track-lang}}","mute":"{{muted}}"}',{delay:f,offset:f}])}return"watchedTime"===e&&d.forEach((function(e){var t={offset:Number(e[0])};u.push([p+',"eventType":"'+e[1]+'","eventCount":"'+e[0]+'","audio-track-lang":"{{audio-track-lang}}","audio-track-name":"{{audio-track-name}}","text-track-lang":"{{text-track-lang}}","text-track-name":"{{text-track-name}}"}',t])})),"viewed"===e&&c.forEach((function(e){var t={percent:Number(e[0])};u.push([p+',"eventType":"'+e[1]+'","eventCount":"'+("99"==e[0]?"100":e[0])+'"}',t])})),u}(e,S,y)})),e=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=e[0],i=1;i<e.length;i++){var n=e[i];if("object"==typeof n)for(var s in n)r[s]=n[s]}return r}(e,m,g,{contentTypeName:o[e.contentTypeId]||"unknown"}),{trackingEvents:JSON.parse(function(e,t,r){void 0===t&&(t={});var n={}.macros,s=void 0===n?"{{"+i+"}}":n,a={};Object.keys(t).forEach((function(e){var r=s.replace(i,e);a[r]=t[e]}));var o=new RegExp("("+Object.keys(a).join("|")+")","ig");return("string"==typeof e?e:JSON.stringify(e)).replace(o,(function(e){return e in a?encodeURI(a[e]):e}))}(v,e))}}},function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var n=i(r(4)),s=i(r(0)),a=i(r(1));s.default(),window.Ya.OTT.buildTrackings=n.default,window.Ya.OTT.PlayerLoader={init:function(e){return(new a.default).init(e)}}}])},6197:(e,t)=>{"use strict";t.Z=function(e,t,r){for(var i=e.length+t.length,n=new Array(i),s=0,a=0,o=0;o<i;){var l=s>=e.length,d=a>=t.length;!l&&(d||r(e[s],t[a])<0)?(n[o]=e[s],s++):(n[o]=t[a],a++),o++}return n}},8533:function(e,t,r){"use strict";function i(e){return-1===["tr","id","fi","lt","pl","et","lv"].indexOf(e)?"ru":"en"}function n(e,t){for(var r=[],i=e.length,n=0;n<i;){var s=e.indexOf("{",n);if(-1===s)return r.push(e.substring(n)),r;var a=e.indexOf("}",s);if(-1===a)return r.push(e.substring(n)),r;r.push(e.substring(n,s),t[e.substring(s+1,a)]),n=a+1}return r}function s(e,t,r){void 0===r&&(r={});var s=function(e,t){var r,i,n;try{for(var s=a(D),o=s.next();!o.done;o=s.next()){if((n=e[o.value])&&t in n)return n[t]}}catch(l){r={error:l}}finally{try{o&&!o.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}return t}(e,t);return"string"===typeof s?n(s,r):function(e,t){var r=D.find((function(e){return Boolean(O[e])}))||i(D[0]);return n((0,O[r])(t.count,e),t)}(s,r)}var a=this&&this.__values||function(e){var t="function"===typeof Symbol&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.resolveI18nLang=t.getI18nLang=t.setI18nLang=t.i18nRaw=void 0;var l=o(r(6606)),d=o(r(701)),u=o(r(5480)),c=o(r(6587)),h=o(r(9753)),p=o(r(650)),f=o(r(205)),m=o(r(7228)),g=o(r(599)),v=o(r(8275)),y=o(r(2598)),S=o(r(7424)),E=o(r(3175)),b=o(r(6187)),A=o(r(4120)),T=o(r(4701)),_=o(r(9254)),w=o(r(9970)),k=o(r(3878)),R=o(r(3397)),P=o(r(1778)),C=o(r(3025)),I=o(r(4256)),O={be:l.default,en:d.default,id:u.default,kk:c.default,ru:h.default,tr:p.default,tt:f.default,uk:m.default,uz:g.default,de:v.default,es:y.default,hy:S.default,ka:E.default,ky:b.default,sr:A.default,fr:T.default,lv:_.default,lt:w.default,ro:k.default,fi:R.default,az:P.default,zh:C.default,he:I.default},D=["ru"];t.default=function(e){return function(t,r){return void 0===r&&(r={}),s(e,t,r).join("")}},t.i18nRaw=function(e){return function(t,r){return void 0===r&&(r={}),s(e,t,r)}},t.setI18nLang=function(e){D="string"===typeof e?[e,i(e),"ru"]:e},t.getI18nLang=function(){return D[0]},t.resolveI18nLang=function(e,t,r){var i=t;if(-1===e.indexOf(i))switch(r){case"com":i="en";break;case"com.tr":i="tr";break;default:i="ru"}return i}},1778:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var n=i(r(701));t.default=n.default},6606:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var n=i(r(9753));t.default=n.default},8275:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var n=i(r(701));t.default=n.default},701:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return e?1===e?t.one:t.some:t.none||""}},2598:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var n=i(r(701));t.default=n.default},3397:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var n=i(r(701));t.default=n.default},4701:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var n=i(r(9753));t.default=n.default},4256:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var n=i(r(701));t.default=n.default},7424:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var n=i(r(701));t.default=n.default},5480:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return e?t.some:t.none||""}},3175:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var n=i(r(701));t.default=n.default},6587:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r=e%10,i=e%100;return e?1===r&&11!==i?t.one:r>1&&r<5&&(i<10||i>20)?t.some:t.many||"":t.none||""}},6187:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var n=i(r(9753));t.default=n.default},9970:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var n=i(r(9753));t.default=n.default},9254:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var n=i(r(9753));t.default=n.default},3878:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var n=i(r(9753));t.default=n.default},9753:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r=e%10,i=e%100;return e?1===r&&11!==i?t.one:r>=2&&r<=4&&12!==i&&13!==i&&14!==i?t.some:t.many||"":t.none||""}},4120:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var n=i(r(9753));t.default=n.default},650:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r=e%10,i=e%100;return e?1===r&&11!==i?t.one:r>1&&r<5&&(i<10||i>20)?t.some:t.many||"":t.none||""}},205:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r=e%10,i=e%100;return e?1===r&&11!==i?t.one:r>1&&r<5&&(i<10||i>20)?t.some:t.many||"":t.none||""}},7228:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var n=i(r(9753));t.default=n.default},599:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r=e%10,i=e%100;return e?1===r&&11!==i?t.one:r>1&&r<5&&(i<10||i>20)?t.some:t.many||"":t.none||""}},3025:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var n=i(r(701));t.default=n.default},8636:function(e,t){var r,i,n;"undefined"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView=function(e){return null!=e&&null!=e.__proto__&&e.__proto__.__proto__===Int8Array.prototype.__proto__}),"undefined"===typeof Math.imul&&(Math.imul=function(e,t){return(4294901760&e)*(65535&t)+(65535&e)*(0|t)|0}),i=[t],void 0===(n="function"===typeof(r=function(e){"use strict";function t(e){return e.length-1|0}function r(e,t){if(null==t){var r=0,i=e.length-1|0;if(r<=i)do{var n=r;if(r=r+1|0,null==e[n])return n}while(r<=i)}else{var s=0,a=e.length-1|0;if(s<=a)do{var o=s;if(s=s+1|0,st(t,e[o]))return o}while(s<=a)}return-1}function i(e,t,r,i,n,s,a){return t=t===Kr?", ":t,r=r===Kr?"":r,i=i===Kr?"":i,n=n===Kr?-1:n,s=s===Kr?"...":s,a=a===Kr?null:a,function(e,t,r,i,n,s,a,o){r=r===Kr?", ":r,i=i===Kr?"":i,n=n===Kr?"":n,s=s===Kr?-1:s,a=a===Kr?"...":a,o=o===Kr?null:o,t.a(i);var l=0,d=e.b();e:for(;d.c();){var u=d.d();if((l=l+1|0)>1&&t.a(r),!(s<0||l<=s))break e;N(t,u,o)}return s>=0&&l>s&&t.a(a),t.a(n),t}(e,Ie(),t,r,i,n,s,a).toString()}function n(e){return se(e)}function s(e){return Ut(e,Me)?n(e):function(e,t){for(var r=e.b();r.c();){var i=r.d();t.g(i)}return t}(e,ne())}function a(e,t){return Ut(e,Me)?e.h(t):function(e,t){if(Ut(e,xe))return e.i(t);for(var r=0,i=e.b();i.c();){var n=i.d();if(z(r),st(t,n))return r;r=r+1|0}return-1}(e,t)>=0}function o(){}function l(){Sr=this}function d(){return null==Sr&&new l,Sr}function u(e){this.q_1=e}function c(e,t){return t===e?"(this Map)":je(t)}function h(e,t){var r;e:{for(var i=e.s().b();i.c();){var n=i.d();if(st(n.r(),t)){r=n;break e}}r=null}return r}function p(){Er=this}function f(){return null==Er&&new p,Er}function m(e){this.x_1=e,S.call(this)}function g(){f(),this.z_1=null,this.a1_1=null}function v(){br=this}function y(){return null==br&&new v,br}function S(){y(),o.call(this)}function E(e,t){if(t<0)throw Qt("Deque is too big.");if(t<=e.k1_1.length)return B();if(e.k1_1===w().m1_1){var r,i=e;w();var n=(s=t)<(a=10)?a:s;return r=We(Array(n),null),i.k1_1=r,B()}var s,a;!function(e,t){var r=We(Array(t),null),i=e.k1_1,n=e.j1_1,s=e.k1_1.length;K(i,r,0,n,s);var a=e.k1_1,o=e.k1_1.length-e.j1_1|0,l=e.j1_1;K(a,r,o,0,l),e.j1_1=0,e.k1_1=r}(e,w().p1(e.k1_1.length,t))}function b(e,t){return t>=e.k1_1.length?t-e.k1_1.length|0:t}function A(e,r){return r===t(e.k1_1)?0:r+1|0}function T(e,r){return 0===r?t(e.k1_1):r-1|0}function _(){var e;Ar=this,e=[],this.m1_1=e,this.n1_1=2147483639,this.o1_1=10}function w(){return null==Ar&&new _,Ar}function k(){w(),this.j1_1=0,this.l1_1=0}function R(){return null==Tr&&new P,Tr}function P(){Tr=this,this.c2_1=new ft(-1478467534,-1720727600)}function C(){_r=this}function I(e){return e.e()-1|0}function O(e,t){this.g2_1=e,this.h2_1=t}function D(){wr=this}function N(e,t,r){var i;null!=r?e.a(r(t)):null==t||"string"===typeof(i=t)||Ut(i,x)?e.a(t):t instanceof Le?e.r2(t.q2_1):e.a(je(t))}function L(e,t){this.k2_1=e,this.l2_1=t}function x(){}function M(){}function F(){}function V(){kr=this}function B(){return null==kr&&new V,kr}function U(){Rr=this,this.MIN_VALUE=-2147483648,this.MAX_VALUE=2147483647,this.SIZE_BYTES=4,this.SIZE_BITS=32}function j(){Pr=this,this.MIN_VALUE=5e-324,this.MAX_VALUE=17976931348623157e292,this.POSITIVE_INFINITY=1/0,this.NEGATIVE_INFINITY=-1/0,this.NaN=NaN,this.SIZE_BYTES=8,this.SIZE_BITS=64}function H(){return null==Pr&&new j,Pr}function W(){}function q(e){for(var t=[],r=e.b();r.c();)t.push(r.d());return t}function Y(e){return 0===(t=[e]).length?ne():se(new O(t,!0));var t}function G(e){return void 0!==e.toArray?e.toArray():q(e)}function K(e,t,r,i,n){d().n(i,n,e.length);var s=n-i|0;if(d().n(r,r+s|0,t.length),Zr(t)&&Zr(e)){var a=e.subarray(i,n);t.set(a,r)}else if(e!==t||r<=i){var o=0;if(o<s)do{var l=o;o=o+1|0,t[r+l|0]=e[i+l|0]}while(o<s)}else{var u=s-1|0;if(0<=u)do{var c=u;u=u+-1|0,t[r+c|0]=e[i+c|0]}while(0<=u)}}function z(e){return e<0&&function(){throw cr("Index overflow has happened.")}(),e}function Z(){o.call(this)}function X(e){this.e3_1=e,this.c3_1=0,this.d3_1=-1}function Q(){Z.call(this),this.a2_1=0}function J(e){this.f3_1=e}function $(e,t){this.g3_1=e,this.h3_1=t}function ee(){ie.call(this)}function te(e){this.l3_1=e,ie.call(this)}function re(){g.call(this),this.q3_1=null,this.r3_1=null}function ie(){Z.call(this)}function ne(){return e=lt(ot(oe)),t=[],oe.call(e,t),e;var e,t}function se(e){return function(e,t){var r;return r=G(e),oe.call(t,r),t}(e,lt(ot(oe)))}function ae(e,t){return d().l(t,e.e()),t}function oe(e){Q.call(this),this.t3_1=e,this.u3_1=!1}function le(e,r){if(function(){var e=Cr;if(null!=e)return e;Cr=!1;var t=[],r=0;if(r<600)do{var i=r;r=r+1|0,t.push(i)}while(r<600);t.sort(de);var n=1,s=t.length;if(n<s)do{var a=n;n=n+1|0;var o=t[a-1|0],l=t[a];if((3&o)===(3&l)&&o>=l)return!1}while(n<s);return Cr=!0,!0}()){var i=(n=r,function(e,t){return n.compare(e,t)});e.sort(i)}else!function(e,t,r,i){var n,s=e.length;n=We(Array(s),null);var a=function e(t,r,i,n,s){if(i===n)return t;var a=(i+n|0)/2|0,o=e(t,r,i,a,s),l=e(t,r,a+1|0,n,s),d=o===r?t:r,u=i,c=a+1|0,h=i;if(h<=n)do{var p=h;if(h=h+1|0,u<=a&&c<=n){var f=o[u],m=l[c];s.compare(f,m)<=0?(d[p]=f,u=u+1|0):(d[p]=m,c=c+1|0)}else u<=a?(d[p]=o[u],u=u+1|0):(d[p]=l[c],c=c+1|0)}while(p!==n);return d}(e,n,t,r,i);if(a!==e){var o=t;if(o<=r)do{var l=o;o=o+1|0,e[l]=a[l]}while(l!==r)}}(e,0,t(e),r);var n}function de(e,t){return(3&e)-(3&t)|0}function ue(){Ir=this}function ce(e){this.x3_1=e,ee.call(this)}function he(e){return function(e,t){re.call(t),pe.call(t),t.d4_1=e,t.e4_1=e.g4()}(new Se((null==Ir&&new ue,Ir)),e),e}function pe(){this.f4_1=null}function fe(){}function me(e,t){var r=ve(e,e.s4_1.w3(t));if(null==r)return null;var i=r;if(null!=i&&jt(i))return ge(i,e,t);var n=i;return e.s4_1.v3(n.r(),t)?n:null}function ge(e,t,r){var i;e:{for(var n=e,s=0,a=n.length;s<a;){var o=n[s];if(s=s+1|0,t.s4_1.v3(o.r(),r)){i=o;break e}}i=null}return i}function ve(e,t){var r=e.t4_1[t];return void 0===r?null:r}function ye(e){this.r4_1=e,this.k4_1=-1,this.l4_1=Object.keys(e.t4_1),this.m4_1=-1,this.n4_1=null,this.o4_1=!1,this.p4_1=-1,this.q4_1=null}function Se(e){this.s4_1=e,this.t4_1=this.v4(),this.u4_1=0}function Ee(){}function be(e){this.y4_1=e,this.w4_1=null,this.x4_1=null,this.x4_1=this.y4_1.j5_1.g5_1}function Ae(e,t,r){this.o5_1=e,$.call(this,t,r),this.m5_1=null,this.n5_1=null}function Te(e){this.j5_1=e,ee.call(this)}function _e(e,t){e.m5_1===e?t.g5_1=null:(t.g5_1===e&&(t.g5_1=e.m5_1),ct(e.m5_1).n5_1=e.n5_1,ct(e.n5_1).m5_1=e.m5_1),e.m5_1=null,e.n5_1=null}function we(e){return he(e),Re.call(e),e.h5_1=he(lt(ot(pe))),e}function ke(){return we(lt(ot(Re)))}function Re(){this.g5_1=null,this.i5_1=!1}function Pe(){}function Ce(e){return!(e===e)}function Ie(){return e=lt(ot(Oe)),Oe.call(e,""),e;var e}function Oe(e){this.q5_1=void 0!==e?e:""}function De(e,t){return e-t|0}function Ne(){Or=this,this.r5_1=0,this.s5_1=65535,this.t5_1=55296,this.u5_1=56319,this.v5_1=56320,this.w5_1=57343,this.x5_1=55296,this.y5_1=57343,this.z5_1=2,this.a6_1=16}function Le(e){null==Or&&new Ne,this.q2_1=e}function xe(){}function Me(){}function Fe(){}function Ve(){}function Be(){}function Ue(){}function je(e){var t=null==e?null:it(e);return null==t?"null":t}function He(e){for(var t=1,r=[],i=e,n=0,s=i.length;n<s;){var a=i[n];n=n+1|0;var o=t,l=a.prototype.$imask$,d=null==l?a.$imask$:l;null!=d&&(r.push(d),o=d.length);var u,c=a.$metadata$.iid;null==c?u=null:(p=c,f=void 0,m=void 0,g=void 0,f=new Int32Array(1+(p>>5)|0),g=1<<(31&p),f[m=p>>5]=f[m]|g,u=f);var h=u;null!=h&&(r.push(h),o=Math.max(o,h.length)),o>t&&(t=o)}var p,f,m,g;return function(e,t){for(var r=0,i=e,n=new Int32Array(i);r<i;){for(var s,a=r,o=0,l=t,d=0,u=l.length;d<u;){var c=l[d];d=d+1|0,a<c.length&&(o|=c[a])}s=o,n[a]=s,r=r+1|0}return n}(t,r)}function We(e,t){var r=0,i=e.length-1|0;if(r<=i)do{var n=r;r=r+1|0,e[n]=t}while(n!==i);return e}function qe(e){return new Ye(e)}function Ye(e){this.d6_1=e,this.c6_1=0}function Ge(){return Qe(),Dr}function Ke(){return Qe(),Nr}function ze(){return Qe(),Lr}function Ze(){return Qe(),xr}function Xe(e){return Qe(),(0|e)===e?(t=e)instanceof ft?t.q6():function(e){return e>2147483647?2147483647:e<-2147483648?-2147483648:0|e}(t):(Ke()[0]=e,zr(ze()[(Qe(),Mr)],31)+ze()[Ze()]|0);var t}function Qe(){if(Fr);else{Fr=!0,Dr=new ArrayBuffer(8);var e=new Float64Array(Ge());Nr=e;new Float32Array(Ge());var t,r=new Int32Array(Ge());Lr=r,Ke()[0]=-1,t=0!==ze()[0]?1:0,xr=t,Mr=1-Ze()|0}}function Je(e){return it(e)}function $e(e,t){var r;switch(typeof e){case"number":r="number"===typeof t?et(e,t):t instanceof ft?et(e,t.g6()):tt(e,t);break;case"string":case"boolean":r=tt(e,t);break;default:r=function(e,t){return e.s2(t)}(e,t)}return r}function et(e,t){var r;if(e<t)r=-1;else if(e>t)r=1;else if(e===t){var i;if(0!==e)i=0;else{var n=1/e;i=n===1/t?0:n<0?-1:1}r=i}else r=e!==e?t!==t?0:1:-1;return r}function tt(e,t){return e<t?-1:e>t?1:0}function rt(e){if(!("kotlinHashCodeValue$"in e)){var t=0|4294967296*Math.random(),r=new Object;r.value=t,r.enumerable=!1,Object.defineProperty(e,"kotlinHashCodeValue$",r)}return e.kotlinHashCodeValue$}function it(e){return null==e?"null":function(e){return!!Vt(e)||Zr(e)}(e)?"[...]":e.toString()}function nt(e){if(null==e)return 0;var t;switch(typeof e){case"object":t="function"===typeof e.hashCode?e.hashCode():rt(e);break;case"function":t=rt(e);break;case"number":t=Xe(e);break;case"boolean":t=e?1:0;break;default:t=function(e){var t=0,r=e.length,i=0,n=r-1|0;if(i<=n)do{var s=i;i=i+1|0;var a=e.charCodeAt(s);t=zr(t,31)+a|0}while(s!==n);return t}(String(e))}return t}function st(e,t){if(null==e)return null==t;if(null==t)return!1;if("object"===typeof e&&"function"===typeof e.equals)return e.equals(t);if(e!==e)return t!==t;if("number"===typeof e&&"number"===typeof t){var r;if(e===t)r=0!==e||1/e===1/t;else r=!1;return r}return e===t}function at(e,t){null!=Error.captureStackTrace?Error.captureStackTrace(e,t):e.stack=(new Error).stack}function ot(e){return e.prototype}function lt(e){return Object.create(e)}function dt(e,t,r){Error.call(e),function(e,t,r){if(!ut(e,"message")){var i;if(null==t){var n;if(null!==t){var s=r,a=null==s?null:s.toString();n=null==a?Kr:a}else n=Kr;i=n}else i=t;e.message=i}ut(e,"cause")||(e.cause=r),e.name=Object.getPrototypeOf(e).constructor.name}(e,t,r)}function ut(e,t){return Object.getPrototypeOf(e).hasOwnProperty(t)}function ct(e){var t;return null==e?function(){throw pr()}():t=e,t}function ht(){throw mr()}function pt(){Vr=this,this.h6_1=new ft(0,-2147483648),this.i6_1=new ft(-1,2147483647),this.j6_1=8,this.k6_1=64}function ft(e,t){null==Vr&&new pt,F.call(this),this.e6_1=e,this.f6_1=t}function mt(){return xt(),Br}function gt(){return xt(),Ur}function vt(){return xt(),jr}function yt(){return xt(),Wr}function St(){return xt(),qr}function Et(e,t){if(xt(),wt(e,t))return 0;var r=Rt(e),i=Rt(t);return r&&!i?-1:!r&&i?1:Rt(At(e,t))?-1:1}function bt(e,t){xt();var r=e.f6_1>>>16|0,i=65535&e.f6_1,n=e.e6_1>>>16|0,s=65535&e.e6_1,a=t.f6_1>>>16|0,o=65535&t.f6_1,l=t.e6_1>>>16|0,d=0,u=0,c=0,h=0;return d=(d=d+((u=(u=u+((c=(c=c+((h=h+(s+(65535&t.e6_1)|0)|0)>>>16|0)|0)+(n+l|0)|0)>>>16|0)|0)+(i+o|0)|0)>>>16|0)|0)+(r+a|0)|0,new ft((c&=65535)<<16|(h&=65535),(d&=65535)<<16|(u&=65535))}function At(e,t){return xt(),bt(e,t.o6())}function Tt(e,t){if(xt(),Pt(e))return mt();if(Pt(t))return mt();if(wt(e,yt()))return Ct(t)?yt():mt();if(wt(t,yt()))return Ct(e)?yt():mt();if(Rt(e))return Rt(t)?Tt(It(e),It(t)):It(Tt(It(e),t));if(Rt(t))return It(Tt(e,It(t)));if(Ot(e,St())&&Ot(t,St()))return Dt(_t(e)*_t(t));var r=e.f6_1>>>16|0,i=65535&e.f6_1,n=e.e6_1>>>16|0,s=65535&e.e6_1,a=t.f6_1>>>16|0,o=65535&t.f6_1,l=t.e6_1>>>16|0,d=65535&t.e6_1,u=0,c=0,h=0,p=0;return h=h+((p=p+zr(s,d)|0)>>>16|0)|0,p&=65535,c=(c=c+((h=h+zr(n,d)|0)>>>16|0)|0)+((h=(h&=65535)+zr(s,l)|0)>>>16|0)|0,h&=65535,u=(u=(u=u+((c=c+zr(i,d)|0)>>>16|0)|0)+((c=(c&=65535)+zr(n,l)|0)>>>16|0)|0)+((c=(c&=65535)+zr(s,o)|0)>>>16|0)|0,c&=65535,u=u+(((zr(r,d)+zr(i,l)|0)+zr(n,o)|0)+zr(s,a)|0)|0,new ft(h<<16|p,(u&=65535)<<16|c)}function _t(e){return xt(),4294967296*e.f6_1+function(e){return xt(),e.e6_1>=0?e.e6_1:4294967296+e.e6_1}(e)}function wt(e,t){return xt(),e.f6_1===t.f6_1&&e.e6_1===t.e6_1}function kt(e){return xt(),new ft(e,e<0?-1:0)}function Rt(e){return xt(),e.f6_1<0}function Pt(e){return xt(),0===e.f6_1&&0===e.e6_1}function Ct(e){return xt(),1===(1&e.e6_1)}function It(e){return xt(),e.o6()}function Ot(e,t){return xt(),Et(e,t)<0}function Dt(e){return xt(),Ce(e)?mt():e<=-0x8000000000000000?yt():e+1>=0x8000000000000000?(xt(),Hr):e<0?It(Dt(-e)):new ft(0|e%4294967296,0|e/4294967296)}function Nt(e,t){return xt(),Et(e,t)>0}function Lt(e,t){return xt(),Et(e,t)>=0}function xt(){Yr||(Yr=!0,Br=kt(0),Ur=kt(1),jr=kt(-1),Hr=new ft(-1,2147483647),Wr=new ft(0,-2147483648),qr=kt(16777216))}function Mt(e,t,r,i){return Ft("class",e,t,r,i,null)}function Ft(e,t,r,i,n,s){return{kind:e,simpleName:t,associatedObjectKey:r,associatedObjects:i,suspendArity:n,$kClass$:Kr,iid:s}}function Vt(e){return Array.isArray(e)}function Bt(e,t,r,i,n,s,a,o){null!=i&&(e.prototype=Object.create(i.prototype),e.prototype.constructor=e);var l=r(t,s,a,null==o?[]:o);e.$metadata$=l,null!=n&&((null!=l.iid?e:e.prototype).$imask$=He(n))}function Ut(e,t){return function(e,t){var r=e.$imask$,i=r;return null!=i&&function(e,t){var r=t>>5;if(r>e.length)return!1;var i=1<<(31&t);return!(0===(e[r]&i))}(i,t)}(e,t.$metadata$.iid)}function jt(e){return!!Vt(e)&&!e.$type$}function Ht(e){var t;switch(typeof e){case"string":case"number":case"boolean":case"function":t=!0;break;default:t=e instanceof Object}return t}function Wt(e){var t,r=typeof e;return"string"===r||"boolean"===r||"number"===typeof(t=e)||t instanceof ft||Ut(e,M)}function qt(e,t,r,i){return Ft("interface",e,t,r,i,function(){null==Gr&&(Gr=0);var e=Yt();Gr=e+1|0;var t=Yt();return t}())}function Yt(){if(null!=Gr)return Gr;!function(e){throw vr("lateinit property "+e+" has not been initialized")}("iid")}function Gt(e,t,r,i){return Ft("object",e,t,r,i,null)}function Kt(e){var t=function(e,t){return ir(e,t),zt.call(t),t}(e,lt(ot(zt)));return at(t,Kt),t}function zt(){at(this,zt)}function Zt(e){var t=function(e,t){return ir(e,t),Xt.call(t),t}(e,lt(ot(Xt)));return at(t,Zt),t}function Xt(){at(this,Xt)}function Qt(e){var t=function(e,t){return ir(e,t),Jt.call(t),t}(e,lt(ot(Jt)));return at(t,Qt),t}function Jt(){at(this,Jt)}function $t(e,t){return dt(t,e),tr.call(t),t}function er(e){var t=$t(e,lt(ot(tr)));return at(t,er),t}function tr(){at(this,tr)}function rr(e){return function(e){dt(e),tr.call(e)}(e),nr.call(e),e}function ir(e,t){return $t(e,t),nr.call(t),t}function nr(){at(this,nr)}function sr(){var e,t=(rr(e=lt(ot(or))),or.call(e),e);return at(t,sr),t}function ar(e){var t=function(e,t){return ir(e,t),or.call(t),t}(e,lt(ot(or)));return at(t,ar),t}function or(){at(this,or)}function lr(){var e,t=(rr(e=lt(ot(ur))),ur.call(e),e);return at(t,lr),t}function dr(e){var t=function(e,t){return ir(e,t),ur.call(t),t}(e,lt(ot(ur)));return at(t,dr),t}function ur(){at(this,ur)}function cr(e){var t=function(e,t){return ir(e,t),hr.call(t),t}(e,lt(ot(hr)));return at(t,cr),t}function hr(){at(this,hr)}function pr(){var e,t=(rr(e=lt(ot(fr))),fr.call(e),e);return at(t,pr),t}function fr(){at(this,fr)}function mr(){var e,t=(rr(e=lt(ot(gr))),gr.call(e),e);return at(t,mr),t}function gr(){at(this,gr)}function vr(e){var t=function(e,t){return ir(e,t),yr.call(t),t}(e,lt(ot(yr)));return at(t,vr),t}function yr(){at(this,yr)}var Sr,Er,br,Ar,Tr,_r,wr,kr,Rr,Pr,Cr,Ir,Or,Dr,Nr,Lr,xr,Mr,Fr,Vr,Br,Ur,jr,Hr,Wr,qr,Yr,Gr,Kr,zr=Math.imul,Zr=ArrayBuffer.isView;return Bt(Me,"Collection",qt),Bt(o,"AbstractCollection",Mt,Kr,[Me]),Bt(l,"Companion",Gt),Bt(u,Kr,Mt),Bt(p,"Companion",Gt),Bt(Ue,"Set",qt,Kr,[Me]),Bt(S,"AbstractSet",Mt,o,[o,Ue]),Bt(m,Kr,Mt,S),Bt(Ve,"Map",qt),Bt(g,"AbstractMap",Mt,Kr,[Ve]),Bt(v,"Companion",Gt),Bt(_,"Companion",Gt),Bt(Z,"AbstractMutableCollection",Mt,o,[o,Me]),Bt(xe,"List",qt,Kr,[Me]),Bt(Q,"AbstractMutableList",Mt,Z,[Z,xe,Me]),Bt(k,"ArrayDeque",Mt,Q),Bt(P,"EmptyList",Gt,Kr,[xe]),Bt(C,"EmptyIterator",Gt),Bt(O,"ArrayAsCollection",Mt,Kr,[Me]),Bt(W,"Comparator",qt),Bt(D,"ReverseOrderComparator",Gt,Kr,[W]),Bt(L,"Pair",Mt),Bt(x,"CharSequence",qt),Bt(M,"Comparable",qt),Bt(F,"Number",Mt),Bt(V,"Unit",Gt),Bt(U,"IntCompanionObject",Gt),Bt(j,"DoubleCompanionObject",Gt),Bt(X,"IteratorImpl",Mt),Bt(J,Kr,Mt),Bt(Fe,"Entry",qt),Bt(Be,"MutableEntry",qt,Kr,[Fe]),Bt($,"SimpleEntry",Mt,Kr,[Be]),Bt(ie,"AbstractMutableSet",Mt,Z,[Z,Ue,Me]),Bt(ee,"AbstractEntrySet",Mt,ie),Bt(te,Kr,Mt,ie),Bt(re,"AbstractMutableMap",Mt,g,[g,Ve]),Bt(oe,"ArrayList",Mt,Q,[Q,xe,Me]),Bt(ue,"HashCode",Gt),Bt(ce,"EntrySet",Mt,ee),Bt(pe,"HashMap",Mt,re,[re,Ve]),Bt(fe,"HashSet",Mt,ie,[ie,Ue,Me]),Bt(ye,Kr,Mt),Bt(Ee,"InternalMap",qt),Bt(Se,"InternalHashCodeMap",Mt,Kr,[Ee]),Bt(be,"EntryIterator",Mt),Bt(Ae,"ChainEntry",Mt,$),Bt(Te,"EntrySet",Mt,ee),Bt(Re,"LinkedHashMap",Mt,pe,[pe,Ve]),Bt(Pe,"LinkedHashSet",Mt,fe,[fe,Ue,Me]),Bt(Oe,"StringBuilder",Mt,Kr,[x]),Bt(Ne,"Companion",Gt),Bt(Le,"Char",Mt,Kr,[M]),Bt(Ye,Kr,Mt),Bt(pt,"Companion",Gt),Bt(ft,"Long",Mt,F,[F,M]),Bt(tr,"Exception",Mt,Error),Bt(nr,"RuntimeException",Mt,tr),Bt(zt,"IllegalArgumentException",Mt,nr),Bt(Xt,"IndexOutOfBoundsException",Mt,nr),Bt(Jt,"IllegalStateException",Mt,nr),Bt(or,"NoSuchElementException",Mt,nr),Bt(ur,"UnsupportedOperationException",Mt,nr),Bt(hr,"ArithmeticException",Mt,nr),Bt(fr,"NullPointerException",Mt,nr),Bt(gr,"ClassCastException",Mt,nr),Bt(yr,"UninitializedPropertyAccessException",Mt,nr),ot(o).h=function(e){var t;e:if(Ut(this,Me)&&this.j())t=!1;else{for(var r=this.b();r.c();)if(st(r.d(),e)){t=!0;break e}t=!1}return t},ot(o).k=function(e){var t;e:if(Ut(e,Me)&&e.j())t=!0;else{for(var r=e.b();r.c();){var i=r.d();if(!this.h(i)){t=!1;break e}}t=!0}return t},ot(o).j=function(){return 0===this.e()},ot(o).toString=function(){return i(this,", ","[","]",Kr,Kr,(e=this,function(t){return t===e?"(this Collection)":je(t)}));var e},ot(o).toArray=function(){return q(this)},ot(l).l=function(e,t){if(e<0||e>=t)throw Zt("index: "+e+", size: "+t)},ot(l).m=function(e,t){if(e<0||e>t)throw Zt("index: "+e+", size: "+t)},ot(l).n=function(e,t,r){if(e<0||t>r)throw Zt("fromIndex: "+e+", toIndex: "+t+", size: "+r);if(e>t)throw Kt("fromIndex: "+e+" > toIndex: "+t)},ot(l).o=function(e){for(var t=1,r=e.b();r.c();){var i=r.d(),n=zr(31,t),s=null==i?null:nt(i);t=n+(null==s?0:s)|0}return t},ot(l).p=function(e,t){if(e.e()!==t.e())return!1;for(var r=t.b(),i=e.b();i.c();)if(!st(i.d(),r.d()))return!1;return!0},ot(u).c=function(){return this.q_1.c()},ot(u).d=function(){return this.q_1.d().r()},ot(p).t=function(e){var t=e.r(),r=null==t?null:nt(t),i=null==r?0:r,n=e.u(),s=null==n?null:nt(n);return i^(null==s?0:s)},ot(p).v=function(e){return je(e.r())+"="+je(e.u())},ot(p).w=function(e,t){return!(null==t||!Ut(t,Fe))&&!!st(e.r(),t.r())&&st(e.u(),t.u())},ot(m).y=function(e){return this.x_1.b1(e)},ot(m).h=function(e){return!(null!=e&&!Ht(e))&&this.y(null==e||Ht(e)?e:ht())},ot(m).b=function(){return new u(this.x_1.s().b())},ot(m).e=function(){return this.x_1.e()},ot(g).b1=function(e){return!(null==h(this,e))},ot(g).d1=function(e){if(null==e||!Ut(e,Fe))return!1;var t=e.r(),r=e.u(),i=(Ut(this,Ve)?this:ht()).e1(t);return!!st(r,i)&&!(null==i&&!(Ut(this,Ve)?this:ht()).b1(t))},ot(g).equals=function(e){if(e===this)return!0;if(null==e||!Ut(e,Ve))return!1;if(this.e()!==e.e())return!1;var t;e:{var r=e.s();if(Ut(r,Me)&&r.j())t=!0;else{for(var i=r.b();i.c();){var n=i.d();if(!this.d1(n)){t=!1;break e}}t=!0}}return t},ot(g).e1=function(e){var t=h(this,e);return null==t?null:t.u()},ot(g).hashCode=function(){return nt(this.s())},ot(g).j=function(){return 0===this.e()},ot(g).e=function(){return this.s().e()},ot(g).f1=function(){return null==this.z_1&&(this.z_1=new m(this)),ct(this.z_1)},ot(g).toString=function(){var e;return i(this.s(),", ","{","}",Kr,Kr,(e=this,function(t){return e.c1(t)}))},ot(g).c1=function(e){return c(this,e.r())+"="+c(this,e.u())},ot(v).g1=function(e){for(var t=0,r=e.b();r.c();){var i=r.d(),n=t,s=null==i?null:nt(i);t=n+(null==s?0:s)|0}return t},ot(v).h1=function(e,t){return e.e()===t.e()&&e.k(t)},ot(S).equals=function(e){return e===this||!(null==e||!Ut(e,Ue))&&y().h1(this,e)},ot(S).hashCode=function(){return y().g1(this)},ot(_).p1=function(e,t){var r=e+(e>>1)|0;return(r-t|0)<0&&(r=t),(r-2147483639|0)>0&&(r=t>2147483639?(null==Rr&&new U,Rr).MAX_VALUE:2147483639),r},ot(k).e=function(){return this.l1_1},ot(k).j=function(){return 0===this.l1_1},ot(k).q1=function(e){E(this,this.l1_1+1|0),this.j1_1=T(this,this.j1_1),this.k1_1[this.j1_1]=e,this.l1_1=this.l1_1+1|0},ot(k).r1=function(e){E(this,this.l1_1+1|0);var t=this.k1_1,r=this.l1_1;t[b(this,this.j1_1+r|0)]=e,this.l1_1=this.l1_1+1|0},ot(k).s1=function(){if(this.j())throw ar("ArrayDeque is empty.");var e=this.j1_1,t=this.k1_1[e],r=null==t||Ht(t)?t:ht();return this.k1_1[this.j1_1]=null,this.j1_1=A(this,this.j1_1),this.l1_1=this.l1_1-1|0,r},ot(k).t1=function(){return this.j()?null:this.s1()},ot(k).u1=function(){if(this.j())throw ar("ArrayDeque is empty.");var e=I(this),t=b(this,this.j1_1+e|0),r=this.k1_1[t],i=null==r||Ht(r)?r:ht();return this.k1_1[t]=null,this.l1_1=this.l1_1-1|0,i},ot(k).g=function(e){return this.r1(e),!0},ot(k).v1=function(e,t){if(d().m(e,this.l1_1),e===this.l1_1)return this.r1(t),B();if(0===e)return this.q1(t),B();E(this,this.l1_1+1|0);var r=b(this,this.j1_1+e|0);if(e<(this.l1_1+1|0)>>1){var i=T(this,r),n=T(this,this.j1_1);if(i>=this.j1_1){this.k1_1[n]=this.k1_1[this.j1_1];var s=this.k1_1,a=this.k1_1;K(s,a,this.j1_1,this.j1_1+1|0,i+1|0)}else{var o=this.k1_1,l=this.k1_1;K(o,l,this.j1_1-1|0,this.j1_1,this.k1_1.length),this.k1_1[this.k1_1.length-1|0]=this.k1_1[0];var u=this.k1_1,c=this.k1_1;K(u,c,0,1,i+1|0)}this.k1_1[i]=t,this.j1_1=n}else{var h=this.l1_1,p=b(this,this.j1_1+h|0);if(r<p){var f=this.k1_1,m=this.k1_1;K(f,m,r+1|0,r,p)}else{var g=this.k1_1,v=this.k1_1;K(g,v,1,0,p),this.k1_1[0]=this.k1_1[this.k1_1.length-1|0];var y=this.k1_1,S=this.k1_1;K(y,S,r+1|0,r,this.k1_1.length-1|0)}this.k1_1[r]=t}this.l1_1=this.l1_1+1|0},ot(k).f=function(e){d().l(e,this.l1_1);var t=b(this,this.j1_1+e|0),r=this.k1_1[t];return null==r||Ht(r)?r:ht()},ot(k).w1=function(e,t){d().l(e,this.l1_1);var r=b(this,this.j1_1+e|0),i=this.k1_1[r],n=null==i||Ht(i)?i:ht();return this.k1_1[r]=t,n},ot(k).h=function(e){return!(-1===this.i(e))},ot(k).i=function(e){var t=this.l1_1,r=b(this,this.j1_1+t|0);if(this.j1_1<r){var i=this.j1_1;if(i<r)do{var n=i;if(i=i+1|0,st(e,this.k1_1[n]))return n-this.j1_1|0}while(i<r)}else if(this.j1_1>=r){var s=this.j1_1,a=this.k1_1.length;if(s<a)do{var o=s;if(s=s+1|0,st(e,this.k1_1[o]))return o-this.j1_1|0}while(s<a);var l=0;if(l<r)do{var d=l;if(l=l+1|0,st(e,this.k1_1[d]))return(d+this.k1_1.length|0)-this.j1_1|0}while(l<r)}return-1},ot(k).x1=function(e){if(d().l(e,this.l1_1),e===I(this))return this.u1();if(0===e)return this.s1();var t=b(this,this.j1_1+e|0),r=this.k1_1[t],i=null==r||Ht(r)?r:ht();if(e<this.l1_1>>1){if(t>=this.j1_1){var n=this.k1_1,s=this.k1_1;K(n,s,this.j1_1+1|0,this.j1_1,t)}else{var a=this.k1_1,o=this.k1_1;K(a,o,1,0,t),this.k1_1[0]=this.k1_1[this.k1_1.length-1|0];var l=this.k1_1,u=this.k1_1;K(l,u,this.j1_1+1|0,this.j1_1,this.k1_1.length-1|0)}this.k1_1[this.j1_1]=null,this.j1_1=A(this,this.j1_1)}else{var c=I(this),h=b(this,this.j1_1+c|0);if(t<=h){var p=this.k1_1,f=this.k1_1;K(p,f,t,t+1|0,h+1|0)}else{var m=this.k1_1,g=this.k1_1;K(m,g,t,t+1|0,this.k1_1.length),this.k1_1[this.k1_1.length-1|0]=this.k1_1[0];var v=this.k1_1,y=this.k1_1;K(v,y,0,1,h+1|0)}this.k1_1[h]=null}return this.l1_1=this.l1_1-1|0,i},ot(k).y1=function(e){var t,r=e.length>=this.l1_1?e:(t=this.l1_1,We(Array(t),null)),i=jt(r)?r:ht(),n=this.l1_1,s=b(this,this.j1_1+n|0);return this.j1_1<s?K(this.k1_1,i,0,this.j1_1,s):this.j()||(K(this.k1_1,i,0,this.j1_1,this.k1_1.length),K(this.k1_1,i,this.k1_1.length-this.j1_1|0,0,s)),i.length>this.l1_1&&(i[this.l1_1]=null),jt(i)?i:ht()},ot(k).z1=function(){var e,t=this.l1_1;return e=We(Array(t),null),this.y1(e)},ot(k).toArray=function(){return this.z1()},ot(P).equals=function(e){return!(null==e||!Ut(e,xe))&&e.j()},ot(P).hashCode=function(){return 1},ot(P).toString=function(){return"[]"},ot(P).e=function(){return 0},ot(P).j=function(){return!0},ot(P).d2=function(e){return!1},ot(P).h=function(e){return!1},ot(P).e2=function(e){return e.j()},ot(P).k=function(e){return this.e2(e)},ot(P).f=function(e){throw Zt("Empty list doesn't contain element at index "+e+".")},ot(P).f2=function(e){return-1},ot(P).i=function(e){return-1},ot(P).b=function(){return null==_r&&new C,_r},ot(C).c=function(){return!1},ot(C).d=function(){throw sr()},ot(O).e=function(){return this.g2_1.length},ot(O).j=function(){return 0===this.g2_1.length},ot(O).i2=function(e){return function(e,t){return r(e,t)>=0}(this.g2_1,e)},ot(O).h=function(e){return!(null!=e&&!Ht(e))&&this.i2(null==e||Ht(e)?e:ht())},ot(O).j2=function(e){var t;e:if(Ut(e,Me)&&e.j())t=!0;else{for(var r=e.b();r.c();){var i=r.d();if(!this.i2(i)){t=!1;break e}}t=!0}return t},ot(O).k=function(e){return this.j2(e)},ot(O).b=function(){return qe(this.g2_1)},ot(D).p2=function(e,t){return $e(t,e)},ot(D).compare=function(e,t){var r=null!=e&&Wt(e)?e:ht();return this.p2(r,null!=t&&Wt(t)?t:ht())},ot(L).toString=function(){return"("+this.k2_1+", "+this.l2_1+")"},ot(L).m2=function(){return this.k2_1},ot(L).n2=function(){return this.l2_1},ot(L).hashCode=function(){var e=null==this.k2_1?0:nt(this.k2_1);return e=zr(e,31)+(null==this.l2_1?0:nt(this.l2_1))|0},ot(L).equals=function(e){if(this===e)return!0;if(!(e instanceof L))return!1;var t=e instanceof L?e:ht();return!!st(this.k2_1,t.k2_1)&&!!st(this.l2_1,t.l2_1)},ot(V).toString=function(){return"kotlin.Unit"},ot(U).t2=function(){return this.MIN_VALUE},ot(U).u2=function(){return this.MAX_VALUE},ot(U).v2=function(){return this.SIZE_BYTES},ot(U).w2=function(){return this.SIZE_BITS},ot(j).t2=function(){return this.MIN_VALUE},ot(j).u2=function(){return this.MAX_VALUE},ot(j).x2=function(){return this.POSITIVE_INFINITY},ot(j).y2=function(){return this.NEGATIVE_INFINITY},ot(j).z2=function(){return this.NaN},ot(j).v2=function(){return this.SIZE_BYTES},ot(j).w2=function(){return this.SIZE_BITS},ot(Z).a3=function(e){this.b2();for(var t=this.b();t.c();)if(st(t.d(),e))return t.b3(),!0;return!1},ot(Z).toJSON=function(){return this.toArray()},ot(Z).b2=function(){},ot(X).c=function(){return this.c3_1<this.e3_1.e()},ot(X).d=function(){if(!this.c())throw sr();var e=this.c3_1;return this.c3_1=e+1|0,this.d3_1=e,this.e3_1.f(this.d3_1)},ot(X).b3=function(){if(-1===this.d3_1)throw Qt(it("Call next() or previous() before removing element from the iterator."));this.e3_1.x1(this.d3_1),this.c3_1=this.d3_1,this.d3_1=-1},ot(Q).g=function(e){return this.b2(),this.v1(this.e(),e),!0},ot(Q).b=function(){return new X(this)},ot(Q).h=function(e){return this.i(e)>=0},ot(Q).i=function(e){var t=0,r=I(this);if(t<=r)do{var i=t;if(t=t+1|0,st(this.f(i),e))return i}while(i!==r);return-1},ot(Q).equals=function(e){return e===this||!(null==e||!Ut(e,xe))&&d().p(this,e)},ot(Q).hashCode=function(){return d().o(this)},ot(J).c=function(){return this.f3_1.c()},ot(J).d=function(){return this.f3_1.d().r()},ot(J).b3=function(){return this.f3_1.b3()},ot($).r=function(){return this.g3_1},ot($).u=function(){return this.h3_1},ot($).i3=function(e){var t=this.h3_1;return this.h3_1=e,t},ot($).hashCode=function(){return f().t(this)},ot($).toString=function(){return f().v(this)},ot($).equals=function(e){return f().w(this,e)},ot(ee).h=function(e){return this.j3(e)},ot(ee).a3=function(e){return this.k3(e)},ot(te).m3=function(e){throw dr("Add is not supported on keys")},ot(te).g=function(e){return this.m3(null==e||Ht(e)?e:ht())},ot(te).y=function(e){return this.l3_1.b1(e)},ot(te).h=function(e){return!(null!=e&&!Ht(e))&&this.y(null==e||Ht(e)?e:ht())},ot(te).b=function(){return new J(this.l3_1.s().b())},ot(te).n3=function(e){return this.b2(),!!this.l3_1.b1(e)&&(this.l3_1.n3(e),!0)},ot(te).a3=function(e){return!(null!=e&&!Ht(e))&&this.n3(null==e||Ht(e)?e:ht())},ot(te).e=function(){return this.l3_1.e()},ot(te).b2=function(){return this.l3_1.b2()},ot(re).f1=function(){return null==this.q3_1&&(this.q3_1=new te(this)),ct(this.q3_1)},ot(re).n3=function(e){this.b2();for(var t=this.s().b();t.c();){var r=t.d();if(st(e,r.r())){var i=r.u();return t.b3(),i}}return null},ot(re).b2=function(){},ot(ie).equals=function(e){return e===this||!(null==e||!Ut(e,Ue))&&y().h1(this,e)},ot(ie).hashCode=function(){return y().g1(this)},ot(oe).e=function(){return this.t3_1.length},ot(oe).f=function(e){var t=this.t3_1[ae(this,e)];return null==t||Ht(t)?t:ht()},ot(oe).w1=function(e,t){this.b2(),ae(this,e);var r=this.t3_1[e];this.t3_1[e]=t;var i=r;return null==i||Ht(i)?i:ht()},ot(oe).g=function(e){this.b2(),this.t3_1.push(e);var t=this.a2_1;return this.a2_1=t+1|0,!0},ot(oe).v1=function(e,t){this.b2(),this.t3_1.splice(function(e,t){return d().m(t,e.e()),t}(this,e),0,t);var r=this.a2_1;this.a2_1=r+1|0},ot(oe).x1=function(e){this.b2(),ae(this,e);var t=this.a2_1;return this.a2_1=t+1|0,e===I(this)?this.t3_1.pop():this.t3_1.splice(e,1)[0]},ot(oe).i=function(e){return r(this.t3_1,e)},ot(oe).toString=function(){return e=this.t3_1,t=(t=", ")===Kr?", ":t,r=(r="[")===Kr?"":r,i=(i="]")===Kr?"":i,n=(n=Kr)===Kr?-1:n,s=(s=Kr)===Kr?"...":s,a=(a=Je)===Kr?null:a,function(e,t,r,i,n,s,a,o){r=r===Kr?", ":r,i=i===Kr?"":i,n=n===Kr?"":n,s=s===Kr?-1:s,a=a===Kr?"...":a,o=o===Kr?null:o,t.a(i);var l=0,d=e,u=0,c=d.length;e:for(;u<c;){var h=d[u];if(u=u+1|0,(l=l+1|0)>1&&t.a(r),!(s<0||l<=s))break e;N(t,h,o)}return s>=0&&l>s&&t.a(a),t.a(n),t}(e,Ie(),t,r,i,n,s,a).toString();var e,t,r,i,n,s,a},ot(oe).z1=function(){return[].slice.call(this.t3_1)},ot(oe).toArray=function(){return this.z1()},ot(oe).b2=function(){if(this.u3_1)throw lr()},ot(ue).v3=function(e,t){return st(e,t)},ot(ue).w3=function(e){var t=null==e?null:nt(e);return null==t?0:t},ot(ce).y3=function(e){throw dr("Add is not supported on entries")},ot(ce).g=function(e){return this.y3(null!=e&&Ut(e,Be)?e:ht())},ot(ce).j3=function(e){return this.x3_1.d1(e)},ot(ce).b=function(){return this.x3_1.d4_1.b()},ot(ce).k3=function(e){return!!a(this,e)&&(this.x3_1.n3(e.r()),!0)},ot(ce).e=function(){return this.x3_1.e()},ot(pe).h4=function(){this.d4_1.h4()},ot(pe).b1=function(e){return this.d4_1.y(e)},ot(pe).s=function(){return null==this.f4_1&&(this.f4_1=this.i4()),ct(this.f4_1)},ot(pe).i4=function(){return new ce(this)},ot(pe).e1=function(e){return this.d4_1.e1(e)},ot(pe).o2=function(e,t){return this.d4_1.o2(e,t)},ot(pe).n3=function(e){return this.d4_1.n3(e)},ot(pe).e=function(){return this.d4_1.e()},ot(fe).g=function(e){return null==this.j4_1.o2(e,this)},ot(fe).h4=function(){this.j4_1.h4()},ot(fe).h=function(e){return this.j4_1.b1(e)},ot(fe).j=function(){return this.j4_1.j()},ot(fe).b=function(){return this.j4_1.f1().b()},ot(fe).a3=function(e){return!(null==this.j4_1.n3(e))},ot(fe).e=function(){return this.j4_1.e()},ot(ye).c=function(){return-1===this.k4_1&&(this.k4_1=function(e){if(null!=e.n4_1&&e.o4_1){var t=e.n4_1,r=t.length,i=e;if(i.p4_1=i.p4_1+1|0,i.p4_1<r)return 0}var n=e;if(n.m4_1=n.m4_1+1|0,n.m4_1<e.l4_1.length){e.n4_1=e.r4_1.t4_1[e.l4_1[e.m4_1]];var s=e,a=e.n4_1;return s.o4_1=null!=a&&jt(a),e.p4_1=0,0}return e.n4_1=null,1}(this)),0===this.k4_1},ot(ye).d=function(){if(!this.c())throw sr();var e=this.o4_1?this.n4_1[this.p4_1]:this.n4_1;return this.q4_1=e,this.k4_1=-1,e},ot(ye).b3=function(){var e=this.q4_1;if(null==e)throw Qt(it("Required value was null."));this.r4_1.n3(ct(this.q4_1).r()),this.q4_1=null;var t=this.p4_1;this.p4_1=t-1|0},ot(Se).g4=function(){return this.s4_1},ot(Se).e=function(){return this.u4_1},ot(Se).o2=function(e,t){var r=this.s4_1.w3(e),i=ve(this,r);if(null==i)this.t4_1[r]=new $(e,t);else{if(null==i||!jt(i)){var n,s=i;if(this.s4_1.v3(s.r(),e))return s.i3(t);n=[s,new $(e,t)],this.t4_1[r]=n;var a=this.u4_1;return this.u4_1=a+1|0,null}var o=i,l=ge(o,this,e);if(null!=l)return l.i3(t);o.push(new $(e,t))}var d=this.u4_1;return this.u4_1=d+1|0,null},ot(Se).n3=function(e){var t=this.s4_1.w3(e),r=ve(this,t);if(null==r)return null;var i=r;if(null==i||!jt(i)){var n=i;if(this.s4_1.v3(n.r(),e)){delete this.t4_1[t],B();var s=this.u4_1;return this.u4_1=s-1|0,n.u()}return null}var a=i,o=0,l=a.length-1|0;if(o<=l)do{var d=o;o=o+1|0;var u=a[d];if(this.s4_1.v3(e,u.r())){1===a.length?(a.length=0,delete this.t4_1[t],B()):a.splice(d,1);var c=this.u4_1;return this.u4_1=c-1|0,u.u()}}while(o<=l);return null},ot(Se).h4=function(){this.t4_1=this.v4(),this.u4_1=0},ot(Se).y=function(e){return!(null==me(this,e))},ot(Se).e1=function(e){var t=me(this,e);return null==t?null:t.u()},ot(Se).b=function(){return new ye(this)},ot(be).c=function(){return!(null===this.x4_1)},ot(be).d=function(){if(!this.c())throw sr();var e=ct(this.x4_1);this.w4_1=e;var t,r=e.m5_1;return t=r!==this.y4_1.j5_1.g5_1?r:null,this.x4_1=t,e},ot(be).b3=function(){if(null==this.w4_1)throw Qt(it("Check failed."));this.y4_1.b2(),_e(ct(this.w4_1),this.y4_1.j5_1),this.y4_1.j5_1.h5_1.n3(ct(this.w4_1).r()),this.w4_1=null},ot(Ae).i3=function(e){return this.o5_1.b2(),ot($).i3.call(this,e)},ot(Te).y3=function(e){throw dr("Add is not supported on entries")},ot(Te).g=function(e){return this.y3(null!=e&&Ut(e,Be)?e:ht())},ot(Te).j3=function(e){return this.j5_1.d1(e)},ot(Te).b=function(){return new be(this)},ot(Te).k3=function(e){return this.b2(),!!a(this,e)&&(this.j5_1.n3(e.r()),!0)},ot(Te).e=function(){return this.j5_1.e()},ot(Te).b2=function(){return this.j5_1.b2()},ot(Re).h4=function(){this.b2(),this.h5_1.h4(),this.g5_1=null},ot(Re).b1=function(e){return this.h5_1.b1(e)},ot(Re).i4=function(){return new Te(this)},ot(Re).e1=function(e){var t=this.h5_1.e1(e);return null==t?null:t.u()},ot(Re).o2=function(e,t){this.b2();var r=this.h5_1.e1(e);if(null==r){var i=new Ae(this,e,t);return this.h5_1.o2(e,i),function(e,t){if(null!=e.m5_1||null!=e.n5_1)throw Qt(it("Check failed."));var r=t.g5_1;if(null==r)t.g5_1=e,e.m5_1=e,e.n5_1=e;else{var i=r.n5_1;if(null==i)throw Qt(it("Required value was null."));var n=i;e.n5_1=n,e.m5_1=r,r.n5_1=e,n.m5_1=e}}(i,this),null}return r.i3(t)},ot(Re).n3=function(e){this.b2();var t=this.h5_1.n3(e);return null!=t?(_e(t,this),t.u()):null},ot(Re).e=function(){return this.h5_1.e()},ot(Re).b2=function(){if(this.i5_1)throw lr()},ot(Pe).b2=function(){return this.j4_1.b2()},ot(Oe).r2=function(e){return this.q5_1=this.q5_1+new Le(e),this},ot(Oe).a=function(e){return this.q5_1=this.q5_1+je(e),this},ot(Oe).toString=function(){return this.q5_1},ot(Le).b6=function(e){return De(this.q2_1,e)},ot(Le).s2=function(e){return function(e,t){return De(e.q2_1,t instanceof Le?t.q2_1:ht())}(this,e)},ot(Le).equals=function(e){return function(e,t){return t instanceof Le&&e===t.q2_1}(this.q2_1,e)},ot(Le).hashCode=function(){return this.q2_1},ot(Le).toString=function(){return e=this.q2_1,String.fromCharCode(e);var e},ot(Ye).c=function(){return!(this.c6_1===this.d6_1.length)},ot(Ye).d=function(){if(this.c6_1===this.d6_1.length)throw ar(""+this.c6_1);var e=this.c6_1;return this.c6_1=e+1|0,this.d6_1[e]},ot(ft).l6=function(e){return Et(this,e)},ot(ft).s2=function(e){return this.l6(e instanceof ft?e:ht())},ot(ft).m6=function(e){return bt(this,e)},ot(ft).n6=function(e){return function(e,t){if(xt(),Pt(t))throw er("division by zero");if(Pt(e))return mt();if(wt(e,yt())){if(wt(t,gt())||wt(t,vt()))return yt();if(wt(t,yt()))return gt();var r=function(e,t){xt();var r=63&t;return 0===r?e:r<32?new ft(e.e6_1<<r,e.f6_1<<r|e.e6_1>>>(32-r|0)|0):new ft(0,e.e6_1<<(r-32|0))}(function(e,t){xt();var r=63&t;return 0===r?e:r<32?new ft(e.e6_1>>>r|0|e.f6_1<<(32-r|0),e.f6_1>>r):new ft(e.f6_1>>(r-32|0),e.f6_1>=0?0:-1)}(e,1).n6(t),1);if(wt(r,mt()))return Rt(t)?gt():vt();var i=At(e,Tt(t,r));return bt(r,i.n6(t))}if(wt(t,yt()))return mt();if(Rt(e))return Rt(t)?It(e).n6(It(t)):It(It(e).n6(t));if(Rt(t))return It(e.n6(It(t)));for(var n=mt(),s=e;Lt(s,t);){for(var a=_t(s)/_t(t),o=Math.max(1,Math.floor(a)),l=Math.ceil(Math.log(o)/Math.LN2),d=l<=48?1:Math.pow(2,l-48),u=Dt(o),c=Tt(u,t);Rt(c)||Nt(c,s);)u=Dt(o-=d),c=Tt(u,t);Pt(u)&&(u=gt()),n=bt(n,u),s=At(s,c)}return n}(this,e)},ot(ft).o6=function(){return this.p6().m6(new ft(1,0))},ot(ft).p6=function(){return new ft(~this.e6_1,~this.f6_1)},ot(ft).q6=function(){return this.e6_1},ot(ft).g6=function(){return _t(this)},ot(ft).valueOf=function(){return this.g6()},ot(ft).equals=function(e){return e instanceof ft&&wt(this,e)},ot(ft).hashCode=function(){return e=this,xt(),e.e6_1^e.f6_1;var e},ot(ft).toString=function(){return function e(t,r){if(xt(),r<2||36<r)throw er("radix out of range: "+r);if(Pt(t))return"0";if(Rt(t)){if(wt(t,yt())){var i=kt(r),n=t.n6(i),s=At(Tt(n,i),t).q6(),a=e(n,r),o=s.toString(r);return a+o}return"-"+e(It(t),r)}for(var l=2===r?31:r<=10?9:r<=21?7:r<=35?6:5,d=Dt(Math.pow(r,l)),u=t,c="";;){var h=u.n6(d),p=At(u,Tt(h,d)).q6(),f=p.toString(r),m=f;if(Pt(u=h))return m+c;for(;m.length<l;)m="0"+m;c=m+c}}(this,10)},ot(Se).v4=function(){var e=Object.create(null);return e.foo=1,delete e.foo,B(),e},Cr=null,e.$_$=e.$_$||{},e.$_$.a=function(){return e=lt(ot(k)),Q.call(e),k.call(e),e.k1_1=w().m1_1,e;var e},e.$_$.b=ne,e.$_$.c=ke,e.$_$.d=function(){return e=lt(ot(Pe)),function(e,t){ie.call(t),fe.call(t),t.j4_1=e}(ke(),e),Pe.call(e),e;var e},e.$_$.e=sr,e.$_$.f=function e(t){var r=ir(t,lt(ot(nr)));return at(r,e),r},e.$_$.g=H,e.$_$.h=B,e.$_$.i=G,e.$_$.j=function(e){return i=(t=[e]).length,function(e,t){for(var r=t,i=0,n=r.length;i<n;){var s=r[i];i=i+1|0;var a=s.m2(),o=s.n2();e.o2(a,o)}}(r=function(e,t){return function(e,t,r){if(he(r),!(e>=0))throw Kt(it("Negative initial capacity: "+e));if(!(t>=0))throw Kt(it("Non-positive load factor: "+t))}(e,0,t),t}(i,lt(ot(pe))),t),r;var t,r,i},e.$_$.k=function(e){return function(e,t){if(Ut(e,Me)){if(e.e()<=1)return function(e){if(Ut(e,Me)){var t;switch(e.e()){case 0:t=R();break;case 1:var r;r=Ut(e,xe)?e.f(0):e.b().d(),t=Y(r);break;default:t=n(e)}return t}return function(e){switch(e.e()){case 0:return R();case 1:return Y(e.f(0));default:return e}}(s(e))}(e);var r=G(e),i=jt(r)?r:ht();return function(e,t){e.length>1&&le(e,t)}(i,t),function(e){return new oe(e)}(i)}var a=s(e);return function(e,t){!function(e,t){if(e.e()<=1)return B();var r=G(e);le(r,t);var i=0,n=r.length;if(i<n)do{var s=i;i=i+1|0,e.w1(s,r[s])}while(i<n)}(e,t)}(a,t),a}(e,(null==wr&&new D,Ut(t=wr,W)?t:ht()));var t},e.$_$.l=qe,e.$_$.m=Mt,e.$_$.n=$e,e.$_$.o=function(e,t,r,i){return Object.defineProperty(e,t,{configurable:!0,get:r,set:i})},e.$_$.p=st,e.$_$.q=qt,e.$_$.r=function(e){return e instanceof ft?e:Dt(e)},e.$_$.s=Gt,e.$_$.t=ot,e.$_$.u=Bt,e.$_$.v=it,e.$_$.w=ft,e.$_$.x=function(e){return!function(e){var t;return H(),e===1/0?t=!0:(H(),t=e===-1/0),t}(e)&&!Ce(e)},e.$_$.y=Ce,e.$_$.z=function(e,t){return new L(e,t)},e.$_$.a1=Kr,e})?r.apply(t,i):r)||(e.exports=n)},9459:function(e,t,r){var i,n,s;n=[t,r(8636)],void 0===(s="function"===typeof(i=function(e,t){"use strict";function r(e,t){return e=e===be?null:e,this.h7(e)}function i(){$=this,this.x6_1=(new q).getValue()}function n(){return null==$&&new i,$}function s(e){n(),this.t6_1=e;var t=this.t6_1;this.u6_1=null==t?null:t.flags;var r=this.t6_1;this.v6_1=new g(null==r?null:r.skippableFragments),this.w6_1=function(e){var t,r=e.t6_1;if(null!=(null==r?null:r.rules)){for(var i=ve(),n=e.t6_1.rules,s=ye(n);s.c();){var a=s.d(),o=a.priority,l=a.rules;i.o2(o,l)}t=i}else{var d=[e.v6_1,new v];t=ge(me(0,d))}return t}(this)}function a(e,t,r){this.disableDynamicBuffer=e,this.lowBufferBeforeStart=t,this.defaultBuffer=r}function o(e,t,r){this.skippableFragments=e,this.flags=t,this.rules=r}function l(){}function d(e,t,r){r=r!==be&&r,this.startTime=e,this.endTime=t,this.autoSkip=r}function u(e,t,r){this.watchedTime=e,this.currentTime=t,this.flags=r}function c(){return ee}function h(e){e=e===be?null:e,this.n7_1=e}function p(e){e=e===be?null:e,this.o7_1=e}function f(e,t){this.watchedTime=e,this.currentTime=t}function m(e,t){this.priority=e,this.rules=t}function g(e){e=e===be?null:e,this.y6_1=e}function v(){}function y(){oe=this,this.q7_1=null,this.r7_1=new Q}function S(){return null==oe&&new y,oe}function E(e){var t,r,i;S(),e===be?(Ce(),t=NaN):t=e,e=t,r=Ie(),this.w7_1=r,this.x7_1=new _(e,!0),this.y7_1=(i=this,function(e){return i.sample(e.durationMs,e.sizeBytes),fe()})}function b(e){Ce(),this.z7_1=NaN,this.a8_1=0,this.b8_1=0,this.c8(e)}function A(){de=this,this.f8_1=new w(5,2),this.g8_1=new w(2,1)}function T(){return null==de&&new A,de}function _(e,t){var r;T(),e===be?(Ce(),r=NaN):r=e,e=r,t=t!==be&&t,this.h8_1=e,this.i8_1=t,this.j8_1=new b(T().f8_1.fast),this.k8_1=new b(T().f8_1.slow),this.l8_1=0,this.m8_1=new z}function w(e,t){this.slow=e,this.fast=t}function k(e,t){e=e===be?null:e,t=t===be?null:t,this.okMessage=e,this.errorMessage=t}function R(e,t){this.value=e,this.source=t}function P(){ce=this,this.MAX="max",this.MIN="min",this.DEFAULT="default"}function C(){return null==ce&&new P,ce}function I(){C()}function O(e,t){Me(t)&&function(e,t){for(e.b9_1.g(t);e.b9_1.l1_1>20;)e.b9_1.t1()}(e,t)}function D(e){var t=e.b9_1.b();if(!t.c())throw Fe();for(var r=t.d();t.c();){var i=t.d(),n=r;r=Math.max(n,i)}return r}function N(){this.b9_1=Ve()}function L(e,t,r){this.hasGoodEstimate=e,this.value=t,this.history=r}function x(e,t,r){r=r!==be&&r,this.durationMs=e,this.sizeBytes=t,this.isLowLatency=r}function M(e,t){var r,i=j().h9_1;if(X().t7_1){var n,s=t.sizeBytes;if(Me(s)){var a=e;a.j9_1=a.j9_1+s,n=fe()}r=n}else{var o;e:{var l=i.u7_1;try{if(l.v7_1.h(l))throw Pe("runLocked: recursion lock error");l.v7_1.g(l);var d,u=t.sizeBytes;if(Me(u)){var c=e;c.j9_1=c.j9_1+u,d=fe()}o=d;break e}finally{l.v7_1.a3(l)}}r=o}return r}function F(e,t){var r,i=j().h9_1;if(X().t7_1){var n=e.o9_1.e1(t),s=null==n?null:n.p9_1,a=null==s?0:s,o=e.o9_1.e1(t);null==o||(o.p9_1=a+1|0);var l=e,d=l.k9_1;if(l.k9_1=d+1|0,e.l9_1)return fe();e.l9_1=!0,e.m9_1=e.i9_1.create(),r=fe()}else{var u;e:{var c=i.u7_1;try{if(c.v7_1.h(c))throw Pe("runLocked: recursion lock error");c.v7_1.g(c);var h=e.o9_1.e1(t),p=null==h?null:h.p9_1,f=null==p?0:p,m=e.o9_1.e1(t);null==m||(m.p9_1=f+1|0);var g=e,v=g.k9_1;if(g.k9_1=v+1|0,e.l9_1)return fe();e.l9_1=!0,e.m9_1=e.i9_1.create(),u=fe();break e}finally{c.v7_1.a3(c)}}r=u}return r}function V(e,t){var r,i=j().h9_1;if(X().t7_1){var n=e.o9_1.e1(t),s=null==n?null:n.p9_1,a=null==s?0:s,o=e.o9_1.e1(t);if(null==o);else{var l,d=o,u=a-1|0;l=Math.max(u,0),d.p9_1=l}var c,h=e,p=e.k9_1-1|0;c=Math.max(p,0),h.k9_1=c,r=fe()}else{var f;e:{var m=i.u7_1;try{if(m.v7_1.h(m))throw Pe("runLocked: recursion lock error");m.v7_1.g(m);var g=e.o9_1.e1(t),v=null==g?null:g.p9_1,y=null==v?0:v,S=e.o9_1.e1(t);if(null==S);else{var E,b=S,A=y-1|0;E=Math.max(A,0),b.p9_1=E}var T,_=e,w=e.k9_1-1|0;T=Math.max(w,0),_.k9_1=T,f=fe();break e}finally{m.v7_1.a3(m)}}r=f}return r}function B(e,t,r){e=e===be?0:e,this.p9_1=e,this.q9_1=t,this.r9_1=r}function U(){he=this,this.h9_1=new Q}function j(){return null==he&&new U,he}function H(e){var t;j(),this.i9_1=e,this.j9_1=0,this.k9_1=0,this.l9_1=!1,this.m9_1=null,this.n9_1=new K,t=ve(),this.o9_1=t}function W(){this.u9_1=null,this.v9_1=null,this.w9_1=null}function q(e){e=e===be?null:e,this.x9_1=e}function Y(e){e=e===be?null:e,this.y9_1=e}function G(e){e=e===be?null:e,this.z9_1=e}function K(){var e;e=Ie(),this.s9_1=e}function z(e){var t;e=e===be?null:e,this.o8_1=e,t=Ie(),this.p8_1=t}function Z(){pe=this,this.t7_1=!1}function X(){return null==pe&&new Z,pe}function Q(){X(),this.u7_1=new J}function J(){var e;e=Ie(),this.v7_1=e}var $,ee,te,re,ie,ne,se,ae,oe,le,de,ue,ce,he,pe,fe=t.$_$.h,me=t.$_$.z,ge=t.$_$.j,ve=t.$_$.c,ye=t.$_$.l,Se=t.$_$.t,Ee=t.$_$.s,be=t.$_$.a1,Ae=t.$_$.u,Te=t.$_$.m,_e=t.$_$.k,we=t.$_$.b,ke=t.$_$.n,Re=t.$_$.q,Pe=t.$_$.f,Ce=t.$_$.g,Ie=t.$_$.d,Oe=t.$_$.o,De=t.$_$.y,Ne=t.$_$.r,Le=t.$_$.v,xe=t.$_$.w,Me=t.$_$.x,Fe=t.$_$.e,Ve=t.$_$.a,Be=t.$_$.i,Ue=t.$_$.p;return Ae(i,"Companion",Ee),Ae(s,"BufferGoalManager",Te),Ae(a,"BufferGoalManagerFlags",Te),Ae(o,"BufferGoalManagerProps",Te),Ae(l,"BufferGoalRule",Re),Ae(d,"SkippableFragment",Te),Ae(u,"BufferGoalRuleProps",Te),Ae(h,"WatchedTime",Te),Ae(p,"CurrentTime",Te),Ae(f,"GetBufferGoalProps",Te),Ae(m,"Rules",Te),Ae(g,"SkippableFragmentsRule",Te,be,[l]),Ae(v,"WatchedTimeRule",Te,be,[l]),Ae(y,"Companion",Ee),Ae(E,"BandwidthEstimator",Te),Ae(b,"EWMA",Te),Ae(A,"Companion",Ee),Ae(_,"EwmaBandwidthEstimatorV2",Te),Ae(w,"HalfLife",Te),Ae(k,"Result",Te),Ae(R,"TtfbEstimate",Te),Ae(P,"Companion",Ee),Ae(I,"TtfbEstimateSource",Te),Ae(N,"TtfbEstimator",Te),Ae(L,"TtfbEstimatorDebugInfo",Te),Ae(x,"BandwidthInfo",Te),Ae(B,"FetcherInfo",Te),Ae(U,"Companion",Ee),Ae(H,"FetcherProgressAccumulator",Te),Ae(W,"SingleListenerFetcher",Te),Ae(q,"DefaultBuffer",Te),Ae(Y,"DisableDynamicBuffer",Te),Ae(G,"LowBufferBeforeStart",Te),Ae(K,"EventEmitter",Te),Ae(z,"Signal",Te),Ae(Z,"Companion",Ee),Ae(Q,"Mutex",Te),Ae(J,"PlatformMutex",Te),Se(s).getBufferGoal=function(e){var t=this.u6_1,r=null==t?null:t.defaultBuffer,i=null==r?null:r.getValue(),s=null==i?n().x6_1:i,a=this.u6_1,o=null==a?null:a.disableDynamicBuffer;if(!0===(null==o?null:o.getValue()))return s;var l=null==e?null:e.watchedTime,d=null==l?null:l.getValue(),c=null==e?null:e.currentTime,h=new u(d,null==c?null:c.getValue(),this.u6_1),p=function(e,t){for(var r=_e(e.f1()).b();r.c();){var i,n=r.d(),s=e.e1(n);if(null==s)i=null;else{for(var a=we(),o=ye(s);o.c();){var l=o.d(),d=l.getBufferGoal(t);null==d||(a.g(d),fe())}i=a}var u,c=i;if(null==c)u=null;else{var h,p=c.b();if(p.c()){var f=p.d();if(p.c()){var m=f;do{var g=p.d(),v=g;ke(m,v)>0&&(f=g,m=v)}while(p.c());h=f}else h=f}else h=null;u=h}var y=u;if(null!=y)return y}return null}(this.w6_1,h);return null==p?s:p},Se(s).setSkippableFragments=function(e){this.v6_1.z6(e)},Se(s).getSkippableFragments=function(){return this.v6_1.a7()},Se(a).b7=function(){return this.disableDynamicBuffer},Se(a).c7=function(){return this.lowBufferBeforeStart},Se(a).d7=function(){return this.defaultBuffer},Se(o).e7=function(){return this.skippableFragments},Se(o).f7=function(){return this.flags},Se(o).g7=function(){return this.rules},Se(d).i7=function(){return this.startTime},Se(d).j7=function(){return this.endTime},Se(d).k7=function(){return this.autoSkip},Se(u).l7=function(){return this.watchedTime},Se(u).m7=function(){return this.currentTime},Se(u).f7=function(){return this.flags},Se(h).getValue=function(){return this.n7_1},Se(p).getValue=function(){return this.o7_1},Se(f).l7=function(){return this.watchedTime},Se(f).m7=function(){return this.currentTime},Se(m).p7=function(){return this.priority},Se(m).g7=function(){return this.rules},Se(g).h7=function(e){var t,r,i,n,s=null==e?null:e.currentTime,a=null==s?0:s,o=this.y6_1;if(null==o)return null;e:{for(var l=ye(o);l.c();){var d=l.d();if(d.startTime<=a&&a<d.endTime){r=d;break e}}r=null}if(null!=(t=r))return a-t.startTime<c()?re:ie;e:{for(var u=ye(o);u.c();){var h=u.d();if(a<h.startTime){n=h;break e}}n=null}return null!=(i=n)?i.startTime-a+ne:null},Se(g).z6=function(e){this.y6_1=e},Se(g).a7=function(){return this.y6_1},Se(v).h7=function(e){var t=null==e?null:e.watchedTime,r=null==t?0:t,i=null==e?null:e.flags,n=null==i?null:i.lowBufferBeforeStart;return!0===(null==n?null:n.getValue())&&r<=0?se:r<c()?te:null},Se(y).s7=function(e){var t=this.q7_1;if(null!=t)return t;var r=this.r7_1;if(X().t7_1){var i=S().q7_1;if(null!=i)return i;var n=new E(e);return S().q7_1=n,n}var s=r.u7_1;try{if(s.v7_1.h(s))throw Pe("runLocked: recursion lock error");s.v7_1.g(s);var a=S().q7_1;if(null!=a)return a;var o=new E(e);return S().q7_1=o,o}finally{s.v7_1.a3(s)}},Se(y).getInstance=function(e,t){var r;return e===be?(Ce(),r=NaN):r=e,e=r,this.s7(e)},Se(E).appendFetcher=function(e){this.w7_1.g(e),e.addProgressListener(this.y7_1)},Se(E).removeFetcher=function(e){this.w7_1.a3(e),e.removeProgressListener(this.y7_1)},Se(E).sample=function(e,t){return this.x7_1.sample(e,t,!1,ue,(le||(le=!0,ae=new w(5,.45)),ae))},Se(E).getBandwidthEstimate=function(){return this.x7_1.getBandwidthEstimate()},Se(E).hasGoodEstimate=function(){return this.x7_1.hasGoodEstimate()},Se(E).setDefaultEstimate=function(e){this.x7_1.setDefaultEstimate(e)},Se(E).addListener=function(e){this.x7_1.addListener(e)},Se(E).removeListener=function(e){this.x7_1.removeListener(e)},Se(E).removeAllListeners=function(){this.x7_1.removeAllListeners()},Se(E).destroy=function(){for(var e=this.w7_1.b();e.c();)e.d().removeProgressListener(this.y7_1)},Se(b).d8=function(e,t){var r=function(e,t,r){var i,n=e.z7_1;return i=Math.pow(n,t),r*(1-i)+i*e.a8_1}(this,e,t);De(r)||(this.a8_1=r,this.b8_1=this.b8_1+e)},Se(b).e8=function(){var e=this.z7_1,t=this.b8_1,r=1-Math.pow(e,t);return this.a8_1/r},Se(b).c8=function(e){var t,r=Math.log(.5)/e;t=Math.exp(r),this.z7_1=t},Se(_).n8=function(e,t,r,i,n){if(e<=0)return new k(be,"Sample ["+Le(Ne(t))+"]/["+Le(Ne(e))+"] not applied. Reason: durationMs <= 0");if(t<(r?2e3:i))return new k(be,"Sample ["+Le(Ne(t))+"]/["+Le(Ne(e))+"] not applied. Reason: too small sample. Min length = "+Le(r?new xe(2e3,0):Ne(i)));var s=n;!function(e,t){e.j8_1.c8(t.fast),e.k8_1.c8(t.slow)}(this,null==s?r?T().g8_1:T().f8_1:s);var a=8*t/(e/1e3),o=this.i8_1?.1:e/1e3;return this.l8_1=this.l8_1+t,this.j8_1.d8(o,a),this.k8_1.d8(o,a),this.m8_1.q8(this.getBandwidthEstimate()),new k("ok")},Se(_).sample=function(e,t,r,i,n,s){return r=r!==be&&r,i=i===be?16e3:i,n=n===be?null:n,this.n8(e,t,r,i,n)},Se(_).getBandwidthEstimate=function(){return this.hasGoodEstimate()?(t=(e=this).j8_1.e8(),r=e.k8_1.e8(),Math.min(t,r)):this.h8_1;var e,t,r},Se(_).hasGoodEstimate=function(){return this.l8_1>=128e3},Se(_).setDefaultEstimate=function(e){this.h8_1=e},Se(_).addListener=function(e){this.m8_1.r8(e)},Se(_).removeListener=function(e){this.m8_1.s8(e)},Se(_).removeAllListeners=function(){this.m8_1.h4()},Se(w).t8=function(){return this.slow},Se(w).u8=function(){return this.fast},Se(k).v8=function(){return this.okMessage},Se(k).w8=function(){return this.errorMessage},Se(R).u=function(){return this.value},Se(R).x8=function(){return this.source},Se(P).y8=function(){return this.MAX},Se(P).z8=function(){return this.MIN},Se(P).a9=function(){return this.DEFAULT},Se(N).appendFetcher=function(e){var t,r;e.addRequestTtfbListener((t=this,(r=function(e){return O(t,e),fe()}).callableName="handleTtfb",r))},Se(N).removeFetcher=function(e){var t,r;e.removeRequestTtfbListener((t=this,(r=function(e){return O(t,e),fe()}).callableName="handleTtfb",r))},Se(N).getMinTtfbEstimate=function(e){if(!this.hasGoodEstimate())return e;var t=this.b9_1.b();if(!t.c())throw Fe();for(var r=t.d();t.c();){var i=t.d(),n=r;r=Math.min(n,i)}var s=r;return C(),new R(s,"min")},Se(N).getTtfbEstimate=function(e){if(!this.hasGoodEstimate())return e;var t=D(this);return C(),new R(t,"max")},Se(N).hasGoodEstimate=function(){return this.b9_1.l1_1>1},Se(N).getDebugInfo=function(){var e=this.hasGoodEstimate(),t=D(this),r=this.b9_1;return new L(e,t,Be(r))},Se(L).c9=function(){return this.hasGoodEstimate},Se(L).u=function(){return this.value},Se(L).d9=function(){return this.history},Se(x).e9=function(){return this.durationMs},Se(x).f9=function(){return this.sizeBytes},Se(x).g9=function(){return this.isLowLatency},Se(H).appendFetcher=function(e){var t,r,i,n,s,a=j().h9_1;if(X().t7_1){var o=(n=this,s=e,function(){return F(n,s),fe()}),l=new B(be,o,function(e,t){return function(){return V(e,t),fe()}}(this,e));this.o9_1.o2(e,l),e.addProgressListener((r=this,(i=function(e){return M(r,e),fe()}).callableName="handleProgress",i)),e.addResponseStartListener(l.q9_1),e.addResponseEndListener(l.r9_1),t=fe()}else{var d;e:{var u=a.u7_1;try{if(u.v7_1.h(u))throw Pe("runLocked: recursion lock error");u.v7_1.g(u);var c=function(e,t){return function(){return F(e,t),fe()}}(this,e),h=new B(be,c,function(e,t){return function(){return V(e,t),fe()}}(this,e));this.o9_1.o2(e,h),e.addProgressListener(function(e){var t=function(t){return M(e,t),fe()};return t.callableName="handleProgress",t}(this)),e.addResponseStartListener(h.q9_1),e.addResponseEndListener(h.r9_1),d=fe();break e}finally{u.v7_1.a3(u)}}t=d}return t},Se(H).removeFetcher=function(e){var t,r,i,n=j().h9_1;if(X().t7_1){var s=this.o9_1.n3(e);if(null==s);else{var a,o=this.k9_1-s.p9_1|0;a=Math.max(o,0),this.k9_1=a,e.removeProgressListener((r=this,(i=function(e){return M(r,e),fe()}).callableName="handleProgress",i)),e.removeResponseStartListener(s.q9_1),e.removeResponseEndListener(s.r9_1),fe()}t=fe()}else{var l;e:{var d=n.u7_1;try{if(d.v7_1.h(d))throw Pe("runLocked: recursion lock error");d.v7_1.g(d);var u=this.o9_1.n3(e);if(null==u);else{var c,h=this.k9_1-u.p9_1|0;c=Math.max(h,0),this.k9_1=c,e.removeProgressListener(function(e){var t=function(t){return M(e,t),fe()};return t.callableName="handleProgress",t}(this)),e.removeResponseStartListener(u.q9_1),e.removeResponseEndListener(u.r9_1),fe()}l=fe();break e}finally{d.v7_1.a3(d)}}t=l}return t},Se(H).process=function(){var e,t=j().h9_1;if(X().t7_1){if(!this.l9_1)return fe();if(0===this.k9_1&&0===this.j9_1)return this.l9_1=!1,this.m9_1=null,fe();var r=this.j9_1;if(0===r)return fe();this.j9_1=0;var i=this.m9_1,n=null==i?null:i.getDurationMs(),s=null==n?0:n;this.m9_1=this.i9_1.create(),this.n9_1.t9(new x(s,r,!1)),e=fe()}else{var a;e:{var o=t.u7_1;try{if(o.v7_1.h(o))throw Pe("runLocked: recursion lock error");if(o.v7_1.g(o),!this.l9_1)return fe();if(0===this.k9_1&&0===this.j9_1)return this.l9_1=!1,this.m9_1=null,fe();var l=this.j9_1;if(0===l)return fe();this.j9_1=0;var d=this.m9_1,u=null==d?null:d.getDurationMs(),c=null==u?0:u;this.m9_1=this.i9_1.create(),this.n9_1.t9(new x(c,l,!1)),a=fe();break e}finally{o.v7_1.a3(o)}}e=a}return e},Se(H).addProgressListener=function(e){var t,r=j().h9_1;if(X().t7_1)this.n9_1.r8(e),t=fe();else{var i;e:{var n=r.u7_1;try{if(n.v7_1.h(n))throw Pe("runLocked: recursion lock error");n.v7_1.g(n),this.n9_1.r8(e),i=fe();break e}finally{n.v7_1.a3(n)}}t=i}return t},Se(H).removeProgressListener=function(e){var t,r=j().h9_1;if(X().t7_1)this.n9_1.s8(e),t=fe();else{var i;e:{var n=r.u7_1;try{if(n.v7_1.h(n))throw Pe("runLocked: recursion lock error");n.v7_1.g(n),this.n9_1.s8(e),i=fe();break e}finally{n.v7_1.a3(n)}}t=i}return t},Se(W).responseStart=function(){var e=this.u9_1;null==e||e()},Se(W).responseEnd=function(){var e=this.v9_1;null==e||e()},Se(W).responseProgress=function(e){var t=this.w9_1;null==t||t(e)},Se(W).addResponseStartListener=function(e){null==this.u9_1&&(this.u9_1=e)},Se(W).removeResponseStartListener=function(e){this.u9_1=null},Se(W).addResponseEndListener=function(e){null==this.v9_1&&(this.v9_1=e)},Se(W).removeResponseEndListener=function(e){this.v9_1=null},Se(W).addProgressListener=function(e){null==this.w9_1&&(this.w9_1=e)},Se(W).removeProgressListener=function(e){this.w9_1=null},Se(q).getValue=function(){var e=this.x9_1;return null==e?30:e},Se(Y).getValue=function(){var e=this.y9_1;return null!=e&&e},Se(G).getValue=function(){var e=this.z9_1;return null!=e&&e},Se(K).r8=function(e){this.s9_1.g(e)},Se(K).s8=function(e){this.s9_1.a3(e)},Se(K).t9=function(e){for(var t=this.s9_1.b();t.c();)t.d()(e)},Se(z).r8=function(e){this.p8_1.g(e)},Se(z).s8=function(e){this.p8_1.a3(e)},Se(z).h4=function(){this.p8_1.h4()},Se(z).q8=function(e){if(Ue(this.o8_1,e))return fe();this.o8_1=e;for(var t=this.p8_1.b();t.c();)t.d()(e)},Se(g).getBufferGoal=r,Se(v).getBufferGoal=r,ee=15,te=15,re=3,ie=3,ne=5,se=5,ue=2e3,function(e){var t=(n=e.ru||(e.ru={})).yandex||(n.yandex={}),r=(l=t.videoplayer||(t.videoplayer={})).multiplatform||(l.multiplatform={});(c=r.bgm||(r.bgm={})).BufferGoalManager=s,t=(n=e.ru||(e.ru={})).yandex||(n.yandex={}),r=(l=t.videoplayer||(t.videoplayer={})).multiplatform||(l.multiplatform={}),(c=r.bgm||(r.bgm={})).BufferGoalManagerFlags=a,t=(n=e.ru||(e.ru={})).yandex||(n.yandex={}),r=(l=t.videoplayer||(t.videoplayer={})).multiplatform||(l.multiplatform={}),(c=r.bgm||(r.bgm={})).BufferGoalManagerProps=o;var i,n=e.ru||(e.ru={}),l=(t=n.yandex||(n.yandex={})).videoplayer||(t.videoplayer={}),c=(r=l.multiplatform||(l.multiplatform={})).bgm||(r.bgm={});t=(n=e.ru||(e.ru={})).yandex||(n.yandex={}),r=(l=t.videoplayer||(t.videoplayer={})).multiplatform||(l.multiplatform={}),(c=r.bgm||(r.bgm={})).SkippableFragment=d,c.BufferGoalRuleProps=u,t=(n=e.ru||(e.ru={})).yandex||(n.yandex={}),r=(l=t.videoplayer||(t.videoplayer={})).multiplatform||(l.multiplatform={}),(c=r.bgm||(r.bgm={})).WatchedTime=h,c.CurrentTime=p,c.GetBufferGoalProps=f,t=(n=e.ru||(e.ru={})).yandex||(n.yandex={}),r=(l=t.videoplayer||(t.videoplayer={})).multiplatform||(l.multiplatform={}),(c=r.bgm||(r.bgm={})).Rules=m,t=(n=e.ru||(e.ru={})).yandex||(n.yandex={}),r=(l=t.videoplayer||(t.videoplayer={})).multiplatform||(l.multiplatform={}),(i=r.estimate||(r.estimate={})).BandwidthEstimator=E,Oe(i.BandwidthEstimator,"Companion",S),t=(n=e.ru||(e.ru={})).yandex||(n.yandex={}),r=(l=t.videoplayer||(t.videoplayer={})).multiplatform||(l.multiplatform={}),(i=r.estimate||(r.estimate={})).EwmaBandwidthEstimatorV2=_,i.HalfLife=w,t=(n=e.ru||(e.ru={})).yandex||(n.yandex={}),r=(l=t.videoplayer||(t.videoplayer={})).multiplatform||(l.multiplatform={}),(i=r.estimate||(r.estimate={})).Result=k,t=(n=e.ru||(e.ru={})).yandex||(n.yandex={}),r=(l=t.videoplayer||(t.videoplayer={})).multiplatform||(l.multiplatform={}),(i=r.estimate||(r.estimate={})).TtfbEstimate=R,t=(n=e.ru||(e.ru={})).yandex||(n.yandex={}),r=(l=t.videoplayer||(t.videoplayer={})).multiplatform||(l.multiplatform={}),(i=r.estimate||(r.estimate={})).TtfbEstimateSource=I,Oe(i.TtfbEstimateSource,"Companion",C),t=(n=e.ru||(e.ru={})).yandex||(n.yandex={}),r=(l=t.videoplayer||(t.videoplayer={})).multiplatform||(l.multiplatform={}),(i=r.estimate||(r.estimate={})).TtfbEstimator=N,t=(n=e.ru||(e.ru={})).yandex||(n.yandex={}),r=(l=t.videoplayer||(t.videoplayer={})).multiplatform||(l.multiplatform={}),(i=r.estimate||(r.estimate={})).TtfbEstimatorDebugInfo=L,t=(n=e.ru||(e.ru={})).yandex||(n.yandex={}),r=(l=t.videoplayer||(t.videoplayer={})).multiplatform||(l.multiplatform={}),(g=r.fetcher||(r.fetcher={})).BandwidthInfo=x,t=(n=e.ru||(e.ru={})).yandex||(n.yandex={}),r=(l=t.videoplayer||(t.videoplayer={})).multiplatform||(l.multiplatform={}),(g=r.fetcher||(r.fetcher={})).FetcherProgressAccumulator=H,Oe(g.FetcherProgressAccumulator,"Companion",j),t=(n=e.ru||(e.ru={})).yandex||(n.yandex={}),r=(l=t.videoplayer||(t.videoplayer={})).multiplatform||(l.multiplatform={}),(g=r.fetcher||(r.fetcher={})).SingleListenerFetcher=W,t=(n=e.ru||(e.ru={})).yandex||(n.yandex={}),((r=(l=t.videoplayer||(t.videoplayer={})).multiplatform||(l.multiplatform={})).flags||(r.flags={})).DefaultBuffer=q,t=(n=e.ru||(e.ru={})).yandex||(n.yandex={}),((r=(l=t.videoplayer||(t.videoplayer={})).multiplatform||(l.multiplatform={})).flags||(r.flags={})).DisableDynamicBuffer=Y,t=(n=e.ru||(e.ru={})).yandex||(n.yandex={}),((r=(l=t.videoplayer||(t.videoplayer={})).multiplatform||(l.multiplatform={})).flags||(r.flags={})).LowBufferBeforeStart=G,n=e.ru||(e.ru={}),l=(t=n.yandex||(n.yandex={})).videoplayer||(t.videoplayer={});var g=(r=l.multiplatform||(l.multiplatform={})).fetcher||(r.fetcher={});n=e.ru||(e.ru={}),l=(t=n.yandex||(n.yandex={})).videoplayer||(t.videoplayer={}),g=(r=l.multiplatform||(l.multiplatform={})).fetcher||(r.fetcher={}),n=e.ru||(e.ru={}),l=(t=n.yandex||(n.yandex={})).videoplayer||(t.videoplayer={}),g=(r=l.multiplatform||(l.multiplatform={})).fetcher||(r.fetcher={}),n=e.ru||(e.ru={}),l=(t=n.yandex||(n.yandex={})).videoplayer||(t.videoplayer={}),(r=l.multiplatform||(l.multiplatform={})).utils||(r.utils={}),n=e.ru||(e.ru={}),l=(t=n.yandex||(n.yandex={})).videoplayer||(t.videoplayer={}),(r=l.multiplatform||(l.multiplatform={})).utils||(r.utils={})}(e),e})?i.apply(t,n):i)||(e.exports=s)},3106:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.identity=void 0,t.identity=function(e){return e}},7881:(e,t,r)=>{"use strict";var i=r(3850);r.o(i,"toBps")&&r.d(t,{toBps:function(){return i.toBps}}),r.o(i,"toSeconds")&&r.d(t,{toSeconds:function(){return i.toSeconds}});var n=r(4423);r.o(n,"toBps")&&r.d(t,{toBps:function(){return n.toBps}}),r.o(n,"toSeconds")&&r.d(t,{toSeconds:function(){return n.toSeconds}});r(2968)},2968:(e,t)=>{"use strict"},6285:(e,t,r)=>{"use strict";function i(e){return Math.max(e,0)}function n(e){return Math.floor(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.toUnsignedInt=t.toUnsignedFloat=t.toInt=t.toUnsigned=t.toFloat=void 0;const s=r(3106);t.toFloat=s.identity,t.toUnsigned=i,t.toInt=n,t.toUnsignedFloat=function(e){return i((0,t.toFloat)(e))},t.toUnsignedInt=function(e){return i(n(e))}},3849:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toTimestamp=t.toMilliseconds=t.toMbps=t.toMegaBitsPerSeconds=t.toKbps=t.toKiloBitsPerSeconds=t.toBps=t.toBitsPerSeconds=t.toMegabits=t.toKilobits=void 0;const i=r(3106),n=r(2008);t.toKilobits=i.identity,t.toMegabits=i.identity,t.toBitsPerSeconds=i.identity,t.toBps=t.toBitsPerSeconds,t.toKiloBitsPerSeconds=i.identity,t.toKbps=t.toKiloBitsPerSeconds,t.toMegaBitsPerSeconds=i.identity,t.toMbps=t.toMegaBitsPerSeconds,t.toMilliseconds=i.identity,t.toTimestamp=n.toMoment},2008:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toPixels=t.toPerSeconds=t.toPercent=t.toPortion=t.toDays=t.toHours=t.toMinutes=t.toSeconds=t.toDuration=t.toMoment=t.toBytes=t.toBits=void 0;const i=r(3106);t.toBits=i.identity,t.toBytes=i.identity,t.toMoment=i.identity,t.toDuration=i.identity,t.toSeconds=i.identity,t.toMinutes=i.identity,t.toHours=i.identity,t.toDays=i.identity,t.toPortion=i.identity,t.toPercent=i.identity,t.toPerSeconds=i.identity,t.toPixels=i.identity},4423:function(e,t,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,i,n)}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||i(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(6285),t),n(r(2008),t),n(r(3849),t)},963:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2846:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},4957:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},3850:function(e,t,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,i,n)}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||i(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(963),t),n(r(4957),t),n(r(2846),t)},1299:(e,t)=>{"use strict";function r(e,t){try{return t(e)}catch(r){return e}}t.parse=function(e,t){if("string"!==typeof e)throw new TypeError("argument str must be a string");for(var n={},a=t||{},o=e.split(s),l=a.decode||i,d=0;d<o.length;d++){var u=o[d],c=u.indexOf("=");if(!(c<0)){var h=u.substr(0,c).trim(),p=u.substr(++c,u.length).trim();'"'==p[0]&&(p=p.slice(1,-1)),void 0==n[h]&&(n[h]=r(p,l))}}return n},t.serialize=function(e,t,r){var i=r||{},s=i.encode||n;if("function"!==typeof s)throw new TypeError("option encode is invalid");if(!a.test(e))throw new TypeError("argument name is invalid");var o=s(t);if(o&&!a.test(o))throw new TypeError("argument val is invalid");var l=e+"="+o;if(null!=i.maxAge){var d=i.maxAge-0;if(isNaN(d))throw new Error("maxAge should be a Number");l+="; Max-Age="+Math.floor(d)}if(i.domain){if(!a.test(i.domain))throw new TypeError("option domain is invalid");l+="; Domain="+i.domain}if(i.path){if(!a.test(i.path))throw new TypeError("option path is invalid");l+="; Path="+i.path}if(i.expires){if("function"!==typeof i.expires.toUTCString)throw new TypeError("option expires is invalid");l+="; Expires="+i.expires.toUTCString()}if(i.httpOnly&&(l+="; HttpOnly"),i.secure&&(l+="; Secure"),i.sameSite)switch("string"===typeof i.sameSite?i.sameSite.toLowerCase():i.sameSite){case!0:l+="; SameSite=Strict";break;case"lax":l+="; SameSite=Lax";break;case"strict":l+="; SameSite=Strict";break;default:throw new TypeError("option sameSite is invalid")}return l};var i=decodeURIComponent,n=encodeURIComponent,s=/; */,a=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/},870:e=>{function t(e,t){var r,i=e[1]||"",n=e[3];if(!n)return i;if(t&&"function"===typeof btoa){var s=(r=n,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */"),a=n.sources.map((function(e){return"/*# sourceURL="+n.sourceRoot+e+" */"}));return[i].concat(a).concat([s]).join("\n")}return[i].join("\n")}e.exports=function(e){var r=[];return r.toString=function(){return this.map((function(r){var i=t(r,e);return r[2]?"@media "+r[2]+"{"+i+"}":i})).join("")},r.i=function(e,t){"string"===typeof e&&(e=[[null,e,""]]);for(var i={},n=0;n<this.length;n++){var s=this[n][0];"number"===typeof s&&(i[s]=!0)}for(n=0;n<e.length;n++){var a=e[n];"number"===typeof a[0]&&i[a[0]]||(t&&!a[2]?a[2]=t:t&&(a[2]="("+a[2]+") and ("+t+")"),r.push(a))}},r}},6386:e=>{e.exports=function(e){e||(e=window);var t=e.navigator.userAgent,r=t.indexOf("MSIE ");if(r>0)return parseInt(t.substring(r+5,t.indexOf(".",r)),10);if(t.indexOf("Trident/")>0){var i=t.indexOf("rv:");return parseInt(t.substring(i+3,t.indexOf(".",i)),10)}var n=t.indexOf("Edge/");return n>0&&parseInt(t.substring(n+5,t.indexOf(".",n)),10)}},6048:e=>{"use strict";var t=Array.isArray,r=Object.keys,i=Object.prototype.hasOwnProperty;e.exports=function e(n,s){if(n===s)return!0;if(n&&s&&"object"==typeof n&&"object"==typeof s){var a,o,l,d=t(n),u=t(s);if(d&&u){if((o=n.length)!=s.length)return!1;for(a=o;0!==a--;)if(!e(n[a],s[a]))return!1;return!0}if(d!=u)return!1;var c=n instanceof Date,h=s instanceof Date;if(c!=h)return!1;if(c&&h)return n.getTime()==s.getTime();var p=n instanceof RegExp,f=s instanceof RegExp;if(p!=f)return!1;if(p&&f)return n.toString()==s.toString();var m=r(n);if((o=m.length)!==r(s).length)return!1;for(a=o;0!==a--;)if(!i.call(s,m[a]))return!1;for(a=o;0!==a--;)if(!e(n[l=m[a]],s[l]))return!1;return!0}return n!==n&&s!==s}},6394:e=>{function t(){var e,t,r,i,n=document.createElement("canvas");try{e=n.getContext("webgl")||n.getContext("experimental-webgl")}catch(s){}return e&&(t=e.getExtension("WEBGL_debug_renderer_info"),r=e.getParameter(t.UNMASKED_VENDOR_WEBGL),i=e.getParameter(t.UNMASKED_RENDERER_WEBGL)),{debugInfo:t,vendor:r,renderer:i}}e.exports=t,e.exports.getGpu=t},5508:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={TALB:"album",TBPM:"bpm",TCOM:"composer",TCON:"genre",TCOP:"copyright",TDEN:"encoding-time",TDLY:"playlist-delay",TDOR:"original-release-time",TDRC:"recording-time",TDRL:"release-time",TDTG:"tagging-time",TENC:"encoder",TEXT:"writer",TFLT:"file-type",TIPL:"involved-people",TIT1:"content-group",TIT2:"title",TIT3:"subtitle",TKEY:"initial-key",TLAN:"language",TLEN:"length",TMCL:"credits",TMED:"media-type",TMOO:"mood",TOAL:"original-album",TOFN:"original-filename",TOLY:"original-writer",TOPE:"original-artist",TOWN:"owner",TPE1:"artist",TPE2:"band",TPE3:"conductor",TPE4:"remixer",TPOS:"set-part",TPRO:"produced-notice",TPUB:"publisher",TRCK:"track",TRSN:"radio-name",TRSO:"radio-owner",TSOA:"album-sort",TSOP:"performer-sort",TSOT:"title-sort",TSRC:"isrc",TSSE:"encoder-settings",TSST:"set-subtitle",TXXX:"user-defined-text-information",TYER:"year",WCOM:"url-commercial",WCOP:"url-legal",WOAF:"url-file",WOAR:"url-artist",WOAS:"url-source",WORS:"url-radio",WPAY:"url-payment",WPUB:"url-publisher",WAF:"url-file",WAR:"url-artist",WAS:"url-source",WCM:"url-commercial",WCP:"url-copyright",WPB:"url-publisher",COMM:"comments",USLT:"lyrics",APIC:"image",PIC:"image",IPLS:"involved-people-list",OWNE:"ownership"},t.FrameTypeValueMap={TXXX:"array",COMM:"array",USLT:"array"}},3940:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=["Blues","Classic Rock","Country","Dance","Disco","Funk","Grunge","Hip-Hop","Jazz","Metal","New Age","Oldies","Other","Pop","R&B","Rap","Reggae","Rock","Techno","Industrial","Alternative","Ska","Death Metal","Pranks","Soundtrack","Euro-Techno","Ambient","Trip-Hop","Vocal","Jazz+Funk","Fusion","Trance","Classical","Instrumental","Acid","House","Game","Sound Clip","Gospel","Noise","AlternRock","Bass","Soul","Punk","Space","Meditative","Instrumental Pop","Instrumental Rock","Ethnic","Gothic","Darkwave","Techno-Industrial","Electronic","Pop-Folk","Eurodance","Dream","Southern Rock","Comedy","Cult","Gangsta Rap","Top 40","Christian Rap","Pop / Funk","Jungle","Native American","Cabaret","New Wave","Psychedelic","Rave","Showtunes","Trailer","Lo-Fi","Tribal","Acid Punk","Acid Jazz","Polka","Retro","Musical","Rock & Roll","Hard Rock","Folk","Folk-Rock","National Folk","Swing","Fast  Fusion","Bebob","Latin","Revival","Celtic","Bluegrass","Avantgarde","Gothic Rock","Progressive Rock","Psychedelic Rock","Symphonic Rock","Slow Rock","Big Band","Chorus","Easy Listening","Acoustic","Humour","Speech","Chanson","Opera","Chamber Music","Sonata","Symphony","Booty Bass","Primus","Porn Groove","Satire","Slow Jam","Club","Tango","Samba","Folklore","Ballad","Power Ballad","Rhythmic Soul","Freestyle","Duet","Punk Rock","Drum Solo","A Cappella","Euro-House","Dance Hall","Goa","Drum & Bass","Club-House","Hardcore","Terror","Indie","BritPop","Negerpunk","Polsk Punk","Beat","Christian Gangsta Rap","Heavy Metal","Black Metal","Crossover","Contemporary Christian","Christian Rock","Merengue","Salsa","Thrash Metal","Anime","JPop","Synthpop","Rock/Pop"]},4053:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=["other","file-icon","icon","cover-front","cover-back","leaflet","media","artist-lead","artist","conductor","band","composer","lyricist-writer","recording-location","during-recording","during-performance","screen","fish","illustration","logo-band","logo-publisher"]},6636:function(e,t,r){"use strict";var i=this&&this.__assign||Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},n=this&&this.__rest||function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&(r[i[n]]=e[i[n]])}return r};Object.defineProperty(t,"__esModule",{value:!0});var s=r(6449);t.parseV1Tag=s.default;var a=r(3796);t.parseV2Tag=a.default,r(1689).default(),t.parse=function(e){var t=s.default(e),r=a.default(e);if(!r&&!t)return!1;var o={version:!1},l=r||o,d=l.version,u=n(l,["version"]),c=t||o,h=c.version,p=n(c,["version"]),f=i({version:{v1:h,v2:d}},p,u);return p.comments&&(f.comments=[{value:p.comments}].concat(u&&u.comments?u.comments:[])),f}},6449:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(3940),n=r(9107);t.default=function(e){if(!e||e.length<128)return!1;e=e.slice(e.length-128);var t={version:{major:1,minor:0}};if("TAG"!==n.readBytesToUTF8(e,3))return!1;var r=/(^[\s0]+|[\s0]+$)/;return t.title=n.readBytesToUTF8(e.slice(3),30).replace(r,""),t.artist=n.readBytesToUTF8(e.slice(33),30).replace(r,""),t.album=n.readBytesToUTF8(e.slice(63),30).replace(r,""),t.year=n.readBytesToUTF8(e.slice(93),4).replace(r,""),0===e[125]?(t.comments=n.readBytesToUTF8(e.slice(97),28).replace(r,""),t.version.minor=1,t.track=e[126]):t.comments=n.readBytesToUTF8(e.slice(97),30).replace(r,""),t.genre=i.default[e[127]]||"",t}},3796:(e,t,r)=>{"use strict";function i(e){return 2097152*(127&e[0])+16384*(127&e[1])+128*(127&e[2])+(127&e[3])}function n(e){return e.length<4?0:16777216*e[0]+65536*e[1]+256*e[2]+e[3]}function s(e,t,r){var i={id:null,tag:null,value:null},n={id:d.readBytesToUTF8(e,4),type:null,size:r,flags:[e[8],e[9]]};if(n.type=n.id[0],i.id=n.id,0!==n.flags[1])return i;if(!(n.id in a.default))return i;i.tag=a.default[n.id];var s=0,u=0,c=0,h=0;if("T"===n.type){if(s=e[10],"TXXX"===n.id){u=11,c=d.getEndpointOfBytes(e,s,u)-u;var p={description:d.readBytesToString(e.slice(u),s,c),value:""};u+=c+1,u=d.skipPaddingZeros(e,u),p.value=d.readBytesToString(e.slice(u),s),i.value=p}else if(i.value=d.readBytesToString(e.slice(11),s),"TCON"===n.id&&null!==i.value)if("("===i.value[0]){var f=i.value.match(/\(\d+\)/g);f&&(i.value=f.map((function(e){return o.default[+e.slice(1,-1)]})).join(","))}else{var m=parseInt(i.value,10);isNaN(m)||(i.value=o.default[m])}}else if("W"===n.type)"WXXX"===n.id&&0===e[10]?i.value=d.readBytesToISO8859(e.slice(11)):i.value=d.readBytesToISO8859(e.slice(10));else if("COMM"===n.id||"USLT"===n.id){s=e[10],u=14,c=0;var g=d.readBytesToISO8859(e.slice(11),3);c=d.getEndpointOfBytes(e,s,u)-u;var v=d.readBytesToString(e.slice(u),s,c);u=d.skipPaddingZeros(e,u+c+1),i.value={language:g,description:v,value:d.readBytesToString(e.slice(u),s)}}else if("APIC"===n.id){s=e[10];var y={type:null,mime:null,description:null,data:null};for(u=11,c=d.getEndpointOfBytes(e,0,u)-u,y.mime=d.readBytesToString(e.slice(u),0,c),y.type=l.default[e[u+c+1]]||"other",u+=c+2,c=0,h=u;;h++)if(0===e[h]){c=h-u;break}y.description=0===c?null:d.readBytesToString(e.slice(u),s,c),u=d.skipPaddingZeros(e,u+c+1),y.data=e.slice(u),i.value=y}else if("IPLS"===n.id)s=e[10],i.value=d.readBytesToString(e.slice(11),s);else if("OWNE"===n.id){s=e[10],u=11,c=d.getEndpointOfBytes(e,s,u);var S=d.readBytesToISO8859(e.slice(u),c);u+=c+1;var E=d.readBytesToISO8859(e.slice(u),8);u+=8,i.value={pricePayed:S,dateOfPurch:E,seller:d.readBytesToString(e.slice(u),s)}}return i}Object.defineProperty(t,"__esModule",{value:!0});var a=r(5508),o=r(3940),l=r(4053),d=r(9107);t.default=function(e){if(!e||e.length<20)return!1;var t=function(e){if(!e||e.length<10)return!1;if("ID3"!==d.readBytesToUTF8(e,3))return!1;var t=e[5];return{version:{major:2,minor:e[3],revision:e[4],flags:{unsync:0!==(128&t),xheader:0!==(64&t),experimental:0!==(32&t)}}}}(e.slice(0,10));if(!t)return!1;var r=t.version.flags;if(r.unsync)throw new Error("no support for unsynchronisation");var o=10;r.xheader&&(o+=i(e.slice(10,14)));var l=i(e.slice(6,10));return function(e,t){var r=0,i=t.version;for(;r<e.length;){var o=n(e.slice(r+4));if(0===o)break;var l=e.slice(r,r+10+o);if(!l.length)break;var d=s(l,i.minor,o);d.tag&&("array"===a.FrameTypeValueMap[d.id]?t[d.tag]?t[d.tag].push(d.value):t[d.tag]=[d.value]:t[d.tag]=d.value),r+=l.length}}(e.slice(o,l+o),t),t},t.calcTagSize=i,t.calcFrameSize=n},1689:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){"function"!==typeof Uint8Array||Uint8Array.prototype.slice||Object.defineProperty(Uint8Array.prototype,"slice",{value:Array.prototype.slice})}},9107:(e,t)=>{"use strict";function r(e,t){t=null==t||t<0?e.length:Math.min(t,e.length);var r=0;239===e[0]&&187===e[1]&&191===e[2]&&(r=3);for(var i=[],n=0;r<t;n++){var a=e[r++],o=void 0,l=void 0,d=void 0;if(0===a)break;a<128?i[n]=s(a):a>=194&&a<224?(o=e[r++],i[n]=s(((31&a)<<6)+(63&o))):a>=224&&a<240?(o=e[r++],l=e[r++],i[n]=s(((15&a)<<12)+((63&o)<<6)+(63&l))):a>=240&&a<245&&(d=((7&a)<<18)+((63&(o=e[r++]))<<12)+((63&(l=e[r++]))<<6)+(63&e[r++])-65536,i[n]=s(55296+(d>>10),56320+(1023&d)))}return i.join("")}function i(e,t,r){r=null==r||r<0?e.length:Math.min(r,e.length);var i=0,n=1,a=0;254===e[0]&&255===e[1]?(t=!0,i=2):255===e[0]&&254===e[1]&&(t=!1,i=2),t&&(n=0,a=1);for(var o,l,d,u,c=[],h=0;i<r&&(o=e[i+n],l=e[i+a],i+=2,0!==(d=(o<<8)+l));h++)o<216||o>=224?c[h]=s(d):(u=(e[i+n]<<8)+e[i+a],i+=2,c[h]=s(d,u));return c.join("")}function n(e,t){t=null==t||t<0?e.length:Math.min(t,e.length);for(var r=[],i=0;i<t;i++)r.push(s(e[i]));return r.join("")}Object.defineProperty(t,"__esModule",{value:!0});var s=String.fromCharCode;t.readBytesToUTF8=r,t.readBytesToUTF16=i,t.readBytesToISO8859=n,t.readBytesToString=function(e,t,s){return 0===t?n(e,s):3===t?r(e,s):1===t||2===t?i(e,void 0,s):null},t.getEndpointOfBytes=function(e,t,r){void 0===r&&(r=0);for(var i=0===t?function(t){return 0===e[t]}:function(t){return 0===e[t]&&0===e[t+1]},n=r;n<e.length&&!i(n);n++);return n},t.skipPaddingZeros=function(e,t){for(var r=t;0===e[r];r++)t++;return t}},502:(e,t,r)=>{"use strict";function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}();t.hasCookies=function(){var e=new u;try{e.setItem("__test","1");var t=e.getItem("__test");return e.removeItem("__test"),"1"===t}catch(r){return!1}};var a,o=r(1299),l=(a=o)&&a.__esModule?a:{default:a},d="lS_",u=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n(this,e),this.cookieOptions=i({path:"/"},t),d=void 0===t.prefix?d:t.prefix}return s(e,[{key:"getItem",value:function(e){var t=l.default.parse(document.cookie);return t&&t.hasOwnProperty(d+e)?t[d+e]:null}},{key:"setItem",value:function(e,t){return document.cookie=l.default.serialize(d+e,t,this.cookieOptions),t}},{key:"removeItem",value:function(e){var t=i({},this.cookieOptions,{maxAge:-1});return document.cookie=l.default.serialize(d+e,"",t),null}},{key:"clear",value:function(){var e=l.default.parse(document.cookie);for(var t in e)0===t.indexOf(d)&&this.removeItem(t.substr(d.length));return null}}]),e}();t.default=u},4585:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._data={}}return r(e,[{key:"getItem",value:function(e){return this._data.hasOwnProperty(e)?this._data[e]:null}},{key:"setItem",value:function(e,t){return this._data[e]=String(t)}},{key:"removeItem",value:function(e){return delete this._data[e]}},{key:"clear",value:function(){return this._data={}}}]),e}();t.default=i},2741:(e,t,r)=>{"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var n=i(r(1402)),s=i(r(502)),a=i(r(4585)),o=null;o=(0,n.default)("localStorage")?window.localStorage:(0,n.default)("sessionStorage")?window.sessionStorage:(0,n.default)("cookieStorage")?new s.default:new a.default,t.ZP=o,n.default,s.default,a.default},1402:(e,t,r)=>{"use strict";function i(e){try{var t=window[e];return t.setItem("__test","1"),t.removeItem("__test"),!0}catch(r){return!1}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"localStorage",t=String(e).replace(/storage$/i,"").toLowerCase();if("local"===t)return i("localStorage");if("session"===t)return i("sessionStorage");if("cookie"===t)return(0,n.hasCookies)();if("memory"===t)return!0;throw new Error("Storage method `"+e+"` is not available.\n    Please use one of the following: localStorage, sessionStorage, cookieStorage, memoryStorage.")};var n=r(502)},8139:e=>{"use strict";e.exports=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){return e.__proto__=t,e}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(e,r)||(e[r]=t[r]);return e})},3741:function(e,t){!function(e){"use strict";function t(e,t){function n(t){for(var r=[];e[u];)if(e.charCodeAt(u)==p){if(e.charCodeAt(u+1)===g){var i=u+2;if(u=e.indexOf(">",u),-1==e.substring(i,u).indexOf(t)){var n=e.substring(0,u).split("\n");throw new Error("Unexpected close tag\nLine: "+(n.length-1)+"\nColumn: "+(n[n.length-1].length+1)+"\nChar: "+e[u])}return u+1&&(u+=1),r}if(e.charCodeAt(u+1)===v){if(e.charCodeAt(u+2)==m){const t=u;for(;-1!==u&&(e.charCodeAt(u)!==f||e.charCodeAt(u-1)!=m||e.charCodeAt(u-2)!=m||-1==u);)u=e.indexOf(">",u+1);-1===u&&(u=e.length),c&&r.push(e.substring(t,u+1))}else{if(e.charCodeAt(u+2)===E&&e.charCodeAt(u+8)===E&&"cdata"===e.substr(u+3,5).toLowerCase()){var a=e.indexOf("]]>",u);-1==a?(r.push(e.substr(u+9)),u=e.length):(r.push(e.substring(u+9,a)),u=a+3);continue}{const t=u+1;u+=2;for(var l=!1;(e.charCodeAt(u)!==f||!0===l)&&e[u];)e.charCodeAt(u)===E?l=!0:!0===l&&e.charCodeAt(u)===b&&(l=!1),u++;r.push(e.substring(t,u))}}u++;continue}var d=o();r.push(d),"?"===d.tagName[0]&&(r.push(...d.children),d.children=[])}else{var y=s();if(h)y.length>0&&r.push(y);else{var S=y.trim();S.length>0&&r.push(S)}u++}return r}function s(){var t=u;return-2===(u=e.indexOf("<",u)-1)&&(u=e.length),e.slice(t,u+1)}function a(){for(var t=u;-1==="\r\n\t>/= ".indexOf(e[u])&&e[u];)u++;return e.slice(t,u)}function o(){u++;const t=a(),r={};let i=[];for(;e.charCodeAt(u)!==f&&e[u];){var s=e.charCodeAt(u);if(s>64&&s<91||s>96&&s<123){for(var o=a(),d=e.charCodeAt(u);d&&d!==y&&d!==S&&!(d>64&&d<91||d>96&&d<123)&&d!==f;)u++,d=e.charCodeAt(u);if(d===y||d===S){var c=l();if(-1===u)return{tagName:t,attributes:r,children:i}}else c=null,u--;r[o]=c}u++}if(e.charCodeAt(u-1)!==g)if("script"==t){var h=u+1;u=e.indexOf("<\/script>",u),i=[e.slice(h,u)],u+=9}else"style"==t?(h=u+1,u=e.indexOf("</style>",u),i=[e.slice(h,u)],u+=8):-1===A.indexOf(t)?(u++,i=n(t)):u++;else u++;return{tagName:t,attributes:r,children:i}}function l(){var t=e[u],r=u+1;return u=e.indexOf(t,r),e.slice(r,u)}var d,u=(t=t||{}).pos||0,c=!!t.keepComments,h=!!t.keepWhitespace,p="<".charCodeAt(0),f=">".charCodeAt(0),m="-".charCodeAt(0),g="/".charCodeAt(0),v="!".charCodeAt(0),y="'".charCodeAt(0),S='"'.charCodeAt(0),E="[".charCodeAt(0),b="]".charCodeAt(0),A=t.noChildNodes||["img","br","input","meta","link","hr"],T=null;if(void 0!==t.attrValue)for(t.attrName=t.attrName||"id",T=[];-1!==(d=new RegExp("\\s"+t.attrName+"\\s*=['\"]"+t.attrValue+"['\"]").exec(e),u=d?d.index:-1);)-1!==(u=e.lastIndexOf("<",u))&&T.push(o()),e=e.substr(u),u=0;else T=t.parseNode?o():n("");return t.filter&&(T=i(T,t.filter)),t.simplify?r(Array.isArray(T)?T:[T]):(t.setPos&&(T.pos=u),T)}function r(e){var t={};if(!e.length)return"";if(1===e.length&&"string"==typeof e[0])return e[0];for(var i in e.forEach((function(e){if("object"==typeof e){t[e.tagName]||(t[e.tagName]=[]);var i=r(e.children);t[e.tagName].push(i),Object.keys(e.attributes).length&&"string"!=typeof i&&(i._attributes=e.attributes)}})),t)1==t[i].length&&(t[i]=t[i][0]);return t}function i(e,t,r,n){void 0===r&&(r=0),void 0===n&&(n="");var s=[];return e.forEach((function(e,a){if("object"==typeof e&&t(e,a,r,n)&&s.push(e),e.children){var o=i(e.children,t,r+1,(n?n+".":"")+a+"."+e.tagName);s=s.concat(o)}})),s}e.filter=i,e.getElementById=function(e,r,i){var n=t(e,{attrValue:r});return i?tXml.simplify(n):n[0]},e.getElementsByClassName=function(e,r,i){const n=t(e,{attrName:"class",attrValue:"[a-zA-Z0-9- ]*"+r+"[a-zA-Z0-9- ]*"});return i?tXml.simplify(n):n},e.parse=t,e.simplify=r,e.simplifyLostLess=function e(t,r){void 0===r&&(r={});var i={};return t.length?1===t.length&&"string"==typeof t[0]?Object.keys(r).length?{_attributes:r,value:t[0]}:t[0]:(t.forEach((function(t){if("object"==typeof t){i[t.tagName]||(i[t.tagName]=[]);var r=e(t.children||[],t.attributes);i[t.tagName].push(r),Object.keys(t.attributes).length&&(r._attributes=t.attributes)}})),i):i},e.stringify=function(e){function t(e){if(e)for(var t=0;t<e.length;t++)"string"==typeof e[t]?i+=e[t].trim():r(e[t])}function r(e){for(var r in i+="<"+e.tagName,e.attributes)null===e.attributes[r]?i+=" "+r:-1===e.attributes[r].indexOf('"')?i+=" "+r+'="'+e.attributes[r].trim()+'"':i+=" "+r+"='"+e.attributes[r].trim()+"'";"?"!==e.tagName[0]?(i+=">",t(e.children),i+="</"+e.tagName+">"):i+="?>"}var i="";return t(e),i},e.toContentString=function e(t){if(Array.isArray(t)){var r="";return t.forEach((function(t){r=(r+=" "+e(t)).trim()})),r}return"object"==typeof t?e(t.children):" "+t},Object.defineProperty(e,"__esModule",{value:!0})}(t)},866:(e,t,r)=>{(t=e.exports=r(870)(!1)).push([e.id,"._20Eh5WL::-webkit-media-controls{display:none!important}._1ll4Zna::-webkit-media-controls-current-time-display,._1ll4Zna::-webkit-media-controls-time-remaining-display{visibility:hidden!important}._3D52tih::-webkit-media-controls-timeline{visibility:hidden!important}._2yNfXKt::-webkit-media-controls-toggle-closed-captions-button{display:none}",""]),t.locals={video_hiddenControls:"_20Eh5WL",videoHiddenControls:"_20Eh5WL",video_hiddenTime:"_1ll4Zna",videoHiddenTime:"_1ll4Zna",video_hiddenTimeline:"_3D52tih",videoHiddenTimeline:"_3D52tih",video_hiddenSubtitlesBtn:"_2yNfXKt",videoHiddenSubtitlesBtn:"_2yNfXKt"}},9840:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});var i={};try{var n=(new EventTarget).constructor;class e extends n{}new e,i.EventTarget=(new EventTarget).constructor}catch(EventTarget){!function(e,t){function r(){t.set(this,a(null))}function n(e,t,r){o(e,t,{configurable:!0,writable:!0,value:r})}function s(e){var t=e.options;return t&&t.once&&e.target.removeEventListener(this.type,e.listener),"function"===typeof e.listener?e.listener.call(e.target,this):e.listener.handleEvent(this),this._stopImmediatePropagationFlag}var a=e.create,o=e.defineProperty,l=r.prototype;n(l,"addEventListener",(function(e,r,i){for(var n=t.get(this),s=n[e]||(n[e]=[]),a=0,o=s.length;a<o;a++)if(s[a].listener===r)return;s.push({target:this,listener:r,options:i})})),n(l,"dispatchEvent",(function(e){var r=t.get(this)[e.type];return r&&(n(e,"target",this),n(e,"currentTarget",this),r.slice(0).some(s,e),delete e.currentTarget,delete e.target),!0})),n(l,"removeEventListener",(function(e,r){for(var i=t.get(this),n=i[e]||(i[e]=[]),s=0,a=n.length;s<a;s++)if(n[s].listener===r)return void n.splice(s,1)})),i.EventTarget=r}(Object,new WeakMap)}const s=i.EventTarget}},r={};e.m=t,e.n=t=>{var r=t&&t.__esModule?()=>t.default:()=>t;return e.d(r,{a:r}),r},e.d=(t,r)=>{for(var i in r)e.o(r,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:r[i]})},e.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};e(9231)})();